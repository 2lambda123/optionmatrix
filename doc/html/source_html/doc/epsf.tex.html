<!-- Generator: GNU source-highlight 3.1.7
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">%%% -*-TeX-*-</font></i>
<i><font color="#9A1900">%%% ====================================================================</font></i>
<i><font color="#9A1900">%%%  @TeX-file{</font></i>
<i><font color="#9A1900">%%%     author          = "Tom Rokicki",</font></i>
<i><font color="#9A1900">%%%     version         = "2.7.4",</font></i>
<i><font color="#9A1900">%%%     date            = "14 February 2011",</font></i>
<i><font color="#9A1900">%%%     time            = "15:44:06 MST",</font></i>
<i><font color="#9A1900">%%%     filename        = "epsf.tex",</font></i>
<i><font color="#9A1900">%%%     address         = "Tom Rokicki</font></i>
<i><font color="#9A1900">%%%                        Box 2081</font></i>
<i><font color="#9A1900">%%%                        Stanford, CA 94309</font></i>
<i><font color="#9A1900">%%%                        USA",</font></i>
<i><font color="#9A1900">%%%     telephone       = "+1 415 855 9989",</font></i>
<i><font color="#9A1900">%%%     checksum        = "29223 653 3100 27123",</font></i>
<i><font color="#9A1900">%%%     email           = "rokicki@cs.stanford.edu (Internet)",</font></i>
<i><font color="#9A1900">%%%     codetable       = "ISO/ASCII",</font></i>
<i><font color="#9A1900">%%%     copyright       = "This file is freely redistributable and</font></i>
<i><font color="#9A1900">%%%                        placed into the public domain by Tomas</font></i>
<i><font color="#9A1900">%%%                        Rokicki.",</font></i>
<i><font color="#9A1900">%%%     keywords        = "PostScript, TeX",</font></i>
<i><font color="#9A1900">%%%     license         = "public domain",</font></i>
<i><font color="#9A1900">%%%     supported       = "yes",</font></i>
<i><font color="#9A1900">%%%     abstract        = "This file contains macros to support the</font></i>
<i><font color="#9A1900">%%%                        inclusion of Encapsulated PostScript files</font></i>
<i><font color="#9A1900">%%%                        in TeX documents.",</font></i>
<i><font color="#9A1900">%%%     docstring       = "This file contains TeX macros to include an</font></i>
<i><font color="#9A1900">%%%                        Encapsulated PostScript graphic.  It works</font></i>
<i><font color="#9A1900">%%%                        by finding the bounding box comment,</font></i>
<i><font color="#9A1900">%%%                        calculating the correct scale values, and</font></i>
<i><font color="#9A1900">%%%                        inserting a vbox of the appropriate size at</font></i>
<i><font color="#9A1900">%%%                        the current position in the TeX document.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        To use, simply use</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        \input epsf % somewhere early on in your TeX file</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        % then where you want to insert a vbox for a figure:</font></i>
<i><font color="#9A1900">%%%                        \epsfbox{filename.ps}</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        Alternatively, you can supply your own</font></i>
<i><font color="#9A1900">%%%                        bounding box by</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        \epsfbox[0 0 30 50]{filename.ps}</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        This will not read in the file, and will</font></i>
<i><font color="#9A1900">%%%                        instead use the bounding box you specify.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        The effect will be to typeset the figure as</font></i>
<i><font color="#9A1900">%%%                        a TeX box, at the point of your \epsfbox</font></i>
<i><font color="#9A1900">%%%                        command. By default, the graphic will have</font></i>
<i><font color="#9A1900">%%%                        its `natural' width (namely the width of</font></i>
<i><font color="#9A1900">%%%                        its bounding box, as described in</font></i>
<i><font color="#9A1900">%%%                        filename.ps). The TeX box will have depth</font></i>
<i><font color="#9A1900">%%%                        zero.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        You can enlarge or reduce the figure by</font></i>
<i><font color="#9A1900">%%%                        using</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                          \epsfxsize = &lt;dimen&gt; \epsfbox{filename.ps}</font></i>
<i><font color="#9A1900">%%%                        or</font></i>
<i><font color="#9A1900">%%%                          \epsfysize = &lt;dimen&gt; \epsfbox{filename.ps}</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        instead. Then the width of the TeX box will</font></i>
<i><font color="#9A1900">%%%                        be \epsfxsize and its height will be scaled</font></i>
<i><font color="#9A1900">%%%                        proportionately (or the height will be</font></i>
<i><font color="#9A1900">%%%                        \epsfysize and its width will be scaled</font></i>
<i><font color="#9A1900">%%%                        proportionately).</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        The width (and height) is restored to zero</font></i>
<i><font color="#9A1900">%%%                        after each use, so \epsfxsize or \epsfysize</font></i>
<i><font color="#9A1900">%%%                        must be specified before EACH use of</font></i>
<i><font color="#9A1900">%%%                        \epsfbox.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        A more general facility for sizing is</font></i>
<i><font color="#9A1900">%%%                        available by defining the \epsfsize macro.</font></i>
<i><font color="#9A1900">%%%                        Normally you can redefine this macro to do</font></i>
<i><font color="#9A1900">%%%                        almost anything.  The first parameter is</font></i>
<i><font color="#9A1900">%%%                        the natural x size of the PostScript</font></i>
<i><font color="#9A1900">%%%                        graphic, the second parameter is the</font></i>
<i><font color="#9A1900">%%%                        natural y size of the PostScript graphic.</font></i>
<i><font color="#9A1900">%%%                        It must return the xsize to use, or 0 if</font></i>
<i><font color="#9A1900">%%%                        natural scaling is to be used.  Common uses</font></i>
<i><font color="#9A1900">%%%                        include:</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                           \epsfxsize  % just leave the old value alone</font></i>
<i><font color="#9A1900">%%%                           0pt         % use the natural sizes</font></i>
<i><font color="#9A1900">%%%                           #1          % use the natural sizes</font></i>
<i><font color="#9A1900">%%%                           \hsize      % scale to full width</font></i>
<i><font color="#9A1900">%%%                           0.5#1       % scale to 50% of natural size</font></i>
<i><font color="#9A1900">%%%                           \ifnum #1 &gt; \hsize \hsize \else #1\fi</font></i>
<i><font color="#9A1900">%%%                                       % smaller of natural, hsize</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        If you want TeX to report the size of the</font></i>
<i><font color="#9A1900">%%%                        figure (as a message on your terminal when</font></i>
<i><font color="#9A1900">%%%                        it processes each figure), use</font></i>
<i><font color="#9A1900">%%%                        `\epsfverbosetrue'.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        If you only want to get the bounding box</font></i>
<i><font color="#9A1900">%%%                        extents, without producing any output boxes</font></i>
<i><font color="#9A1900">%%%                        or \special{}, then use \epsfgetbb{filename}.</font></i>
<i><font color="#9A1900">%%%                        The bounding box corner coordinates are saved</font></i>
<i><font color="#9A1900">%%%                        in the macros \epsfllx, \epsflly, \epsfurx,</font></i>
<i><font color="#9A1900">%%%                        and \epsfury in PostScript units of big</font></i>
<i><font color="#9A1900">%%%                        points.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        Revision history:</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        epsf.tex macro file:</font></i>
<i><font color="#9A1900">%%%                        Originally written by Tomas Rokicki of</font></i>
<i><font color="#9A1900">%%%                        Radical Eye Software, 29 Mar 1989.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        Revised by Don Knuth, 3 Jan 1990.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        Revised by Tomas Rokicki, 18 Jul 1990.</font></i>
<i><font color="#9A1900">%%%                        Accept bounding boxes with no space after</font></i>
<i><font color="#9A1900">%%%                        the colon.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        Revised by Nelson H. F. Beebe</font></i>
<i><font color="#9A1900">%%%                        &lt;beebe@math.utah.edu&gt;, 03 Dec 1991 [2.0].</font></i>
<i><font color="#9A1900">%%%                        Add version number and date typeout.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        Use \immediate\write16 instead of \message</font></i>
<i><font color="#9A1900">%%%                        to ensure output on new line.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        Handle nested EPS files.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        Handle %%BoundingBox: (atend) lines.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        Do not quit when blank lines are found.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        Add a few percents to remove generation of</font></i>
<i><font color="#9A1900">%%%                        spurious blank space.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        Move \special output to</font></i>
<i><font color="#9A1900">%%%                        \epsfspecial{filename} so that other macro</font></i>
<i><font color="#9A1900">%%%                        packages can input this one, then change</font></i>
<i><font color="#9A1900">%%%                        the definition of \epsfspecial to match</font></i>
<i><font color="#9A1900">%%%                        another DVI driver.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        Move size computation to \epsfsetsize which</font></i>
<i><font color="#9A1900">%%%                        can be called by the user; the verbose</font></i>
<i><font color="#9A1900">%%%                        output of the bounding box and scaled width</font></i>
<i><font color="#9A1900">%%%                        and height happens here.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        Revised by Nelson H. F. Beebe</font></i>
<i><font color="#9A1900">%%%                        &lt;beebe@math.utah.edu&gt;, 05 May 1992 [2.1].</font></i>
<i><font color="#9A1900">%%%                        Wrap \leavevmode\hbox{} around \vbox{} with</font></i>
<i><font color="#9A1900">%%%                        the \special so that \epsffile{} can be</font></i>
<i><font color="#9A1900">%%%                        used inside \begin{center}...\end{center}</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        Revised by Nelson H. F. Beebe</font></i>
<i><font color="#9A1900">%%%                        &lt;beebe@math.utah.edu&gt;, 09 Dec 1992 [2.2].</font></i>
<i><font color="#9A1900">%%%                        Introduce \epsfshow{true,false} and</font></i>
<i><font color="#9A1900">%%%                        \epsfframe{true,false} macros; the latter</font></i>
<i><font color="#9A1900">%%%                        suppresses the insertion of the PostScript,</font></i>
<i><font color="#9A1900">%%%                        and instead just creates an empty box,</font></i>
<i><font color="#9A1900">%%%                        which may be handy for rapid prototyping.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        Revised by Nelson H. F. Beebe</font></i>
<i><font color="#9A1900">%%%                        &lt;beebe@math.utah.edu&gt;, 14 Dec 1992 [2.3].</font></i>
<i><font color="#9A1900">%%%                        Add \epsfshowfilename{true,false}.  When</font></i>
<i><font color="#9A1900">%%%                        true, and \epsfshowfalse is specified, the</font></i>
<i><font color="#9A1900">%%%                        PostScript file name will be displayed</font></i>
<i><font color="#9A1900">%%%                        centered in the figure box.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        Revised by Nelson H. F. Beebe</font></i>
<i><font color="#9A1900">%%%                        &lt;beebe@math.utah.edu&gt;, 20 June 1993 [2.4].</font></i>
<i><font color="#9A1900">%%%                        Remove non-zero debug setting of \epsfframemargin,</font></i>
<i><font color="#9A1900">%%%                        and change margin handling to preserve EPS image</font></i>
<i><font color="#9A1900">%%%                        size and aspect ratio, so that the actual</font></i>
<i><font color="#9A1900">%%%                        box is \epsfxsize+\epsfframemargin wide by</font></i>
<i><font color="#9A1900">%%%                        \epsfysize+\epsfframemargin high.</font></i>
<i><font color="#9A1900">%%%                        Reduce output of \epsfshowfilenametrue to</font></i>
<i><font color="#9A1900">%%%                        just the bare file name.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        Revised by Nelson H. F. Beebe</font></i>
<i><font color="#9A1900">%%%                        &lt;beebe@math.utah.edu&gt;, 13 July 1993 [2.5].</font></i>
<i><font color="#9A1900">%%%                        Add \epsfframethickness for control of</font></i>
<i><font color="#9A1900">%%%                        \epsfframe frame lines.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        Revised by Nelson H. F. Beebe</font></i>
<i><font color="#9A1900">%%%                        &lt;beebe@math.utah.edu&gt;, 02 July 1996 [2.6]</font></i>
<i><font color="#9A1900">%%%                        Add missing initialization \epsfatendfalse;</font></i>
<i><font color="#9A1900">%%%                        the lack of this resulted in the wrong</font></i>
<i><font color="#9A1900">%%%                        BoundingBox being picked up, mea culpa, sigh...</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        Revised by Nelson H. F. Beebe</font></i>
<i><font color="#9A1900">%%%                        &lt;beebe@math.utah.edu&gt;, 25 October 1996 [2.7]</font></i>
<i><font color="#9A1900">%%%                        Update to match changes in from dvips 5-600</font></i>
<i><font color="#9A1900">%%%                        distribution: new user-accessible macros:</font></i>
<i><font color="#9A1900">%%%                        \epsfclipon, \epsfclipoff, \epsfdrafton,</font></i>
<i><font color="#9A1900">%%%                        \epsfdraftoff, change \empty to \epsfempty.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        Revised by Nelson H. F. Beebe</font></i>
<i><font color="#9A1900">%%%                        &lt;beebe@math.utah.edu&gt;, 18 May 2002 [2.7.1]</font></i>
<i><font color="#9A1900">%%%                        Add write statements to echo input file</font></i>
<i><font color="#9A1900">%%%                        names.  Prior to that change, an error in</font></i>
<i><font color="#9A1900">%%%                        such a file could be quite hard to track</font></i>
<i><font color="#9A1900">%%%                        down: a long list of TeX page numbers could</font></i>
<i><font color="#9A1900">%%%                        suddenly be followed by ``TeX buffer</font></i>
<i><font color="#9A1900">%%%                        capacity'' exceeded, without any indication</font></i>
<i><font color="#9A1900">%%%                        of the file that was responsible.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        Revised by Nelson H. F. Beebe</font></i>
<i><font color="#9A1900">%%%                        &lt;beebe@math.utah.edu&gt;, 16 May 2003 [2.7.2]</font></i>
<i><font color="#9A1900">%%%                        Supply two critical percent characters that</font></i>
<i><font color="#9A1900">%%%                        were mistakenly omitted in version 2.7.1,</font></i>
<i><font color="#9A1900">%%%                        and resulted in a small amount of spurious</font></i>
<i><font color="#9A1900">%%%                        horizontal space.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        Revised by Nelson H. F. Beebe</font></i>
<i><font color="#9A1900">%%%                        &lt;beebe@math.utah.edu&gt;, 14 Feb 2011 [2.7.3]</font></i>
<i><font color="#9A1900">%%%                        Add previously-missing \space in rwi</font></i>
<i><font color="#9A1900">%%%                        assignments (bug reported 14-Feb-2011 by</font></i>
<i><font color="#9A1900">%%%                        Stefan Rueger &lt;s.rueger@open.ac.uk&gt;).</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        Revised by Nelson H. F. Beebe</font></i>
<i><font color="#9A1900">%%%                        &lt;beebe@math.utah.edu&gt;, Karl Berry</font></i>
<i><font color="#9A1900">%%%                        &lt;karl@freefriends.org&gt;, and Robin Fairbairns</font></i>
<i><font color="#9A1900">%%%                        &lt;Robin.Fairbairns@cl.cam.ac.uk&gt;,</font></i>
<i><font color="#9A1900">%%%                        23 July 2005 [2.7.3]</font></i>
<i><font color="#9A1900">%%%                        Add critical \hbox{} wrapper in \epsfsetgraph</font></i>
<i><font color="#9A1900">%%%                        so that \epsfbox{} does not conflict with</font></i>
<i><font color="#9A1900">%%%                        LaTeX center environment when \epsfbox{} is</font></i>
<i><font color="#9A1900">%%%                        surrounded by other horizonal objects.</font></i>
<i><font color="#9A1900">%%%                        Improve macro readability by adding legal,</font></i>
<i><font color="#9A1900">%%%                        but invisible-in-typeset-output, spaces.</font></i>
<i><font color="#9A1900">%%%                        Ensure that verbose status reports come</font></i>
<i><font color="#9A1900">%%%                        inside (filename ...) list.</font></i>
<i><font color="#9A1900">%%%</font></i>
<i><font color="#9A1900">%%%                        ---------------------------------------------</font></i>
<i><font color="#9A1900">%%%                        The checksum field above contains a CRC-16</font></i>
<i><font color="#9A1900">%%%                        checksum as the first value, followed by</font></i>
<i><font color="#9A1900">%%%                        the equivalent of the standard UNIX wc</font></i>
<i><font color="#9A1900">%%%                        (word count) utility output of lines,</font></i>
<i><font color="#9A1900">%%%                        words, and characters.  This is produced by</font></i>
<i><font color="#9A1900">%%%                        Robert Solovay's checksum utility.",</font></i>
<i><font color="#9A1900">%%%  }</font></i>
<i><font color="#9A1900">%%% ====================================================================</font></i>

<i><font color="#9A1900">%\immediate \write16 {This is `epsf.tex' v2.0 &lt;02 Dec 1991&gt;}%</font></i>
<i><font color="#9A1900">%\immediate \write16 {This is `epsf.tex' v2.1 &lt;05 May 1992&gt;}%</font></i>
<i><font color="#9A1900">%\immediate \write16 {This is `epsf.tex' v2.2 &lt;09 Dec 1992&gt;}%</font></i>
<i><font color="#9A1900">%\immediate \write16 {This is `epsf.tex' v2.3 &lt;14 Dec 1992&gt;}%</font></i>
<i><font color="#9A1900">%\immediate \write16 {This is `epsf.tex' v2.4 &lt;20 June 1993&gt;}%</font></i>
<i><font color="#9A1900">%\immediate \write16 {This is `epsf.tex' v2.5 &lt;13 July 1993&gt;}%</font></i>
<i><font color="#9A1900">%\immediate \write16 {This is `epsf.tex' v2.6 &lt;02 July 1996&gt;}%</font></i>
<i><font color="#9A1900">%\immediate \write16 {This is `epsf.tex' v2.7 &lt;25 October 1996&gt;}%</font></i>
<i><font color="#9A1900">%\immediate \write16 {This is `epsf.tex' v2.7.1 &lt;18 May 2002&gt;}%</font></i>
<i><font color="#9A1900">%\immediate \write16 {This is `epsf.tex' v2.7.2 &lt;16 May 2003&gt;}%</font></i>
<i><font color="#9A1900">%\immediate \write16 {This is `epsf.tex' v2.7.3 &lt;23 July 2005&gt;}%</font></i>
<b><font color="#0000FF">\immediate</font></b> <b><font color="#0000FF">\write</font></b>16 <font color="#009900">{This is `epsf.tex' v2.7.4 &lt;14 February 2011&gt;}</font><i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\newread</font></b> <b><font color="#0000FF">\epsffilein</font></b>    <i><font color="#9A1900">% file to \read</font></i>
<b><font color="#0000FF">\newif</font></b> <b><font color="#0000FF">\ifepsfatend</font></b>     <i><font color="#9A1900">% need to scan to LAST %%BoundingBox comment?</font></i>
<b><font color="#0000FF">\newif</font></b> <b><font color="#0000FF">\ifepsfbbfound</font></b>   <i><font color="#9A1900">% success?</font></i>
<b><font color="#0000FF">\newif</font></b> <b><font color="#0000FF">\ifepsfdraft</font></b>     <i><font color="#9A1900">% use draft mode?</font></i>
<b><font color="#0000FF">\newif</font></b> <b><font color="#0000FF">\ifepsffileok</font></b>    <i><font color="#9A1900">% continue looking for the bounding box?</font></i>
<b><font color="#0000FF">\newif</font></b> <b><font color="#0000FF">\ifepsfframe</font></b>     <i><font color="#9A1900">% frame the bounding box?</font></i>
<b><font color="#0000FF">\newif</font></b> <b><font color="#0000FF">\ifepsfshow</font></b>      <i><font color="#9A1900">% show PostScript file, or just bounding box?</font></i>
<b><font color="#0000FF">\epsfshowtrue</font></b>          <i><font color="#9A1900">% default is to display PostScript file</font></i>
<b><font color="#0000FF">\newif</font></b> <b><font color="#0000FF">\ifepsfshowfilename</font></b> <i><font color="#9A1900">% show the file name if \epsfshowfalse specified?</font></i>
<b><font color="#0000FF">\newif</font></b> <b><font color="#0000FF">\ifepsfverbose</font></b>   <i><font color="#9A1900">% report what you're making?</font></i>
<b><font color="#0000FF">\newdimen</font></b> <b><font color="#0000FF">\epsfframemargin</font></b> <i><font color="#9A1900">% margin between box and frame</font></i>
<b><font color="#0000FF">\newdimen</font></b> <b><font color="#0000FF">\epsfframethickness</font></b> <i><font color="#9A1900">% thickness of frame rules</font></i>
<b><font color="#0000FF">\newdimen</font></b> <b><font color="#0000FF">\epsfrsize</font></b>    <i><font color="#9A1900">% vertical size before scaling</font></i>
<b><font color="#0000FF">\newdimen</font></b> <b><font color="#0000FF">\epsftmp</font></b>      <i><font color="#9A1900">% register for arithmetic manipulation</font></i>
<b><font color="#0000FF">\newdimen</font></b> <b><font color="#0000FF">\epsftsize</font></b>    <i><font color="#9A1900">% horizontal size before scaling</font></i>
<b><font color="#0000FF">\newdimen</font></b> <b><font color="#0000FF">\epsfxsize</font></b>    <i><font color="#9A1900">% horizontal size after scaling</font></i>
<b><font color="#0000FF">\newdimen</font></b> <b><font color="#0000FF">\epsfysize</font></b>    <i><font color="#9A1900">% vertical size after scaling</font></i>
<b><font color="#0000FF">\newdimen</font></b> <b><font color="#0000FF">\pspoints</font></b>     <i><font color="#9A1900">% conversion factor</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\pspoints</font></b> = 1bp        <i><font color="#9A1900">% Adobe points are `big'</font></i>
<b><font color="#0000FF">\epsfxsize</font></b> = 0pt       <i><font color="#9A1900">% default value, means `use natural size'</font></i>
<b><font color="#0000FF">\epsfysize</font></b> = 0pt       <i><font color="#9A1900">% ditto</font></i>
<b><font color="#0000FF">\epsfframemargin</font></b> = 0pt <i><font color="#9A1900">% default value: frame box flush around picture</font></i>
<b><font color="#0000FF">\epsfframethickness</font></b> = 0.4pt <i><font color="#9A1900">% TeX's default rule thickness</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfbox</font></b> #1<font color="#009900">{%</font>
<font color="#009900">    \global \def \epsfllx {72}%</font>
<font color="#009900">    \global \def \epsflly {72}%</font>
<font color="#009900">    \global \def \epsfurx {540}%</font>
<font color="#009900">    \global \def \epsfury {720}%</font>
<font color="#009900">    \def \lbracket {[}%</font>
<font color="#009900">    \def \testit {#1}%</font>
<font color="#009900">    \ifx \testit \lbracket</font>
<font color="#009900">        \let \next = \epsfgetlitbb</font>
<font color="#009900">    \else</font>
<font color="#009900">        \let \next = \epsfnormal</font>
<font color="#009900">    \fi</font>
<font color="#009900">    \next{#1}%</font>
<font color="#009900">}</font><i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% We use \epsfgetlitbb if the user specified an explicit bounding box,</font></i>
<i><font color="#9A1900">% and \epsfnormal otherwise.  Because \epsfgetbb can be called</font></i>
<i><font color="#9A1900">% separately to retrieve the bounding box, we move the verbose</font></i>
<i><font color="#9A1900">% printing the bounding box extents and size on the terminal to</font></i>
<i><font color="#9A1900">% \epsfstatus.  Therefore, when the user provided the bounding box,</font></i>
<i><font color="#9A1900">% \epsfgetbb will not be called, so we must call \epsfsetsize and</font></i>
<i><font color="#9A1900">% \epsfstatus ourselves.</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfgetlitbb</font></b> #1#2 #3 #4 #5]#6<font color="#009900">{%</font>
<font color="#009900">   \epsfgrab #2 #3 #4 #5 .\\%</font>
<font color="#009900">   \epsfsetsize</font>
<font color="#009900">   \epsfstatus{#6}%</font>
<font color="#009900">   \epsfsetgraph{#6}%</font>
<font color="#009900">}</font><i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfnormal</font></b> #1<font color="#009900">{%</font>
<font color="#009900">    \epsfgetbb{#1}%</font>
<font color="#009900">    \epsfsetgraph{#1}%</font>
<font color="#009900">}</font><i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfgetbb</font></b> #1<font color="#009900">{%</font>
<font color="#009900">%</font>
<font color="#009900">%   The first thing we need to do is to open the</font>
<font color="#009900">%   PostScript file, if possible.</font>
<font color="#009900">%</font>
<font color="#009900">    \openin\epsffilein=#1</font>
<font color="#009900">    \immediate \write16 {(#1}%</font>
<font color="#009900">    \ifeof \epsffilein</font>
<font color="#009900">        \errmessage{Could not open file #1, ignoring it}%</font>
<font color="#009900">    \else                       %process the file</font>
<font color="#009900">        {%                      %start a group to contain catcode changes</font>
<font color="#009900">            % Make all special characters, except space, to be of type</font>
<font color="#009900">            % `other' so we process the file in almost verbatim mode</font>
<font color="#009900">            % (TeXbook, p. 344).</font>
<font color="#009900">            \chardef \other = 12%</font>
<font color="#009900">            \def \do ##1{\catcode`##1=\other}%</font>
<font color="#009900">            \dospecials</font>
<font color="#009900">            \catcode `\ = 10%</font>
<font color="#009900">            \epsffileoktrue        %true while we are looping</font>
<font color="#009900">            \epsfatendfalse        %[02-Jul-1996]: add forgotten initialization</font>
<font color="#009900">            \loop                  %reading lines from the EPS file</font>
<font color="#009900">                \read \epsffilein to \epsffileline</font>
<font color="#009900">                \ifeof \epsffilein %then no more input</font>
<font color="#009900">                \epsffileokfalse   %so set completion flag</font>
<font color="#009900">            \else                  %otherwise process one line</font>
<font color="#009900">                \expandafter \epsfaux \epsffileline :. \\%</font>
<font color="#009900">            \fi</font>
<font color="#009900">            \ifepsffileok</font>
<font color="#009900">            \repeat</font>
<font color="#009900">            \ifepsfbbfound</font>
<font color="#009900">            \else</font>
<font color="#009900">                \ifepsfverbose</font>
<font color="#009900">                    \immediate \write16 {No BoundingBox comment found in %</font>
<font color="#009900">                                         file #1; using defaults}%</font>
<font color="#009900">                \fi</font>
<font color="#009900">            \fi</font>
<font color="#009900">        }%                      %end catcode changes</font>
<font color="#009900">        \closein\epsffilein</font>
<font color="#009900">    \fi                         %end of file processing</font>
<font color="#009900">    \epsfsetsize                %compute size parameters</font>
<font color="#009900">    \epsfstatus{#1}%</font>
<font color="#009900">    \immediate \write16 {)}%</font>
<font color="#009900">}</font><i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% Clipping control:</font></i>
<b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfclipon</font></b>  <font color="#009900">{\def \epsfclipstring { clip}}</font><i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfclipoff</font></b> <font color="#009900">{\def \epsfclipstring {\ifepsfdraft \space clip\fi}}</font><i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\epsfclipoff</font></b> <i><font color="#9A1900">% default for dvips is OFF</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% The special that is emitted by \epsfsetgraph comes from this macro.</font></i>
<i><font color="#9A1900">% It is defined separately to allow easy customization by other</font></i>
<i><font color="#9A1900">% packages that first \input epsf.tex, then redefine \epsfspecial.</font></i>
<i><font color="#9A1900">% This macro is invoked in the lower-left corner of a box of the</font></i>
<i><font color="#9A1900">% width and height determined from the arguments to \epsffile, or</font></i>
<i><font color="#9A1900">% from the %%BoundingBox in the EPS file itself.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% This version is for dvips:</font></i>
<b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfspecial</font></b> #1<font color="#009900">{%</font>
<font color="#009900">     \epsftmp=10\epsfxsize</font>
<font color="#009900">     \divide \epsftmp by \pspoints</font>
<font color="#009900">     \ifnum \epsfrsize = 0%</font>
<font color="#009900">       \relax</font>
<font color="#009900">       \special{PSfile=\ifepsfdraft psdraft.ps\else#1\fi\space</font>
<font color="#009900">		llx=\epsfllx\space</font>
<font color="#009900">		lly=\epsflly\space</font>
<font color="#009900">		urx=\epsfurx\space</font>
<font color="#009900">		ury=\epsfury\space</font>
<font color="#009900">		rwi=\number\epsftmp\space</font>
<font color="#009900">		\epsfclipstring</font>
<font color="#009900">               }%</font>
<font color="#009900">     \else</font>
<font color="#009900">       \epsfrsize=10\epsfysize</font>
<font color="#009900">       \divide \epsfrsize by \pspoints</font>
<font color="#009900">       \special{PSfile=\ifepsfdraft psdraft.ps\else#1\fi\space</font>
<font color="#009900">		llx=\epsfllx\space</font>
<font color="#009900">		lly=\epsflly\space</font>
<font color="#009900">		urx=\epsfurx\space</font>
<font color="#009900">		ury=\epsfury\space</font>
<font color="#009900">		rwi=\number\epsftmp\space</font>
<font color="#009900">		rhi=\number\epsfrsize</font>
<font color="#009900">		\epsfclipstring</font>
<font color="#009900">               }%</font>
<font color="#009900">     \fi</font>
<font color="#009900">}</font><i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% \epsfframe macro adapted from the TeXbook, exercise 21.3, p. 223, 331.</font></i>
<i><font color="#9A1900">% but modified to set the box width to the natural width, rather</font></i>
<i><font color="#9A1900">% than the line width, and to include space for margins and rules</font></i>
<b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfframe</font></b> #1<i><font color="#9A1900">%</font></i>
<font color="#009900">{%</font>
<font color="#009900"> % method for detecting latex suggested by Robin Fairbairns, May 2005.</font>
<font color="#009900">  \ifx \documentstyle \epsfundefined</font>
<font color="#009900">    \relax</font>
<font color="#009900">  \else</font>
<font color="#009900">%    \leavevmode                   % so we can put this inside</font>
<font color="#009900">                                  % a latex centered environment</font>
<font color="#009900">    % The \leavevmode breaks under plain when this is inside a box,</font>
<font color="#009900">    % because it forces the figure to be the entire \hsize.  On the</font>
<font color="#009900">    % other hand, we need the \leavevmode for it to work in LaTeX,</font>
<font color="#009900">    % because the {center} environment works by adjusting TeX's</font>
<font color="#009900">    % paragraph parameters.</font>
<font color="#009900">    %</font>
<font color="#009900">    % Compare the LaTeX sequence</font>
<font color="#009900">    % \begin{center}</font>
<font color="#009900">    %   \epsfbox{tip.eps}q</font>
<font color="#009900">    % \end{center}</font>
<font color="#009900">    % (needs the \leavevmode to put the q right next to the image)</font>
<font color="#009900">    %</font>
<font color="#009900">    % with the plain TeX sequence:</font>
<font color="#009900">    % \leftline{\vbox{\epsfbox{tip.eps}}q}</font>
<font color="#009900">    % (had the q all the way over to the right, when \leavevmode was used)</font>
<font color="#009900">  \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  \setbox0 = \hbox{#1}%</font>
<font color="#009900">  \dimen0 = \wd0                                % natural width of argument</font>
<font color="#009900">  \advance \dimen0 by 2\epsfframemargin         % plus width of 2 margins</font>
<font color="#009900">  \advance \dimen0 by 2\epsfframethickness      % plus width of 2 rule lines</font>
<font color="#009900">  \relax</font>
<font color="#009900">  \hbox{%</font>
<font color="#009900">    \vbox</font>
<font color="#009900">    {%</font>
<font color="#009900">      \hrule height \epsfframethickness depth 0pt</font>
<font color="#009900">      \hbox to \dimen0</font>
<font color="#009900">      {%</font>
<font color="#009900">	\hss</font>
<font color="#009900">	\vrule width \epsfframethickness</font>
<font color="#009900">	\kern \epsfframemargin</font>
<font color="#009900">	\vbox {\kern \epsfframemargin \box0 \kern \epsfframemargin }%</font>
<font color="#009900">	\kern \epsfframemargin</font>
<font color="#009900">	\vrule width \epsfframethickness</font>
<font color="#009900">	\hss</font>
<font color="#009900">      }% end hbox</font>
<font color="#009900">      \hrule height 0pt depth \epsfframethickness</font>
<font color="#009900">    }% end vbox</font>
<font color="#009900">  }% end hbox</font>
<font color="#009900">  \relax</font>
<font color="#009900">}</font><i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfsetgraph</font></b> #1<i><font color="#9A1900">%</font></i>
<font color="#009900">{%</font>
<font color="#009900">   %</font>
<font color="#009900">   % Make the vbox and stick in a \special that the DVI driver can</font>
<font color="#009900">   % parse.  \vfil and \hfil are used to place the \special origin at</font>
<font color="#009900">   % the lower-left corner of the vbox.  \epsfspecial can be redefined</font>
<font color="#009900">   % to produce alternate \special syntaxes.</font>
<font color="#009900">   %</font>
<font color="#009900">   \ifvmode \leavevmode \fi</font>
<font color="#009900">   \relax</font>
<font color="#009900">   \hbox{% so we can put this in \begin{center}...\end{center}</font>
<font color="#009900">     \ifepsfframe \expandafter \epsfframe \fi</font>
<font color="#009900">     {\vbox to\epsfysize</font>
<font color="#009900">     {%</font>
<font color="#009900">        \ifepsfshow</font>
<font color="#009900">            % output \special{} at lower-left corner of figure box</font>
<font color="#009900">            \vfil</font>
<font color="#009900">            \hbox to \epsfxsize{\epsfspecial{#1}\hfil}%</font>
<font color="#009900">        \else</font>
<font color="#009900">            \vfil</font>
<font color="#009900">            \hbox to\epsfxsize{%</font>
<font color="#009900">               \hss</font>
<font color="#009900">               \ifepsfshowfilename</font>
<font color="#009900">               {%</font>
<font color="#009900">                  \epsfframemargin=3pt % local change of margin</font>
<font color="#009900">                  \epsfframe{{\tt #1}}%</font>
<font color="#009900">               }%</font>
<font color="#009900">               \fi</font>
<font color="#009900">               \hss</font>
<font color="#009900">            }%</font>
<font color="#009900">            \vfil</font>
<font color="#009900">        \fi</font>
<font color="#009900">     }%</font>
<font color="#009900">   }}%</font>
<font color="#009900">   \relax</font>
<font color="#009900">   %</font>
<font color="#009900">   % Reset \epsfxsize and \epsfysize, as documented above.</font>
<font color="#009900">   %</font>
<font color="#009900">   \global \epsfxsize = 0pt</font>
<font color="#009900">   \global \epsfysize = 0pt</font>
<font color="#009900">}</font><i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%   Now we have to calculate the scale and offset values to use.</font></i>
<i><font color="#9A1900">%   First we compute the natural sizes.</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfsetsize</font></b>
<font color="#009900">{%</font>
<font color="#009900">   \epsfrsize = \epsfury \pspoints</font>
<font color="#009900">   \advance \epsfrsize by -\epsflly \pspoints</font>
<font color="#009900">   \epsftsize = \epsfurx \pspoints</font>
<font color="#009900">   \advance \epsftsize by -\epsfllx \pspoints</font>
<font color="#009900">%</font>
<font color="#009900">%   If `epsfxsize' is 0, we default to the natural size of the picture.</font>
<font color="#009900">%   Otherwise we scale the graph to be \epsfxsize wide.</font>
<font color="#009900">%</font>
<font color="#009900">   \epsfxsize = \epsfsize{\epsftsize}{\epsfrsize}%</font>
<font color="#009900">   \ifnum \epsfxsize = 0</font>
<font color="#009900">      \ifnum \epsfysize = 0</font>
<font color="#009900">	\epsfxsize = \epsftsize</font>
<font color="#009900">        \epsfysize = \epsfrsize</font>
<font color="#009900">	\epsfrsize = 0pt</font>
<font color="#009900">%</font>
<font color="#009900">%   We have a sticky problem here:  TeX doesn't do floating point arithmetic!</font>
<font color="#009900">%   Our goal is to compute y = rx/t. The following loop does this reasonably</font>
<font color="#009900">%   fast, with an error of at most about 16 sp (about 1/4000 pt).</font>
<font color="#009900">%</font>
<font color="#009900">      \else</font>
<font color="#009900">	\epsftmp = \epsftsize</font>
<font color="#009900">        \divide \epsftmp by \epsfrsize</font>
<font color="#009900">	\epsfxsize = \epsfysize</font>
<font color="#009900">        \multiply \epsfxsize by \epsftmp</font>
<font color="#009900">	\multiply \epsftmp by \epsfrsize</font>
<font color="#009900">        \advance \epsftsize by -\epsftmp</font>
<font color="#009900">	\epsftmp = \epsfysize</font>
<font color="#009900">	\loop</font>
<font color="#009900">        \advance \epsftsize by \epsftsize</font>
<font color="#009900">        \divide \epsftmp by 2</font>
<font color="#009900">	\ifnum \epsftmp &gt; 0</font>
<font color="#009900">	   \ifnum \epsftsize &lt; \epsfrsize</font>
<font color="#009900">           \else</font>
<font color="#009900">	      \advance \epsftsize -\epsfrsize</font>
<font color="#009900">              \advance \epsfxsize \epsftmp</font>
<font color="#009900">           \fi</font>
<font color="#009900">	\repeat</font>
<font color="#009900">	\epsfrsize = 0pt</font>
<font color="#009900">      \fi</font>
<font color="#009900">   \else</font>
<font color="#009900">     \ifnum \epsfysize = 0</font>
<font color="#009900">       \epsftmp = \epsfrsize</font>
<font color="#009900">       \divide \epsftmp by \epsftsize</font>
<font color="#009900">       \epsfysize = \epsfxsize</font>
<font color="#009900">       \multiply \epsfysize by \epsftmp</font>
<font color="#009900">       \multiply \epsftmp by \epsftsize</font>
<font color="#009900">       \advance \epsfrsize by -\epsftmp</font>
<font color="#009900">       \epsftmp = \epsfxsize</font>
<font color="#009900">       \loop</font>
<font color="#009900">	 \advance \epsfrsize by \epsfrsize</font>
<font color="#009900">	 \divide \epsftmp by 2</font>
<font color="#009900">       \ifnum \epsftmp &gt; 0</font>
<font color="#009900">	  \ifnum \epsfrsize &lt; \epsftsize</font>
<font color="#009900">          \else</font>
<font color="#009900">	     \advance \epsfrsize by -\epsftsize</font>
<font color="#009900">             \advance \epsfysize by \epsftmp</font>
<font color="#009900">          \fi</font>
<font color="#009900">       \repeat</font>
<font color="#009900">       \epsfrsize = 0pt</font>
<font color="#009900">     \else</font>
<font color="#009900">       \epsfrsize = \epsfysize</font>
<font color="#009900">     \fi</font>
<font color="#009900">   \fi</font>
<font color="#009900">}</font><i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% Issue some status messages if the user requested them</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfstatus</font></b> #1<font color="#009900">{% arg = filename</font>
<font color="#009900">   \ifepsfverbose</font>
<font color="#009900">     \immediate \write16 {#1: BoundingBox:</font>
<font color="#009900">			  llx = \epsfllx \space lly = \epsflly \space</font>
<font color="#009900">			  urx = \epsfurx \space ury = \epsfury \space}%</font>
<font color="#009900">     \immediate \write16 {#1: scaled width = \the\epsfxsize \space</font>
<font color="#009900">			  scaled height = \the\epsfysize}%</font>
<font color="#009900">   \fi</font>
<font color="#009900">}</font><i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%   We still need to define the tricky \epsfaux macro. This requires</font></i>
<i><font color="#9A1900">%   a couple of magic constants for comparison purposes.</font></i>
<i><font color="#9A1900">%</font></i>
<font color="#009900">{\catcode`\%=12 \global \let \epsfpercent=%\global \def \epsfbblit {%BoundingBox}}</font><i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\global</font></b> <b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfatend</font></b><font color="#009900">{(atend)}</font><i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%   So we're ready to check for `%BoundingBox:' and to grab the</font></i>
<i><font color="#9A1900">%   values if they are found.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%   If we find a line</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%   %%BoundingBox: (atend)</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%   then we ignore it, but set a flag to force parsing all of the</font></i>
<i><font color="#9A1900">%   file, so the last %%BoundingBox parsed will be the one used.  This</font></i>
<i><font color="#9A1900">%   is necessary, because EPS files can themselves contain other EPS</font></i>
<i><font color="#9A1900">%   files with their own %%BoundingBox comments.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%   If we find a line</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%   %%BoundingBox: llx lly urx ury</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%   then we save the 4 values in \epsfllx, \epsflly, \epsfurx, \epsfury.</font></i>
<i><font color="#9A1900">%   Then, if we have not previously parsed an (atend), we flag completion</font></i>
<i><font color="#9A1900">%   and can stop reading the file.  Otherwise, we must keep on reading</font></i>
<i><font color="#9A1900">%   to end of file so that we find the values on the LAST %%BoundingBox.</font></i>
<b><font color="#0000FF">\long</font></b> <b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfaux</font></b>#1#2:#3<font color="#990000">\\</font><i><font color="#9A1900">%</font></i>
<font color="#009900">{%</font>
<font color="#009900">   \def \testit {#2}%           % save second character up to just before colon</font>
<font color="#009900">   \ifx#1\epsfpercent           % then first char is percent (quick test)</font>
<font color="#009900">       \ifx \testit \epsfbblit  % then (slow test) we have %%BoundingBox</font>
<font color="#009900">            \epsfgrab #3 . . . \\%</font>
<font color="#009900">            \ifx \epsfllx\epsfatend % then ignore %%BoundingBox: (atend)</font>
<font color="#009900">                \global \epsfatendtrue</font>
<font color="#009900">            \else               % else found %%BoundingBox: llx lly urx ury</font>
<font color="#009900">                \ifepsfatend    % then keep parsing ALL %%BoundingBox lines</font>
<font color="#009900">                \else           % else stop after first one parsed</font>
<font color="#009900">                    \epsffileokfalse</font>
<font color="#009900">                \fi</font>
<font color="#009900">                \global \epsfbbfoundtrue</font>
<font color="#009900">            \fi</font>
<font color="#009900">       \fi</font>
<font color="#009900">   \fi</font>
<font color="#009900">}</font><i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%   Here we grab the values and stuff them in the appropriate definitions.</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfempty</font></b> <font color="#009900">{}</font><i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfgrab</font></b> #1 #2 #3 #4 #5<font color="#990000">\\</font><font color="#009900">{%</font>
<font color="#009900">   \global \def \epsfllx {#1}\ifx \epsfllx\epsfempty</font>
<font color="#009900">      \epsfgrab #2 #3 #4 #5 .\\\else</font>
<font color="#009900">   \global \def \epsflly {#2}%</font>
<font color="#009900">   \global \def \epsfurx {#3}\global \def \epsfury {#4}\fi</font>
<font color="#009900">}</font><i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%   We default the epsfsize macro.</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def</font></b> <b><font color="#0000FF">\epsfsize</font></b> #1#2<font color="#009900">{\epsfxsize}</font><i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">%   Finally, another definition for compatibility with older macros.</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\let</font></b> <b><font color="#0000FF">\epsffile</font></b> = <b><font color="#0000FF">\epsfbox</font></b>
<b><font color="#0000FF">\endinput</font></b>
</tt></pre>
