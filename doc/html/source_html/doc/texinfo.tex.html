<!-- Generator: GNU source-highlight 3.1.7
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">% texinfo.tex -- TeX macros to handle Texinfo files.</font></i>
<i><font color="#9A1900">% </font></i>
<i><font color="#9A1900">% Load plain if necessary, i.e., if running under initex.</font></i>
<b><font color="#0000FF">\expandafter\ifx\csname</font></b> fmtname<b><font color="#0000FF">\endcsname\relax\input</font></b> plain<b><font color="#0000FF">\fi</font></b>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def\texinfoversion</font></b><font color="#009900">{2012-03-11.15}</font>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% Copyright 1985, 1986, 1988, 1990, 1991, 1992, 1993, 1994, 1995,</font></i>
<i><font color="#9A1900">% 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006,</font></i>
<i><font color="#9A1900">% 2007, 2008, 2009, 2010, 2011, 2012 Free Software Foundation, Inc.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% This texinfo.tex file is free software: you can redistribute it and/or</font></i>
<i><font color="#9A1900">% modify it under the terms of the GNU General Public License as</font></i>
<i><font color="#9A1900">% published by the Free Software Foundation, either version 3 of the</font></i>
<i><font color="#9A1900">% License, or (at your option) any later version.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% This texinfo.tex file is distributed in the hope that it will be</font></i>
<i><font color="#9A1900">% useful, but WITHOUT ANY WARRANTY; without even the implied warranty</font></i>
<i><font color="#9A1900">% of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</font></i>
<i><font color="#9A1900">% General Public License for more details.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% You should have received a copy of the GNU General Public License</font></i>
<i><font color="#9A1900">% along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% As a special exception, when this file is read by TeX when processing</font></i>
<i><font color="#9A1900">% a Texinfo source document, you may use the result without</font></i>
<i><font color="#9A1900">% restriction.  (This has been our intent since Texinfo was invented.)</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% Please try the latest version of texinfo.tex before submitting bug</font></i>
<i><font color="#9A1900">% reports; you can get the latest version from:</font></i>
<i><font color="#9A1900">%   http://www.gnu.org/software/texinfo/ (the Texinfo home page), or</font></i>
<i><font color="#9A1900">%   ftp://tug.org/tex/texinfo.tex</font></i>
<i><font color="#9A1900">%     (and all CTAN mirrors, see http://www.ctan.org).</font></i>
<i><font color="#9A1900">% The texinfo.tex in any given distribution could well be out</font></i>
<i><font color="#9A1900">% of date, so if that's what you're using, please check.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% Send bug reports to bug-texinfo@gnu.org.  Please include including a</font></i>
<i><font color="#9A1900">% complete document in each bug report with which we can reproduce the</font></i>
<i><font color="#9A1900">% problem.  Patches are, of course, greatly appreciated.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% To process a Texinfo manual with TeX, it's most reliable to use the</font></i>
<i><font color="#9A1900">% texi2dvi shell script that comes with the distribution.  For a simple</font></i>
<i><font color="#9A1900">% manual foo.texi, however, you can get away with this:</font></i>
<i><font color="#9A1900">%   tex foo.texi</font></i>
<i><font color="#9A1900">%   texindex foo.??</font></i>
<i><font color="#9A1900">%   tex foo.texi</font></i>
<i><font color="#9A1900">%   tex foo.texi</font></i>
<i><font color="#9A1900">%   dvips foo.dvi -o  # or whatever; this makes foo.ps.</font></i>
<i><font color="#9A1900">% The extra TeX runs get the cross-reference information correct.</font></i>
<i><font color="#9A1900">% Sometimes one run after texindex suffices, and sometimes you need more</font></i>
<i><font color="#9A1900">% than two; texi2dvi does it as many times as necessary.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% It is possible to adapt texinfo.tex for other languages, to some</font></i>
<i><font color="#9A1900">% extent.  You can get the existing language-specific files from the</font></i>
<i><font color="#9A1900">% full Texinfo distribution.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% The GNU Texinfo home page is http://www.gnu.org/software/texinfo.</font></i>


<b><font color="#0000FF">\message</font></b><font color="#009900">{Loading texinfo [version \texinfoversion]:}</font>

<i><font color="#9A1900">% If in a .fmt file, print the version number</font></i>
<i><font color="#9A1900">% and turn on active characters that we couldn't do earlier because</font></i>
<i><font color="#9A1900">% they might have appeared in the input file name.</font></i>
<b><font color="#0000FF">\everyjob</font></b><font color="#009900">{\message{[Texinfo version \texinfoversion]}%</font>
<font color="#009900">  \catcode`+=\active \catcode`\_=\active}</font>

<b><font color="#0000FF">\chardef\other</font></b>=12

<i><font color="#9A1900">% We never want plain's \outer definition of \+ in Texinfo.</font></i>
<i><font color="#9A1900">% For @tex, we can use \tabalign.</font></i>
<b><font color="#0000FF">\let</font></b>\+ = <b><font color="#0000FF">\relax</font></b>

<i><font color="#9A1900">% Save some plain tex macros whose names we will redefine.</font></i>
<b><font color="#0000FF">\let\ptexb</font></b>=<b><font color="#0000FF">\b</font></b>
<b><font color="#0000FF">\let\ptexbullet</font></b>=<b><font color="#0000FF">\bullet</font></b>
<b><font color="#0000FF">\let\ptexc</font></b>=<b><font color="#0000FF">\c</font></b>
<b><font color="#0000FF">\let\ptexcomma</font></b>=\,
<b><font color="#0000FF">\let\ptexdot</font></b>=\.
<b><font color="#0000FF">\let\ptexdots</font></b>=<b><font color="#0000FF">\dots</font></b>
<b><font color="#0000FF">\let\ptexend</font></b>=<b><font color="#0000FF">\end</font></b>
<b><font color="#0000FF">\let\ptexequiv</font></b>=<b><font color="#0000FF">\equiv</font></b>
<b><font color="#0000FF">\let\ptexexclam</font></b>=\!
<b><font color="#0000FF">\let\ptexfootnote</font></b>=<b><font color="#0000FF">\footnote</font></b>
<b><font color="#0000FF">\let\ptexgtr</font></b>=&gt;
<b><font color="#0000FF">\let\ptexhat</font></b>=^
<b><font color="#0000FF">\let\ptexi</font></b>=<b><font color="#0000FF">\i</font></b>
<b><font color="#0000FF">\let\ptexindent</font></b>=<b><font color="#0000FF">\indent</font></b>
<b><font color="#0000FF">\let\ptexinsert</font></b>=<b><font color="#0000FF">\insert</font></b>
<b><font color="#0000FF">\let\ptexlbrace</font></b>=<font color="#990000">\{</font>
<b><font color="#0000FF">\let\ptexless</font></b>=&lt;
<b><font color="#0000FF">\let\ptexnewwrite\newwrite</font></b>
<b><font color="#0000FF">\let\ptexnoindent</font></b>=<b><font color="#0000FF">\noindent</font></b>
<b><font color="#0000FF">\let\ptexplus</font></b>=+
<b><font color="#0000FF">\let\ptexraggedright</font></b>=<b><font color="#0000FF">\raggedright</font></b>
<b><font color="#0000FF">\let\ptexrbrace</font></b>=<font color="#990000">\}</font>
<b><font color="#0000FF">\let\ptexslash</font></b>=\/
<b><font color="#0000FF">\let\ptexstar</font></b>=\<font color="#990000">*</font>
<b><font color="#0000FF">\let\ptext</font></b>=<b><font color="#0000FF">\t</font></b>
<b><font color="#0000FF">\let\ptextop</font></b>=<b><font color="#0000FF">\top</font></b>
<font color="#009900">{\catcode`\'=\active \global\let\ptexquoteright'}</font><i><font color="#9A1900">% active in plain's math mode</font></i>

<i><font color="#9A1900">% If this character appears in an error message or help string, it</font></i>
<i><font color="#9A1900">% starts a new line in the output.</font></i>
<b><font color="#0000FF">\newlinechar</font></b> = <font color="#FF0000">`^^J</font>

<font color="#FF0000">% Use TeX 3.0'</font>s <b><font color="#0000FF">\inputlineno</font></b> to get the line number, for better error
<i><font color="#9A1900">% messages, but if we're using an old version of TeX, don't do anything.</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\ifx\inputlineno\thisisundefined</font></b>
  <b><font color="#0000FF">\let\linenumber</font></b> = <b><font color="#0000FF">\empty</font></b> <i><font color="#9A1900">% Pre-3.0.</font></i>
<b><font color="#0000FF">\else</font></b>
  <b><font color="#0000FF">\def\linenumber</font></b><font color="#009900">{l.\the\inputlineno:\space}</font>
<b><font color="#0000FF">\fi</font></b>

<i><font color="#9A1900">% Set up fixed words for English if not already set.</font></i>
<b><font color="#0000FF">\ifx\putwordAppendix\undefined</font></b>  <b><font color="#0000FF">\gdef\putwordAppendix</font></b><font color="#009900">{Appendix}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordChapter\undefined</font></b>   <b><font color="#0000FF">\gdef\putwordChapter</font></b><font color="#009900">{Chapter}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putworderror\undefined</font></b>     <b><font color="#0000FF">\gdef\putworderror</font></b><font color="#009900">{error}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordfile\undefined</font></b>      <b><font color="#0000FF">\gdef\putwordfile</font></b><font color="#009900">{file}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordin\undefined</font></b>        <b><font color="#0000FF">\gdef\putwordin</font></b><font color="#009900">{in}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordIndexIsEmpty\undefined</font></b>       <b><font color="#0000FF">\gdef\putwordIndexIsEmpty</font></b><font color="#009900">{(Index is empty)}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordIndexNonexistent\undefined</font></b>   <b><font color="#0000FF">\gdef\putwordIndexNonexistent</font></b><font color="#009900">{(Index is nonexistent)}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordInfo\undefined</font></b>      <b><font color="#0000FF">\gdef\putwordInfo</font></b><font color="#009900">{Info}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordInstanceVariableof\undefined</font></b> <b><font color="#0000FF">\gdef\putwordInstanceVariableof</font></b><font color="#009900">{Instance Variable of}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordMethodon\undefined</font></b>  <b><font color="#0000FF">\gdef\putwordMethodon</font></b><font color="#009900">{Method on}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordNoTitle\undefined</font></b>   <b><font color="#0000FF">\gdef\putwordNoTitle</font></b><font color="#009900">{No Title}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordof\undefined</font></b>        <b><font color="#0000FF">\gdef\putwordof</font></b><font color="#009900">{of}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordon\undefined</font></b>        <b><font color="#0000FF">\gdef\putwordon</font></b><font color="#009900">{on}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordpage\undefined</font></b>      <b><font color="#0000FF">\gdef\putwordpage</font></b><font color="#009900">{page}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordsection\undefined</font></b>   <b><font color="#0000FF">\gdef\putwordsection</font></b><font color="#009900">{section}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordSection\undefined</font></b>   <b><font color="#0000FF">\gdef\putwordSection</font></b><font color="#009900">{Section}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordsee\undefined</font></b>       <b><font color="#0000FF">\gdef\putwordsee</font></b><font color="#009900">{see}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordSee\undefined</font></b>       <b><font color="#0000FF">\gdef\putwordSee</font></b><font color="#009900">{See}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordShortTOC\undefined</font></b>  <b><font color="#0000FF">\gdef\putwordShortTOC</font></b><font color="#009900">{Short Contents}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordTOC\undefined</font></b>       <b><font color="#0000FF">\gdef\putwordTOC</font></b><font color="#009900">{Table of Contents}</font><b><font color="#0000FF">\fi</font></b>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\ifx\putwordMJan\undefined</font></b> <b><font color="#0000FF">\gdef\putwordMJan</font></b><font color="#009900">{January}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordMFeb\undefined</font></b> <b><font color="#0000FF">\gdef\putwordMFeb</font></b><font color="#009900">{February}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordMMar\undefined</font></b> <b><font color="#0000FF">\gdef\putwordMMar</font></b><font color="#009900">{March}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordMApr\undefined</font></b> <b><font color="#0000FF">\gdef\putwordMApr</font></b><font color="#009900">{April}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordMMay\undefined</font></b> <b><font color="#0000FF">\gdef\putwordMMay</font></b><font color="#009900">{May}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordMJun\undefined</font></b> <b><font color="#0000FF">\gdef\putwordMJun</font></b><font color="#009900">{June}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordMJul\undefined</font></b> <b><font color="#0000FF">\gdef\putwordMJul</font></b><font color="#009900">{July}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordMAug\undefined</font></b> <b><font color="#0000FF">\gdef\putwordMAug</font></b><font color="#009900">{August}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordMSep\undefined</font></b> <b><font color="#0000FF">\gdef\putwordMSep</font></b><font color="#009900">{September}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordMOct\undefined</font></b> <b><font color="#0000FF">\gdef\putwordMOct</font></b><font color="#009900">{October}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordMNov\undefined</font></b> <b><font color="#0000FF">\gdef\putwordMNov</font></b><font color="#009900">{November}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordMDec\undefined</font></b> <b><font color="#0000FF">\gdef\putwordMDec</font></b><font color="#009900">{December}</font><b><font color="#0000FF">\fi</font></b>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\ifx\putwordDefmac\undefined</font></b>    <b><font color="#0000FF">\gdef\putwordDefmac</font></b><font color="#009900">{Macro}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordDefspec\undefined</font></b>   <b><font color="#0000FF">\gdef\putwordDefspec</font></b><font color="#009900">{Special Form}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordDefvar\undefined</font></b>    <b><font color="#0000FF">\gdef\putwordDefvar</font></b><font color="#009900">{Variable}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordDefopt\undefined</font></b>    <b><font color="#0000FF">\gdef\putwordDefopt</font></b><font color="#009900">{User Option}</font><b><font color="#0000FF">\fi</font></b>
<b><font color="#0000FF">\ifx\putwordDeffunc\undefined</font></b>   <b><font color="#0000FF">\gdef\putwordDeffunc</font></b><font color="#009900">{Function}</font><b><font color="#0000FF">\fi</font></b>

<i><font color="#9A1900">% Since the category of space is not known, we have to be careful.</font></i>
<b><font color="#0000FF">\chardef\spacecat</font></b> = 10
<b><font color="#0000FF">\def\spaceisspace</font></b><font color="#009900">{\catcode`\ =\spacecat}</font>

<i><font color="#9A1900">% sometimes characters are active, so we need control sequences.</font></i>
<b><font color="#0000FF">\chardef\ampChar</font></b>   = <font color="#FF0000">`\&amp;</font>
<font color="#FF0000">\chardef\colonChar = `\:</font>
<font color="#FF0000">\chardef\commaChar = `\,</font>
<font color="#FF0000">\chardef\dashChar  = `\-</font>
<font color="#FF0000">\chardef\dotChar   = `\.</font>
<font color="#FF0000">\chardef\exclamChar= `\!</font>
<font color="#FF0000">\chardef\hashChar  = `\#</font>
<font color="#FF0000">\chardef\lquoteChar= `\`</font>
<font color="#FF0000">\chardef\questChar = `\?</font>
<font color="#FF0000">\chardef\rquoteChar= `\'</font>
<font color="#FF0000">\chardef\semiChar  = `\;</font>
<font color="#FF0000">\chardef\slashChar = `\/</font>
<font color="#FF0000">\chardef\underChar = `\_</font>

<font color="#FF0000">% Ignore a token.</font>
<font color="#FF0000">%</font>
<font color="#FF0000">\def\gobble#1{}</font>

<font color="#FF0000">% The following is used inside several \edef'</font>s.
<b><font color="#0000FF">\def\makecsname</font></b>#1<font color="#009900">{\expandafter\noexpand\csname#1\endcsname}</font>

<i><font color="#9A1900">% Hyphenation fixes.</font></i>
<b><font color="#0000FF">\hyphenation</font></b>{
  Flor-i-da Ghost-script Ghost-view Mac-OS Post-Script
  ap-pen-dix bit-map bit-maps
  data-base data-bases eshell fall-ing half-way long-est man-u-script
  man-u-scripts mini-buf-fer mini-buf-fers over-view par-a-digm
  par-a-digms rath-er rec-tan-gu-lar ro-bot-ics se-vere-ly set-up spa-ces
  spell-ing spell-ings
  stand-alone strong-est time-stamp time-stamps which-ever white-space
  wide-spread wrap-around
}

<i><font color="#9A1900">% Margin to add to right of even pages, to left of odd pages.</font></i>
<b><font color="#0000FF">\newdimen\bindingoffset</font></b>
<b><font color="#0000FF">\newdimen\normaloffset</font></b>
<b><font color="#0000FF">\newdimen\pagewidth</font></b> <b><font color="#0000FF">\newdimen\pageheight</font></b>

<i><font color="#9A1900">% For a final copy, take out the rectangles</font></i>
<i><font color="#9A1900">% that mark overfull boxes (in case you have decided</font></i>
<i><font color="#9A1900">% that the text looks ok even though it passes the margin).</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def\finalout</font></b><font color="#009900">{\overfullrule=0pt }</font>

<i><font color="#9A1900">% Sometimes it is convenient to have everything in the transcript file</font></i>
<i><font color="#9A1900">% and nothing on the terminal.  We don't just call \tracingall here,</font></i>
<i><font color="#9A1900">% since that produces some useless output on the terminal.  We also make</font></i>
<i><font color="#9A1900">% some effort to order the tracing commands to reduce output in the log</font></i>
<i><font color="#9A1900">% file; cf. trace.sty in LaTeX.</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def\gloggingall</font></b><font color="#009900">{\begingroup \globaldefs = 1 \loggingall \endgroup}</font><i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def\loggingall</font></b><font color="#009900">{%</font>
<font color="#009900">  \tracingstats2</font>
<font color="#009900">  \tracingpages1</font>
<font color="#009900">  \tracinglostchars2  % 2 gives us more in etex</font>
<font color="#009900">  \tracingparagraphs1</font>
<font color="#009900">  \tracingoutput1</font>
<font color="#009900">  \tracingmacros2</font>
<font color="#009900">  \tracingrestores1</font>
<font color="#009900">  \showboxbreadth\maxdimen \showboxdepth\maxdimen</font>
<font color="#009900">  \ifx\eTeXversion\thisisundefined\else % etex gives us more logging</font>
<font color="#009900">    \tracingscantokens1</font>
<font color="#009900">    \tracingifs1</font>
<font color="#009900">    \tracinggroups1</font>
<font color="#009900">    \tracingnesting2</font>
<font color="#009900">    \tracingassigns1</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \tracingcommands3  % 3 gives us more in etex</font>
<font color="#009900">  \errorcontextlines16</font>
<font color="#009900">}</font><i><font color="#9A1900">%</font></i>

<i><font color="#9A1900">% @errormsg{MSG}.  Do the index-like expansions on MSG, but if things</font></i>
<i><font color="#9A1900">% aren't perfect, it's not the end of the world, being an error message,</font></i>
<i><font color="#9A1900">% after all.</font></i>
<i><font color="#9A1900">% </font></i>
<b><font color="#0000FF">\def\errormsg</font></b><font color="#009900">{\begingroup \indexnofonts \doerrormsg}</font>
<b><font color="#0000FF">\def\doerrormsg</font></b>#1<font color="#009900">{\errmessage{#1}}</font>

<i><font color="#9A1900">% add check for \lastpenalty to plain's definitions.  If the last thing</font></i>
<i><font color="#9A1900">% we did was a \nobreak, we don't want to insert more space.</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def\smallbreak</font></b><font color="#009900">{\ifnum\lastpenalty&lt;10000\par\ifdim\lastskip&lt;\smallskipamount</font>
<font color="#009900">  \removelastskip\penalty-50\smallskip\fi\fi}</font>
<b><font color="#0000FF">\def\medbreak</font></b><font color="#009900">{\ifnum\lastpenalty&lt;10000\par\ifdim\lastskip&lt;\medskipamount</font>
<font color="#009900">  \removelastskip\penalty-100\medskip\fi\fi}</font>
<b><font color="#0000FF">\def\bigbreak</font></b><font color="#009900">{\ifnum\lastpenalty&lt;10000\par\ifdim\lastskip&lt;\bigskipamount</font>
<font color="#009900">  \removelastskip\penalty-200\bigskip\fi\fi}</font>

<i><font color="#9A1900">% Do @cropmarks to get crop marks.</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\newif\ifcropmarks</font></b>
<b><font color="#0000FF">\let\cropmarks</font></b> = <b><font color="#0000FF">\cropmarkstrue</font></b>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% Dimensions to add cropmarks at corners.</font></i>
<i><font color="#9A1900">% Added by P. A. MacKay, 12 Nov. 1986</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\newdimen\outerhsize</font></b> <b><font color="#0000FF">\newdimen\outervsize</font></b> <i><font color="#9A1900">% set by the paper size routines</font></i>
<b><font color="#0000FF">\newdimen\cornerlong</font></b>  <b><font color="#0000FF">\cornerlong</font></b>=1pc
<b><font color="#0000FF">\newdimen\cornerthick</font></b> <b><font color="#0000FF">\cornerthick</font></b>=.3pt
<b><font color="#0000FF">\newdimen\topandbottommargin</font></b> <b><font color="#0000FF">\topandbottommargin</font></b>=.75in

<i><font color="#9A1900">% Output a mark which sets \thischapter, \thissection and \thiscolor.</font></i>
<i><font color="#9A1900">% We dump everything together because we only have one kind of mark.</font></i>
<i><font color="#9A1900">% This works because we only use \botmark / \topmark, not \firstmark.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% A mark contains a subexpression of the \ifcase ... \fi construct.</font></i>
<i><font color="#9A1900">% \get*marks macros below extract the needed part using \ifcase.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% Another complication is to let the user choose whether \thischapter</font></i>
<i><font color="#9A1900">% (\thissection) refers to the chapter (section) in effect at the top</font></i>
<i><font color="#9A1900">% of a page, or that at the bottom of a page.  The solution is</font></i>
<i><font color="#9A1900">% described on page 260 of The TeXbook.  It involves outputting two</font></i>
<i><font color="#9A1900">% marks for the sectioning macros, one before the section break, and</font></i>
<i><font color="#9A1900">% one after.  I won't pretend I can describe this better than DEK...</font></i>
<b><font color="#0000FF">\def\domark</font></b><font color="#009900">{%</font>
<font color="#009900">  \toks0=\expandafter{\lastchapterdefs}%</font>
<font color="#009900">  \toks2=\expandafter{\lastsectiondefs}%</font>
<font color="#009900">  \toks4=\expandafter{\prevchapterdefs}%</font>
<font color="#009900">  \toks6=\expandafter{\prevsectiondefs}%</font>
<font color="#009900">  \toks8=\expandafter{\lastcolordefs}%</font>
<font color="#009900">  \mark{%</font>
<font color="#009900">                   \the\toks0 \the\toks2</font>
<font color="#009900">      \noexpand\or \the\toks4 \the\toks6</font>
<font color="#009900">    \noexpand\else \the\toks8</font>
<font color="#009900">  }%</font>
<font color="#009900">}</font>
<i><font color="#9A1900">% \topmark doesn't work for the very first chapter (after the title</font></i>
<i><font color="#9A1900">% page or the contents), so we use \firstmark there -- this gets us</font></i>
<i><font color="#9A1900">% the mark with the chapter defs, unless the user sneaks in, e.g.,</font></i>
<i><font color="#9A1900">% @setcolor (or @url, or @link, etc.) between @contents and the very</font></i>
<i><font color="#9A1900">% first @chapter.</font></i>
<b><font color="#0000FF">\def\gettopheadingmarks</font></b><font color="#009900">{%</font>
<font color="#009900">  \ifcase0\topmark\fi</font>
<font color="#009900">  \ifx\thischapter\empty \ifcase0\firstmark\fi \fi</font>
<font color="#009900">}</font>
<b><font color="#0000FF">\def\getbottomheadingmarks</font></b><font color="#009900">{\ifcase1\botmark\fi}</font>
<b><font color="#0000FF">\def\getcolormarks</font></b><font color="#009900">{\ifcase2\topmark\fi}</font>

<i><font color="#9A1900">% Avoid "undefined control sequence" errors.</font></i>
<b><font color="#0000FF">\def\lastchapterdefs</font></b><font color="#009900">{}</font>
<b><font color="#0000FF">\def\lastsectiondefs</font></b><font color="#009900">{}</font>
<b><font color="#0000FF">\def\prevchapterdefs</font></b><font color="#009900">{}</font>
<b><font color="#0000FF">\def\prevsectiondefs</font></b><font color="#009900">{}</font>
<b><font color="#0000FF">\def\lastcolordefs</font></b><font color="#009900">{}</font>

<i><font color="#9A1900">% Main output routine.</font></i>
<b><font color="#0000FF">\chardef\PAGE</font></b> = 255
<b><font color="#0000FF">\output</font></b> = <font color="#009900">{\onepageout{\pagecontents\PAGE}}</font>

<b><font color="#0000FF">\newbox\headlinebox</font></b>
<b><font color="#0000FF">\newbox\footlinebox</font></b>

<i><font color="#9A1900">% \onepageout takes a vbox as an argument.  Note that \pagecontents</font></i>
<i><font color="#9A1900">% does insertions, but you have to call it yourself.</font></i>
<b><font color="#0000FF">\def\onepageout</font></b>#1<font color="#009900">{%</font>
<font color="#009900">  \ifcropmarks \hoffset=0pt \else \hoffset=\normaloffset \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  \ifodd\pageno  \advance\hoffset by \bindingoffset</font>
<font color="#009900">  \else \advance\hoffset by -\bindingoffset\fi</font>
<font color="#009900">  %</font>
<font color="#009900">  % Do this outside of the \shipout so @code etc. will be expanded in</font>
<font color="#009900">  % the headline as they should be, not taken literally (outputting ''code).</font>
<font color="#009900">  \ifodd\pageno \getoddheadingmarks \else \getevenheadingmarks \fi</font>
<font color="#009900">  \setbox\headlinebox = \vbox{\let\hsize=\pagewidth \makeheadline}%</font>
<font color="#009900">  \ifodd\pageno \getoddfootingmarks \else \getevenfootingmarks \fi</font>
<font color="#009900">  \setbox\footlinebox = \vbox{\let\hsize=\pagewidth \makefootline}%</font>
<font color="#009900">  %</font>
<font color="#009900">  {%</font>
<font color="#009900">    % Have to do this stuff outside the \shipout because we want it to</font>
<font color="#009900">    % take effect in \write's, yet the group defined by the \vbox ends</font>
<font color="#009900">    % before the \shipout runs.</font>
<font color="#009900">    %</font>
<font color="#009900">    \indexdummies         % don't expand commands in the output.</font>
<font color="#009900">    \normalturnoffactive  % \ in index entries must not stay \, e.g., if</font>
<font color="#009900">               % the page break happens to be in the middle of an example.</font>
<font color="#009900">               % We don't want .vr (or whatever) entries like this:</font>
<font color="#009900">               % \entry{{\tt \indexbackslash }acronym}{32}{\code {\acronym}}</font>
<font color="#009900">               % "\acronym" won't work when it's read back in;</font>
<font color="#009900">               % it needs to be</font>
<font color="#009900">               % {\code {{\tt \backslashcurfont }acronym}</font>
<font color="#009900">    \shipout\vbox{%</font>
<font color="#009900">      % Do this early so pdf references go to the beginning of the page.</font>
<font color="#009900">      \ifpdfmakepagedest \pdfdest name{\the\pageno} xyz\fi</font>
<font color="#009900">      %</font>
<font color="#009900">      \ifcropmarks \vbox to \outervsize\bgroup</font>
<font color="#009900">        \hsize = \outerhsize</font>
<font color="#009900">        \vskip-\topandbottommargin</font>
<font color="#009900">        \vtop to0pt{%</font>
<font color="#009900">          \line{\ewtop\hfil\ewtop}%</font>
<font color="#009900">          \nointerlineskip</font>
<font color="#009900">          \line{%</font>
<font color="#009900">            \vbox{\moveleft\cornerthick\nstop}%</font>
<font color="#009900">            \hfill</font>
<font color="#009900">            \vbox{\moveright\cornerthick\nstop}%</font>
<font color="#009900">          }%</font>
<font color="#009900">          \vss}%</font>
<font color="#009900">        \vskip\topandbottommargin</font>
<font color="#009900">        \line\bgroup</font>
<font color="#009900">          \hfil % center the page within the outer (page) hsize.</font>
<font color="#009900">          \ifodd\pageno\hskip\bindingoffset\fi</font>
<font color="#009900">          \vbox\bgroup</font>
<font color="#009900">      \fi</font>
<font color="#009900">      %</font>
<font color="#009900">      \unvbox\headlinebox</font>
<font color="#009900">      \pagebody{#1}%</font>
<font color="#009900">      \ifdim\ht\footlinebox &gt; 0pt</font>
<font color="#009900">        % Only leave this space if the footline is nonempty.</font>
<font color="#009900">        % (We lessened \vsize for it in \oddfootingyyy.)</font>
<font color="#009900">        % The \baselineskip=24pt in plain's \makefootline has no effect.</font>
<font color="#009900">        \vskip 24pt</font>
<font color="#009900">        \unvbox\footlinebox</font>
<font color="#009900">      \fi</font>
<font color="#009900">      %</font>
<font color="#009900">      \ifcropmarks</font>
<font color="#009900">          \egroup % end of \vbox\bgroup</font>
<font color="#009900">        \hfil\egroup % end of (centering) \line\bgroup</font>
<font color="#009900">        \vskip\topandbottommargin plus1fill minus1fill</font>
<font color="#009900">        \boxmaxdepth = \cornerthick</font>
<font color="#009900">        \vbox to0pt{\vss</font>
<font color="#009900">          \line{%</font>
<font color="#009900">            \vbox{\moveleft\cornerthick\nsbot}%</font>
<font color="#009900">            \hfill</font>
<font color="#009900">            \vbox{\moveright\cornerthick\nsbot}%</font>
<font color="#009900">          }%</font>
<font color="#009900">          \nointerlineskip</font>
<font color="#009900">          \line{\ewbot\hfil\ewbot}%</font>
<font color="#009900">        }%</font>
<font color="#009900">      \egroup % \vbox from first cropmarks clause</font>
<font color="#009900">      \fi</font>
<font color="#009900">    }% end of \shipout\vbox</font>
<font color="#009900">  }% end of group with \indexdummies</font>
<font color="#009900">  \advancepageno</font>
<font color="#009900">  \ifnum\outputpenalty&gt;-20000 \else\dosupereject\fi</font>
<font color="#009900">}</font>

<font color="#009900">\newinsert\margin \dimen\margin=\maxdimen</font>

<font color="#009900">\def\pagebody#1{\vbox to\pageheight{\boxmaxdepth=\maxdepth #1}}</font>
<font color="#009900">{\catcode`\@ =11</font>
<font color="#009900">\gdef\pagecontents#1{\ifvoid\topins\else\unvbox\topins\fi</font>
<font color="#009900">% marginal hacks, juha@viisa.uucp (Juha Takala)</font>
<font color="#009900">\ifvoid\margin\else % marginal info is present</font>
<font color="#009900">  \rlap{\kern\hsize\vbox to\z@{\kern1pt\box\margin \vss}}\fi</font>
<font color="#009900">\dimen@=\dp#1\relax \unvbox#1\relax</font>
<font color="#009900">\ifvoid\footins\else\vskip\skip\footins\footnoterule \unvbox\footins\fi</font>
<font color="#009900">\ifr@ggedbottom \kern-\dimen@ \vfil \fi}</font>
<font color="#009900">}</font>

<font color="#009900">% Here are the rules for the cropmarks.  Note that they are</font>
<font color="#009900">% offset so that the space between them is truly \outerhsize or \outervsize</font>
<font color="#009900">% (P. A. MacKay, 12 November, 1986)</font>
<font color="#009900">%</font>
<font color="#009900">\def\ewtop{\vrule height\cornerthick depth0pt width\cornerlong}</font>
<font color="#009900">\def\nstop{\vbox</font>
<font color="#009900">  {\hrule height\cornerthick depth\cornerlong width\cornerthick}}</font>
<font color="#009900">\def\ewbot{\vrule height0pt depth\cornerthick width\cornerlong}</font>
<font color="#009900">\def\nsbot{\vbox</font>
<font color="#009900">  {\hrule height\cornerlong depth\cornerthick width\cornerthick}}</font>

<font color="#009900">% Parse an argument, then pass it to #1.  The argument is the rest of</font>
<font color="#009900">% the input line (except we remove a trailing comment).  #1 should be a</font>
<font color="#009900">% macro which expects an ordinary undelimited TeX argument.</font>
<font color="#009900">%</font>
<font color="#009900">\def\parsearg{\parseargusing{}}</font>
<font color="#009900">\def\parseargusing#1#2{%</font>
<font color="#009900">  \def\argtorun{#2}%</font>
<font color="#009900">  \begingroup</font>
<font color="#009900">    \obeylines</font>
<font color="#009900">    \spaceisspace</font>
<font color="#009900">    #1%</font>
<font color="#009900">    \parseargline\empty% Insert the \empty token, see \finishparsearg below.</font>
<font color="#009900">}</font>

<font color="#009900">{\obeylines %</font>
<font color="#009900">  \gdef\parseargline#1^^M{%</font>
<font color="#009900">    \endgroup % End of the group started in \parsearg.</font>
<font color="#009900">    \argremovecomment #1\comment\ArgTerm%</font>
<font color="#009900">  }%</font>
<font color="#009900">}</font>

<font color="#009900">% First remove any @comment, then any @c comment.</font>
<font color="#009900">\def\argremovecomment#1\comment#2\ArgTerm{\argremovec #1\c\ArgTerm}</font>
<font color="#009900">\def\argremovec#1\c#2\ArgTerm{\argcheckspaces#1\^^M\ArgTerm}</font>

<font color="#009900">% Each occurrence of `\^^M' or `&lt;space&gt;\^^M' is replaced by a single space.</font>
<font color="#009900">%</font>
<font color="#009900">% \argremovec might leave us with trailing space, e.g.,</font>
<font color="#009900">%    @end itemize  @c foo</font>
<font color="#009900">% This space token undergoes the same procedure and is eventually removed</font>
<font color="#009900">% by \finishparsearg.</font>
<font color="#009900">%</font>
<font color="#009900">\def\argcheckspaces#1\^^M{\argcheckspacesX#1\^^M \^^M}</font>
<font color="#009900">\def\argcheckspacesX#1 \^^M{\argcheckspacesY#1\^^M}</font>
<font color="#009900">\def\argcheckspacesY#1\^^M#2\^^M#3\ArgTerm{%</font>
<font color="#009900">  \def\temp{#3}%</font>
<font color="#009900">  \ifx\temp\empty</font>
<font color="#009900">    % Do not use \next, perhaps the caller of \parsearg uses it; reuse \temp:</font>
<font color="#009900">    \let\temp\finishparsearg</font>
<font color="#009900">  \else</font>
<font color="#009900">    \let\temp\argcheckspaces</font>
<font color="#009900">  \fi</font>
<font color="#009900">  % Put the space token in:</font>
<font color="#009900">  \temp#1 #3\ArgTerm</font>
<font color="#009900">}</font>

<font color="#009900">% If a _delimited_ argument is enclosed in braces, they get stripped; so</font>
<font color="#009900">% to get _exactly_ the rest of the line, we had to prevent such situation.</font>
<font color="#009900">% We prepended an \empty token at the very beginning and we expand it now,</font>
<font color="#009900">% just before passing the control to \argtorun.</font>
<font color="#009900">% (Similarly, we have to think about #3 of \argcheckspacesY above: it is</font>
<font color="#009900">% either the null string, or it ends with \^^M---thus there is no danger</font>
<font color="#009900">% that a pair of braces would be stripped.</font>
<font color="#009900">%</font>
<font color="#009900">% But first, we have to remove the trailing space token.</font>
<font color="#009900">%</font>
<font color="#009900">\def\finishparsearg#1 \ArgTerm{\expandafter\argtorun\expandafter{#1}}</font>

<font color="#009900">% \parseargdef\foo{...}</font>
<font color="#009900">%	is roughly equivalent to</font>
<font color="#009900">% \def\foo{\parsearg\Xfoo}</font>
<font color="#009900">% \def\Xfoo#1{...}</font>
<font color="#009900">%</font>
<font color="#009900">% Actually, I use \csname\string\foo\endcsname, ie. \\foo, as it is my</font>
<font color="#009900">% favourite TeX trick.  --kasal, 16nov03</font>

<font color="#009900">\def\parseargdef#1{%</font>
<font color="#009900">  \expandafter \doparseargdef \csname\string#1\endcsname #1%</font>
<font color="#009900">}</font>
<font color="#009900">\def\doparseargdef#1#2{%</font>
<font color="#009900">  \def#2{\parsearg#1}%</font>
<font color="#009900">  \def#1##1%</font>
<font color="#009900">}</font>

<font color="#009900">% Several utility definitions with active space:</font>
<font color="#009900">{</font>
<font color="#009900">  \obeyspaces</font>
<font color="#009900">  \gdef\obeyedspace{ }</font>

<font color="#009900">  % Make each space character in the input produce a normal interword</font>
<font color="#009900">  % space in the output.  Don't allow a line break at this space, as this</font>
<font color="#009900">  % is used only in environments like @example, where each line of input</font>
<font color="#009900">  % should produce a line of output anyway.</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef\sepspaces{\obeyspaces\let =\tie}</font>

<font color="#009900">  % If an index command is used in an @example environment, any spaces</font>
<font color="#009900">  % therein should become regular spaces in the raw index file, not the</font>
<font color="#009900">  % expansion of \tie (\leavevmode \penalty \@M \ ).</font>
<font color="#009900">  \gdef\unsepspaces{\let =\space}</font>
<font color="#009900">}</font>


<font color="#009900">\def\flushcr{\ifx\par\lisppar \def\next##1{}\else \let\next=\relax \fi \next}</font>

<font color="#009900">% Define the framework for environments in texinfo.tex.  It's used like this:</font>
<font color="#009900">%</font>
<font color="#009900">%   \envdef\foo{...}</font>
<font color="#009900">%   \def\Efoo{...}</font>
<font color="#009900">%</font>
<font color="#009900">% It's the responsibility of \envdef to insert \begingroup before the</font>
<font color="#009900">% actual body; @end closes the group after calling \Efoo.  \envdef also</font>
<font color="#009900">% defines \thisenv, so the current environment is known; @end checks</font>
<font color="#009900">% whether the environment name matches.  The \checkenv macro can also be</font>
<font color="#009900">% used to check whether the current environment is the one expected.</font>
<font color="#009900">%</font>
<font color="#009900">% Non-false conditionals (@iftex, @ifset) don't fit into this, so they</font>
<font color="#009900">% are not treated as environments; they don't open a group.  (The</font>
<font color="#009900">% implementation of @end takes care not to call \endgroup in this</font>
<font color="#009900">% special case.)</font>


<font color="#009900">% At run-time, environments start with this:</font>
<font color="#009900">\def\startenvironment#1{\begingroup\def\thisenv{#1}}</font>
<font color="#009900">% initialize</font>
<font color="#009900">\let\thisenv\empty</font>

<font color="#009900">% ... but they get defined via ``\envdef\foo{...}'':</font>
<font color="#009900">\long\def\envdef#1#2{\def#1{\startenvironment#1#2}}</font>
<font color="#009900">\def\envparseargdef#1#2{\parseargdef#1{\startenvironment#1#2}}</font>

<font color="#009900">% Check whether we're in the right environment:</font>
<font color="#009900">\def\checkenv#1{%</font>
<font color="#009900">  \def\temp{#1}%</font>
<font color="#009900">  \ifx\thisenv\temp</font>
<font color="#009900">  \else</font>
<font color="#009900">    \badenverr</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% Environment mismatch, #1 expected:</font>
<font color="#009900">\def\badenverr{%</font>
<font color="#009900">  \errhelp = \EMsimple</font>
<font color="#009900">  \errmessage{This command can appear only \inenvironment\temp,</font>
<font color="#009900">    not \inenvironment\thisenv}%</font>
<font color="#009900">}</font>
<font color="#009900">\def\inenvironment#1{%</font>
<font color="#009900">  \ifx#1\empty</font>
<font color="#009900">    outside of any environment%</font>
<font color="#009900">  \else</font>
<font color="#009900">    in environment \expandafter\string#1%</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% @end foo executes the definition of \Efoo.</font>
<font color="#009900">% But first, it executes a specialized version of \checkenv</font>
<font color="#009900">%</font>
<font color="#009900">\parseargdef\end{%</font>
<font color="#009900">  \if 1\csname iscond.#1\endcsname</font>
<font color="#009900">  \else</font>
<font color="#009900">    % The general wording of \badenverr may not be ideal.</font>
<font color="#009900">    \expandafter\checkenv\csname#1\endcsname</font>
<font color="#009900">    \csname E#1\endcsname</font>
<font color="#009900">    \endgroup</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">\newhelp\EMsimple{Press RETURN to continue.}</font>


<font color="#009900">% Be sure we're in horizontal mode when doing a tie, since we make space</font>
<font color="#009900">% equivalent to this in @example-like environments. Otherwise, a space</font>
<font color="#009900">% at the beginning of a line will start with \penalty -- and</font>
<font color="#009900">% since \penalty is valid in vertical mode, we'd end up putting the</font>
<font color="#009900">% penalty on the vertical list instead of in the new paragraph.</font>
<font color="#009900">{\catcode`@ = 11</font>
<font color="#009900"> % Avoid using \@M directly, because that causes trouble</font>
<font color="#009900"> % if the definition is written into an index file.</font>
<font color="#009900"> \global\let\tiepenalty = \@M</font>
<font color="#009900"> \gdef\tie{\leavevmode\penalty\tiepenalty\ }</font>
<font color="#009900">}</font>

<font color="#009900">% @: forces normal size whitespace following.</font>
<font color="#009900">\def\:{\spacefactor=1000 }</font>

<font color="#009900">% @* forces a line break.</font>
<font color="#009900">\def\*{\hfil\break\hbox{}\ignorespaces}</font>

<font color="#009900">% @/ allows a line break.</font>
<font color="#009900">\let\/=\allowbreak</font>

<font color="#009900">% @. is an end-of-sentence period.</font>
<font color="#009900">\def\.{.\spacefactor=\endofsentencespacefactor\space}</font>

<font color="#009900">% @! is an end-of-sentence bang.</font>
<font color="#009900">\def\!{!\spacefactor=\endofsentencespacefactor\space}</font>

<font color="#009900">% @? is an end-of-sentence query.</font>
<font color="#009900">\def\?{?\spacefactor=\endofsentencespacefactor\space}</font>

<font color="#009900">% @frenchspacing on|off  says whether to put extra space after punctuation.</font>
<font color="#009900">%</font>
<font color="#009900">\def\onword{on}</font>
<font color="#009900">\def\offword{off}</font>
<font color="#009900">%</font>
<font color="#009900">\parseargdef\frenchspacing{%</font>
<font color="#009900">  \def\temp{#1}%</font>
<font color="#009900">  \ifx\temp\onword \plainfrenchspacing</font>
<font color="#009900">  \else\ifx\temp\offword \plainnonfrenchspacing</font>
<font color="#009900">  \else</font>
<font color="#009900">    \errhelp = \EMsimple</font>
<font color="#009900">    \errmessage{Unknown @frenchspacing option `\temp', must be on|off}%</font>
<font color="#009900">  \fi\fi</font>
<font color="#009900">}</font>

<font color="#009900">% @w prevents a word break.  Without the \leavevmode, @w at the</font>
<font color="#009900">% beginning of a paragraph, when TeX is still in vertical mode, would</font>
<font color="#009900">% produce a whole line of output instead of starting the paragraph.</font>
<font color="#009900">\def\w#1{\leavevmode\hbox{#1}}</font>

<font color="#009900">% @group ... @end group forces ... to be all on one page, by enclosing</font>
<font color="#009900">% it in a TeX vbox.  We use \vtop instead of \vbox to construct the box</font>
<font color="#009900">% to keep its height that of a normal line.  According to the rules for</font>
<font color="#009900">% \topskip (p.114 of the TeXbook), the glue inserted is</font>
<font color="#009900">% max (\topskip - \ht (first item), 0).  If that height is large,</font>
<font color="#009900">% therefore, no glue is inserted, and the space between the headline and</font>
<font color="#009900">% the text is small, which looks bad.</font>
<font color="#009900">%</font>
<font color="#009900">% Another complication is that the group might be very large.  This can</font>
<font color="#009900">% cause the glue on the previous page to be unduly stretched, because it</font>
<font color="#009900">% does not have much material.  In this case, it's better to add an</font>
<font color="#009900">% explicit \vfill so that the extra space is at the bottom.  The</font>
<font color="#009900">% threshold for doing this is if the group is more than \vfilllimit</font>
<font color="#009900">% percent of a page (\vfilllimit can be changed inside of @tex).</font>
<font color="#009900">%</font>
<font color="#009900">\newbox\groupbox</font>
<font color="#009900">\def\vfilllimit{0.7}</font>
<font color="#009900">%</font>
<font color="#009900">\envdef\group{%</font>
<font color="#009900">  \ifnum\catcode`\^^M=\active \else</font>
<font color="#009900">    \errhelp = \groupinvalidhelp</font>
<font color="#009900">    \errmessage{@group invalid in context where filling is enabled}%</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \startsavinginserts</font>
<font color="#009900">  %</font>
<font color="#009900">  \setbox\groupbox = \vtop\bgroup</font>
<font color="#009900">    % Do @comment since we are called inside an environment such as</font>
<font color="#009900">    % @example, where each end-of-line in the input causes an</font>
<font color="#009900">    % end-of-line in the output.  We don't want the end-of-line after</font>
<font color="#009900">    % the `@group' to put extra space in the output.  Since @group</font>
<font color="#009900">    % should appear on a line by itself (according to the Texinfo</font>
<font color="#009900">    % manual), we don't worry about eating any user text.</font>
<font color="#009900">    \comment</font>
<font color="#009900">}</font>
<font color="#009900">%</font>
<font color="#009900">% The \vtop produces a box with normal height and large depth; thus, TeX puts</font>
<font color="#009900">% \baselineskip glue before it, and (when the next line of text is done)</font>
<font color="#009900">% \lineskip glue after it.  Thus, space below is not quite equal to space</font>
<font color="#009900">% above.  But it's pretty close.</font>
<font color="#009900">\def\Egroup{%</font>
<font color="#009900">    % To get correct interline space between the last line of the group</font>
<font color="#009900">    % and the first line afterwards, we have to propagate \prevdepth.</font>
<font color="#009900">    \endgraf % Not \par, as it may have been set to \lisppar.</font>
<font color="#009900">    \global\dimen1 = \prevdepth</font>
<font color="#009900">  \egroup           % End the \vtop.</font>
<font color="#009900">  % \dimen0 is the vertical size of the group's box.</font>
<font color="#009900">  \dimen0 = \ht\groupbox  \advance\dimen0 by \dp\groupbox</font>
<font color="#009900">  % \dimen2 is how much space is left on the page (more or less).</font>
<font color="#009900">  \dimen2 = \pageheight   \advance\dimen2 by -\pagetotal</font>
<font color="#009900">  % if the group doesn't fit on the current page, and it's a big big</font>
<font color="#009900">  % group, force a page break.</font>
<font color="#009900">  \ifdim \dimen0 &gt; \dimen2</font>
<font color="#009900">    \ifdim \pagetotal &lt; \vfilllimit\pageheight</font>
<font color="#009900">      \page</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \box\groupbox</font>
<font color="#009900">  \prevdepth = \dimen1</font>
<font color="#009900">  \checkinserts</font>
<font color="#009900">}</font>
<font color="#009900">%</font>
<font color="#009900">% TeX puts in an \escapechar (i.e., `@') at the beginning of the help</font>
<font color="#009900">% message, so this ends up printing `@group can only ...'.</font>
<font color="#009900">%</font>
<font color="#009900">\newhelp\groupinvalidhelp{%</font>
<font color="#009900">group can only be used in environments such as @example,^^J%</font>
<font color="#009900">where each line of input produces a line of output.}</font>

<font color="#009900">% @need space-in-mils</font>
<font color="#009900">% forces a page break if there is not space-in-mils remaining.</font>

<font color="#009900">\newdimen\mil  \mil=0.001in</font>

<font color="#009900">\parseargdef\need{%</font>
<font color="#009900">  % Ensure vertical mode, so we don't make a big box in the middle of a</font>
<font color="#009900">  % paragraph.</font>
<font color="#009900">  \par</font>
<font color="#009900">  %</font>
<font color="#009900">  % If the @need value is less than one line space, it's useless.</font>
<font color="#009900">  \dimen0 = #1\mil</font>
<font color="#009900">  \dimen2 = \ht\strutbox</font>
<font color="#009900">  \advance\dimen2 by \dp\strutbox</font>
<font color="#009900">  \ifdim\dimen0 &gt; \dimen2</font>
<font color="#009900">    %</font>
<font color="#009900">    % Do a \strut just to make the height of this box be normal, so the</font>
<font color="#009900">    % normal leading is inserted relative to the preceding line.</font>
<font color="#009900">    % And a page break here is fine.</font>
<font color="#009900">    \vtop to #1\mil{\strut\vfil}%</font>
<font color="#009900">    %</font>
<font color="#009900">    % TeX does not even consider page breaks if a penalty added to the</font>
<font color="#009900">    % main vertical list is 10000 or more.  But in order to see if the</font>
<font color="#009900">    % empty box we just added fits on the page, we must make it consider</font>
<font color="#009900">    % page breaks.  On the other hand, we don't want to actually break the</font>
<font color="#009900">    % page after the empty box.  So we use a penalty of 9999.</font>
<font color="#009900">    %</font>
<font color="#009900">    % There is an extremely small chance that TeX will actually break the</font>
<font color="#009900">    % page at this \penalty, if there are no other feasible breakpoints in</font>
<font color="#009900">    % sight.  (If the user is using lots of big @group commands, which</font>
<font color="#009900">    % almost-but-not-quite fill up a page, TeX will have a hard time doing</font>
<font color="#009900">    % good page breaking, for example.)  However, I could not construct an</font>
<font color="#009900">    % example where a page broke at this \penalty; if it happens in a real</font>
<font color="#009900">    % document, then we can reconsider our strategy.</font>
<font color="#009900">    \penalty9999</font>
<font color="#009900">    %</font>
<font color="#009900">    % Back up by the size of the box, whether we did a page break or not.</font>
<font color="#009900">    \kern -#1\mil</font>
<font color="#009900">    %</font>
<font color="#009900">    % Do not allow a page break right after this kern.</font>
<font color="#009900">    \nobreak</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% @br   forces paragraph break (and is undocumented).</font>

<font color="#009900">\let\br = \par</font>

<font color="#009900">% @page forces the start of a new page.</font>
<font color="#009900">%</font>
<font color="#009900">\def\page{\par\vfill\supereject}</font>

<font color="#009900">% @exdent text....</font>
<font color="#009900">% outputs text on separate line in roman font, starting at standard page margin</font>

<font color="#009900">% This records the amount of indent in the innermost environment.</font>
<font color="#009900">% That's how much \exdent should take out.</font>
<font color="#009900">\newskip\exdentamount</font>

<font color="#009900">% This defn is used inside fill environments such as @defun.</font>
<font color="#009900">\parseargdef\exdent{\hfil\break\hbox{\kern -\exdentamount{\rm#1}}\hfil\break}</font>

<font color="#009900">% This defn is used inside nofill environments such as @example.</font>
<font color="#009900">\parseargdef\nofillexdent{{\advance \leftskip by -\exdentamount</font>
<font color="#009900">  \leftline{\hskip\leftskip{\rm#1}}}}</font>

<font color="#009900">% @inmargin{WHICH}{TEXT} puts TEXT in the WHICH margin next to the current</font>
<font color="#009900">% paragraph.  For more general purposes, use the \margin insertion</font>
<font color="#009900">% class.  WHICH is `l' or `r'.  Not documented, written for gawk manual.</font>
<font color="#009900">%</font>
<font color="#009900">\newskip\inmarginspacing \inmarginspacing=1cm</font>
<font color="#009900">\def\strutdepth{\dp\strutbox}</font>
<font color="#009900">%</font>
<font color="#009900">\def\doinmargin#1#2{\strut\vadjust{%</font>
<font color="#009900">  \nobreak</font>
<font color="#009900">  \kern-\strutdepth</font>
<font color="#009900">  \vtop to \strutdepth{%</font>
<font color="#009900">    \baselineskip=\strutdepth</font>
<font color="#009900">    \vss</font>
<font color="#009900">    % if you have multiple lines of stuff to put here, you'll need to</font>
<font color="#009900">    % make the vbox yourself of the appropriate size.</font>
<font color="#009900">    \ifx#1l%</font>
<font color="#009900">      \llap{\ignorespaces #2\hskip\inmarginspacing}%</font>
<font color="#009900">    \else</font>
<font color="#009900">      \rlap{\hskip\hsize \hskip\inmarginspacing \ignorespaces #2}%</font>
<font color="#009900">    \fi</font>
<font color="#009900">    \null</font>
<font color="#009900">  }%</font>
<font color="#009900">}}</font>
<font color="#009900">\def\inleftmargin{\doinmargin l}</font>
<font color="#009900">\def\inrightmargin{\doinmargin r}</font>
<font color="#009900">%</font>
<font color="#009900">% @inmargin{TEXT [, RIGHT-TEXT]}</font>
<font color="#009900">% (if RIGHT-TEXT is given, use TEXT for left page, RIGHT-TEXT for right;</font>
<font color="#009900">% else use TEXT for both).</font>
<font color="#009900">%</font>
<font color="#009900">\def\inmargin#1{\parseinmargin #1,,\finish}</font>
<font color="#009900">\def\parseinmargin#1,#2,#3\finish{% not perfect, but better than nothing.</font>
<font color="#009900">  \setbox0 = \hbox{\ignorespaces #2}%</font>
<font color="#009900">  \ifdim\wd0 &gt; 0pt</font>
<font color="#009900">    \def\lefttext{#1}%  have both texts</font>
<font color="#009900">    \def\righttext{#2}%</font>
<font color="#009900">  \else</font>
<font color="#009900">    \def\lefttext{#1}%  have only one text</font>
<font color="#009900">    \def\righttext{#1}%</font>
<font color="#009900">  \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  \ifodd\pageno</font>
<font color="#009900">    \def\temp{\inrightmargin\righttext}% odd page -&gt; outside is right margin</font>
<font color="#009900">  \else</font>
<font color="#009900">    \def\temp{\inleftmargin\lefttext}%</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \temp</font>
<font color="#009900">}</font>

<font color="#009900">% @| inserts a changebar to the left of the current line.  It should</font>
<font color="#009900">% surround any changed text.  This approach does *not* work if the</font>
<font color="#009900">% change spans more than two lines of output.  To handle that, we would</font>
<font color="#009900">% have adopt a much more difficult approach (putting marks into the main</font>
<font color="#009900">% vertical list for the beginning and end of each change).  This command</font>
<font color="#009900">% is not documented, not supported, and doesn't work.</font>
<font color="#009900">%</font>
<font color="#009900">\def\|{%</font>
<font color="#009900">  % \vadjust can only be used in horizontal mode.</font>
<font color="#009900">  \leavevmode</font>
<font color="#009900">  %</font>
<font color="#009900">  % Append this vertical mode material after the current line in the output.</font>
<font color="#009900">  \vadjust{%</font>
<font color="#009900">    % We want to insert a rule with the height and depth of the current</font>
<font color="#009900">    % leading; that is exactly what \strutbox is supposed to record.</font>
<font color="#009900">    \vskip-\baselineskip</font>
<font color="#009900">    %</font>
<font color="#009900">    % \vadjust-items are inserted at the left edge of the type.  So</font>
<font color="#009900">    % the \llap here moves out into the left-hand margin.</font>
<font color="#009900">    \llap{%</font>
<font color="#009900">      %</font>
<font color="#009900">      % For a thicker or thinner bar, change the `1pt'.</font>
<font color="#009900">      \vrule height\baselineskip width1pt</font>
<font color="#009900">      %</font>
<font color="#009900">      % This is the space between the bar and the text.</font>
<font color="#009900">      \hskip 12pt</font>
<font color="#009900">    }%</font>
<font color="#009900">  }%</font>
<font color="#009900">}</font>

<font color="#009900">% @include FILE -- \input text of FILE.</font>
<font color="#009900">%</font>
<font color="#009900">\def\include{\parseargusing\filenamecatcodes\includezzz}</font>
<font color="#009900">\def\includezzz#1{%</font>
<font color="#009900">  \pushthisfilestack</font>
<font color="#009900">  \def\thisfile{#1}%</font>
<font color="#009900">  {%</font>
<font color="#009900">    \makevalueexpandable  % we want to expand any @value in FILE.</font>
<font color="#009900">    \turnoffactive        % and allow special characters in the expansion</font>
<font color="#009900">    \indexnofonts         % Allow `@@' and other weird things in file names.</font>
<font color="#009900">    \wlog{texinfo.tex: doing @include of #1^^J}%</font>
<font color="#009900">    \edef\temp{\noexpand\input #1 }%</font>
<font color="#009900">    %</font>
<font color="#009900">    % This trickery is to read FILE outside of a group, in case it makes</font>
<font color="#009900">    % definitions, etc.</font>
<font color="#009900">    \expandafter</font>
<font color="#009900">  }\temp</font>
<font color="#009900">  \popthisfilestack</font>
<font color="#009900">}</font>
<font color="#009900">\def\filenamecatcodes{%</font>
<font color="#009900">  \catcode`\\=\other</font>
<font color="#009900">  \catcode`~=\other</font>
<font color="#009900">  \catcode`^=\other</font>
<font color="#009900">  \catcode`_=\other</font>
<font color="#009900">  \catcode`|=\other</font>
<font color="#009900">  \catcode`&lt;=\other</font>
<font color="#009900">  \catcode`&gt;=\other</font>
<font color="#009900">  \catcode`+=\other</font>
<font color="#009900">  \catcode`-=\other</font>
<font color="#009900">  \catcode`\`=\other</font>
<font color="#009900">  \catcode`\'=\other</font>
<font color="#009900">}</font>

<font color="#009900">\def\pushthisfilestack{%</font>
<font color="#009900">  \expandafter\pushthisfilestackX\popthisfilestack\StackTerm</font>
<font color="#009900">}</font>
<font color="#009900">\def\pushthisfilestackX{%</font>
<font color="#009900">  \expandafter\pushthisfilestackY\thisfile\StackTerm</font>
<font color="#009900">}</font>
<font color="#009900">\def\pushthisfilestackY #1\StackTerm #2\StackTerm {%</font>
<font color="#009900">  \gdef\popthisfilestack{\gdef\thisfile{#1}\gdef\popthisfilestack{#2}}%</font>
<font color="#009900">}</font>

<font color="#009900">\def\popthisfilestack{\errthisfilestackempty}</font>
<font color="#009900">\def\errthisfilestackempty{\errmessage{Internal error:</font>
<font color="#009900">  the stack of filenames is empty.}}</font>
<font color="#009900">%</font>
<font color="#009900">\def\thisfile{}</font>

<font color="#009900">% @center line</font>
<font color="#009900">% outputs that line, centered.</font>
<font color="#009900">%</font>
<font color="#009900">\parseargdef\center{%</font>
<font color="#009900">  \ifhmode</font>
<font color="#009900">    \let\centersub\centerH</font>
<font color="#009900">  \else</font>
<font color="#009900">    \let\centersub\centerV</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \centersub{\hfil \ignorespaces#1\unskip \hfil}%</font>
<font color="#009900">  \let\centersub\relax % don't let the definition persist, just in case</font>
<font color="#009900">}</font>
<font color="#009900">\def\centerH#1{{%</font>
<font color="#009900">  \hfil\break</font>
<font color="#009900">  \advance\hsize by -\leftskip</font>
<font color="#009900">  \advance\hsize by -\rightskip</font>
<font color="#009900">  \line{#1}%</font>
<font color="#009900">  \break</font>
<font color="#009900">}}</font>
<font color="#009900">%</font>
<font color="#009900">\newcount\centerpenalty</font>
<font color="#009900">\def\centerV#1{%</font>
<font color="#009900">  % The idea here is the same as in \startdefun, \cartouche, etc.: if</font>
<font color="#009900">  % @center is the first thing after a section heading, we need to wipe</font>
<font color="#009900">  % out the negative parskip inserted by \sectionheading, but still</font>
<font color="#009900">  % prevent a page break here.</font>
<font color="#009900">  \centerpenalty = \lastpenalty</font>
<font color="#009900">  \ifnum\centerpenalty&gt;10000 \vskip\parskip \fi</font>
<font color="#009900">  \ifnum\centerpenalty&gt;9999 \penalty\centerpenalty \fi</font>
<font color="#009900">  \line{\kern\leftskip #1\kern\rightskip}%</font>
<font color="#009900">}</font>

<font color="#009900">% @sp n   outputs n lines of vertical space</font>
<font color="#009900">%</font>
<font color="#009900">\parseargdef\sp{\vskip #1\baselineskip}</font>

<font color="#009900">% @comment ...line which is ignored...</font>
<font color="#009900">% @c is the same as @comment</font>
<font color="#009900">% @ignore ... @end ignore  is another way to write a comment</font>
<font color="#009900">%</font>
<font color="#009900">\def\comment{\begingroup \catcode`\^^M=\other%</font>
<font color="#009900">\catcode`\@=\other \catcode`\{=\other \catcode`\}=\other%</font>
<font color="#009900">\commentxxx}</font>
<font color="#009900">{\catcode`\^^M=\other \gdef\commentxxx#1^^M{\endgroup}}</font>
<font color="#009900">%</font>
<font color="#009900">\let\c=\comment</font>

<font color="#009900">% @paragraphindent NCHARS</font>
<font color="#009900">% We'll use ems for NCHARS, close enough.</font>
<font color="#009900">% NCHARS can also be the word `asis' or `none'.</font>
<font color="#009900">% We cannot feasibly implement @paragraphindent asis, though.</font>
<font color="#009900">%</font>
<font color="#009900">\def\asisword{asis} % no translation, these are keywords</font>
<font color="#009900">\def\noneword{none}</font>
<font color="#009900">%</font>
<font color="#009900">\parseargdef\paragraphindent{%</font>
<font color="#009900">  \def\temp{#1}%</font>
<font color="#009900">  \ifx\temp\asisword</font>
<font color="#009900">  \else</font>
<font color="#009900">    \ifx\temp\noneword</font>
<font color="#009900">      \defaultparindent = 0pt</font>
<font color="#009900">    \else</font>
<font color="#009900">      \defaultparindent = #1em</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \parindent = \defaultparindent</font>
<font color="#009900">}</font>

<font color="#009900">% @exampleindent NCHARS</font>
<font color="#009900">% We'll use ems for NCHARS like @paragraphindent.</font>
<font color="#009900">% It seems @exampleindent asis isn't necessary, but</font>
<font color="#009900">% I preserve it to make it similar to @paragraphindent.</font>
<font color="#009900">\parseargdef\exampleindent{%</font>
<font color="#009900">  \def\temp{#1}%</font>
<font color="#009900">  \ifx\temp\asisword</font>
<font color="#009900">  \else</font>
<font color="#009900">    \ifx\temp\noneword</font>
<font color="#009900">      \lispnarrowing = 0pt</font>
<font color="#009900">    \else</font>
<font color="#009900">      \lispnarrowing = #1em</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% @firstparagraphindent WORD</font>
<font color="#009900">% If WORD is `none', then suppress indentation of the first paragraph</font>
<font color="#009900">% after a section heading.  If WORD is `insert', then do indent at such</font>
<font color="#009900">% paragraphs.</font>
<font color="#009900">%</font>
<font color="#009900">% The paragraph indentation is suppressed or not by calling</font>
<font color="#009900">% \suppressfirstparagraphindent, which the sectioning commands do.</font>
<font color="#009900">% We switch the definition of this back and forth according to WORD.</font>
<font color="#009900">% By default, we suppress indentation.</font>
<font color="#009900">%</font>
<font color="#009900">\def\suppressfirstparagraphindent{\dosuppressfirstparagraphindent}</font>
<font color="#009900">\def\insertword{insert}</font>
<font color="#009900">%</font>
<font color="#009900">\parseargdef\firstparagraphindent{%</font>
<font color="#009900">  \def\temp{#1}%</font>
<font color="#009900">  \ifx\temp\noneword</font>
<font color="#009900">    \let\suppressfirstparagraphindent = \dosuppressfirstparagraphindent</font>
<font color="#009900">  \else\ifx\temp\insertword</font>
<font color="#009900">    \let\suppressfirstparagraphindent = \relax</font>
<font color="#009900">  \else</font>
<font color="#009900">    \errhelp = \EMsimple</font>
<font color="#009900">    \errmessage{Unknown @firstparagraphindent option `\temp'}%</font>
<font color="#009900">  \fi\fi</font>
<font color="#009900">}</font>

<font color="#009900">% Here is how we actually suppress indentation.  Redefine \everypar to</font>
<font color="#009900">% \kern backwards by \parindent, and then reset itself to empty.</font>
<font color="#009900">%</font>
<font color="#009900">% We also make \indent itself not actually do anything until the next</font>
<font color="#009900">% paragraph.</font>
<font color="#009900">%</font>
<font color="#009900">\gdef\dosuppressfirstparagraphindent{%</font>
<font color="#009900">  \gdef\indent{%</font>
<font color="#009900">    \restorefirstparagraphindent</font>
<font color="#009900">    \indent</font>
<font color="#009900">  }%</font>
<font color="#009900">  \gdef\noindent{%</font>
<font color="#009900">    \restorefirstparagraphindent</font>
<font color="#009900">    \noindent</font>
<font color="#009900">  }%</font>
<font color="#009900">  \global\everypar = {%</font>
<font color="#009900">    \kern -\parindent</font>
<font color="#009900">    \restorefirstparagraphindent</font>
<font color="#009900">  }%</font>
<font color="#009900">}</font>

<font color="#009900">\gdef\restorefirstparagraphindent{%</font>
<font color="#009900">  \global \let \indent = \ptexindent</font>
<font color="#009900">  \global \let \noindent = \ptexnoindent</font>
<font color="#009900">  \global \everypar = {}%</font>
<font color="#009900">}</font>


<font color="#009900">% @refill is a no-op.</font>
<font color="#009900">\let\refill=\relax</font>

<font color="#009900">% If working on a large document in chapters, it is convenient to</font>
<font color="#009900">% be able to disable indexing, cross-referencing, and contents, for test runs.</font>
<font color="#009900">% This is done with @novalidate (before @setfilename).</font>
<font color="#009900">%</font>
<font color="#009900">\newif\iflinks \linkstrue % by default we want the aux files.</font>
<font color="#009900">\let\novalidate = \linksfalse</font>

<font color="#009900">% @setfilename is done at the beginning of every texinfo file.</font>
<font color="#009900">% So open here the files we need to have open while reading the input.</font>
<font color="#009900">% This makes it possible to make a .fmt file for texinfo.</font>
<font color="#009900">\def\setfilename{%</font>
<font color="#009900">   \fixbackslash  % Turn off hack to swallow `\input texinfo'.</font>
<font color="#009900">   \iflinks</font>
<font color="#009900">     \tryauxfile</font>
<font color="#009900">     % Open the new aux file.  TeX will close it automatically at exit.</font>
<font color="#009900">     \immediate\openout\auxfile=\jobname.aux</font>
<font color="#009900">   \fi % \openindices needs to do some work in any case.</font>
<font color="#009900">   \openindices</font>
<font color="#009900">   \let\setfilename=\comment % Ignore extra @setfilename cmds.</font>
<font color="#009900">   %</font>
<font color="#009900">   % If texinfo.cnf is present on the system, read it.</font>
<font color="#009900">   % Useful for site-wide @afourpaper, etc.</font>
<font color="#009900">   \openin 1 texinfo.cnf</font>
<font color="#009900">   \ifeof 1 \else \input texinfo.cnf \fi</font>
<font color="#009900">   \closein 1</font>
<font color="#009900">   %</font>
<font color="#009900">   \comment % Ignore the actual filename.</font>
<font color="#009900">}</font>

<font color="#009900">% Called from \setfilename.</font>
<font color="#009900">%</font>
<font color="#009900">\def\openindices{%</font>
<font color="#009900">  \newindex{cp}%</font>
<font color="#009900">  \newcodeindex{fn}%</font>
<font color="#009900">  \newcodeindex{vr}%</font>
<font color="#009900">  \newcodeindex{tp}%</font>
<font color="#009900">  \newcodeindex{ky}%</font>
<font color="#009900">  \newcodeindex{pg}%</font>
<font color="#009900">}</font>

<font color="#009900">% @bye.</font>
<font color="#009900">\outer\def\bye{\pagealignmacro\tracingstats=1\ptexend}</font>


<font color="#009900">\message{pdf,}</font>
<font color="#009900">% adobe `portable' document format</font>
<font color="#009900">\newcount\tempnum</font>
<font color="#009900">\newcount\lnkcount</font>
<font color="#009900">\newtoks\filename</font>
<font color="#009900">\newcount\filenamelength</font>
<font color="#009900">\newcount\pgn</font>
<font color="#009900">\newtoks\toksA</font>
<font color="#009900">\newtoks\toksB</font>
<font color="#009900">\newtoks\toksC</font>
<font color="#009900">\newtoks\toksD</font>
<font color="#009900">\newbox\boxA</font>
<font color="#009900">\newcount\countA</font>
<font color="#009900">\newif\ifpdf</font>
<font color="#009900">\newif\ifpdfmakepagedest</font>

<font color="#009900">% when pdftex is run in dvi mode, \pdfoutput is defined (so \pdfoutput=1</font>
<font color="#009900">% can be set).  So we test for \relax and 0 as well as being undefined.</font>
<font color="#009900">\ifx\pdfoutput\thisisundefined</font>
<font color="#009900">\else</font>
<font color="#009900">  \ifx\pdfoutput\relax</font>
<font color="#009900">  \else</font>
<font color="#009900">    \ifcase\pdfoutput</font>
<font color="#009900">    \else</font>
<font color="#009900">      \pdftrue</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">\fi</font>

<font color="#009900">% PDF uses PostScript string constants for the names of xref targets,</font>
<font color="#009900">% for display in the outlines, and in other places.  Thus, we have to</font>
<font color="#009900">% double any backslashes.  Otherwise, a name like "\node" will be</font>
<font color="#009900">% interpreted as a newline (\n), followed by o, d, e.  Not good.</font>
<font color="#009900">% </font>
<font color="#009900">% See http://www.ntg.nl/pipermail/ntg-pdftex/2004-July/000654.html and</font>
<font color="#009900">% related messages.  The final outcome is that it is up to the TeX user</font>
<font color="#009900">% to double the backslashes and otherwise make the string valid, so</font>
<font color="#009900">% that's what we do.  pdftex 1.30.0 (ca.2005) introduced a primitive to</font>
<font color="#009900">% do this reliably, so we use it.</font>

<font color="#009900">% #1 is a control sequence in which to do the replacements,</font>
<font color="#009900">% which we \xdef.</font>
<font color="#009900">\def\txiescapepdf#1{%</font>
<font color="#009900">  \ifx\pdfescapestring\relax</font>
<font color="#009900">    % No primitive available; should we give a warning or log?</font>
<font color="#009900">    % Many times it won't matter.</font>
<font color="#009900">  \else</font>
<font color="#009900">    % The expandable \pdfescapestring primitive escapes parentheses,</font>
<font color="#009900">    % backslashes, and other special chars.</font>
<font color="#009900">    \xdef#1{\pdfescapestring{#1}}%</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">\newhelp\nopdfimagehelp{Texinfo supports .png, .jpg, .jpeg, and .pdf images</font>
<font color="#009900">with PDF output, and none of those formats could be found.  (.eps cannot</font>
<font color="#009900">be supported due to the design of the PDF format; use regular TeX (DVI</font>
<font color="#009900">output) for that.)}</font>

<font color="#009900">\ifpdf</font>
<font color="#009900">  %</font>
<font color="#009900">  % Color manipulation macros based on pdfcolor.tex,</font>
<font color="#009900">  % except using rgb instead of cmyk; the latter is said to render as a</font>
<font color="#009900">  % very dark gray on-screen and a very dark halftone in print, instead</font>
<font color="#009900">  % of actual black.</font>
<font color="#009900">  \def\rgbDarkRed{0.50 0.09 0.12}</font>
<font color="#009900">  \def\rgbBlack{0 0 0}</font>
<font color="#009900">  %</font>
<font color="#009900">  % k sets the color for filling (usual text, etc.);</font>
<font color="#009900">  % K sets the color for stroking (thin rules, e.g., normal _'s).</font>
<font color="#009900">  \def\pdfsetcolor#1{\pdfliteral{#1 rg  #1 RG}}</font>
<font color="#009900">  %</font>
<font color="#009900">  % Set color, and create a mark which defines \thiscolor accordingly,</font>
<font color="#009900">  % so that \makeheadline knows which color to restore.</font>
<font color="#009900">  \def\setcolor#1{%</font>
<font color="#009900">    \xdef\lastcolordefs{\gdef\noexpand\thiscolor{#1}}%</font>
<font color="#009900">    \domark</font>
<font color="#009900">    \pdfsetcolor{#1}%</font>
<font color="#009900">  }</font>
<font color="#009900">  %</font>
<font color="#009900">  \def\maincolor{\rgbBlack}</font>
<font color="#009900">  \pdfsetcolor{\maincolor}</font>
<font color="#009900">  \edef\thiscolor{\maincolor}</font>
<font color="#009900">  \def\lastcolordefs{}</font>
<font color="#009900">  %</font>
<font color="#009900">  \def\makefootline{%</font>
<font color="#009900">    \baselineskip24pt</font>
<font color="#009900">    \line{\pdfsetcolor{\maincolor}\the\footline}%</font>
<font color="#009900">  }</font>
<font color="#009900">  %</font>
<font color="#009900">  \def\makeheadline{%</font>
<font color="#009900">    \vbox to 0pt{%</font>
<font color="#009900">      \vskip-22.5pt</font>
<font color="#009900">      \line{%</font>
<font color="#009900">        \vbox to8.5pt{}%</font>
<font color="#009900">        % Extract \thiscolor definition from the marks.</font>
<font color="#009900">        \getcolormarks</font>
<font color="#009900">        % Typeset the headline with \maincolor, then restore the color.</font>
<font color="#009900">        \pdfsetcolor{\maincolor}\the\headline\pdfsetcolor{\thiscolor}%</font>
<font color="#009900">      }%</font>
<font color="#009900">      \vss</font>
<font color="#009900">    }%</font>
<font color="#009900">    \nointerlineskip</font>
<font color="#009900">  }</font>
<font color="#009900">  %</font>
<font color="#009900">  %</font>
<font color="#009900">  \pdfcatalog{/PageMode /UseOutlines}</font>
<font color="#009900">  %</font>
<font color="#009900">  % #1 is image name, #2 width (might be empty/whitespace), #3 height (ditto).</font>
<font color="#009900">  \def\dopdfimage#1#2#3{%</font>
<font color="#009900">    \def\pdfimagewidth{#2}\setbox0 = \hbox{\ignorespaces #2}%</font>
<font color="#009900">    \def\pdfimageheight{#3}\setbox2 = \hbox{\ignorespaces #3}%</font>
<font color="#009900">    %</font>
<font color="#009900">    % pdftex (and the PDF format) support .pdf, .png, .jpg (among</font>
<font color="#009900">    % others).  Let's try in that order, PDF first since if</font>
<font color="#009900">    % someone has a scalable image, presumably better to use that than a</font>
<font color="#009900">    % bitmap.</font>
<font color="#009900">    \let\pdfimgext=\empty</font>
<font color="#009900">    \begingroup</font>
<font color="#009900">      \openin 1 #1.pdf \ifeof 1</font>
<font color="#009900">        \openin 1 #1.PDF \ifeof 1</font>
<font color="#009900">          \openin 1 #1.png \ifeof 1</font>
<font color="#009900">            \openin 1 #1.jpg \ifeof 1</font>
<font color="#009900">              \openin 1 #1.jpeg \ifeof 1</font>
<font color="#009900">                \openin 1 #1.JPG \ifeof 1</font>
<font color="#009900">                  \errhelp = \nopdfimagehelp</font>
<font color="#009900">                  \errmessage{Could not find image file #1 for pdf}%</font>
<font color="#009900">                \else \gdef\pdfimgext{JPG}%</font>
<font color="#009900">                \fi</font>
<font color="#009900">              \else \gdef\pdfimgext{jpeg}%</font>
<font color="#009900">              \fi</font>
<font color="#009900">            \else \gdef\pdfimgext{jpg}%</font>
<font color="#009900">            \fi</font>
<font color="#009900">          \else \gdef\pdfimgext{png}%</font>
<font color="#009900">          \fi</font>
<font color="#009900">        \else \gdef\pdfimgext{PDF}%</font>
<font color="#009900">        \fi</font>
<font color="#009900">      \else \gdef\pdfimgext{pdf}%</font>
<font color="#009900">      \fi</font>
<font color="#009900">      \closein 1</font>
<font color="#009900">    \endgroup</font>
<font color="#009900">    %</font>
<font color="#009900">    % without \immediate, ancient pdftex seg faults when the same image is</font>
<font color="#009900">    % included twice.  (Version 3.14159-pre-1.0-unofficial-20010704.)</font>
<font color="#009900">    \ifnum\pdftexversion &lt; 14</font>
<font color="#009900">      \immediate\pdfimage</font>
<font color="#009900">    \else</font>
<font color="#009900">      \immediate\pdfximage</font>
<font color="#009900">    \fi</font>
<font color="#009900">      \ifdim \wd0 &gt;0pt width \pdfimagewidth \fi</font>
<font color="#009900">      \ifdim \wd2 &gt;0pt height \pdfimageheight \fi</font>
<font color="#009900">      \ifnum\pdftexversion&lt;13</font>
<font color="#009900">         #1.\pdfimgext</font>
<font color="#009900">       \else</font>
<font color="#009900">         {#1.\pdfimgext}%</font>
<font color="#009900">       \fi</font>
<font color="#009900">    \ifnum\pdftexversion &lt; 14 \else</font>
<font color="#009900">      \pdfrefximage \pdflastximage</font>
<font color="#009900">    \fi}</font>
<font color="#009900">  %</font>
<font color="#009900">  \def\pdfmkdest#1{{%</font>
<font color="#009900">    % We have to set dummies so commands such as @code, and characters</font>
<font color="#009900">    % such as \, aren't expanded when present in a section title.</font>
<font color="#009900">    \indexnofonts</font>
<font color="#009900">    \turnoffactive</font>
<font color="#009900">    \makevalueexpandable</font>
<font color="#009900">    \def\pdfdestname{#1}%</font>
<font color="#009900">    \txiescapepdf\pdfdestname</font>
<font color="#009900">    \safewhatsit{\pdfdest name{\pdfdestname} xyz}%</font>
<font color="#009900">  }}</font>
<font color="#009900">  %</font>
<font color="#009900">  % used to mark target names; must be expandable.</font>
<font color="#009900">  \def\pdfmkpgn#1{#1}</font>
<font color="#009900">  %</font>
<font color="#009900">  % by default, use a color that is dark enough to print on paper as</font>
<font color="#009900">  % nearly black, but still distinguishable for online viewing.</font>
<font color="#009900">  \def\urlcolor{\rgbDarkRed}</font>
<font color="#009900">  \def\linkcolor{\rgbDarkRed}</font>
<font color="#009900">  \def\endlink{\setcolor{\maincolor}\pdfendlink}</font>
<font color="#009900">  %</font>
<font color="#009900">  % Adding outlines to PDF; macros for calculating structure of outlines</font>
<font color="#009900">  % come from Petr Olsak</font>
<font color="#009900">  \def\expnumber#1{\expandafter\ifx\csname#1\endcsname\relax 0%</font>
<font color="#009900">    \else \csname#1\endcsname \fi}</font>
<font color="#009900">  \def\advancenumber#1{\tempnum=\expnumber{#1}\relax</font>
<font color="#009900">    \advance\tempnum by 1</font>
<font color="#009900">    \expandafter\xdef\csname#1\endcsname{\the\tempnum}}</font>
<font color="#009900">  %</font>
<font color="#009900">  % #1 is the section text, which is what will be displayed in the</font>
<font color="#009900">  % outline by the pdf viewer.  #2 is the pdf expression for the number</font>
<font color="#009900">  % of subentries (or empty, for subsubsections).  #3 is the node text,</font>
<font color="#009900">  % which might be empty if this toc entry had no corresponding node.</font>
<font color="#009900">  % #4 is the page number</font>
<font color="#009900">  %</font>
<font color="#009900">  \def\dopdfoutline#1#2#3#4{%</font>
<font color="#009900">    % Generate a link to the node text if that exists; else, use the</font>
<font color="#009900">    % page number.  We could generate a destination for the section</font>
<font color="#009900">    % text in the case where a section has no node, but it doesn't</font>
<font color="#009900">    % seem worth the trouble, since most documents are normally structured.</font>
<font color="#009900">    \edef\pdfoutlinedest{#3}%</font>
<font color="#009900">    \ifx\pdfoutlinedest\empty</font>
<font color="#009900">      \def\pdfoutlinedest{#4}%</font>
<font color="#009900">    \else</font>
<font color="#009900">      \txiescapepdf\pdfoutlinedest</font>
<font color="#009900">    \fi</font>
<font color="#009900">    %</font>
<font color="#009900">    % Also escape PDF chars in the display string.</font>
<font color="#009900">    \edef\pdfoutlinetext{#1}%</font>
<font color="#009900">    \txiescapepdf\pdfoutlinetext</font>
<font color="#009900">    %</font>
<font color="#009900">    \pdfoutline goto name{\pdfmkpgn{\pdfoutlinedest}}#2{\pdfoutlinetext}%</font>
<font color="#009900">  }</font>
<font color="#009900">  %</font>
<font color="#009900">  \def\pdfmakeoutlines{%</font>
<font color="#009900">    \begingroup</font>
<font color="#009900">      % Read toc silently, to get counts of subentries for \pdfoutline.</font>
<font color="#009900">      \def\partentry##1##2##3##4{}% ignore parts in the outlines</font>
<font color="#009900">      \def\numchapentry##1##2##3##4{%</font>
<font color="#009900">	\def\thischapnum{##2}%</font>
<font color="#009900">	\def\thissecnum{0}%</font>
<font color="#009900">	\def\thissubsecnum{0}%</font>
<font color="#009900">      }%</font>
<font color="#009900">      \def\numsecentry##1##2##3##4{%</font>
<font color="#009900">	\advancenumber{chap\thischapnum}%</font>
<font color="#009900">	\def\thissecnum{##2}%</font>
<font color="#009900">	\def\thissubsecnum{0}%</font>
<font color="#009900">      }%</font>
<font color="#009900">      \def\numsubsecentry##1##2##3##4{%</font>
<font color="#009900">	\advancenumber{sec\thissecnum}%</font>
<font color="#009900">	\def\thissubsecnum{##2}%</font>
<font color="#009900">      }%</font>
<font color="#009900">      \def\numsubsubsecentry##1##2##3##4{%</font>
<font color="#009900">	\advancenumber{subsec\thissubsecnum}%</font>
<font color="#009900">      }%</font>
<font color="#009900">      \def\thischapnum{0}%</font>
<font color="#009900">      \def\thissecnum{0}%</font>
<font color="#009900">      \def\thissubsecnum{0}%</font>
<font color="#009900">      %</font>
<font color="#009900">      % use \def rather than \let here because we redefine \chapentry et</font>
<font color="#009900">      % al. a second time, below.</font>
<font color="#009900">      \def\appentry{\numchapentry}%</font>
<font color="#009900">      \def\appsecentry{\numsecentry}%</font>
<font color="#009900">      \def\appsubsecentry{\numsubsecentry}%</font>
<font color="#009900">      \def\appsubsubsecentry{\numsubsubsecentry}%</font>
<font color="#009900">      \def\unnchapentry{\numchapentry}%</font>
<font color="#009900">      \def\unnsecentry{\numsecentry}%</font>
<font color="#009900">      \def\unnsubsecentry{\numsubsecentry}%</font>
<font color="#009900">      \def\unnsubsubsecentry{\numsubsubsecentry}%</font>
<font color="#009900">      \readdatafile{toc}%</font>
<font color="#009900">      %</font>
<font color="#009900">      % Read toc second time, this time actually producing the outlines.</font>
<font color="#009900">      % The `-' means take the \expnumber as the absolute number of</font>
<font color="#009900">      % subentries, which we calculated on our first read of the .toc above.</font>
<font color="#009900">      %</font>
<font color="#009900">      % We use the node names as the destinations.</font>
<font color="#009900">      \def\numchapentry##1##2##3##4{%</font>
<font color="#009900">        \dopdfoutline{##1}{count-\expnumber{chap##2}}{##3}{##4}}%</font>
<font color="#009900">      \def\numsecentry##1##2##3##4{%</font>
<font color="#009900">        \dopdfoutline{##1}{count-\expnumber{sec##2}}{##3}{##4}}%</font>
<font color="#009900">      \def\numsubsecentry##1##2##3##4{%</font>
<font color="#009900">        \dopdfoutline{##1}{count-\expnumber{subsec##2}}{##3}{##4}}%</font>
<font color="#009900">      \def\numsubsubsecentry##1##2##3##4{% count is always zero</font>
<font color="#009900">        \dopdfoutline{##1}{}{##3}{##4}}%</font>
<font color="#009900">      %</font>
<font color="#009900">      % PDF outlines are displayed using system fonts, instead of</font>
<font color="#009900">      % document fonts.  Therefore we cannot use special characters,</font>
<font color="#009900">      % since the encoding is unknown.  For example, the eogonek from</font>
<font color="#009900">      % Latin 2 (0xea) gets translated to a | character.  Info from</font>
<font color="#009900">      % Staszek Wawrykiewicz, 19 Jan 2004 04:09:24 +0100.</font>
<font color="#009900">      %</font>
<font color="#009900">      % TODO this right, we have to translate 8-bit characters to</font>
<font color="#009900">      % their "best" equivalent, based on the @documentencoding.  Too</font>
<font color="#009900">      % much work for too little return.  Just use the ASCII equivalents</font>
<font color="#009900">      % we use for the index sort strings.</font>
<font color="#009900">      % </font>
<font color="#009900">      \indexnofonts</font>
<font color="#009900">      \setupdatafile</font>
<font color="#009900">      % We can have normal brace characters in the PDF outlines, unlike</font>
<font color="#009900">      % Texinfo index files.  So set that up.</font>
<font color="#009900">      \def\{{\lbracecharliteral}%</font>
<font color="#009900">      \def\}{\rbracecharliteral}%</font>
<font color="#009900">      \catcode`\\=\active \otherbackslash</font>
<font color="#009900">      \input \tocreadfilename</font>
<font color="#009900">    \endgroup</font>
<font color="#009900">  }</font>
<font color="#009900">  {\catcode`[=1 \catcode`]=2</font>
<font color="#009900">   \catcode`{=\other \catcode`}=\other</font>
<font color="#009900">   \gdef\lbracecharliteral[{]%</font>
<font color="#009900">   \gdef\rbracecharliteral[}]%</font>
<font color="#009900">  ]</font>
<font color="#009900">  %</font>
<font color="#009900">  \def\skipspaces#1{\def\PP{#1}\def\D{|}%</font>
<font color="#009900">    \ifx\PP\D\let\nextsp\relax</font>
<font color="#009900">    \else\let\nextsp\skipspaces</font>
<font color="#009900">      \ifx\p\space\else\addtokens{\filename}{\PP}%</font>
<font color="#009900">        \advance\filenamelength by 1</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \fi</font>
<font color="#009900">    \nextsp}</font>
<font color="#009900">  \def\getfilename#1{%</font>
<font color="#009900">    \filenamelength=0</font>
<font color="#009900">    % If we don't expand the argument now, \skipspaces will get</font>
<font color="#009900">    % snagged on things like "@value{foo}".</font>
<font color="#009900">    \edef\temp{#1}%</font>
<font color="#009900">    \expandafter\skipspaces\temp|\relax</font>
<font color="#009900">  }</font>
<font color="#009900">  \ifnum\pdftexversion &lt; 14</font>
<font color="#009900">    \let \startlink \pdfannotlink</font>
<font color="#009900">  \else</font>
<font color="#009900">    \let \startlink \pdfstartlink</font>
<font color="#009900">  \fi</font>
<font color="#009900">  % make a live url in pdf output.</font>
<font color="#009900">  \def\pdfurl#1{%</font>
<font color="#009900">    \begingroup</font>
<font color="#009900">      % it seems we really need yet another set of dummies; have not</font>
<font color="#009900">      % tried to figure out what each command should do in the context</font>
<font color="#009900">      % of @url.  for now, just make @/ a no-op, that's the only one</font>
<font color="#009900">      % people have actually reported a problem with.</font>
<font color="#009900">      %</font>
<font color="#009900">      \normalturnoffactive</font>
<font color="#009900">      \def\@{@}%</font>
<font color="#009900">      \let\/=\empty</font>
<font color="#009900">      \makevalueexpandable</font>
<font color="#009900">      % do we want to go so far as to use \indexnofonts instead of just</font>
<font color="#009900">      % special-casing \var here?</font>
<font color="#009900">      \def\var##1{##1}%</font>
<font color="#009900">      %</font>
<font color="#009900">      \leavevmode\setcolor{\urlcolor}%</font>
<font color="#009900">      \startlink attr{/Border [0 0 0]}%</font>
<font color="#009900">        user{/Subtype /Link /A &lt;&lt; /S /URI /URI (#1) &gt;&gt;}%</font>
<font color="#009900">    \endgroup}</font>
<font color="#009900">  \def\pdfgettoks#1.{\setbox\boxA=\hbox{\toksA={#1.}\toksB={}\maketoks}}</font>
<font color="#009900">  \def\addtokens#1#2{\edef\addtoks{\noexpand#1={\the#1#2}}\addtoks}</font>
<font color="#009900">  \def\adn#1{\addtokens{\toksC}{#1}\global\countA=1\let\next=\maketoks}</font>
<font color="#009900">  \def\poptoks#1#2|ENDTOKS|{\let\first=#1\toksD={#1}\toksA={#2}}</font>
<font color="#009900">  \def\maketoks{%</font>
<font color="#009900">    \expandafter\poptoks\the\toksA|ENDTOKS|\relax</font>
<font color="#009900">    \ifx\first0\adn0</font>
<font color="#009900">    \else\ifx\first1\adn1 \else\ifx\first2\adn2 \else\ifx\first3\adn3</font>
<font color="#009900">    \else\ifx\first4\adn4 \else\ifx\first5\adn5 \else\ifx\first6\adn6</font>
<font color="#009900">    \else\ifx\first7\adn7 \else\ifx\first8\adn8 \else\ifx\first9\adn9</font>
<font color="#009900">    \else</font>
<font color="#009900">      \ifnum0=\countA\else\makelink\fi</font>
<font color="#009900">      \ifx\first.\let\next=\done\else</font>
<font color="#009900">        \let\next=\maketoks</font>
<font color="#009900">        \addtokens{\toksB}{\the\toksD}</font>
<font color="#009900">        \ifx\first,\addtokens{\toksB}{\space}\fi</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \fi\fi\fi\fi\fi\fi\fi\fi\fi\fi</font>
<font color="#009900">    \next}</font>
<font color="#009900">  \def\makelink{\addtokens{\toksB}%</font>
<font color="#009900">    {\noexpand\pdflink{\the\toksC}}\toksC={}\global\countA=0}</font>
<font color="#009900">  \def\pdflink#1{%</font>
<font color="#009900">    \startlink attr{/Border [0 0 0]} goto name{\pdfmkpgn{#1}}</font>
<font color="#009900">    \setcolor{\linkcolor}#1\endlink}</font>
<font color="#009900">  \def\done{\edef\st{\global\noexpand\toksA={\the\toksB}}\st}</font>
<font color="#009900">\else</font>
<font color="#009900">  % non-pdf mode</font>
<font color="#009900">  \let\pdfmkdest = \gobble</font>
<font color="#009900">  \let\pdfurl = \gobble</font>
<font color="#009900">  \let\endlink = \relax</font>
<font color="#009900">  \let\setcolor = \gobble</font>
<font color="#009900">  \let\pdfsetcolor = \gobble</font>
<font color="#009900">  \let\pdfmakeoutlines = \relax</font>
<font color="#009900">\fi  % \ifx\pdfoutput</font>


<font color="#009900">\message{fonts,}</font>

<font color="#009900">% Change the current font style to #1, remembering it in \curfontstyle.</font>
<font color="#009900">% For now, we do not accumulate font styles: @b{@i{foo}} prints foo in</font>
<font color="#009900">% italics, not bold italics.</font>
<font color="#009900">%</font>
<font color="#009900">\def\setfontstyle#1{%</font>
<font color="#009900">  \def\curfontstyle{#1}% not as a control sequence, because we are \edef'd.</font>
<font color="#009900">  \csname ten#1\endcsname  % change the current font</font>
<font color="#009900">}</font>

<font color="#009900">% Select #1 fonts with the current style.</font>
<font color="#009900">%</font>
<font color="#009900">\def\selectfonts#1{\csname #1fonts\endcsname \csname\curfontstyle\endcsname}</font>

<font color="#009900">\def\rm{\fam=0 \setfontstyle{rm}}</font>
<font color="#009900">\def\it{\fam=\itfam \setfontstyle{it}}</font>
<font color="#009900">\def\sl{\fam=\slfam \setfontstyle{sl}}</font>
<font color="#009900">\def\bf{\fam=\bffam \setfontstyle{bf}}\def\bfstylename{bf}</font>
<font color="#009900">\def\tt{\fam=\ttfam \setfontstyle{tt}}</font>

<font color="#009900">% Unfortunately, we have to override this for titles and the like, since</font>
<font color="#009900">% in those cases "rm" is bold.  Sigh.</font>
<font color="#009900">\def\rmisbold{\rm\def\curfontstyle{bf}}</font>

<font color="#009900">% Texinfo sort of supports the sans serif font style, which plain TeX does not.</font>
<font color="#009900">% So we set up a \sf.</font>
<font color="#009900">\newfam\sffam</font>
<font color="#009900">\def\sf{\fam=\sffam \setfontstyle{sf}}</font>
<font color="#009900">\let\li = \sf % Sometimes we call it \li, not \sf.</font>

<font color="#009900">% We don't need math for this font style.</font>
<font color="#009900">\def\ttsl{\setfontstyle{ttsl}}</font>


<font color="#009900">% Default leading.</font>
<font color="#009900">\newdimen\textleading  \textleading = 13.2pt</font>

<font color="#009900">% Set the baselineskip to #1, and the lineskip and strut size</font>
<font color="#009900">% correspondingly.  There is no deep meaning behind these magic numbers</font>
<font color="#009900">% used as factors; they just match (closely enough) what Knuth defined.</font>
<font color="#009900">%</font>
<font color="#009900">\def\lineskipfactor{.08333}</font>
<font color="#009900">\def\strutheightpercent{.70833}</font>
<font color="#009900">\def\strutdepthpercent {.29167}</font>
<font color="#009900">%</font>
<font color="#009900">% can get a sort of poor man's double spacing by redefining this.</font>
<font color="#009900">\def\baselinefactor{1}</font>
<font color="#009900">%</font>
<font color="#009900">\def\setleading#1{%</font>
<font color="#009900">  \dimen0 = #1\relax</font>
<font color="#009900">  \normalbaselineskip = \baselinefactor\dimen0</font>
<font color="#009900">  \normallineskip = \lineskipfactor\normalbaselineskip</font>
<font color="#009900">  \normalbaselines</font>
<font color="#009900">  \setbox\strutbox =\hbox{%</font>
<font color="#009900">    \vrule width0pt height\strutheightpercent\baselineskip</font>
<font color="#009900">                    depth \strutdepthpercent \baselineskip</font>
<font color="#009900">  }%</font>
<font color="#009900">}</font>

<font color="#009900">% PDF CMaps.  See also LaTeX's t1.cmap.</font>
<font color="#009900">%</font>
<font color="#009900">% do nothing with this by default.</font>
<font color="#009900">\expandafter\let\csname cmapOT1\endcsname\gobble</font>
<font color="#009900">\expandafter\let\csname cmapOT1IT\endcsname\gobble</font>
<font color="#009900">\expandafter\let\csname cmapOT1TT\endcsname\gobble</font>

<font color="#009900">% if we are producing pdf, and we have \pdffontattr, then define cmaps.</font>
<font color="#009900">% (\pdffontattr was introduced many years ago, but people still run</font>
<font color="#009900">% older pdftex's; it's easy to conditionalize, so we do.)</font>
<font color="#009900">\ifpdf \ifx\pdffontattr\thisisundefined \else</font>
<font color="#009900">  \begingroup</font>
<font color="#009900">    \catcode`\^^M=\active \def^^M{^^J}% Output line endings as the ^^J char.</font>
<font color="#009900">    \catcode`\%=12 \immediate\pdfobj stream {%!PS-Adobe-3.0 Resource-CMap</font>
<font color="#009900">%%DocumentNeededResources: ProcSet (CIDInit)</font>
<font color="#009900">%%IncludeResource: ProcSet (CIDInit)</font>
<font color="#009900">%%BeginResource: CMap (TeX-OT1-0)</font>
<font color="#009900">%%Title: (TeX-OT1-0 TeX OT1 0)</font>
<font color="#009900">%%Version: 1.000</font>
<font color="#009900">%%EndComments</font>
<font color="#009900">/CIDInit /ProcSet findresource begin</font>
<font color="#009900">12 dict begin</font>
<font color="#009900">begincmap</font>
<font color="#009900">/CIDSystemInfo</font>
<font color="#009900">&lt;&lt; /Registry (TeX)</font>
<font color="#009900">/Ordering (OT1)</font>
<font color="#009900">/Supplement 0</font>
<font color="#009900">&gt;&gt; def</font>
<font color="#009900">/CMapName /TeX-OT1-0 def</font>
<font color="#009900">/CMapType 2 def</font>
<font color="#009900">1 begincodespacerange</font>
<font color="#009900">&lt;00&gt; &lt;7F&gt;</font>
<font color="#009900">endcodespacerange</font>
<font color="#009900">8 beginbfrange</font>
<font color="#009900">&lt;00&gt; &lt;01&gt; &lt;0393&gt;</font>
<font color="#009900">&lt;09&gt; &lt;0A&gt; &lt;03A8&gt;</font>
<font color="#009900">&lt;23&gt; &lt;26&gt; &lt;0023&gt;</font>
<font color="#009900">&lt;28&gt; &lt;3B&gt; &lt;0028&gt;</font>
<font color="#009900">&lt;3F&gt; &lt;5B&gt; &lt;003F&gt;</font>
<font color="#009900">&lt;5D&gt; &lt;5E&gt; &lt;005D&gt;</font>
<font color="#009900">&lt;61&gt; &lt;7A&gt; &lt;0061&gt;</font>
<font color="#009900">&lt;7B&gt; &lt;7C&gt; &lt;2013&gt;</font>
<font color="#009900">endbfrange</font>
<font color="#009900">40 beginbfchar</font>
<font color="#009900">&lt;02&gt; &lt;0398&gt;</font>
<font color="#009900">&lt;03&gt; &lt;039B&gt;</font>
<font color="#009900">&lt;04&gt; &lt;039E&gt;</font>
<font color="#009900">&lt;05&gt; &lt;03A0&gt;</font>
<font color="#009900">&lt;06&gt; &lt;03A3&gt;</font>
<font color="#009900">&lt;07&gt; &lt;03D2&gt;</font>
<font color="#009900">&lt;08&gt; &lt;03A6&gt;</font>
<font color="#009900">&lt;0B&gt; &lt;00660066&gt;</font>
<font color="#009900">&lt;0C&gt; &lt;00660069&gt;</font>
<font color="#009900">&lt;0D&gt; &lt;0066006C&gt;</font>
<font color="#009900">&lt;0E&gt; &lt;006600660069&gt;</font>
<font color="#009900">&lt;0F&gt; &lt;00660066006C&gt;</font>
<font color="#009900">&lt;10&gt; &lt;0131&gt;</font>
<font color="#009900">&lt;11&gt; &lt;0237&gt;</font>
<font color="#009900">&lt;12&gt; &lt;0060&gt;</font>
<font color="#009900">&lt;13&gt; &lt;00B4&gt;</font>
<font color="#009900">&lt;14&gt; &lt;02C7&gt;</font>
<font color="#009900">&lt;15&gt; &lt;02D8&gt;</font>
<font color="#009900">&lt;16&gt; &lt;00AF&gt;</font>
<font color="#009900">&lt;17&gt; &lt;02DA&gt;</font>
<font color="#009900">&lt;18&gt; &lt;00B8&gt;</font>
<font color="#009900">&lt;19&gt; &lt;00DF&gt;</font>
<font color="#009900">&lt;1A&gt; &lt;00E6&gt;</font>
<font color="#009900">&lt;1B&gt; &lt;0153&gt;</font>
<font color="#009900">&lt;1C&gt; &lt;00F8&gt;</font>
<font color="#009900">&lt;1D&gt; &lt;00C6&gt;</font>
<font color="#009900">&lt;1E&gt; &lt;0152&gt;</font>
<font color="#009900">&lt;1F&gt; &lt;00D8&gt;</font>
<font color="#009900">&lt;21&gt; &lt;0021&gt;</font>
<font color="#009900">&lt;22&gt; &lt;201D&gt;</font>
<font color="#009900">&lt;27&gt; &lt;2019&gt;</font>
<font color="#009900">&lt;3C&gt; &lt;00A1&gt;</font>
<font color="#009900">&lt;3D&gt; &lt;003D&gt;</font>
<font color="#009900">&lt;3E&gt; &lt;00BF&gt;</font>
<font color="#009900">&lt;5C&gt; &lt;201C&gt;</font>
<font color="#009900">&lt;5F&gt; &lt;02D9&gt;</font>
<font color="#009900">&lt;60&gt; &lt;2018&gt;</font>
<font color="#009900">&lt;7D&gt; &lt;02DD&gt;</font>
<font color="#009900">&lt;7E&gt; &lt;007E&gt;</font>
<font color="#009900">&lt;7F&gt; &lt;00A8&gt;</font>
<font color="#009900">endbfchar</font>
<font color="#009900">endcmap</font>
<font color="#009900">CMapName currentdict /CMap defineresource pop</font>
<font color="#009900">end</font>
<font color="#009900">end</font>
<font color="#009900">%%EndResource</font>
<font color="#009900">%%EOF</font>
<font color="#009900">    }\endgroup</font>
<font color="#009900">  \expandafter\edef\csname cmapOT1\endcsname#1{%</font>
<font color="#009900">    \pdffontattr#1{/ToUnicode \the\pdflastobj\space 0 R}%</font>
<font color="#009900">  }%</font>
<font color="#009900">%</font>
<font color="#009900">% \cmapOT1IT</font>
<font color="#009900">  \begingroup</font>
<font color="#009900">    \catcode`\^^M=\active \def^^M{^^J}% Output line endings as the ^^J char.</font>
<font color="#009900">    \catcode`\%=12 \immediate\pdfobj stream {%!PS-Adobe-3.0 Resource-CMap</font>
<font color="#009900">%%DocumentNeededResources: ProcSet (CIDInit)</font>
<font color="#009900">%%IncludeResource: ProcSet (CIDInit)</font>
<font color="#009900">%%BeginResource: CMap (TeX-OT1IT-0)</font>
<font color="#009900">%%Title: (TeX-OT1IT-0 TeX OT1IT 0)</font>
<font color="#009900">%%Version: 1.000</font>
<font color="#009900">%%EndComments</font>
<font color="#009900">/CIDInit /ProcSet findresource begin</font>
<font color="#009900">12 dict begin</font>
<font color="#009900">begincmap</font>
<font color="#009900">/CIDSystemInfo</font>
<font color="#009900">&lt;&lt; /Registry (TeX)</font>
<font color="#009900">/Ordering (OT1IT)</font>
<font color="#009900">/Supplement 0</font>
<font color="#009900">&gt;&gt; def</font>
<font color="#009900">/CMapName /TeX-OT1IT-0 def</font>
<font color="#009900">/CMapType 2 def</font>
<font color="#009900">1 begincodespacerange</font>
<font color="#009900">&lt;00&gt; &lt;7F&gt;</font>
<font color="#009900">endcodespacerange</font>
<font color="#009900">8 beginbfrange</font>
<font color="#009900">&lt;00&gt; &lt;01&gt; &lt;0393&gt;</font>
<font color="#009900">&lt;09&gt; &lt;0A&gt; &lt;03A8&gt;</font>
<font color="#009900">&lt;25&gt; &lt;26&gt; &lt;0025&gt;</font>
<font color="#009900">&lt;28&gt; &lt;3B&gt; &lt;0028&gt;</font>
<font color="#009900">&lt;3F&gt; &lt;5B&gt; &lt;003F&gt;</font>
<font color="#009900">&lt;5D&gt; &lt;5E&gt; &lt;005D&gt;</font>
<font color="#009900">&lt;61&gt; &lt;7A&gt; &lt;0061&gt;</font>
<font color="#009900">&lt;7B&gt; &lt;7C&gt; &lt;2013&gt;</font>
<font color="#009900">endbfrange</font>
<font color="#009900">42 beginbfchar</font>
<font color="#009900">&lt;02&gt; &lt;0398&gt;</font>
<font color="#009900">&lt;03&gt; &lt;039B&gt;</font>
<font color="#009900">&lt;04&gt; &lt;039E&gt;</font>
<font color="#009900">&lt;05&gt; &lt;03A0&gt;</font>
<font color="#009900">&lt;06&gt; &lt;03A3&gt;</font>
<font color="#009900">&lt;07&gt; &lt;03D2&gt;</font>
<font color="#009900">&lt;08&gt; &lt;03A6&gt;</font>
<font color="#009900">&lt;0B&gt; &lt;00660066&gt;</font>
<font color="#009900">&lt;0C&gt; &lt;00660069&gt;</font>
<font color="#009900">&lt;0D&gt; &lt;0066006C&gt;</font>
<font color="#009900">&lt;0E&gt; &lt;006600660069&gt;</font>
<font color="#009900">&lt;0F&gt; &lt;00660066006C&gt;</font>
<font color="#009900">&lt;10&gt; &lt;0131&gt;</font>
<font color="#009900">&lt;11&gt; &lt;0237&gt;</font>
<font color="#009900">&lt;12&gt; &lt;0060&gt;</font>
<font color="#009900">&lt;13&gt; &lt;00B4&gt;</font>
<font color="#009900">&lt;14&gt; &lt;02C7&gt;</font>
<font color="#009900">&lt;15&gt; &lt;02D8&gt;</font>
<font color="#009900">&lt;16&gt; &lt;00AF&gt;</font>
<font color="#009900">&lt;17&gt; &lt;02DA&gt;</font>
<font color="#009900">&lt;18&gt; &lt;00B8&gt;</font>
<font color="#009900">&lt;19&gt; &lt;00DF&gt;</font>
<font color="#009900">&lt;1A&gt; &lt;00E6&gt;</font>
<font color="#009900">&lt;1B&gt; &lt;0153&gt;</font>
<font color="#009900">&lt;1C&gt; &lt;00F8&gt;</font>
<font color="#009900">&lt;1D&gt; &lt;00C6&gt;</font>
<font color="#009900">&lt;1E&gt; &lt;0152&gt;</font>
<font color="#009900">&lt;1F&gt; &lt;00D8&gt;</font>
<font color="#009900">&lt;21&gt; &lt;0021&gt;</font>
<font color="#009900">&lt;22&gt; &lt;201D&gt;</font>
<font color="#009900">&lt;23&gt; &lt;0023&gt;</font>
<font color="#009900">&lt;24&gt; &lt;00A3&gt;</font>
<font color="#009900">&lt;27&gt; &lt;2019&gt;</font>
<font color="#009900">&lt;3C&gt; &lt;00A1&gt;</font>
<font color="#009900">&lt;3D&gt; &lt;003D&gt;</font>
<font color="#009900">&lt;3E&gt; &lt;00BF&gt;</font>
<font color="#009900">&lt;5C&gt; &lt;201C&gt;</font>
<font color="#009900">&lt;5F&gt; &lt;02D9&gt;</font>
<font color="#009900">&lt;60&gt; &lt;2018&gt;</font>
<font color="#009900">&lt;7D&gt; &lt;02DD&gt;</font>
<font color="#009900">&lt;7E&gt; &lt;007E&gt;</font>
<font color="#009900">&lt;7F&gt; &lt;00A8&gt;</font>
<font color="#009900">endbfchar</font>
<font color="#009900">endcmap</font>
<font color="#009900">CMapName currentdict /CMap defineresource pop</font>
<font color="#009900">end</font>
<font color="#009900">end</font>
<font color="#009900">%%EndResource</font>
<font color="#009900">%%EOF</font>
<font color="#009900">    }\endgroup</font>
<font color="#009900">  \expandafter\edef\csname cmapOT1IT\endcsname#1{%</font>
<font color="#009900">    \pdffontattr#1{/ToUnicode \the\pdflastobj\space 0 R}%</font>
<font color="#009900">  }%</font>
<font color="#009900">%</font>
<font color="#009900">% \cmapOT1TT</font>
<font color="#009900">  \begingroup</font>
<font color="#009900">    \catcode`\^^M=\active \def^^M{^^J}% Output line endings as the ^^J char.</font>
<font color="#009900">    \catcode`\%=12 \immediate\pdfobj stream {%!PS-Adobe-3.0 Resource-CMap</font>
<font color="#009900">%%DocumentNeededResources: ProcSet (CIDInit)</font>
<font color="#009900">%%IncludeResource: ProcSet (CIDInit)</font>
<font color="#009900">%%BeginResource: CMap (TeX-OT1TT-0)</font>
<font color="#009900">%%Title: (TeX-OT1TT-0 TeX OT1TT 0)</font>
<font color="#009900">%%Version: 1.000</font>
<font color="#009900">%%EndComments</font>
<font color="#009900">/CIDInit /ProcSet findresource begin</font>
<font color="#009900">12 dict begin</font>
<font color="#009900">begincmap</font>
<font color="#009900">/CIDSystemInfo</font>
<font color="#009900">&lt;&lt; /Registry (TeX)</font>
<font color="#009900">/Ordering (OT1TT)</font>
<font color="#009900">/Supplement 0</font>
<font color="#009900">&gt;&gt; def</font>
<font color="#009900">/CMapName /TeX-OT1TT-0 def</font>
<font color="#009900">/CMapType 2 def</font>
<font color="#009900">1 begincodespacerange</font>
<font color="#009900">&lt;00&gt; &lt;7F&gt;</font>
<font color="#009900">endcodespacerange</font>
<font color="#009900">5 beginbfrange</font>
<font color="#009900">&lt;00&gt; &lt;01&gt; &lt;0393&gt;</font>
<font color="#009900">&lt;09&gt; &lt;0A&gt; &lt;03A8&gt;</font>
<font color="#009900">&lt;21&gt; &lt;26&gt; &lt;0021&gt;</font>
<font color="#009900">&lt;28&gt; &lt;5F&gt; &lt;0028&gt;</font>
<font color="#009900">&lt;61&gt; &lt;7E&gt; &lt;0061&gt;</font>
<font color="#009900">endbfrange</font>
<font color="#009900">32 beginbfchar</font>
<font color="#009900">&lt;02&gt; &lt;0398&gt;</font>
<font color="#009900">&lt;03&gt; &lt;039B&gt;</font>
<font color="#009900">&lt;04&gt; &lt;039E&gt;</font>
<font color="#009900">&lt;05&gt; &lt;03A0&gt;</font>
<font color="#009900">&lt;06&gt; &lt;03A3&gt;</font>
<font color="#009900">&lt;07&gt; &lt;03D2&gt;</font>
<font color="#009900">&lt;08&gt; &lt;03A6&gt;</font>
<font color="#009900">&lt;0B&gt; &lt;2191&gt;</font>
<font color="#009900">&lt;0C&gt; &lt;2193&gt;</font>
<font color="#009900">&lt;0D&gt; &lt;0027&gt;</font>
<font color="#009900">&lt;0E&gt; &lt;00A1&gt;</font>
<font color="#009900">&lt;0F&gt; &lt;00BF&gt;</font>
<font color="#009900">&lt;10&gt; &lt;0131&gt;</font>
<font color="#009900">&lt;11&gt; &lt;0237&gt;</font>
<font color="#009900">&lt;12&gt; &lt;0060&gt;</font>
<font color="#009900">&lt;13&gt; &lt;00B4&gt;</font>
<font color="#009900">&lt;14&gt; &lt;02C7&gt;</font>
<font color="#009900">&lt;15&gt; &lt;02D8&gt;</font>
<font color="#009900">&lt;16&gt; &lt;00AF&gt;</font>
<font color="#009900">&lt;17&gt; &lt;02DA&gt;</font>
<font color="#009900">&lt;18&gt; &lt;00B8&gt;</font>
<font color="#009900">&lt;19&gt; &lt;00DF&gt;</font>
<font color="#009900">&lt;1A&gt; &lt;00E6&gt;</font>
<font color="#009900">&lt;1B&gt; &lt;0153&gt;</font>
<font color="#009900">&lt;1C&gt; &lt;00F8&gt;</font>
<font color="#009900">&lt;1D&gt; &lt;00C6&gt;</font>
<font color="#009900">&lt;1E&gt; &lt;0152&gt;</font>
<font color="#009900">&lt;1F&gt; &lt;00D8&gt;</font>
<font color="#009900">&lt;20&gt; &lt;2423&gt;</font>
<font color="#009900">&lt;27&gt; &lt;2019&gt;</font>
<font color="#009900">&lt;60&gt; &lt;2018&gt;</font>
<font color="#009900">&lt;7F&gt; &lt;00A8&gt;</font>
<font color="#009900">endbfchar</font>
<font color="#009900">endcmap</font>
<font color="#009900">CMapName currentdict /CMap defineresource pop</font>
<font color="#009900">end</font>
<font color="#009900">end</font>
<font color="#009900">%%EndResource</font>
<font color="#009900">%%EOF</font>
<font color="#009900">    }\endgroup</font>
<font color="#009900">  \expandafter\edef\csname cmapOT1TT\endcsname#1{%</font>
<font color="#009900">    \pdffontattr#1{/ToUnicode \the\pdflastobj\space 0 R}%</font>
<font color="#009900">  }%</font>
<font color="#009900">\fi\fi</font>


<font color="#009900">% Set the font macro #1 to the font named #2, adding on the</font>
<font color="#009900">% specified font prefix (normally `cm').</font>
<font color="#009900">% #3 is the font's design size, #4 is a scale factor, #5 is the CMap</font>
<font color="#009900">% encoding (currently only OT1, OT1IT and OT1TT are allowed, pass</font>
<font color="#009900">% empty to omit).</font>
<font color="#009900">\def\setfont#1#2#3#4#5{%</font>
<font color="#009900">  \font#1=\fontprefix#2#3 scaled #4</font>
<font color="#009900">  \csname cmap#5\endcsname#1%</font>
<font color="#009900">}</font>
<font color="#009900">% This is what gets called when #5 of \setfont is empty.</font>
<font color="#009900">\let\cmap\gobble</font>
<font color="#009900">% emacs-page end of cmaps</font>

<font color="#009900">% Use cm as the default font prefix.</font>
<font color="#009900">% To specify the font prefix, you must define \fontprefix</font>
<font color="#009900">% before you read in texinfo.tex.</font>
<font color="#009900">\ifx\fontprefix\thisisundefined</font>
<font color="#009900">\def\fontprefix{cm}</font>
<font color="#009900">\fi</font>
<font color="#009900">% Support font families that don't use the same naming scheme as CM.</font>
<font color="#009900">\def\rmshape{r}</font>
<font color="#009900">\def\rmbshape{bx}               %where the normal face is bold</font>
<font color="#009900">\def\bfshape{b}</font>
<font color="#009900">\def\bxshape{bx}</font>
<font color="#009900">\def\ttshape{tt}</font>
<font color="#009900">\def\ttbshape{tt}</font>
<font color="#009900">\def\ttslshape{sltt}</font>
<font color="#009900">\def\itshape{ti}</font>
<font color="#009900">\def\itbshape{bxti}</font>
<font color="#009900">\def\slshape{sl}</font>
<font color="#009900">\def\slbshape{bxsl}</font>
<font color="#009900">\def\sfshape{ss}</font>
<font color="#009900">\def\sfbshape{ss}</font>
<font color="#009900">\def\scshape{csc}</font>
<font color="#009900">\def\scbshape{csc}</font>

<font color="#009900">% Definitions for a main text size of 11pt.  This is the default in</font>
<font color="#009900">% Texinfo.</font>
<font color="#009900">%</font>
<font color="#009900">\def\definetextfontsizexi{%</font>
<font color="#009900">% Text fonts (11.2pt, magstep1).</font>
<font color="#009900">\def\textnominalsize{11pt}</font>
<font color="#009900">\edef\mainmagstep{\magstephalf}</font>
<font color="#009900">\setfont\textrm\rmshape{10}{\mainmagstep}{OT1}</font>
<font color="#009900">\setfont\texttt\ttshape{10}{\mainmagstep}{OT1TT}</font>
<font color="#009900">\setfont\textbf\bfshape{10}{\mainmagstep}{OT1}</font>
<font color="#009900">\setfont\textit\itshape{10}{\mainmagstep}{OT1IT}</font>
<font color="#009900">\setfont\textsl\slshape{10}{\mainmagstep}{OT1}</font>
<font color="#009900">\setfont\textsf\sfshape{10}{\mainmagstep}{OT1}</font>
<font color="#009900">\setfont\textsc\scshape{10}{\mainmagstep}{OT1}</font>
<font color="#009900">\setfont\textttsl\ttslshape{10}{\mainmagstep}{OT1TT}</font>
<font color="#009900">\font\texti=cmmi10 scaled \mainmagstep</font>
<font color="#009900">\font\textsy=cmsy10 scaled \mainmagstep</font>
<font color="#009900">\def\textecsize{1095}</font>

<font color="#009900">% A few fonts for @defun names and args.</font>
<font color="#009900">\setfont\defbf\bfshape{10}{\magstep1}{OT1}</font>
<font color="#009900">\setfont\deftt\ttshape{10}{\magstep1}{OT1TT}</font>
<font color="#009900">\setfont\defttsl\ttslshape{10}{\magstep1}{OT1TT}</font>
<font color="#009900">\def\df{\let\tentt=\deftt \let\tenbf = \defbf \let\tenttsl=\defttsl \bf}</font>

<font color="#009900">% Fonts for indices, footnotes, small examples (9pt).</font>
<font color="#009900">\def\smallnominalsize{9pt}</font>
<font color="#009900">\setfont\smallrm\rmshape{9}{1000}{OT1}</font>
<font color="#009900">\setfont\smalltt\ttshape{9}{1000}{OT1TT}</font>
<font color="#009900">\setfont\smallbf\bfshape{10}{900}{OT1}</font>
<font color="#009900">\setfont\smallit\itshape{9}{1000}{OT1IT}</font>
<font color="#009900">\setfont\smallsl\slshape{9}{1000}{OT1}</font>
<font color="#009900">\setfont\smallsf\sfshape{9}{1000}{OT1}</font>
<font color="#009900">\setfont\smallsc\scshape{10}{900}{OT1}</font>
<font color="#009900">\setfont\smallttsl\ttslshape{10}{900}{OT1TT}</font>
<font color="#009900">\font\smalli=cmmi9</font>
<font color="#009900">\font\smallsy=cmsy9</font>
<font color="#009900">\def\smallecsize{0900}</font>

<font color="#009900">% Fonts for small examples (8pt).</font>
<font color="#009900">\def\smallernominalsize{8pt}</font>
<font color="#009900">\setfont\smallerrm\rmshape{8}{1000}{OT1}</font>
<font color="#009900">\setfont\smallertt\ttshape{8}{1000}{OT1TT}</font>
<font color="#009900">\setfont\smallerbf\bfshape{10}{800}{OT1}</font>
<font color="#009900">\setfont\smallerit\itshape{8}{1000}{OT1IT}</font>
<font color="#009900">\setfont\smallersl\slshape{8}{1000}{OT1}</font>
<font color="#009900">\setfont\smallersf\sfshape{8}{1000}{OT1}</font>
<font color="#009900">\setfont\smallersc\scshape{10}{800}{OT1}</font>
<font color="#009900">\setfont\smallerttsl\ttslshape{10}{800}{OT1TT}</font>
<font color="#009900">\font\smalleri=cmmi8</font>
<font color="#009900">\font\smallersy=cmsy8</font>
<font color="#009900">\def\smallerecsize{0800}</font>

<font color="#009900">% Fonts for title page (20.4pt):</font>
<font color="#009900">\def\titlenominalsize{20pt}</font>
<font color="#009900">\setfont\titlerm\rmbshape{12}{\magstep3}{OT1}</font>
<font color="#009900">\setfont\titleit\itbshape{10}{\magstep4}{OT1IT}</font>
<font color="#009900">\setfont\titlesl\slbshape{10}{\magstep4}{OT1}</font>
<font color="#009900">\setfont\titlett\ttbshape{12}{\magstep3}{OT1TT}</font>
<font color="#009900">\setfont\titlettsl\ttslshape{10}{\magstep4}{OT1TT}</font>
<font color="#009900">\setfont\titlesf\sfbshape{17}{\magstep1}{OT1}</font>
<font color="#009900">\let\titlebf=\titlerm</font>
<font color="#009900">\setfont\titlesc\scbshape{10}{\magstep4}{OT1}</font>
<font color="#009900">\font\titlei=cmmi12 scaled \magstep3</font>
<font color="#009900">\font\titlesy=cmsy10 scaled \magstep4</font>
<font color="#009900">\def\titleecsize{2074}</font>

<font color="#009900">% Chapter (and unnumbered) fonts (17.28pt).</font>
<font color="#009900">\def\chapnominalsize{17pt}</font>
<font color="#009900">\setfont\chaprm\rmbshape{12}{\magstep2}{OT1}</font>
<font color="#009900">\setfont\chapit\itbshape{10}{\magstep3}{OT1IT}</font>
<font color="#009900">\setfont\chapsl\slbshape{10}{\magstep3}{OT1}</font>
<font color="#009900">\setfont\chaptt\ttbshape{12}{\magstep2}{OT1TT}</font>
<font color="#009900">\setfont\chapttsl\ttslshape{10}{\magstep3}{OT1TT}</font>
<font color="#009900">\setfont\chapsf\sfbshape{17}{1000}{OT1}</font>
<font color="#009900">\let\chapbf=\chaprm</font>
<font color="#009900">\setfont\chapsc\scbshape{10}{\magstep3}{OT1}</font>
<font color="#009900">\font\chapi=cmmi12 scaled \magstep2</font>
<font color="#009900">\font\chapsy=cmsy10 scaled \magstep3</font>
<font color="#009900">\def\chapecsize{1728}</font>

<font color="#009900">% Section fonts (14.4pt).</font>
<font color="#009900">\def\secnominalsize{14pt}</font>
<font color="#009900">\setfont\secrm\rmbshape{12}{\magstep1}{OT1}</font>
<font color="#009900">\setfont\secit\itbshape{10}{\magstep2}{OT1IT}</font>
<font color="#009900">\setfont\secsl\slbshape{10}{\magstep2}{OT1}</font>
<font color="#009900">\setfont\sectt\ttbshape{12}{\magstep1}{OT1TT}</font>
<font color="#009900">\setfont\secttsl\ttslshape{10}{\magstep2}{OT1TT}</font>
<font color="#009900">\setfont\secsf\sfbshape{12}{\magstep1}{OT1}</font>
<font color="#009900">\let\secbf\secrm</font>
<font color="#009900">\setfont\secsc\scbshape{10}{\magstep2}{OT1}</font>
<font color="#009900">\font\seci=cmmi12 scaled \magstep1</font>
<font color="#009900">\font\secsy=cmsy10 scaled \magstep2</font>
<font color="#009900">\def\sececsize{1440}</font>

<font color="#009900">% Subsection fonts (13.15pt).</font>
<font color="#009900">\def\ssecnominalsize{13pt}</font>
<font color="#009900">\setfont\ssecrm\rmbshape{12}{\magstephalf}{OT1}</font>
<font color="#009900">\setfont\ssecit\itbshape{10}{1315}{OT1IT}</font>
<font color="#009900">\setfont\ssecsl\slbshape{10}{1315}{OT1}</font>
<font color="#009900">\setfont\ssectt\ttbshape{12}{\magstephalf}{OT1TT}</font>
<font color="#009900">\setfont\ssecttsl\ttslshape{10}{1315}{OT1TT}</font>
<font color="#009900">\setfont\ssecsf\sfbshape{12}{\magstephalf}{OT1}</font>
<font color="#009900">\let\ssecbf\ssecrm</font>
<font color="#009900">\setfont\ssecsc\scbshape{10}{1315}{OT1}</font>
<font color="#009900">\font\sseci=cmmi12 scaled \magstephalf</font>
<font color="#009900">\font\ssecsy=cmsy10 scaled 1315</font>
<font color="#009900">\def\ssececsize{1200}</font>

<font color="#009900">% Reduced fonts for @acro in text (10pt).</font>
<font color="#009900">\def\reducednominalsize{10pt}</font>
<font color="#009900">\setfont\reducedrm\rmshape{10}{1000}{OT1}</font>
<font color="#009900">\setfont\reducedtt\ttshape{10}{1000}{OT1TT}</font>
<font color="#009900">\setfont\reducedbf\bfshape{10}{1000}{OT1}</font>
<font color="#009900">\setfont\reducedit\itshape{10}{1000}{OT1IT}</font>
<font color="#009900">\setfont\reducedsl\slshape{10}{1000}{OT1}</font>
<font color="#009900">\setfont\reducedsf\sfshape{10}{1000}{OT1}</font>
<font color="#009900">\setfont\reducedsc\scshape{10}{1000}{OT1}</font>
<font color="#009900">\setfont\reducedttsl\ttslshape{10}{1000}{OT1TT}</font>
<font color="#009900">\font\reducedi=cmmi10</font>
<font color="#009900">\font\reducedsy=cmsy10</font>
<font color="#009900">\def\reducedecsize{1000}</font>

<font color="#009900">\textleading = 13.2pt % line spacing for 11pt CM</font>
<font color="#009900">\textfonts            % reset the current fonts</font>
<font color="#009900">\rm</font>
<font color="#009900">} % end of 11pt text font size definitions</font>


<font color="#009900">% Definitions to make the main text be 10pt Computer Modern, with</font>
<font color="#009900">% section, chapter, etc., sizes following suit.  This is for the GNU</font>
<font color="#009900">% Press printing of the Emacs 22 manual.  Maybe other manuals in the</font>
<font color="#009900">% future.  Used with @smallbook, which sets the leading to 12pt.</font>
<font color="#009900">%</font>
<font color="#009900">\def\definetextfontsizex{%</font>
<font color="#009900">% Text fonts (10pt).</font>
<font color="#009900">\def\textnominalsize{10pt}</font>
<font color="#009900">\edef\mainmagstep{1000}</font>
<font color="#009900">\setfont\textrm\rmshape{10}{\mainmagstep}{OT1}</font>
<font color="#009900">\setfont\texttt\ttshape{10}{\mainmagstep}{OT1TT}</font>
<font color="#009900">\setfont\textbf\bfshape{10}{\mainmagstep}{OT1}</font>
<font color="#009900">\setfont\textit\itshape{10}{\mainmagstep}{OT1IT}</font>
<font color="#009900">\setfont\textsl\slshape{10}{\mainmagstep}{OT1}</font>
<font color="#009900">\setfont\textsf\sfshape{10}{\mainmagstep}{OT1}</font>
<font color="#009900">\setfont\textsc\scshape{10}{\mainmagstep}{OT1}</font>
<font color="#009900">\setfont\textttsl\ttslshape{10}{\mainmagstep}{OT1TT}</font>
<font color="#009900">\font\texti=cmmi10 scaled \mainmagstep</font>
<font color="#009900">\font\textsy=cmsy10 scaled \mainmagstep</font>
<font color="#009900">\def\textecsize{1000}</font>

<font color="#009900">% A few fonts for @defun names and args.</font>
<font color="#009900">\setfont\defbf\bfshape{10}{\magstephalf}{OT1}</font>
<font color="#009900">\setfont\deftt\ttshape{10}{\magstephalf}{OT1TT}</font>
<font color="#009900">\setfont\defttsl\ttslshape{10}{\magstephalf}{OT1TT}</font>
<font color="#009900">\def\df{\let\tentt=\deftt \let\tenbf = \defbf \let\tenttsl=\defttsl \bf}</font>

<font color="#009900">% Fonts for indices, footnotes, small examples (9pt).</font>
<font color="#009900">\def\smallnominalsize{9pt}</font>
<font color="#009900">\setfont\smallrm\rmshape{9}{1000}{OT1}</font>
<font color="#009900">\setfont\smalltt\ttshape{9}{1000}{OT1TT}</font>
<font color="#009900">\setfont\smallbf\bfshape{10}{900}{OT1}</font>
<font color="#009900">\setfont\smallit\itshape{9}{1000}{OT1IT}</font>
<font color="#009900">\setfont\smallsl\slshape{9}{1000}{OT1}</font>
<font color="#009900">\setfont\smallsf\sfshape{9}{1000}{OT1}</font>
<font color="#009900">\setfont\smallsc\scshape{10}{900}{OT1}</font>
<font color="#009900">\setfont\smallttsl\ttslshape{10}{900}{OT1TT}</font>
<font color="#009900">\font\smalli=cmmi9</font>
<font color="#009900">\font\smallsy=cmsy9</font>
<font color="#009900">\def\smallecsize{0900}</font>

<font color="#009900">% Fonts for small examples (8pt).</font>
<font color="#009900">\def\smallernominalsize{8pt}</font>
<font color="#009900">\setfont\smallerrm\rmshape{8}{1000}{OT1}</font>
<font color="#009900">\setfont\smallertt\ttshape{8}{1000}{OT1TT}</font>
<font color="#009900">\setfont\smallerbf\bfshape{10}{800}{OT1}</font>
<font color="#009900">\setfont\smallerit\itshape{8}{1000}{OT1IT}</font>
<font color="#009900">\setfont\smallersl\slshape{8}{1000}{OT1}</font>
<font color="#009900">\setfont\smallersf\sfshape{8}{1000}{OT1}</font>
<font color="#009900">\setfont\smallersc\scshape{10}{800}{OT1}</font>
<font color="#009900">\setfont\smallerttsl\ttslshape{10}{800}{OT1TT}</font>
<font color="#009900">\font\smalleri=cmmi8</font>
<font color="#009900">\font\smallersy=cmsy8</font>
<font color="#009900">\def\smallerecsize{0800}</font>

<font color="#009900">% Fonts for title page (20.4pt):</font>
<font color="#009900">\def\titlenominalsize{20pt}</font>
<font color="#009900">\setfont\titlerm\rmbshape{12}{\magstep3}{OT1}</font>
<font color="#009900">\setfont\titleit\itbshape{10}{\magstep4}{OT1IT}</font>
<font color="#009900">\setfont\titlesl\slbshape{10}{\magstep4}{OT1}</font>
<font color="#009900">\setfont\titlett\ttbshape{12}{\magstep3}{OT1TT}</font>
<font color="#009900">\setfont\titlettsl\ttslshape{10}{\magstep4}{OT1TT}</font>
<font color="#009900">\setfont\titlesf\sfbshape{17}{\magstep1}{OT1}</font>
<font color="#009900">\let\titlebf=\titlerm</font>
<font color="#009900">\setfont\titlesc\scbshape{10}{\magstep4}{OT1}</font>
<font color="#009900">\font\titlei=cmmi12 scaled \magstep3</font>
<font color="#009900">\font\titlesy=cmsy10 scaled \magstep4</font>
<font color="#009900">\def\titleecsize{2074}</font>

<font color="#009900">% Chapter fonts (14.4pt).</font>
<font color="#009900">\def\chapnominalsize{14pt}</font>
<font color="#009900">\setfont\chaprm\rmbshape{12}{\magstep1}{OT1}</font>
<font color="#009900">\setfont\chapit\itbshape{10}{\magstep2}{OT1IT}</font>
<font color="#009900">\setfont\chapsl\slbshape{10}{\magstep2}{OT1}</font>
<font color="#009900">\setfont\chaptt\ttbshape{12}{\magstep1}{OT1TT}</font>
<font color="#009900">\setfont\chapttsl\ttslshape{10}{\magstep2}{OT1TT}</font>
<font color="#009900">\setfont\chapsf\sfbshape{12}{\magstep1}{OT1}</font>
<font color="#009900">\let\chapbf\chaprm</font>
<font color="#009900">\setfont\chapsc\scbshape{10}{\magstep2}{OT1}</font>
<font color="#009900">\font\chapi=cmmi12 scaled \magstep1</font>
<font color="#009900">\font\chapsy=cmsy10 scaled \magstep2</font>
<font color="#009900">\def\chapecsize{1440}</font>

<font color="#009900">% Section fonts (12pt).</font>
<font color="#009900">\def\secnominalsize{12pt}</font>
<font color="#009900">\setfont\secrm\rmbshape{12}{1000}{OT1}</font>
<font color="#009900">\setfont\secit\itbshape{10}{\magstep1}{OT1IT}</font>
<font color="#009900">\setfont\secsl\slbshape{10}{\magstep1}{OT1}</font>
<font color="#009900">\setfont\sectt\ttbshape{12}{1000}{OT1TT}</font>
<font color="#009900">\setfont\secttsl\ttslshape{10}{\magstep1}{OT1TT}</font>
<font color="#009900">\setfont\secsf\sfbshape{12}{1000}{OT1}</font>
<font color="#009900">\let\secbf\secrm</font>
<font color="#009900">\setfont\secsc\scbshape{10}{\magstep1}{OT1}</font>
<font color="#009900">\font\seci=cmmi12</font>
<font color="#009900">\font\secsy=cmsy10 scaled \magstep1</font>
<font color="#009900">\def\sececsize{1200}</font>

<font color="#009900">% Subsection fonts (10pt).</font>
<font color="#009900">\def\ssecnominalsize{10pt}</font>
<font color="#009900">\setfont\ssecrm\rmbshape{10}{1000}{OT1}</font>
<font color="#009900">\setfont\ssecit\itbshape{10}{1000}{OT1IT}</font>
<font color="#009900">\setfont\ssecsl\slbshape{10}{1000}{OT1}</font>
<font color="#009900">\setfont\ssectt\ttbshape{10}{1000}{OT1TT}</font>
<font color="#009900">\setfont\ssecttsl\ttslshape{10}{1000}{OT1TT}</font>
<font color="#009900">\setfont\ssecsf\sfbshape{10}{1000}{OT1}</font>
<font color="#009900">\let\ssecbf\ssecrm</font>
<font color="#009900">\setfont\ssecsc\scbshape{10}{1000}{OT1}</font>
<font color="#009900">\font\sseci=cmmi10</font>
<font color="#009900">\font\ssecsy=cmsy10</font>
<font color="#009900">\def\ssececsize{1000}</font>

<font color="#009900">% Reduced fonts for @acro in text (9pt).</font>
<font color="#009900">\def\reducednominalsize{9pt}</font>
<font color="#009900">\setfont\reducedrm\rmshape{9}{1000}{OT1}</font>
<font color="#009900">\setfont\reducedtt\ttshape{9}{1000}{OT1TT}</font>
<font color="#009900">\setfont\reducedbf\bfshape{10}{900}{OT1}</font>
<font color="#009900">\setfont\reducedit\itshape{9}{1000}{OT1IT}</font>
<font color="#009900">\setfont\reducedsl\slshape{9}{1000}{OT1}</font>
<font color="#009900">\setfont\reducedsf\sfshape{9}{1000}{OT1}</font>
<font color="#009900">\setfont\reducedsc\scshape{10}{900}{OT1}</font>
<font color="#009900">\setfont\reducedttsl\ttslshape{10}{900}{OT1TT}</font>
<font color="#009900">\font\reducedi=cmmi9</font>
<font color="#009900">\font\reducedsy=cmsy9</font>
<font color="#009900">\def\reducedecsize{0900}</font>

<font color="#009900">\divide\parskip by 2  % reduce space between paragraphs</font>
<font color="#009900">\textleading = 12pt   % line spacing for 10pt CM</font>
<font color="#009900">\textfonts            % reset the current fonts</font>
<font color="#009900">\rm</font>
<font color="#009900">} % end of 10pt text font size definitions</font>


<font color="#009900">% We provide the user-level command</font>
<font color="#009900">%   @fonttextsize 10</font>
<font color="#009900">% (or 11) to redefine the text font size.  pt is assumed.</font>
<font color="#009900">%</font>
<font color="#009900">\def\xiword{11}</font>
<font color="#009900">\def\xword{10}</font>
<font color="#009900">\def\xwordpt{10pt}</font>
<font color="#009900">%</font>
<font color="#009900">\parseargdef\fonttextsize{%</font>
<font color="#009900">  \def\textsizearg{#1}%</font>
<font color="#009900">  %\wlog{doing @fonttextsize \textsizearg}%</font>
<font color="#009900">  %</font>
<font color="#009900">  % Set \globaldefs so that documents can use this inside @tex, since</font>
<font color="#009900">  % makeinfo 4.8 does not support it, but we need it nonetheless.</font>
<font color="#009900">  %</font>
<font color="#009900"> \begingroup \globaldefs=1</font>
<font color="#009900">  \ifx\textsizearg\xword \definetextfontsizex</font>
<font color="#009900">  \else \ifx\textsizearg\xiword \definetextfontsizexi</font>
<font color="#009900">  \else</font>
<font color="#009900">    \errhelp=\EMsimple</font>
<font color="#009900">    \errmessage{@fonttextsize only supports `10' or `11', not `\textsizearg'}</font>
<font color="#009900">  \fi\fi</font>
<font color="#009900"> \endgroup</font>
<font color="#009900">}</font>


<font color="#009900">% In order for the font changes to affect most math symbols and letters,</font>
<font color="#009900">% we have to define the \textfont of the standard families.  Since</font>
<font color="#009900">% texinfo doesn't allow for producing subscripts and superscripts except</font>
<font color="#009900">% in the main text, we don't bother to reset \scriptfont and</font>
<font color="#009900">% \scriptscriptfont (which would also require loading a lot more fonts).</font>
<font color="#009900">%</font>
<font color="#009900">\def\resetmathfonts{%</font>
<font color="#009900">  \textfont0=\tenrm \textfont1=\teni \textfont2=\tensy</font>
<font color="#009900">  \textfont\itfam=\tenit \textfont\slfam=\tensl \textfont\bffam=\tenbf</font>
<font color="#009900">  \textfont\ttfam=\tentt \textfont\sffam=\tensf</font>
<font color="#009900">}</font>

<font color="#009900">% The font-changing commands redefine the meanings of \tenSTYLE, instead</font>
<font color="#009900">% of just \STYLE.  We do this because \STYLE needs to also set the</font>
<font color="#009900">% current \fam for math mode.  Our \STYLE (e.g., \rm) commands hardwire</font>
<font color="#009900">% \tenSTYLE to set the current font.</font>
<font color="#009900">%</font>
<font color="#009900">% Each font-changing command also sets the names \lsize (one size lower)</font>
<font color="#009900">% and \lllsize (three sizes lower).  These relative commands are used in</font>
<font color="#009900">% the LaTeX logo and acronyms.</font>
<font color="#009900">%</font>
<font color="#009900">% This all needs generalizing, badly.</font>
<font color="#009900">%</font>
<font color="#009900">\def\textfonts{%</font>
<font color="#009900">  \let\tenrm=\textrm \let\tenit=\textit \let\tensl=\textsl</font>
<font color="#009900">  \let\tenbf=\textbf \let\tentt=\texttt \let\smallcaps=\textsc</font>
<font color="#009900">  \let\tensf=\textsf \let\teni=\texti \let\tensy=\textsy</font>
<font color="#009900">  \let\tenttsl=\textttsl</font>
<font color="#009900">  \def\curfontsize{text}%</font>
<font color="#009900">  \def\lsize{reduced}\def\lllsize{smaller}%</font>
<font color="#009900">  \resetmathfonts \setleading{\textleading}}</font>
<font color="#009900">\def\titlefonts{%</font>
<font color="#009900">  \let\tenrm=\titlerm \let\tenit=\titleit \let\tensl=\titlesl</font>
<font color="#009900">  \let\tenbf=\titlebf \let\tentt=\titlett \let\smallcaps=\titlesc</font>
<font color="#009900">  \let\tensf=\titlesf \let\teni=\titlei \let\tensy=\titlesy</font>
<font color="#009900">  \let\tenttsl=\titlettsl</font>
<font color="#009900">  \def\curfontsize{title}%</font>
<font color="#009900">  \def\lsize{chap}\def\lllsize{subsec}%</font>
<font color="#009900">  \resetmathfonts \setleading{27pt}}</font>
<font color="#009900">\def\titlefont#1{{\titlefonts\rmisbold #1}}</font>
<font color="#009900">\def\chapfonts{%</font>
<font color="#009900">  \let\tenrm=\chaprm \let\tenit=\chapit \let\tensl=\chapsl</font>
<font color="#009900">  \let\tenbf=\chapbf \let\tentt=\chaptt \let\smallcaps=\chapsc</font>
<font color="#009900">  \let\tensf=\chapsf \let\teni=\chapi \let\tensy=\chapsy</font>
<font color="#009900">  \let\tenttsl=\chapttsl</font>
<font color="#009900">  \def\curfontsize{chap}%</font>
<font color="#009900">  \def\lsize{sec}\def\lllsize{text}%</font>
<font color="#009900">  \resetmathfonts \setleading{19pt}}</font>
<font color="#009900">\def\secfonts{%</font>
<font color="#009900">  \let\tenrm=\secrm \let\tenit=\secit \let\tensl=\secsl</font>
<font color="#009900">  \let\tenbf=\secbf \let\tentt=\sectt \let\smallcaps=\secsc</font>
<font color="#009900">  \let\tensf=\secsf \let\teni=\seci \let\tensy=\secsy</font>
<font color="#009900">  \let\tenttsl=\secttsl</font>
<font color="#009900">  \def\curfontsize{sec}%</font>
<font color="#009900">  \def\lsize{subsec}\def\lllsize{reduced}%</font>
<font color="#009900">  \resetmathfonts \setleading{16pt}}</font>
<font color="#009900">\def\subsecfonts{%</font>
<font color="#009900">  \let\tenrm=\ssecrm \let\tenit=\ssecit \let\tensl=\ssecsl</font>
<font color="#009900">  \let\tenbf=\ssecbf \let\tentt=\ssectt \let\smallcaps=\ssecsc</font>
<font color="#009900">  \let\tensf=\ssecsf \let\teni=\sseci \let\tensy=\ssecsy</font>
<font color="#009900">  \let\tenttsl=\ssecttsl</font>
<font color="#009900">  \def\curfontsize{ssec}%</font>
<font color="#009900">  \def\lsize{text}\def\lllsize{small}%</font>
<font color="#009900">  \resetmathfonts \setleading{15pt}}</font>
<font color="#009900">\let\subsubsecfonts = \subsecfonts</font>
<font color="#009900">\def\reducedfonts{%</font>
<font color="#009900">  \let\tenrm=\reducedrm \let\tenit=\reducedit \let\tensl=\reducedsl</font>
<font color="#009900">  \let\tenbf=\reducedbf \let\tentt=\reducedtt \let\reducedcaps=\reducedsc</font>
<font color="#009900">  \let\tensf=\reducedsf \let\teni=\reducedi \let\tensy=\reducedsy</font>
<font color="#009900">  \let\tenttsl=\reducedttsl</font>
<font color="#009900">  \def\curfontsize{reduced}%</font>
<font color="#009900">  \def\lsize{small}\def\lllsize{smaller}%</font>
<font color="#009900">  \resetmathfonts \setleading{10.5pt}}</font>
<font color="#009900">\def\smallfonts{%</font>
<font color="#009900">  \let\tenrm=\smallrm \let\tenit=\smallit \let\tensl=\smallsl</font>
<font color="#009900">  \let\tenbf=\smallbf \let\tentt=\smalltt \let\smallcaps=\smallsc</font>
<font color="#009900">  \let\tensf=\smallsf \let\teni=\smalli \let\tensy=\smallsy</font>
<font color="#009900">  \let\tenttsl=\smallttsl</font>
<font color="#009900">  \def\curfontsize{small}%</font>
<font color="#009900">  \def\lsize{smaller}\def\lllsize{smaller}%</font>
<font color="#009900">  \resetmathfonts \setleading{10.5pt}}</font>
<font color="#009900">\def\smallerfonts{%</font>
<font color="#009900">  \let\tenrm=\smallerrm \let\tenit=\smallerit \let\tensl=\smallersl</font>
<font color="#009900">  \let\tenbf=\smallerbf \let\tentt=\smallertt \let\smallcaps=\smallersc</font>
<font color="#009900">  \let\tensf=\smallersf \let\teni=\smalleri \let\tensy=\smallersy</font>
<font color="#009900">  \let\tenttsl=\smallerttsl</font>
<font color="#009900">  \def\curfontsize{smaller}%</font>
<font color="#009900">  \def\lsize{smaller}\def\lllsize{smaller}%</font>
<font color="#009900">  \resetmathfonts \setleading{9.5pt}}</font>

<font color="#009900">% Fonts for short table of contents.</font>
<font color="#009900">\setfont\shortcontrm\rmshape{12}{1000}{OT1}</font>
<font color="#009900">\setfont\shortcontbf\bfshape{10}{\magstep1}{OT1}  % no cmb12</font>
<font color="#009900">\setfont\shortcontsl\slshape{12}{1000}{OT1}</font>
<font color="#009900">\setfont\shortconttt\ttshape{12}{1000}{OT1TT}</font>

<font color="#009900">% Define these just so they can be easily changed for other fonts.</font>
<font color="#009900">\def\angleleft{$\langle$}</font>
<font color="#009900">\def\angleright{$\rangle$}</font>

<font color="#009900">% Set the fonts to use with the @small... environments.</font>
<font color="#009900">\let\smallexamplefonts = \smallfonts</font>

<font color="#009900">% About \smallexamplefonts.  If we use \smallfonts (9pt), @smallexample</font>
<font color="#009900">% can fit this many characters:</font>
<font color="#009900">%   8.5x11=86   smallbook=72  a4=90  a5=69</font>
<font color="#009900">% If we use \scriptfonts (8pt), then we can fit this many characters:</font>
<font color="#009900">%   8.5x11=90+  smallbook=80  a4=90+  a5=77</font>
<font color="#009900">% For me, subjectively, the few extra characters that fit aren't worth</font>
<font color="#009900">% the additional smallness of 8pt.  So I'm making the default 9pt.</font>
<font color="#009900">%</font>
<font color="#009900">% By the way, for comparison, here's what fits with @example (10pt):</font>
<font color="#009900">%   8.5x11=71  smallbook=60  a4=75  a5=58</font>
<font color="#009900">% --karl, 24jan03.</font>

<font color="#009900">% Set up the default fonts, so we can use them for creating boxes.</font>
<font color="#009900">%</font>
<font color="#009900">\definetextfontsizexi</font>


<font color="#009900">\message{markup,}</font>

<font color="#009900">% Check if we are currently using a typewriter font.  Since all the</font>
<font color="#009900">% Computer Modern typewriter fonts have zero interword stretch (and</font>
<font color="#009900">% shrink), and it is reasonable to expect all typewriter fonts to have</font>
<font color="#009900">% this property, we can check that font parameter.</font>
<font color="#009900">%</font>
<font color="#009900">\def\ifmonospace{\ifdim\fontdimen3\font=0pt }</font>

<font color="#009900">% Markup style infrastructure.  \defmarkupstylesetup\INITMACRO will</font>
<font color="#009900">% define and register \INITMACRO to be called on markup style changes.</font>
<font color="#009900">% \INITMACRO can check \currentmarkupstyle for the innermost</font>
<font color="#009900">% style and the set of \ifmarkupSTYLE switches for all styles</font>
<font color="#009900">% currently in effect.</font>
<font color="#009900">\newif\ifmarkupvar</font>
<font color="#009900">\newif\ifmarkupsamp</font>
<font color="#009900">\newif\ifmarkupkey</font>
<font color="#009900">%\newif\ifmarkupfile % @file == @samp.</font>
<font color="#009900">%\newif\ifmarkupoption % @option == @samp.</font>
<font color="#009900">\newif\ifmarkupcode</font>
<font color="#009900">\newif\ifmarkupkbd</font>
<font color="#009900">%\newif\ifmarkupenv % @env == @code.</font>
<font color="#009900">%\newif\ifmarkupcommand % @command == @code.</font>
<font color="#009900">\newif\ifmarkuptex % @tex (and part of @math, for now).</font>
<font color="#009900">\newif\ifmarkupexample</font>
<font color="#009900">\newif\ifmarkupverb</font>
<font color="#009900">\newif\ifmarkupverbatim</font>

<font color="#009900">\let\currentmarkupstyle\empty</font>

<font color="#009900">\def\setupmarkupstyle#1{%</font>
<font color="#009900">  \csname markup#1true\endcsname</font>
<font color="#009900">  \def\currentmarkupstyle{#1}%</font>
<font color="#009900">  \markupstylesetup</font>
<font color="#009900">}</font>

<font color="#009900">\let\markupstylesetup\empty</font>

<font color="#009900">\def\defmarkupstylesetup#1{%</font>
<font color="#009900">  \expandafter\def\expandafter\markupstylesetup</font>
<font color="#009900">    \expandafter{\markupstylesetup #1}%</font>
<font color="#009900">  \def#1%</font>
<font color="#009900">}</font>

<font color="#009900">% Markup style setup for left and right quotes.</font>
<font color="#009900">\defmarkupstylesetup\markupsetuplq{%</font>
<font color="#009900">  \expandafter\let\expandafter \temp</font>
<font color="#009900">    \csname markupsetuplq\currentmarkupstyle\endcsname</font>
<font color="#009900">  \ifx\temp\relax \markupsetuplqdefault \else \temp \fi</font>
<font color="#009900">}</font>

<font color="#009900">\defmarkupstylesetup\markupsetuprq{%</font>
<font color="#009900">  \expandafter\let\expandafter \temp</font>
<font color="#009900">    \csname markupsetuprq\currentmarkupstyle\endcsname</font>
<font color="#009900">  \ifx\temp\relax \markupsetuprqdefault \else \temp \fi</font>
<font color="#009900">}</font>

<font color="#009900">{</font>
<font color="#009900">\catcode`\'=\active</font>
<font color="#009900">\catcode`\`=\active</font>

<font color="#009900">\gdef\markupsetuplqdefault{\let`\lq}</font>
<font color="#009900">\gdef\markupsetuprqdefault{\let'\rq}</font>

<font color="#009900">\gdef\markupsetcodequoteleft{\let`\codequoteleft}</font>
<font color="#009900">\gdef\markupsetcodequoteright{\let'\codequoteright}</font>

<font color="#009900">\gdef\markupsetnoligaturesquoteleft{\let`\noligaturesquoteleft}</font>
<font color="#009900">}</font>

<font color="#009900">\let\markupsetuplqcode \markupsetcodequoteleft</font>
<font color="#009900">\let\markupsetuprqcode \markupsetcodequoteright</font>
<font color="#009900">%</font>
<font color="#009900">\let\markupsetuplqexample \markupsetcodequoteleft</font>
<font color="#009900">\let\markupsetuprqexample \markupsetcodequoteright</font>
<font color="#009900">%</font>
<font color="#009900">\let\markupsetuplqsamp \markupsetcodequoteleft</font>
<font color="#009900">\let\markupsetuprqsamp \markupsetcodequoteright</font>
<font color="#009900">%</font>
<font color="#009900">\let\markupsetuplqverb \markupsetcodequoteleft</font>
<font color="#009900">\let\markupsetuprqverb \markupsetcodequoteright</font>
<font color="#009900">%</font>
<font color="#009900">\let\markupsetuplqverbatim \markupsetcodequoteleft</font>
<font color="#009900">\let\markupsetuprqverbatim \markupsetcodequoteright</font>

<font color="#009900">\let\markupsetuplqkbd \markupsetnoligaturesquoteleft</font>

<font color="#009900">% Allow an option to not use regular directed right quote/apostrophe</font>
<font color="#009900">% (char 0x27), but instead the undirected quote from cmtt (char 0x0d).</font>
<font color="#009900">% The undirected quote is ugly, so don't make it the default, but it</font>
<font color="#009900">% works for pasting with more pdf viewers (at least evince), the</font>
<font color="#009900">% lilypond developers report.  xpdf does work with the regular 0x27.</font>
<font color="#009900">%</font>
<font color="#009900">\def\codequoteright{%</font>
<font color="#009900">  \expandafter\ifx\csname SETtxicodequoteundirected\endcsname\relax</font>
<font color="#009900">    \expandafter\ifx\csname SETcodequoteundirected\endcsname\relax</font>
<font color="#009900">      '%</font>
<font color="#009900">    \else \char'15 \fi</font>
<font color="#009900">  \else \char'15 \fi</font>
<font color="#009900">}</font>
<font color="#009900">%</font>
<font color="#009900">% and a similar option for the left quote char vs. a grave accent.</font>
<font color="#009900">% Modern fonts display ASCII 0x60 as a grave accent, so some people like</font>
<font color="#009900">% the code environments to do likewise.</font>
<font color="#009900">%</font>
<font color="#009900">\def\codequoteleft{%</font>
<font color="#009900">  \expandafter\ifx\csname SETtxicodequotebacktick\endcsname\relax</font>
<font color="#009900">    \expandafter\ifx\csname SETcodequotebacktick\endcsname\relax</font>
<font color="#009900">      % [Knuth] pp. 380,381,391</font>
<font color="#009900">      % \relax disables Spanish ligatures ?` and !` of \tt font.</font>
<font color="#009900">      \relax`%</font>
<font color="#009900">    \else \char'22 \fi</font>
<font color="#009900">  \else \char'22 \fi</font>
<font color="#009900">}</font>

<font color="#009900">% Commands to set the quote options.</font>
<font color="#009900">% </font>
<font color="#009900">\parseargdef\codequoteundirected{%</font>
<font color="#009900">  \def\temp{#1}%</font>
<font color="#009900">  \ifx\temp\onword</font>
<font color="#009900">    \expandafter\let\csname SETtxicodequoteundirected\endcsname</font>
<font color="#009900">      = t%</font>
<font color="#009900">  \else\ifx\temp\offword</font>
<font color="#009900">    \expandafter\let\csname SETtxicodequoteundirected\endcsname</font>
<font color="#009900">      = \relax</font>
<font color="#009900">  \else</font>
<font color="#009900">    \errhelp = \EMsimple</font>
<font color="#009900">    \errmessage{Unknown @codequoteundirected value `\temp', must be on|off}%</font>
<font color="#009900">  \fi\fi</font>
<font color="#009900">}</font>
<font color="#009900">%</font>
<font color="#009900">\parseargdef\codequotebacktick{%</font>
<font color="#009900">  \def\temp{#1}%</font>
<font color="#009900">  \ifx\temp\onword</font>
<font color="#009900">    \expandafter\let\csname SETtxicodequotebacktick\endcsname</font>
<font color="#009900">      = t%</font>
<font color="#009900">  \else\ifx\temp\offword</font>
<font color="#009900">    \expandafter\let\csname SETtxicodequotebacktick\endcsname</font>
<font color="#009900">      = \relax</font>
<font color="#009900">  \else</font>
<font color="#009900">    \errhelp = \EMsimple</font>
<font color="#009900">    \errmessage{Unknown @codequotebacktick value `\temp', must be on|off}%</font>
<font color="#009900">  \fi\fi</font>
<font color="#009900">}</font>

<font color="#009900">% [Knuth] pp. 380,381,391, disable Spanish ligatures ?` and !` of \tt font.</font>
<font color="#009900">\def\noligaturesquoteleft{\relax\lq}</font>

<font color="#009900">% Count depth in font-changes, for error checks</font>
<font color="#009900">\newcount\fontdepth \fontdepth=0</font>

<font color="#009900">% Font commands.</font>

<font color="#009900">% #1 is the font command (\sl or \it), #2 is the text to slant.</font>
<font color="#009900">% If we are in a monospaced environment, however, 1) always use \ttsl,</font>
<font color="#009900">% and 2) do not add an italic correction.</font>
<font color="#009900">\def\dosmartslant#1#2{%</font>
<font color="#009900">  \ifusingtt </font>
<font color="#009900">    {{\ttsl #2}\let\next=\relax}%</font>
<font color="#009900">    {\def\next{{#1#2}\futurelet\next\smartitaliccorrection}}%</font>
<font color="#009900">  \next</font>
<font color="#009900">}</font>
<font color="#009900">\def\smartslanted{\dosmartslant\sl}</font>
<font color="#009900">\def\smartitalic{\dosmartslant\it}</font>

<font color="#009900">% Output an italic correction unless \next (presumed to be the following</font>
<font color="#009900">% character) is such as not to need one.</font>
<font color="#009900">\def\smartitaliccorrection{%</font>
<font color="#009900">  \ifx\next,%</font>
<font color="#009900">  \else\ifx\next-%</font>
<font color="#009900">  \else\ifx\next.%</font>
<font color="#009900">  \else\ptexslash</font>
<font color="#009900">  \fi\fi\fi</font>
<font color="#009900">  \aftersmartic</font>
<font color="#009900">}</font>

<font color="#009900">% like \smartslanted except unconditionally uses \ttsl, and no ic.</font>
<font color="#009900">% @var is set to this for defun arguments.</font>
<font color="#009900">\def\ttslanted#1{{\ttsl #1}}</font>

<font color="#009900">% @cite is like \smartslanted except unconditionally use \sl.  We never want</font>
<font color="#009900">% ttsl for book titles, do we?</font>
<font color="#009900">\def\cite#1{{\sl #1}\futurelet\next\smartitaliccorrection}</font>

<font color="#009900">\def\aftersmartic{}</font>
<font color="#009900">\def\var#1{%</font>
<font color="#009900">  \let\saveaftersmartic = \aftersmartic</font>
<font color="#009900">  \def\aftersmartic{\null\let\aftersmartic=\saveaftersmartic}%</font>
<font color="#009900">  \smartslanted{#1}%</font>
<font color="#009900">}</font>

<font color="#009900">\let\i=\smartitalic</font>
<font color="#009900">\let\slanted=\smartslanted</font>
<font color="#009900">\let\dfn=\smartslanted</font>
<font color="#009900">\let\emph=\smartitalic</font>

<font color="#009900">% Explicit font changes: @r, @sc, undocumented @ii.</font>
<font color="#009900">\def\r#1{{\rm #1}}              % roman font</font>
<font color="#009900">\def\sc#1{{\smallcaps#1}}       % smallcaps font</font>
<font color="#009900">\def\ii#1{{\it #1}}             % italic font</font>

<font color="#009900">% @b, explicit bold.  Also @strong.</font>
<font color="#009900">\def\b#1{{\bf #1}}</font>
<font color="#009900">\let\strong=\b</font>

<font color="#009900">% @sansserif, explicit sans.</font>
<font color="#009900">\def\sansserif#1{{\sf #1}}</font>

<font color="#009900">% We can't just use \exhyphenpenalty, because that only has effect at</font>
<font color="#009900">% the end of a paragraph.  Restore normal hyphenation at the end of the</font>
<font color="#009900">% group within which \nohyphenation is presumably called.</font>
<font color="#009900">%</font>
<font color="#009900">\def\nohyphenation{\hyphenchar\font = -1  \aftergroup\restorehyphenation}</font>
<font color="#009900">\def\restorehyphenation{\hyphenchar\font = `- }</font>

<font color="#009900">% Set sfcode to normal for the chars that usually have another value.</font>
<font color="#009900">% Can't use plain's \frenchspacing because it uses the `\x notation, and</font>
<font color="#009900">% sometimes \x has an active definition that messes things up.</font>
<font color="#009900">%</font>
<font color="#009900">\catcode`@=11</font>
<font color="#009900">  \def\plainfrenchspacing{%</font>
<font color="#009900">    \sfcode\dotChar  =\@m \sfcode\questChar=\@m \sfcode\exclamChar=\@m</font>
<font color="#009900">    \sfcode\colonChar=\@m \sfcode\semiChar =\@m \sfcode\commaChar =\@m</font>
<font color="#009900">    \def\endofsentencespacefactor{1000}% for @. and friends</font>
<font color="#009900">  }</font>
<font color="#009900">  \def\plainnonfrenchspacing{%</font>
<font color="#009900">    \sfcode`\.3000\sfcode`\?3000\sfcode`\!3000</font>
<font color="#009900">    \sfcode`\:2000\sfcode`\;1500\sfcode`\,1250</font>
<font color="#009900">    \def\endofsentencespacefactor{3000}% for @. and friends</font>
<font color="#009900">  }</font>
<font color="#009900">\catcode`@=\other</font>
<font color="#009900">\def\endofsentencespacefactor{3000}% default</font>

<font color="#009900">% @t, explicit typewriter.</font>
<font color="#009900">\def\t#1{%</font>
<font color="#009900">  {\tt \rawbackslash \plainfrenchspacing #1}%</font>
<font color="#009900">  \null</font>
<font color="#009900">}</font>

<font color="#009900">% @samp.</font>
<font color="#009900">\def\samp#1{{\setupmarkupstyle{samp}\lq\tclose{#1}\rq\null}}</font>

<font color="#009900">% definition of @key that produces a lozenge.  Doesn't adjust to text size.</font>
<font color="#009900">%\setfont\keyrm\rmshape{8}{1000}{OT1}</font>
<font color="#009900">%\font\keysy=cmsy9</font>
<font color="#009900">%\def\key#1{{\keyrm\textfont2=\keysy \leavevmode\hbox{%</font>
<font color="#009900">%  \raise0.4pt\hbox{\angleleft}\kern-.08em\vtop{%</font>
<font color="#009900">%    \vbox{\hrule\kern-0.4pt</font>
<font color="#009900">%     \hbox{\raise0.4pt\hbox{\vphantom{\angleleft}}#1}}%</font>
<font color="#009900">%    \kern-0.4pt\hrule}%</font>
<font color="#009900">%  \kern-.06em\raise0.4pt\hbox{\angleright}}}}</font>

<font color="#009900">% definition of @key with no lozenge.  If the current font is already</font>
<font color="#009900">% monospace, don't change it; that way, we respect @kbdinputstyle.  But</font>
<font color="#009900">% if it isn't monospace, then use \tt.</font>
<font color="#009900">%</font>
<font color="#009900">\def\key#1{{\setupmarkupstyle{key}%</font>
<font color="#009900">  \nohyphenation</font>
<font color="#009900">  \ifmonospace\else\tt\fi</font>
<font color="#009900">  #1}\null}</font>

<font color="#009900">% ctrl is no longer a Texinfo command.</font>
<font color="#009900">\def\ctrl #1{{\tt \rawbackslash \hat}#1}</font>

<font color="#009900">% @file, @option are the same as @samp.</font>
<font color="#009900">\let\file=\samp</font>
<font color="#009900">\let\option=\samp</font>

<font color="#009900">% @code is a modification of @t,</font>
<font color="#009900">% which makes spaces the same size as normal in the surrounding text.</font>
<font color="#009900">\def\tclose#1{%</font>
<font color="#009900">  {%</font>
<font color="#009900">    % Change normal interword space to be same as for the current font.</font>
<font color="#009900">    \spaceskip = \fontdimen2\font</font>
<font color="#009900">    %</font>
<font color="#009900">    % Switch to typewriter.</font>
<font color="#009900">    \tt</font>
<font color="#009900">    %</font>
<font color="#009900">    % But `\ ' produces the large typewriter interword space.</font>
<font color="#009900">    \def\ {{\spaceskip = 0pt{} }}%</font>
<font color="#009900">    %</font>
<font color="#009900">    % Turn off hyphenation.</font>
<font color="#009900">    \nohyphenation</font>
<font color="#009900">    %</font>
<font color="#009900">    \rawbackslash</font>
<font color="#009900">    \plainfrenchspacing</font>
<font color="#009900">    #1%</font>
<font color="#009900">  }%</font>
<font color="#009900">  \null % reset spacefactor to 1000</font>
<font color="#009900">}</font>

<font color="#009900">% We *must* turn on hyphenation at `-' and `_' in @code.</font>
<font color="#009900">% Otherwise, it is too hard to avoid overfull hboxes</font>
<font color="#009900">% in the Emacs manual, the Library manual, etc.</font>

<font color="#009900">% Unfortunately, TeX uses one parameter (\hyphenchar) to control</font>
<font color="#009900">% both hyphenation at - and hyphenation within words.</font>
<font color="#009900">% We must therefore turn them both off (\tclose does that)</font>
<font color="#009900">% and arrange explicitly to hyphenate at a dash.</font>
<font color="#009900">%  -- rms.</font>
<font color="#009900">{</font>
<font color="#009900">  \catcode`\-=\active \catcode`\_=\active</font>
<font color="#009900">  \catcode`\'=\active \catcode`\`=\active</font>
<font color="#009900">  \global\let'=\rq \global\let`=\lq  % default definitions</font>
<font color="#009900">  %</font>
<font color="#009900">  \global\def\code{\begingroup</font>
<font color="#009900">    \setupmarkupstyle{code}%</font>
<font color="#009900">    % The following should really be moved into \setupmarkupstyle handlers.</font>
<font color="#009900">    \catcode\dashChar=\active  \catcode\underChar=\active</font>
<font color="#009900">    \ifallowcodebreaks</font>
<font color="#009900">     \let-\codedash</font>
<font color="#009900">     \let_\codeunder</font>
<font color="#009900">    \else</font>
<font color="#009900">     \let-\realdash</font>
<font color="#009900">     \let_\realunder</font>
<font color="#009900">    \fi</font>
<font color="#009900">    \codex</font>
<font color="#009900">  }</font>
<font color="#009900">}</font>

<font color="#009900">\def\codex #1{\tclose{#1}\endgroup}</font>

<font color="#009900">\def\realdash{-}</font>
<font color="#009900">\def\codedash{-\discretionary{}{}{}}</font>
<font color="#009900">\def\codeunder{%</font>
<font color="#009900">  % this is all so @math{@code{var_name}+1} can work.  In math mode, _</font>
<font color="#009900">  % is "active" (mathcode"8000) and \normalunderscore (or \char95, etc.)</font>
<font color="#009900">  % will therefore expand the active definition of _, which is us</font>
<font color="#009900">  % (inside @code that is), therefore an endless loop.</font>
<font color="#009900">  \ifusingtt{\ifmmode</font>
<font color="#009900">               \mathchar"075F % class 0=ordinary, family 7=ttfam, pos 0x5F=_.</font>
<font color="#009900">             \else\normalunderscore \fi</font>
<font color="#009900">             \discretionary{}{}{}}%</font>
<font color="#009900">            {\_}%</font>
<font color="#009900">}</font>

<font color="#009900">% An additional complication: the above will allow breaks after, e.g.,</font>
<font color="#009900">% each of the four underscores in __typeof__.  This is undesirable in</font>
<font color="#009900">% some manuals, especially if they don't have long identifiers in</font>
<font color="#009900">% general.  @allowcodebreaks provides a way to control this.</font>
<font color="#009900">%</font>
<font color="#009900">\newif\ifallowcodebreaks  \allowcodebreakstrue</font>

<font color="#009900">\def\keywordtrue{true}</font>
<font color="#009900">\def\keywordfalse{false}</font>

<font color="#009900">\parseargdef\allowcodebreaks{%</font>
<font color="#009900">  \def\txiarg{#1}%</font>
<font color="#009900">  \ifx\txiarg\keywordtrue</font>
<font color="#009900">    \allowcodebreakstrue</font>
<font color="#009900">  \else\ifx\txiarg\keywordfalse</font>
<font color="#009900">    \allowcodebreaksfalse</font>
<font color="#009900">  \else</font>
<font color="#009900">    \errhelp = \EMsimple</font>
<font color="#009900">    \errmessage{Unknown @allowcodebreaks option `\txiarg', must be true|false}%</font>
<font color="#009900">  \fi\fi</font>
<font color="#009900">}</font>

<font color="#009900">% @uref (abbreviation for `urlref') takes an optional (comma-separated)</font>
<font color="#009900">% second argument specifying the text to display and an optional third</font>
<font color="#009900">% arg as text to display instead of (rather than in addition to) the url</font>
<font color="#009900">% itself.  First (mandatory) arg is the url.</font>
<font color="#009900">% (This \urefnobreak definition isn't used now, leaving it for a while</font>
<font color="#009900">% for comparison.)</font>
<font color="#009900">\def\urefnobreak#1{\dourefnobreak #1,,,\finish}</font>
<font color="#009900">\def\dourefnobreak#1,#2,#3,#4\finish{\begingroup</font>
<font color="#009900">  \unsepspaces</font>
<font color="#009900">  \pdfurl{#1}%</font>
<font color="#009900">  \setbox0 = \hbox{\ignorespaces #3}%</font>
<font color="#009900">  \ifdim\wd0 &gt; 0pt</font>
<font color="#009900">    \unhbox0 % third arg given, show only that</font>
<font color="#009900">  \else</font>
<font color="#009900">    \setbox0 = \hbox{\ignorespaces #2}%</font>
<font color="#009900">    \ifdim\wd0 &gt; 0pt</font>
<font color="#009900">      \ifpdf</font>
<font color="#009900">        \unhbox0             % PDF: 2nd arg given, show only it</font>
<font color="#009900">      \else</font>
<font color="#009900">        \unhbox0\ (\code{#1})% DVI: 2nd arg given, show both it and url</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \else</font>
<font color="#009900">      \code{#1}% only url given, so show it</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \endlink</font>
<font color="#009900">\endgroup}</font>

<font color="#009900">% This \urefbreak definition is the active one.</font>
<font color="#009900">\def\urefbreak{\begingroup \urefcatcodes \dourefbreak}</font>
<font color="#009900">\let\uref=\urefbreak</font>
<font color="#009900">\def\dourefbreak#1{\urefbreakfinish #1,,,\finish}</font>
<font color="#009900">\def\urefbreakfinish#1,#2,#3,#4\finish{% doesn't work in @example</font>
<font color="#009900">  \unsepspaces</font>
<font color="#009900">  \pdfurl{#1}%</font>
<font color="#009900">  \setbox0 = \hbox{\ignorespaces #3}%</font>
<font color="#009900">  \ifdim\wd0 &gt; 0pt</font>
<font color="#009900">    \unhbox0 % third arg given, show only that</font>
<font color="#009900">  \else</font>
<font color="#009900">    \setbox0 = \hbox{\ignorespaces #2}%</font>
<font color="#009900">    \ifdim\wd0 &gt; 0pt</font>
<font color="#009900">      \ifpdf</font>
<font color="#009900">        \unhbox0             % PDF: 2nd arg given, show only it</font>
<font color="#009900">      \else</font>
<font color="#009900">        \unhbox0\ (\urefcode{#1})% DVI: 2nd arg given, show both it and url</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \else</font>
<font color="#009900">      \urefcode{#1}% only url given, so show it</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \endlink</font>
<font color="#009900">\endgroup}</font>

<font color="#009900">% Allow line breaks around only a few characters (only).</font>
<font color="#009900">\def\urefcatcodes{%</font>
<font color="#009900">  \catcode\ampChar=\active   \catcode\dotChar=\active</font>
<font color="#009900">  \catcode\hashChar=\active  \catcode\questChar=\active</font>
<font color="#009900">  \catcode\slashChar=\active</font>
<font color="#009900">}</font>
<font color="#009900">{</font>
<font color="#009900">  \urefcatcodes</font>
<font color="#009900">  %</font>
<font color="#009900">  \global\def\urefcode{\begingroup</font>
<font color="#009900">    \setupmarkupstyle{code}%</font>
<font color="#009900">    \urefcatcodes</font>
<font color="#009900">    \let&amp;\urefcodeamp</font>
<font color="#009900">    \let.\urefcodedot</font>
<font color="#009900">    \let#\urefcodehash</font>
<font color="#009900">    \let?\urefcodequest</font>
<font color="#009900">    \let/\urefcodeslash</font>
<font color="#009900">    \codex</font>
<font color="#009900">  }</font>
<font color="#009900">  %</font>
<font color="#009900">  % By default, they are just regular characters.</font>
<font color="#009900">  \global\def&amp;{\normalamp}</font>
<font color="#009900">  \global\def.{\normaldot}</font>
<font color="#009900">  \global\def#{\normalhash}</font>
<font color="#009900">  \global\def?{\normalquest}</font>
<font color="#009900">  \global\def/{\normalslash}</font>
<font color="#009900">}</font>

<font color="#009900">% we put a little stretch before and after the breakable chars, to help</font>
<font color="#009900">% line breaking of long url's.  The unequal skips make look better in</font>
<font color="#009900">% cmtt at least, especially for dots.</font>
<font color="#009900">\def\urefprestretch{\urefprebreak \hskip0pt plus.13em }</font>
<font color="#009900">\def\urefpoststretch{\urefpostbreak \hskip0pt plus.1em }</font>
<font color="#009900">%</font>
<font color="#009900">\def\urefcodeamp{\urefprestretch \&amp;\urefpoststretch}</font>
<font color="#009900">\def\urefcodedot{\urefprestretch .\urefpoststretch}</font>
<font color="#009900">\def\urefcodehash{\urefprestretch \#\urefpoststretch}</font>
<font color="#009900">\def\urefcodequest{\urefprestretch ?\urefpoststretch}</font>
<font color="#009900">\def\urefcodeslash{\futurelet\next\urefcodeslashfinish}</font>
<font color="#009900">{</font>
<font color="#009900">  \catcode`\/=\active</font>
<font color="#009900">  \global\def\urefcodeslashfinish{%</font>
<font color="#009900">    \urefprestretch \slashChar</font>
<font color="#009900">    % Allow line break only after the final / in a sequence of</font>
<font color="#009900">    % slashes, to avoid line break between the slashes in http://.</font>
<font color="#009900">    \ifx\next/\else \urefpoststretch \fi</font>
<font color="#009900">  }</font>
<font color="#009900">}</font>

<font color="#009900">% One more complication: by default we'll break after the special</font>
<font color="#009900">% characters, but some people like to break before the special chars, so</font>
<font color="#009900">% allow that.  Also allow no breaking at all, for manual control.</font>
<font color="#009900">% </font>
<font color="#009900">\parseargdef\urefbreakstyle{%</font>
<font color="#009900">  \def\txiarg{#1}%</font>
<font color="#009900">  \ifx\txiarg\wordnone</font>
<font color="#009900">    \def\urefprebreak{\nobreak}\def\urefpostbreak{\nobreak}</font>
<font color="#009900">  \else\ifx\txiarg\wordbefore</font>
<font color="#009900">    \def\urefprebreak{\allowbreak}\def\urefpostbreak{\nobreak}</font>
<font color="#009900">  \else\ifx\txiarg\wordafter</font>
<font color="#009900">    \def\urefprebreak{\nobreak}\def\urefpostbreak{\allowbreak}</font>
<font color="#009900">  \else</font>
<font color="#009900">    \errhelp = \EMsimple</font>
<font color="#009900">    \errmessage{Unknown @urefbreakstyle setting `\txiarg'}%</font>
<font color="#009900">  \fi\fi\fi</font>
<font color="#009900">}</font>
<font color="#009900">\def\wordafter{after}</font>
<font color="#009900">\def\wordbefore{before}</font>
<font color="#009900">\def\wordnone{none}</font>

<font color="#009900">\urefbreakstyle after</font>

<font color="#009900">% @url synonym for @uref, since that's how everyone uses it.</font>
<font color="#009900">%</font>
<font color="#009900">\let\url=\uref</font>

<font color="#009900">% rms does not like angle brackets --karl, 17may97.</font>
<font color="#009900">% So now @email is just like @uref, unless we are pdf.</font>
<font color="#009900">%</font>
<font color="#009900">%\def\email#1{\angleleft{\tt #1}\angleright}</font>
<font color="#009900">\ifpdf</font>
<font color="#009900">  \def\email#1{\doemail#1,,\finish}</font>
<font color="#009900">  \def\doemail#1,#2,#3\finish{\begingroup</font>
<font color="#009900">    \unsepspaces</font>
<font color="#009900">    \pdfurl{mailto:#1}%</font>
<font color="#009900">    \setbox0 = \hbox{\ignorespaces #2}%</font>
<font color="#009900">    \ifdim\wd0&gt;0pt\unhbox0\else\code{#1}\fi</font>
<font color="#009900">    \endlink</font>
<font color="#009900">  \endgroup}</font>
<font color="#009900">\else</font>
<font color="#009900">  \let\email=\uref</font>
<font color="#009900">\fi</font>

<font color="#009900">% @kbd is like @code, except that if the argument is just one @key command,</font>
<font color="#009900">% then @kbd has no effect.</font>
<font color="#009900">\def\kbd#1{{\setupmarkupstyle{kbd}\def\look{#1}\expandafter\kbdfoo\look??\par}}</font>

<font color="#009900">% @kbdinputstyle -- arg is `distinct' (@kbd uses slanted tty font always),</font>
<font color="#009900">%   `example' (@kbd uses ttsl only inside of @example and friends),</font>
<font color="#009900">%   or `code' (@kbd uses normal tty font always).</font>
<font color="#009900">\parseargdef\kbdinputstyle{%</font>
<font color="#009900">  \def\txiarg{#1}%</font>
<font color="#009900">  \ifx\txiarg\worddistinct</font>
<font color="#009900">    \gdef\kbdexamplefont{\ttsl}\gdef\kbdfont{\ttsl}%</font>
<font color="#009900">  \else\ifx\txiarg\wordexample</font>
<font color="#009900">    \gdef\kbdexamplefont{\ttsl}\gdef\kbdfont{\tt}%</font>
<font color="#009900">  \else\ifx\txiarg\wordcode</font>
<font color="#009900">    \gdef\kbdexamplefont{\tt}\gdef\kbdfont{\tt}%</font>
<font color="#009900">  \else</font>
<font color="#009900">    \errhelp = \EMsimple</font>
<font color="#009900">    \errmessage{Unknown @kbdinputstyle setting `\txiarg'}%</font>
<font color="#009900">  \fi\fi\fi</font>
<font color="#009900">}</font>
<font color="#009900">\def\worddistinct{distinct}</font>
<font color="#009900">\def\wordexample{example}</font>
<font color="#009900">\def\wordcode{code}</font>

<font color="#009900">% Default is `distinct'.</font>
<font color="#009900">\kbdinputstyle distinct</font>

<font color="#009900">\def\xkey{\key}</font>
<font color="#009900">\def\kbdfoo#1#2#3\par{\def\one{#1}\def\three{#3}\def\threex{??}%</font>
<font color="#009900">\ifx\one\xkey\ifx\threex\three \key{#2}%</font>
<font color="#009900">\else{\tclose{\kbdfont\setupmarkupstyle{kbd}\look}}\fi</font>
<font color="#009900">\else{\tclose{\kbdfont\setupmarkupstyle{kbd}\look}}\fi}</font>

<font color="#009900">% For @indicateurl, @env, @command quotes seem unnecessary, so use \code.</font>
<font color="#009900">\let\indicateurl=\code</font>
<font color="#009900">\let\env=\code</font>
<font color="#009900">\let\command=\code</font>

<font color="#009900">% @clicksequence{File @click{} Open ...}</font>
<font color="#009900">\def\clicksequence#1{\begingroup #1\endgroup}</font>

<font color="#009900">% @clickstyle @arrow   (by default)</font>
<font color="#009900">\parseargdef\clickstyle{\def\click{#1}}</font>
<font color="#009900">\def\click{\arrow}</font>

<font color="#009900">% Typeset a dimension, e.g., `in' or `pt'.  The only reason for the</font>
<font color="#009900">% argument is to make the input look right: @dmn{pt} instead of @dmn{}pt.</font>
<font color="#009900">%</font>
<font color="#009900">\def\dmn#1{\thinspace #1}</font>

<font color="#009900">% @l was never documented to mean ``switch to the Lisp font'',</font>
<font color="#009900">% and it is not used as such in any manual I can find.  We need it for</font>
<font color="#009900">% Polish suppressed-l.  --karl, 22sep96.</font>
<font color="#009900">%\def\l#1{{\li #1}\null}</font>

<font color="#009900">% @acronym for "FBI", "NATO", and the like.</font>
<font color="#009900">% We print this one point size smaller, since it's intended for</font>
<font color="#009900">% all-uppercase.</font>
<font color="#009900">%</font>
<font color="#009900">\def\acronym#1{\doacronym #1,,\finish}</font>
<font color="#009900">\def\doacronym#1,#2,#3\finish{%</font>
<font color="#009900">  {\selectfonts\lsize #1}%</font>
<font color="#009900">  \def\temp{#2}%</font>
<font color="#009900">  \ifx\temp\empty \else</font>
<font color="#009900">    \space ({\unsepspaces \ignorespaces \temp \unskip})%</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \null % reset \spacefactor=1000</font>
<font color="#009900">}</font>

<font color="#009900">% @abbr for "Comput. J." and the like.</font>
<font color="#009900">% No font change, but don't do end-of-sentence spacing.</font>
<font color="#009900">%</font>
<font color="#009900">\def\abbr#1{\doabbr #1,,\finish}</font>
<font color="#009900">\def\doabbr#1,#2,#3\finish{%</font>
<font color="#009900">  {\plainfrenchspacing #1}%</font>
<font color="#009900">  \def\temp{#2}%</font>
<font color="#009900">  \ifx\temp\empty \else</font>
<font color="#009900">    \space ({\unsepspaces \ignorespaces \temp \unskip})%</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \null % reset \spacefactor=1000</font>
<font color="#009900">}</font>

<font color="#009900">% @asis just yields its argument.  Used with @table, for example.</font>
<font color="#009900">%</font>
<font color="#009900">\def\asis#1{#1}</font>

<font color="#009900">% @math outputs its argument in math mode.</font>
<font color="#009900">%</font>
<font color="#009900">% One complication: _ usually means subscripts, but it could also mean</font>
<font color="#009900">% an actual _ character, as in @math{@var{some_variable} + 1}.  So make</font>
<font color="#009900">% _ active, and distinguish by seeing if the current family is \slfam,</font>
<font color="#009900">% which is what @var uses.</font>
<font color="#009900">{</font>
<font color="#009900">  \catcode`\_ = \active</font>
<font color="#009900">  \gdef\mathunderscore{%</font>
<font color="#009900">    \catcode`\_=\active</font>
<font color="#009900">    \def_{\ifnum\fam=\slfam \_\else\sb\fi}%</font>
<font color="#009900">  }</font>
<font color="#009900">}</font>
<font color="#009900">% Another complication: we want \\ (and @\) to output a math (or tt) \.</font>
<font color="#009900">% FYI, plain.tex uses \\ as a temporary control sequence (for no</font>
<font color="#009900">% particular reason), but this is not advertised and we don't care.</font>
<font color="#009900">%</font>
<font color="#009900">% The \mathchar is class=0=ordinary, family=7=ttfam, position=5C=\.</font>
<font color="#009900">\def\mathbackslash{\ifnum\fam=\ttfam \mathchar"075C \else\backslash \fi}</font>
<font color="#009900">%</font>
<font color="#009900">\def\math{%</font>
<font color="#009900">  \tex</font>
<font color="#009900">  \mathunderscore</font>
<font color="#009900">  \let\\ = \mathbackslash</font>
<font color="#009900">  \mathactive</font>
<font color="#009900">  % make the texinfo accent commands work in math mode</font>
<font color="#009900">  \let\"=\ddot</font>
<font color="#009900">  \let\'=\acute</font>
<font color="#009900">  \let\==\bar</font>
<font color="#009900">  \let\^=\hat</font>
<font color="#009900">  \let\`=\grave</font>
<font color="#009900">  \let\u=\breve</font>
<font color="#009900">  \let\v=\check</font>
<font color="#009900">  \let\~=\tilde</font>
<font color="#009900">  \let\dotaccent=\dot</font>
<font color="#009900">  $\finishmath</font>
<font color="#009900">}</font>
<font color="#009900">\def\finishmath#1{#1$\endgroup}  % Close the group opened by \tex.</font>

<font color="#009900">% Some active characters (such as &lt;) are spaced differently in math.</font>
<font color="#009900">% We have to reset their definitions in case the @math was an argument</font>
<font color="#009900">% to a command which sets the catcodes (such as @item or @section).</font>
<font color="#009900">%</font>
<font color="#009900">{</font>
<font color="#009900">  \catcode`^ = \active</font>
<font color="#009900">  \catcode`&lt; = \active</font>
<font color="#009900">  \catcode`&gt; = \active</font>
<font color="#009900">  \catcode`+ = \active</font>
<font color="#009900">  \catcode`' = \active</font>
<font color="#009900">  \gdef\mathactive{%</font>
<font color="#009900">    \let^ = \ptexhat</font>
<font color="#009900">    \let&lt; = \ptexless</font>
<font color="#009900">    \let&gt; = \ptexgtr</font>
<font color="#009900">    \let+ = \ptexplus</font>
<font color="#009900">    \let' = \ptexquoteright</font>
<font color="#009900">  }</font>
<font color="#009900">}</font>

<font color="#009900">% @inlinefmt{FMTNAME,PROCESSED-TEXT} and @inlineraw{FMTNAME,RAW-TEXT}.</font>
<font color="#009900">% Ignore unless FMTNAME == tex; then it is like @iftex and @tex,</font>
<font color="#009900">% except specified as a normal braced arg, so no newlines to worry about.</font>
<font color="#009900">% </font>
<font color="#009900">\def\outfmtnametex{tex}</font>
<font color="#009900">%</font>
<font color="#009900">\long\def\inlinefmt#1{\doinlinefmt #1,\finish}</font>
<font color="#009900">\long\def\doinlinefmt#1,#2,\finish{%</font>
<font color="#009900">  \def\inlinefmtname{#1}%</font>
<font color="#009900">  \ifx\inlinefmtname\outfmtnametex \ignorespaces #2\fi</font>
<font color="#009900">}</font>
<font color="#009900">% For raw, must switch into @tex before parsing the argument, to avoid</font>
<font color="#009900">% setting catcodes prematurely.  Doing it this way means that, for</font>
<font color="#009900">% example, @inlineraw{html, foo{bar} gets a parse error instead of being</font>
<font color="#009900">% ignored.  But this isn't important because if people want a literal</font>
<font color="#009900">% *right* brace they would have to use a command anyway, so they may as</font>
<font color="#009900">% well use a command to get a left brace too.  We could re-use the</font>
<font color="#009900">% delimiter character idea from \verb, but it seems like overkill.</font>
<font color="#009900">% </font>
<font color="#009900">\long\def\inlineraw{\tex \doinlineraw}</font>
<font color="#009900">\long\def\doinlineraw#1{\doinlinerawtwo #1,\finish}</font>
<font color="#009900">\def\doinlinerawtwo#1,#2,\finish{%</font>
<font color="#009900">  \def\inlinerawname{#1}%</font>
<font color="#009900">  \ifx\inlinerawname\outfmtnametex \ignorespaces #2\fi</font>
<font color="#009900">  \endgroup % close group opened by \tex.</font>
<font color="#009900">}</font>


<font color="#009900">\message{glyphs,}</font>
<font color="#009900">% and logos.</font>

<font color="#009900">% @@ prints an @, as does @atchar{}.</font>
<font color="#009900">\def\@{\char64 }</font>
<font color="#009900">\let\atchar=\@</font>

<font color="#009900">% @{ @} @lbracechar{} @rbracechar{} all generate brace characters.</font>
<font color="#009900">% Unless we're in typewriter, use \ecfont because the CM text fonts do</font>
<font color="#009900">% not have braces, and we don't want to switch into math.</font>
<font color="#009900">\def\mylbrace{{\ifmonospace\else\ecfont\fi \char123}}</font>
<font color="#009900">\def\myrbrace{{\ifmonospace\else\ecfont\fi \char125}}</font>
<font color="#009900">\let\{=\mylbrace \let\lbracechar=\{</font>
<font color="#009900">\let\}=\myrbrace \let\rbracechar=\}</font>
<font color="#009900">\begingroup</font>
<font color="#009900">  % Definitions to produce \{ and \} commands for indices,</font>
<font color="#009900">  % and @{ and @} for the aux/toc files.</font>
<font color="#009900">  \catcode`\{ = \other \catcode`\} = \other</font>
<font color="#009900">  \catcode`\[ = 1 \catcode`\] = 2</font>
<font color="#009900">  \catcode`\! = 0 \catcode`\\ = \other</font>
<font color="#009900">  !gdef!lbracecmd[\{]%</font>
<font color="#009900">  !gdef!rbracecmd[\}]%</font>
<font color="#009900">  !gdef!lbraceatcmd[@{]%</font>
<font color="#009900">  !gdef!rbraceatcmd[@}]%</font>
<font color="#009900">!endgroup</font>

<font color="#009900">% @comma{} to avoid , parsing problems.</font>
<font color="#009900">\let\comma = ,</font>

<font color="#009900">% Accents: @, @dotaccent @ringaccent @ubaraccent @udotaccent</font>
<font color="#009900">% Others are defined by plain TeX: @` @' @" @^ @~ @= @u @v @H.</font>
<font color="#009900">\let\, = \ptexc</font>
<font color="#009900">\let\dotaccent = \ptexdot</font>
<font color="#009900">\def\ringaccent#1{{\accent23 #1}}</font>
<font color="#009900">\let\tieaccent = \ptext</font>
<font color="#009900">\let\ubaraccent = \ptexb</font>
<font color="#009900">\let\udotaccent = \d</font>

<font color="#009900">% Other special characters: @questiondown @exclamdown @ordf @ordm</font>
<font color="#009900">% Plain TeX defines: @AA @AE @O @OE @L (plus lowercase versions) @ss.</font>
<font color="#009900">\def\questiondown{?`}</font>
<font color="#009900">\def\exclamdown{!`}</font>
<font color="#009900">\def\ordf{\leavevmode\raise1ex\hbox{\selectfonts\lllsize \underbar{a}}}</font>
<font color="#009900">\def\ordm{\leavevmode\raise1ex\hbox{\selectfonts\lllsize \underbar{o}}}</font>

<font color="#009900">% Dotless i and dotless j, used for accents.</font>
<font color="#009900">\def\imacro{i}</font>
<font color="#009900">\def\jmacro{j}</font>
<font color="#009900">\def\dotless#1{%</font>
<font color="#009900">  \def\temp{#1}%</font>
<font color="#009900">  \ifx\temp\imacro \ifmmode\imath \else\ptexi \fi</font>
<font color="#009900">  \else\ifx\temp\jmacro \ifmmode\jmath \else\j \fi</font>
<font color="#009900">  \else \errmessage{@dotless can be used only with i or j}%</font>
<font color="#009900">  \fi\fi</font>
<font color="#009900">}</font>

<font color="#009900">% The \TeX{} logo, as in plain, but resetting the spacing so that a</font>
<font color="#009900">% period following counts as ending a sentence.  (Idea found in latex.)</font>
<font color="#009900">%</font>
<font color="#009900">\edef\TeX{\TeX \spacefactor=1000 }</font>

<font color="#009900">% @LaTeX{} logo.  Not quite the same results as the definition in</font>
<font color="#009900">% latex.ltx, since we use a different font for the raised A; it's most</font>
<font color="#009900">% convenient for us to use an explicitly smaller font, rather than using</font>
<font color="#009900">% the \scriptstyle font (since we don't reset \scriptstyle and</font>
<font color="#009900">% \scriptscriptstyle).</font>
<font color="#009900">%</font>
<font color="#009900">\def\LaTeX{%</font>
<font color="#009900">  L\kern-.36em</font>
<font color="#009900">  {\setbox0=\hbox{T}%</font>
<font color="#009900">   \vbox to \ht0{\hbox{%</font>
<font color="#009900">     \ifx\textnominalsize\xwordpt</font>
<font color="#009900">       % for 10pt running text, \lllsize (8pt) is too small for the A in LaTeX.</font>
<font color="#009900">       % Revert to plain's \scriptsize, which is 7pt.</font>
<font color="#009900">       \count255=\the\fam $\fam\count255 \scriptstyle A$%</font>
<font color="#009900">     \else</font>
<font color="#009900">       % For 11pt, we can use our lllsize.</font>
<font color="#009900">       \selectfonts\lllsize A%</font>
<font color="#009900">     \fi</font>
<font color="#009900">     }%</font>
<font color="#009900">     \vss</font>
<font color="#009900">  }}%</font>
<font color="#009900">  \kern-.15em</font>
<font color="#009900">  \TeX</font>
<font color="#009900">}</font>

<font color="#009900">% Some math mode symbols.</font>
<font color="#009900">\def\bullet{$\ptexbullet$}</font>
<font color="#009900">\def\geq{\ifmmode \ge\else $\ge$\fi}</font>
<font color="#009900">\def\leq{\ifmmode \le\else $\le$\fi}</font>
<font color="#009900">\def\minus{\ifmmode -\else $-$\fi}</font>

<font color="#009900">% @dots{} outputs an ellipsis using the current font.</font>
<font color="#009900">% We do .5em per period so that it has the same spacing in the cm</font>
<font color="#009900">% typewriter fonts as three actual period characters; on the other hand,</font>
<font color="#009900">% in other typewriter fonts three periods are wider than 1.5em.  So do</font>
<font color="#009900">% whichever is larger.</font>
<font color="#009900">%</font>
<font color="#009900">\def\dots{%</font>
<font color="#009900">  \leavevmode</font>
<font color="#009900">  \setbox0=\hbox{...}% get width of three periods</font>
<font color="#009900">  \ifdim\wd0 &gt; 1.5em</font>
<font color="#009900">    \dimen0 = \wd0</font>
<font color="#009900">  \else</font>
<font color="#009900">    \dimen0 = 1.5em</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \hbox to \dimen0{%</font>
<font color="#009900">    \hskip 0pt plus.25fil</font>
<font color="#009900">    .\hskip 0pt plus1fil</font>
<font color="#009900">    .\hskip 0pt plus1fil</font>
<font color="#009900">    .\hskip 0pt plus.5fil</font>
<font color="#009900">  }%</font>
<font color="#009900">}</font>

<font color="#009900">% @enddots{} is an end-of-sentence ellipsis.</font>
<font color="#009900">%</font>
<font color="#009900">\def\enddots{%</font>
<font color="#009900">  \dots</font>
<font color="#009900">  \spacefactor=\endofsentencespacefactor</font>
<font color="#009900">}</font>

<font color="#009900">% @point{}, @result{}, @expansion{}, @print{}, @equiv{}.</font>
<font color="#009900">%</font>
<font color="#009900">% Since these characters are used in examples, they should be an even number of</font>
<font color="#009900">% \tt widths. Each \tt character is 1en, so two makes it 1em.</font>
<font color="#009900">%</font>
<font color="#009900">\def\point{$\star$}</font>
<font color="#009900">\def\arrow{\leavevmode\raise.05ex\hbox to 1em{\hfil$\rightarrow$\hfil}}</font>
<font color="#009900">\def\result{\leavevmode\raise.05ex\hbox to 1em{\hfil$\Rightarrow$\hfil}}</font>
<font color="#009900">\def\expansion{\leavevmode\hbox to 1em{\hfil$\mapsto$\hfil}}</font>
<font color="#009900">\def\print{\leavevmode\lower.1ex\hbox to 1em{\hfil$\dashv$\hfil}}</font>
<font color="#009900">\def\equiv{\leavevmode\hbox to 1em{\hfil$\ptexequiv$\hfil}}</font>

<font color="#009900">% The @error{} command.</font>
<font color="#009900">% Adapted from the TeXbook's \boxit.</font>
<font color="#009900">%</font>
<font color="#009900">\newbox\errorbox</font>
<font color="#009900">%</font>
<font color="#009900">{\tentt \global\dimen0 = 3em}% Width of the box.</font>
<font color="#009900">\dimen2 = .55pt % Thickness of rules</font>
<font color="#009900">% The text. (`r' is open on the right, `e' somewhat less so on the left.)</font>
<font color="#009900">\setbox0 = \hbox{\kern-.75pt \reducedsf \putworderror\kern-1.5pt}</font>
<font color="#009900">%</font>
<font color="#009900">\setbox\errorbox=\hbox to \dimen0{\hfil</font>
<font color="#009900">   \hsize = \dimen0 \advance\hsize by -5.8pt % Space to left+right.</font>
<font color="#009900">   \advance\hsize by -2\dimen2 % Rules.</font>
<font color="#009900">   \vbox{%</font>
<font color="#009900">      \hrule height\dimen2</font>
<font color="#009900">      \hbox{\vrule width\dimen2 \kern3pt          % Space to left of text.</font>
<font color="#009900">         \vtop{\kern2.4pt \box0 \kern2.4pt}% Space above/below.</font>
<font color="#009900">         \kern3pt\vrule width\dimen2}% Space to right.</font>
<font color="#009900">      \hrule height\dimen2}</font>
<font color="#009900">    \hfil}</font>
<font color="#009900">%</font>
<font color="#009900">\def\error{\leavevmode\lower.7ex\copy\errorbox}</font>

<font color="#009900">% @pounds{} is a sterling sign, which Knuth put in the CM italic font.</font>
<font color="#009900">%</font>
<font color="#009900">\def\pounds{{\it\$}}</font>

<font color="#009900">% @euro{} comes from a separate font, depending on the current style.</font>
<font color="#009900">% We use the free feym* fonts from the eurosym package by Henrik</font>
<font color="#009900">% Theiling, which support regular, slanted, bold and bold slanted (and</font>
<font color="#009900">% "outlined" (blackboard board, sort of) versions, which we don't need).</font>
<font color="#009900">% It is available from http://www.ctan.org/tex-archive/fonts/eurosym.</font>
<font color="#009900">%</font>
<font color="#009900">% Although only regular is the truly official Euro symbol, we ignore</font>
<font color="#009900">% that.  The Euro is designed to be slightly taller than the regular</font>
<font color="#009900">% font height.</font>
<font color="#009900">%</font>
<font color="#009900">% feymr - regular</font>
<font color="#009900">% feymo - slanted</font>
<font color="#009900">% feybr - bold</font>
<font color="#009900">% feybo - bold slanted</font>
<font color="#009900">%</font>
<font color="#009900">% There is no good (free) typewriter version, to my knowledge.</font>
<font color="#009900">% A feymr10 euro is ~7.3pt wide, while a normal cmtt10 char is ~5.25pt wide.</font>
<font color="#009900">% Hmm.</font>
<font color="#009900">%</font>
<font color="#009900">% Also doesn't work in math.  Do we need to do math with euro symbols?</font>
<font color="#009900">% Hope not.</font>
<font color="#009900">%</font>
<font color="#009900">%</font>
<font color="#009900">\def\euro{{\eurofont e}}</font>
<font color="#009900">\def\eurofont{%</font>
<font color="#009900">  % We set the font at each command, rather than predefining it in</font>
<font color="#009900">  % \textfonts and the other font-switching commands, so that</font>
<font color="#009900">  % installations which never need the symbol don't have to have the</font>
<font color="#009900">  % font installed.</font>
<font color="#009900">  %</font>
<font color="#009900">  % There is only one designed size (nominal 10pt), so we always scale</font>
<font color="#009900">  % that to the current nominal size.</font>
<font color="#009900">  %</font>
<font color="#009900">  % By the way, simply using "at 1em" works for cmr10 and the like, but</font>
<font color="#009900">  % does not work for cmbx10 and other extended/shrunken fonts.</font>
<font color="#009900">  %</font>
<font color="#009900">  \def\eurosize{\csname\curfontsize nominalsize\endcsname}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \ifx\curfontstyle\bfstylename</font>
<font color="#009900">    % bold:</font>
<font color="#009900">    \font\thiseurofont = \ifusingit{feybo10}{feybr10} at \eurosize</font>
<font color="#009900">  \else</font>
<font color="#009900">    % regular:</font>
<font color="#009900">    \font\thiseurofont = \ifusingit{feymo10}{feymr10} at \eurosize</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \thiseurofont</font>
<font color="#009900">}</font>

<font color="#009900">% Glyphs from the EC fonts.  We don't use \let for the aliases, because</font>
<font color="#009900">% sometimes we redefine the original macro, and the alias should reflect</font>
<font color="#009900">% the redefinition.</font>
<font color="#009900">%</font>
<font color="#009900">% Use LaTeX names for the Icelandic letters.</font>
<font color="#009900">\def\DH{{\ecfont \char"D0}} % Eth</font>
<font color="#009900">\def\dh{{\ecfont \char"F0}} % eth</font>
<font color="#009900">\def\TH{{\ecfont \char"DE}} % Thorn</font>
<font color="#009900">\def\th{{\ecfont \char"FE}} % thorn</font>
<font color="#009900">%</font>
<font color="#009900">\def\guillemetleft{{\ecfont \char"13}}</font>
<font color="#009900">\def\guillemotleft{\guillemetleft}</font>
<font color="#009900">\def\guillemetright{{\ecfont \char"14}}</font>
<font color="#009900">\def\guillemotright{\guillemetright}</font>
<font color="#009900">\def\guilsinglleft{{\ecfont \char"0E}}</font>
<font color="#009900">\def\guilsinglright{{\ecfont \char"0F}}</font>
<font color="#009900">\def\quotedblbase{{\ecfont \char"12}}</font>
<font color="#009900">\def\quotesinglbase{{\ecfont \char"0D}}</font>
<font color="#009900">%</font>
<font color="#009900">% This positioning is not perfect (see the ogonek LaTeX package), but</font>
<font color="#009900">% we have the precomposed glyphs for the most common cases.  We put the</font>
<font color="#009900">% tests to use those glyphs in the single \ogonek macro so we have fewer</font>
<font color="#009900">% dummy definitions to worry about for index entries, etc.</font>
<font color="#009900">%</font>
<font color="#009900">% ogonek is also used with other letters in Lithuanian (IOU), but using</font>
<font color="#009900">% the precomposed glyphs for those is not so easy since they aren't in</font>
<font color="#009900">% the same EC font.</font>
<font color="#009900">\def\ogonek#1{{%</font>
<font color="#009900">  \def\temp{#1}%</font>
<font color="#009900">  \ifx\temp\macrocharA\Aogonek</font>
<font color="#009900">  \else\ifx\temp\macrochara\aogonek</font>
<font color="#009900">  \else\ifx\temp\macrocharE\Eogonek</font>
<font color="#009900">  \else\ifx\temp\macrochare\eogonek</font>
<font color="#009900">  \else</font>
<font color="#009900">    \ecfont \setbox0=\hbox{#1}%</font>
<font color="#009900">    \ifdim\ht0=1ex\accent"0C #1%</font>
<font color="#009900">    \else\ooalign{\unhbox0\crcr\hidewidth\char"0C \hidewidth}%</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi\fi\fi\fi</font>
<font color="#009900">  }%</font>
<font color="#009900">}</font>
<font color="#009900">\def\Aogonek{{\ecfont \char"81}}\def\macrocharA{A}</font>
<font color="#009900">\def\aogonek{{\ecfont \char"A1}}\def\macrochara{a}</font>
<font color="#009900">\def\Eogonek{{\ecfont \char"86}}\def\macrocharE{E}</font>
<font color="#009900">\def\eogonek{{\ecfont \char"A6}}\def\macrochare{e}</font>
<font color="#009900">%</font>
<font color="#009900">% Use the ec* fonts (cm-super in outline format) for non-CM glyphs.</font>
<font color="#009900">\def\ecfont{%</font>
<font color="#009900">  % We can't distinguish serif/sans and italic/slanted, but this</font>
<font color="#009900">  % is used for crude hacks anyway (like adding French and German</font>
<font color="#009900">  % quotes to documents typeset with CM, where we lose kerning), so</font>
<font color="#009900">  % hopefully nobody will notice/care.</font>
<font color="#009900">  \edef\ecsize{\csname\curfontsize ecsize\endcsname}%</font>
<font color="#009900">  \edef\nominalsize{\csname\curfontsize nominalsize\endcsname}%</font>
<font color="#009900">  \ifx\curfontstyle\bfstylename</font>
<font color="#009900">    % bold:</font>
<font color="#009900">    \font\thisecfont = ecb\ifusingit{i}{x}\ecsize \space at \nominalsize</font>
<font color="#009900">  \else</font>
<font color="#009900">    % regular:</font>
<font color="#009900">    \font\thisecfont = ec\ifusingit{ti}{rm}\ecsize \space at \nominalsize</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \thisecfont</font>
<font color="#009900">}</font>

<font color="#009900">% @registeredsymbol - R in a circle.  The font for the R should really</font>
<font color="#009900">% be smaller yet, but lllsize is the best we can do for now.</font>
<font color="#009900">% Adapted from the plain.tex definition of \copyright.</font>
<font color="#009900">%</font>
<font color="#009900">\def\registeredsymbol{%</font>
<font color="#009900">  $^{{\ooalign{\hfil\raise.07ex\hbox{\selectfonts\lllsize R}%</font>
<font color="#009900">               \hfil\crcr\Orb}}%</font>
<font color="#009900">    }$%</font>
<font color="#009900">}</font>

<font color="#009900">% @textdegree - the normal degrees sign.</font>
<font color="#009900">%</font>
<font color="#009900">\def\textdegree{$^\circ$}</font>

<font color="#009900">% Laurent Siebenmann reports \Orb undefined with:</font>
<font color="#009900">%  Textures 1.7.7 (preloaded format=plain 93.10.14)  (68K)  16 APR 2004 02:38</font>
<font color="#009900">% so we'll define it if necessary.</font>
<font color="#009900">%</font>
<font color="#009900">\ifx\Orb\thisisundefined</font>
<font color="#009900">\def\Orb{\mathhexbox20D}</font>
<font color="#009900">\fi</font>

<font color="#009900">% Quotes.</font>
<font color="#009900">\chardef\quotedblleft="5C</font>
<font color="#009900">\chardef\quotedblright=`\"</font>
<font color="#009900">\chardef\quoteleft=`\`</font>
<font color="#009900">\chardef\quoteright=`\'</font>


<font color="#009900">\message{page headings,}</font>

<font color="#009900">\newskip\titlepagetopglue \titlepagetopglue = 1.5in</font>
<font color="#009900">\newskip\titlepagebottomglue \titlepagebottomglue = 2pc</font>

<font color="#009900">% First the title page.  Must do @settitle before @titlepage.</font>
<font color="#009900">\newif\ifseenauthor</font>
<font color="#009900">\newif\iffinishedtitlepage</font>

<font color="#009900">% Do an implicit @contents or @shortcontents after @end titlepage if the</font>
<font color="#009900">% user says @setcontentsaftertitlepage or @setshortcontentsaftertitlepage.</font>
<font color="#009900">%</font>
<font color="#009900">\newif\ifsetcontentsaftertitlepage</font>
<font color="#009900"> \let\setcontentsaftertitlepage = \setcontentsaftertitlepagetrue</font>
<font color="#009900">\newif\ifsetshortcontentsaftertitlepage</font>
<font color="#009900"> \let\setshortcontentsaftertitlepage = \setshortcontentsaftertitlepagetrue</font>

<font color="#009900">\parseargdef\shorttitlepage{%</font>
<font color="#009900">  \begingroup \hbox{}\vskip 1.5in \chaprm \centerline{#1}%</font>
<font color="#009900">  \endgroup\page\hbox{}\page}</font>

<font color="#009900">\envdef\titlepage{%</font>
<font color="#009900">  % Open one extra group, as we want to close it in the middle of \Etitlepage.</font>
<font color="#009900">  \begingroup</font>
<font color="#009900">    \parindent=0pt \textfonts</font>
<font color="#009900">    % Leave some space at the very top of the page.</font>
<font color="#009900">    \vglue\titlepagetopglue</font>
<font color="#009900">    % No rule at page bottom unless we print one at the top with @title.</font>
<font color="#009900">    \finishedtitlepagetrue</font>
<font color="#009900">    %</font>
<font color="#009900">    % Most title ``pages'' are actually two pages long, with space</font>
<font color="#009900">    % at the top of the second.  We don't want the ragged left on the second.</font>
<font color="#009900">    \let\oldpage = \page</font>
<font color="#009900">    \def\page{%</font>
<font color="#009900">      \iffinishedtitlepage\else</font>
<font color="#009900">	 \finishtitlepage</font>
<font color="#009900">      \fi</font>
<font color="#009900">      \let\page = \oldpage</font>
<font color="#009900">      \page</font>
<font color="#009900">      \null</font>
<font color="#009900">    }%</font>
<font color="#009900">}</font>

<font color="#009900">\def\Etitlepage{%</font>
<font color="#009900">    \iffinishedtitlepage\else</font>
<font color="#009900">	\finishtitlepage</font>
<font color="#009900">    \fi</font>
<font color="#009900">    % It is important to do the page break before ending the group,</font>
<font color="#009900">    % because the headline and footline are only empty inside the group.</font>
<font color="#009900">    % If we use the new definition of \page, we always get a blank page</font>
<font color="#009900">    % after the title page, which we certainly don't want.</font>
<font color="#009900">    \oldpage</font>
<font color="#009900">  \endgroup</font>
<font color="#009900">  %</font>
<font color="#009900">  % Need this before the \...aftertitlepage checks so that if they are</font>
<font color="#009900">  % in effect the toc pages will come out with page numbers.</font>
<font color="#009900">  \HEADINGSon</font>
<font color="#009900">  %</font>
<font color="#009900">  % If they want short, they certainly want long too.</font>
<font color="#009900">  \ifsetshortcontentsaftertitlepage</font>
<font color="#009900">    \shortcontents</font>
<font color="#009900">    \contents</font>
<font color="#009900">    \global\let\shortcontents = \relax</font>
<font color="#009900">    \global\let\contents = \relax</font>
<font color="#009900">  \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  \ifsetcontentsaftertitlepage</font>
<font color="#009900">    \contents</font>
<font color="#009900">    \global\let\contents = \relax</font>
<font color="#009900">    \global\let\shortcontents = \relax</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">\def\finishtitlepage{%</font>
<font color="#009900">  \vskip4pt \hrule height 2pt width \hsize</font>
<font color="#009900">  \vskip\titlepagebottomglue</font>
<font color="#009900">  \finishedtitlepagetrue</font>
<font color="#009900">}</font>

<font color="#009900">% Macros to be used within @titlepage:</font>

<font color="#009900">\let\subtitlerm=\tenrm</font>
<font color="#009900">\def\subtitlefont{\subtitlerm \normalbaselineskip = 13pt \normalbaselines}</font>

<font color="#009900">\parseargdef\title{%</font>
<font color="#009900">  \checkenv\titlepage</font>
<font color="#009900">  \leftline{\titlefonts\rmisbold #1}</font>
<font color="#009900">  % print a rule at the page bottom also.</font>
<font color="#009900">  \finishedtitlepagefalse</font>
<font color="#009900">  \vskip4pt \hrule height 4pt width \hsize \vskip4pt</font>
<font color="#009900">}</font>

<font color="#009900">\parseargdef\subtitle{%</font>
<font color="#009900">  \checkenv\titlepage</font>
<font color="#009900">  {\subtitlefont \rightline{#1}}%</font>
<font color="#009900">}</font>

<font color="#009900">% @author should come last, but may come many times.</font>
<font color="#009900">% It can also be used inside @quotation.</font>
<font color="#009900">%</font>
<font color="#009900">\parseargdef\author{%</font>
<font color="#009900">  \def\temp{\quotation}%</font>
<font color="#009900">  \ifx\thisenv\temp</font>
<font color="#009900">    \def\quotationauthor{#1}% printed in \Equotation.</font>
<font color="#009900">  \else</font>
<font color="#009900">    \checkenv\titlepage</font>
<font color="#009900">    \ifseenauthor\else \vskip 0pt plus 1filll \seenauthortrue \fi</font>
<font color="#009900">    {\secfonts\rmisbold \leftline{#1}}%</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>


<font color="#009900">% Set up page headings and footings.</font>

<font color="#009900">\let\thispage=\folio</font>

<font color="#009900">\newtoks\evenheadline    % headline on even pages</font>
<font color="#009900">\newtoks\oddheadline     % headline on odd pages</font>
<font color="#009900">\newtoks\evenfootline    % footline on even pages</font>
<font color="#009900">\newtoks\oddfootline     % footline on odd pages</font>

<font color="#009900">% Now make TeX use those variables</font>
<font color="#009900">\headline={{\textfonts\rm \ifodd\pageno \the\oddheadline</font>
<font color="#009900">                            \else \the\evenheadline \fi}}</font>
<font color="#009900">\footline={{\textfonts\rm \ifodd\pageno \the\oddfootline</font>
<font color="#009900">                            \else \the\evenfootline \fi}\HEADINGShook}</font>
<font color="#009900">\let\HEADINGShook=\relax</font>

<font color="#009900">% Commands to set those variables.</font>
<font color="#009900">% For example, this is what  @headings on  does</font>
<font color="#009900">% @evenheading @thistitle|@thispage|@thischapter</font>
<font color="#009900">% @oddheading @thischapter|@thispage|@thistitle</font>
<font color="#009900">% @evenfooting @thisfile||</font>
<font color="#009900">% @oddfooting ||@thisfile</font>


<font color="#009900">\def\evenheading{\parsearg\evenheadingxxx}</font>
<font color="#009900">\def\evenheadingxxx #1{\evenheadingyyy #1\|\|\|\|\finish}</font>
<font color="#009900">\def\evenheadingyyy #1\|#2\|#3\|#4\finish{%</font>
<font color="#009900">\global\evenheadline={\rlap{\centerline{#2}}\line{#1\hfil#3}}}</font>

<font color="#009900">\def\oddheading{\parsearg\oddheadingxxx}</font>
<font color="#009900">\def\oddheadingxxx #1{\oddheadingyyy #1\|\|\|\|\finish}</font>
<font color="#009900">\def\oddheadingyyy #1\|#2\|#3\|#4\finish{%</font>
<font color="#009900">\global\oddheadline={\rlap{\centerline{#2}}\line{#1\hfil#3}}}</font>

<font color="#009900">\parseargdef\everyheading{\oddheadingxxx{#1}\evenheadingxxx{#1}}%</font>

<font color="#009900">\def\evenfooting{\parsearg\evenfootingxxx}</font>
<font color="#009900">\def\evenfootingxxx #1{\evenfootingyyy #1\|\|\|\|\finish}</font>
<font color="#009900">\def\evenfootingyyy #1\|#2\|#3\|#4\finish{%</font>
<font color="#009900">\global\evenfootline={\rlap{\centerline{#2}}\line{#1\hfil#3}}}</font>

<font color="#009900">\def\oddfooting{\parsearg\oddfootingxxx}</font>
<font color="#009900">\def\oddfootingxxx #1{\oddfootingyyy #1\|\|\|\|\finish}</font>
<font color="#009900">\def\oddfootingyyy #1\|#2\|#3\|#4\finish{%</font>
<font color="#009900">  \global\oddfootline = {\rlap{\centerline{#2}}\line{#1\hfil#3}}%</font>
<font color="#009900">  %</font>
<font color="#009900">  % Leave some space for the footline.  Hopefully ok to assume</font>
<font color="#009900">  % @evenfooting will not be used by itself.</font>
<font color="#009900">  \global\advance\pageheight by -12pt</font>
<font color="#009900">  \global\advance\vsize by -12pt</font>
<font color="#009900">}</font>

<font color="#009900">\parseargdef\everyfooting{\oddfootingxxx{#1}\evenfootingxxx{#1}}</font>

<font color="#009900">% @evenheadingmarks top     \thischapter &lt;- chapter at the top of a page</font>
<font color="#009900">% @evenheadingmarks bottom  \thischapter &lt;- chapter at the bottom of a page</font>
<font color="#009900">%</font>
<font color="#009900">% The same set of arguments for:</font>
<font color="#009900">%</font>
<font color="#009900">% @oddheadingmarks</font>
<font color="#009900">% @evenfootingmarks</font>
<font color="#009900">% @oddfootingmarks</font>
<font color="#009900">% @everyheadingmarks</font>
<font color="#009900">% @everyfootingmarks</font>

<font color="#009900">\def\evenheadingmarks{\headingmarks{even}{heading}}</font>
<font color="#009900">\def\oddheadingmarks{\headingmarks{odd}{heading}}</font>
<font color="#009900">\def\evenfootingmarks{\headingmarks{even}{footing}}</font>
<font color="#009900">\def\oddfootingmarks{\headingmarks{odd}{footing}}</font>
<font color="#009900">\def\everyheadingmarks#1 {\headingmarks{even}{heading}{#1}</font>
<font color="#009900">                          \headingmarks{odd}{heading}{#1} }</font>
<font color="#009900">\def\everyfootingmarks#1 {\headingmarks{even}{footing}{#1}</font>
<font color="#009900">                          \headingmarks{odd}{footing}{#1} }</font>
<font color="#009900">% #1 = even/odd, #2 = heading/footing, #3 = top/bottom.</font>
<font color="#009900">\def\headingmarks#1#2#3 {%</font>
<font color="#009900">  \expandafter\let\expandafter\temp \csname get#3headingmarks\endcsname</font>
<font color="#009900">  \global\expandafter\let\csname get#1#2marks\endcsname \temp</font>
<font color="#009900">}</font>

<font color="#009900">\everyheadingmarks bottom</font>
<font color="#009900">\everyfootingmarks bottom</font>

<font color="#009900">% @headings double      turns headings on for double-sided printing.</font>
<font color="#009900">% @headings single      turns headings on for single-sided printing.</font>
<font color="#009900">% @headings off         turns them off.</font>
<font color="#009900">% @headings on          same as @headings double, retained for compatibility.</font>
<font color="#009900">% @headings after       turns on double-sided headings after this page.</font>
<font color="#009900">% @headings doubleafter turns on double-sided headings after this page.</font>
<font color="#009900">% @headings singleafter turns on single-sided headings after this page.</font>
<font color="#009900">% By default, they are off at the start of a document,</font>
<font color="#009900">% and turned `on' after @end titlepage.</font>

<font color="#009900">\def\headings #1 {\csname HEADINGS#1\endcsname}</font>

<font color="#009900">\def\headingsoff{% non-global headings elimination</font>
<font color="#009900">  \evenheadline={\hfil}\evenfootline={\hfil}%</font>
<font color="#009900">   \oddheadline={\hfil}\oddfootline={\hfil}%</font>
<font color="#009900">}</font>

<font color="#009900">\def\HEADINGSoff{{\globaldefs=1 \headingsoff}} % global setting</font>
<font color="#009900">\HEADINGSoff  % it's the default</font>

<font color="#009900">% When we turn headings on, set the page number to 1.</font>
<font color="#009900">% For double-sided printing, put current file name in lower left corner,</font>
<font color="#009900">% chapter name on inside top of right hand pages, document</font>
<font color="#009900">% title on inside top of left hand pages, and page numbers on outside top</font>
<font color="#009900">% edge of all pages.</font>
<font color="#009900">\def\HEADINGSdouble{%</font>
<font color="#009900">\global\pageno=1</font>
<font color="#009900">\global\evenfootline={\hfil}</font>
<font color="#009900">\global\oddfootline={\hfil}</font>
<font color="#009900">\global\evenheadline={\line{\folio\hfil\thistitle}}</font>
<font color="#009900">\global\oddheadline={\line{\thischapter\hfil\folio}}</font>
<font color="#009900">\global\let\contentsalignmacro = \chapoddpage</font>
<font color="#009900">}</font>
<font color="#009900">\let\contentsalignmacro = \chappager</font>

<font color="#009900">% For single-sided printing, chapter title goes across top left of page,</font>
<font color="#009900">% page number on top right.</font>
<font color="#009900">\def\HEADINGSsingle{%</font>
<font color="#009900">\global\pageno=1</font>
<font color="#009900">\global\evenfootline={\hfil}</font>
<font color="#009900">\global\oddfootline={\hfil}</font>
<font color="#009900">\global\evenheadline={\line{\thischapter\hfil\folio}}</font>
<font color="#009900">\global\oddheadline={\line{\thischapter\hfil\folio}}</font>
<font color="#009900">\global\let\contentsalignmacro = \chappager</font>
<font color="#009900">}</font>
<font color="#009900">\def\HEADINGSon{\HEADINGSdouble}</font>

<font color="#009900">\def\HEADINGSafter{\let\HEADINGShook=\HEADINGSdoublex}</font>
<font color="#009900">\let\HEADINGSdoubleafter=\HEADINGSafter</font>
<font color="#009900">\def\HEADINGSdoublex{%</font>
<font color="#009900">\global\evenfootline={\hfil}</font>
<font color="#009900">\global\oddfootline={\hfil}</font>
<font color="#009900">\global\evenheadline={\line{\folio\hfil\thistitle}}</font>
<font color="#009900">\global\oddheadline={\line{\thischapter\hfil\folio}}</font>
<font color="#009900">\global\let\contentsalignmacro = \chapoddpage</font>
<font color="#009900">}</font>

<font color="#009900">\def\HEADINGSsingleafter{\let\HEADINGShook=\HEADINGSsinglex}</font>
<font color="#009900">\def\HEADINGSsinglex{%</font>
<font color="#009900">\global\evenfootline={\hfil}</font>
<font color="#009900">\global\oddfootline={\hfil}</font>
<font color="#009900">\global\evenheadline={\line{\thischapter\hfil\folio}}</font>
<font color="#009900">\global\oddheadline={\line{\thischapter\hfil\folio}}</font>
<font color="#009900">\global\let\contentsalignmacro = \chappager</font>
<font color="#009900">}</font>

<font color="#009900">% Subroutines used in generating headings</font>
<font color="#009900">% This produces Day Month Year style of output.</font>
<font color="#009900">% Only define if not already defined, in case a txi-??.tex file has set</font>
<font color="#009900">% up a different format (e.g., txi-cs.tex does this).</font>
<font color="#009900">\ifx\today\thisisundefined</font>
<font color="#009900">\def\today{%</font>
<font color="#009900">  \number\day\space</font>
<font color="#009900">  \ifcase\month</font>
<font color="#009900">  \or\putwordMJan\or\putwordMFeb\or\putwordMMar\or\putwordMApr</font>
<font color="#009900">  \or\putwordMMay\or\putwordMJun\or\putwordMJul\or\putwordMAug</font>
<font color="#009900">  \or\putwordMSep\or\putwordMOct\or\putwordMNov\or\putwordMDec</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \space\number\year}</font>
<font color="#009900">\fi</font>

<font color="#009900">% @settitle line...  specifies the title of the document, for headings.</font>
<font color="#009900">% It generates no output of its own.</font>
<font color="#009900">\def\thistitle{\putwordNoTitle}</font>
<font color="#009900">\def\settitle{\parsearg{\gdef\thistitle}}</font>


<font color="#009900">\message{tables,}</font>
<font color="#009900">% Tables -- @table, @ftable, @vtable, @item(x).</font>

<font color="#009900">% default indentation of table text</font>
<font color="#009900">\newdimen\tableindent \tableindent=.8in</font>
<font color="#009900">% default indentation of @itemize and @enumerate text</font>
<font color="#009900">\newdimen\itemindent  \itemindent=.3in</font>
<font color="#009900">% margin between end of table item and start of table text.</font>
<font color="#009900">\newdimen\itemmargin  \itemmargin=.1in</font>

<font color="#009900">% used internally for \itemindent minus \itemmargin</font>
<font color="#009900">\newdimen\itemmax</font>

<font color="#009900">% Note @table, @ftable, and @vtable define @item, @itemx, etc., with</font>
<font color="#009900">% these defs.</font>
<font color="#009900">% They also define \itemindex</font>
<font color="#009900">% to index the item name in whatever manner is desired (perhaps none).</font>

<font color="#009900">\newif\ifitemxneedsnegativevskip</font>

<font color="#009900">\def\itemxpar{\par\ifitemxneedsnegativevskip\nobreak\vskip-\parskip\nobreak\fi}</font>

<font color="#009900">\def\internalBitem{\smallbreak \parsearg\itemzzz}</font>
<font color="#009900">\def\internalBitemx{\itemxpar \parsearg\itemzzz}</font>

<font color="#009900">\def\itemzzz #1{\begingroup %</font>
<font color="#009900">  \advance\hsize by -\rightskip</font>
<font color="#009900">  \advance\hsize by -\tableindent</font>
<font color="#009900">  \setbox0=\hbox{\itemindicate{#1}}%</font>
<font color="#009900">  \itemindex{#1}%</font>
<font color="#009900">  \nobreak % This prevents a break before @itemx.</font>
<font color="#009900">  %</font>
<font color="#009900">  % If the item text does not fit in the space we have, put it on a line</font>
<font color="#009900">  % by itself, and do not allow a page break either before or after that</font>
<font color="#009900">  % line.  We do not start a paragraph here because then if the next</font>
<font color="#009900">  % command is, e.g., @kindex, the whatsit would get put into the</font>
<font color="#009900">  % horizontal list on a line by itself, resulting in extra blank space.</font>
<font color="#009900">  \ifdim \wd0&gt;\itemmax</font>
<font color="#009900">    %</font>
<font color="#009900">    % Make this a paragraph so we get the \parskip glue and wrapping,</font>
<font color="#009900">    % but leave it ragged-right.</font>
<font color="#009900">    \begingroup</font>
<font color="#009900">      \advance\leftskip by-\tableindent</font>
<font color="#009900">      \advance\hsize by\tableindent</font>
<font color="#009900">      \advance\rightskip by0pt plus1fil\relax</font>
<font color="#009900">      \leavevmode\unhbox0\par</font>
<font color="#009900">    \endgroup</font>
<font color="#009900">    %</font>
<font color="#009900">    % We're going to be starting a paragraph, but we don't want the</font>
<font color="#009900">    % \parskip glue -- logically it's part of the @item we just started.</font>
<font color="#009900">    \nobreak \vskip-\parskip</font>
<font color="#009900">    %</font>
<font color="#009900">    % Stop a page break at the \parskip glue coming up.  However, if</font>
<font color="#009900">    % what follows is an environment such as @example, there will be no</font>
<font color="#009900">    % \parskip glue; then the negative vskip we just inserted would</font>
<font color="#009900">    % cause the example and the item to crash together.  So we use this</font>
<font color="#009900">    % bizarre value of 10001 as a signal to \aboveenvbreak to insert</font>
<font color="#009900">    % \parskip glue after all.  Section titles are handled this way also.</font>
<font color="#009900">    %</font>
<font color="#009900">    \penalty 10001</font>
<font color="#009900">    \endgroup</font>
<font color="#009900">    \itemxneedsnegativevskipfalse</font>
<font color="#009900">  \else</font>
<font color="#009900">    % The item text fits into the space.  Start a paragraph, so that the</font>
<font color="#009900">    % following text (if any) will end up on the same line.</font>
<font color="#009900">    \noindent</font>
<font color="#009900">    % Do this with kerns and \unhbox so that if there is a footnote in</font>
<font color="#009900">    % the item text, it can migrate to the main vertical list and</font>
<font color="#009900">    % eventually be printed.</font>
<font color="#009900">    \nobreak\kern-\tableindent</font>
<font color="#009900">    \dimen0 = \itemmax  \advance\dimen0 by \itemmargin \advance\dimen0 by -\wd0</font>
<font color="#009900">    \unhbox0</font>
<font color="#009900">    \nobreak\kern\dimen0</font>
<font color="#009900">    \endgroup</font>
<font color="#009900">    \itemxneedsnegativevskiptrue</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">\def\item{\errmessage{@item while not in a list environment}}</font>
<font color="#009900">\def\itemx{\errmessage{@itemx while not in a list environment}}</font>

<font color="#009900">% @table, @ftable, @vtable.</font>
<font color="#009900">\envdef\table{%</font>
<font color="#009900">  \let\itemindex\gobble</font>
<font color="#009900">  \tablecheck{table}%</font>
<font color="#009900">}</font>
<font color="#009900">\envdef\ftable{%</font>
<font color="#009900">  \def\itemindex ##1{\doind {fn}{\code{##1}}}%</font>
<font color="#009900">  \tablecheck{ftable}%</font>
<font color="#009900">}</font>
<font color="#009900">\envdef\vtable{%</font>
<font color="#009900">  \def\itemindex ##1{\doind {vr}{\code{##1}}}%</font>
<font color="#009900">  \tablecheck{vtable}%</font>
<font color="#009900">}</font>
<font color="#009900">\def\tablecheck#1{%</font>
<font color="#009900">  \ifnum \the\catcode`\^^M=\active</font>
<font color="#009900">    \endgroup</font>
<font color="#009900">    \errmessage{This command won't work in this context; perhaps the problem is</font>
<font color="#009900">      that we are \inenvironment\thisenv}%</font>
<font color="#009900">    \def\next{\doignore{#1}}%</font>
<font color="#009900">  \else</font>
<font color="#009900">    \let\next\tablex</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \next</font>
<font color="#009900">}</font>
<font color="#009900">\def\tablex#1{%</font>
<font color="#009900">  \def\itemindicate{#1}%</font>
<font color="#009900">  \parsearg\tabley</font>
<font color="#009900">}</font>
<font color="#009900">\def\tabley#1{%</font>
<font color="#009900">  {%</font>
<font color="#009900">    \makevalueexpandable</font>
<font color="#009900">    \edef\temp{\noexpand\tablez #1\space\space\space}%</font>
<font color="#009900">    \expandafter</font>
<font color="#009900">  }\temp \endtablez</font>
<font color="#009900">}</font>
<font color="#009900">\def\tablez #1 #2 #3 #4\endtablez{%</font>
<font color="#009900">  \aboveenvbreak</font>
<font color="#009900">  \ifnum 0#1&gt;0 \advance \leftskip by #1\mil \fi</font>
<font color="#009900">  \ifnum 0#2&gt;0 \tableindent=#2\mil \fi</font>
<font color="#009900">  \ifnum 0#3&gt;0 \advance \rightskip by #3\mil \fi</font>
<font color="#009900">  \itemmax=\tableindent</font>
<font color="#009900">  \advance \itemmax by -\itemmargin</font>
<font color="#009900">  \advance \leftskip by \tableindent</font>
<font color="#009900">  \exdentamount=\tableindent</font>
<font color="#009900">  \parindent = 0pt</font>
<font color="#009900">  \parskip = \smallskipamount</font>
<font color="#009900">  \ifdim \parskip=0pt \parskip=2pt \fi</font>
<font color="#009900">  \let\item = \internalBitem</font>
<font color="#009900">  \let\itemx = \internalBitemx</font>
<font color="#009900">}</font>
<font color="#009900">\def\Etable{\endgraf\afterenvbreak}</font>
<font color="#009900">\let\Eftable\Etable</font>
<font color="#009900">\let\Evtable\Etable</font>
<font color="#009900">\let\Eitemize\Etable</font>
<font color="#009900">\let\Eenumerate\Etable</font>

<font color="#009900">% This is the counter used by @enumerate, which is really @itemize</font>

<font color="#009900">\newcount \itemno</font>

<font color="#009900">\envdef\itemize{\parsearg\doitemize}</font>

<font color="#009900">\def\doitemize#1{%</font>
<font color="#009900">  \aboveenvbreak</font>
<font color="#009900">  \itemmax=\itemindent</font>
<font color="#009900">  \advance\itemmax by -\itemmargin</font>
<font color="#009900">  \advance\leftskip by \itemindent</font>
<font color="#009900">  \exdentamount=\itemindent</font>
<font color="#009900">  \parindent=0pt</font>
<font color="#009900">  \parskip=\smallskipamount</font>
<font color="#009900">  \ifdim\parskip=0pt \parskip=2pt \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  % Try typesetting the item mark that if the document erroneously says</font>
<font color="#009900">  % something like @itemize @samp (intending @table), there's an error</font>
<font color="#009900">  % right away at the @itemize.  It's not the best error message in the</font>
<font color="#009900">  % world, but it's better than leaving it to the @item.  This means if</font>
<font color="#009900">  % the user wants an empty mark, they have to say @w{} not just @w.</font>
<font color="#009900">  \def\itemcontents{#1}%</font>
<font color="#009900">  \setbox0 = \hbox{\itemcontents}%</font>
<font color="#009900">  %</font>
<font color="#009900">  % @itemize with no arg is equivalent to @itemize @bullet.</font>
<font color="#009900">  \ifx\itemcontents\empty\def\itemcontents{\bullet}\fi</font>
<font color="#009900">  %</font>
<font color="#009900">  \let\item=\itemizeitem</font>
<font color="#009900">}</font>

<font color="#009900">% Definition of @item while inside @itemize and @enumerate.</font>
<font color="#009900">%</font>
<font color="#009900">\def\itemizeitem{%</font>
<font color="#009900">  \advance\itemno by 1  % for enumerations</font>
<font color="#009900">  {\let\par=\endgraf \smallbreak}% reasonable place to break</font>
<font color="#009900">  {%</font>
<font color="#009900">   % If the document has an @itemize directly after a section title, a</font>
<font color="#009900">   % \nobreak will be last on the list, and \sectionheading will have</font>
<font color="#009900">   % done a \vskip-\parskip.  In that case, we don't want to zero</font>
<font color="#009900">   % parskip, or the item text will crash with the heading.  On the</font>
<font color="#009900">   % other hand, when there is normal text preceding the item (as there</font>
<font color="#009900">   % usually is), we do want to zero parskip, or there would be too much</font>
<font color="#009900">   % space.  In that case, we won't have a \nobreak before.  At least</font>
<font color="#009900">   % that's the theory.</font>
<font color="#009900">   \ifnum\lastpenalty&lt;10000 \parskip=0in \fi</font>
<font color="#009900">   \noindent</font>
<font color="#009900">   \hbox to 0pt{\hss \itemcontents \kern\itemmargin}%</font>
<font color="#009900">   %</font>
<font color="#009900">   \vadjust{\penalty 1200}}% not good to break after first line of item.</font>
<font color="#009900">  \flushcr</font>
<font color="#009900">}</font>

<font color="#009900">% \splitoff TOKENS\endmark defines \first to be the first token in</font>
<font color="#009900">% TOKENS, and \rest to be the remainder.</font>
<font color="#009900">%</font>
<font color="#009900">\def\splitoff#1#2\endmark{\def\first{#1}\def\rest{#2}}%</font>

<font color="#009900">% Allow an optional argument of an uppercase letter, lowercase letter,</font>
<font color="#009900">% or number, to specify the first label in the enumerated list.  No</font>
<font color="#009900">% argument is the same as `1'.</font>
<font color="#009900">%</font>
<font color="#009900">\envparseargdef\enumerate{\enumeratey #1  \endenumeratey}</font>
<font color="#009900">\def\enumeratey #1 #2\endenumeratey{%</font>
<font color="#009900">  % If we were given no argument, pretend we were given `1'.</font>
<font color="#009900">  \def\thearg{#1}%</font>
<font color="#009900">  \ifx\thearg\empty \def\thearg{1}\fi</font>
<font color="#009900">  %</font>
<font color="#009900">  % Detect if the argument is a single token.  If so, it might be a</font>
<font color="#009900">  % letter.  Otherwise, the only valid thing it can be is a number.</font>
<font color="#009900">  % (We will always have one token, because of the test we just made.</font>
<font color="#009900">  % This is a good thing, since \splitoff doesn't work given nothing at</font>
<font color="#009900">  % all -- the first parameter is undelimited.)</font>
<font color="#009900">  \expandafter\splitoff\thearg\endmark</font>
<font color="#009900">  \ifx\rest\empty</font>
<font color="#009900">    % Only one token in the argument.  It could still be anything.</font>
<font color="#009900">    % A ``lowercase letter'' is one whose \lccode is nonzero.</font>
<font color="#009900">    % An ``uppercase letter'' is one whose \lccode is both nonzero, and</font>
<font color="#009900">    %   not equal to itself.</font>
<font color="#009900">    % Otherwise, we assume it's a number.</font>
<font color="#009900">    %</font>
<font color="#009900">    % We need the \relax at the end of the \ifnum lines to stop TeX from</font>
<font color="#009900">    % continuing to look for a &lt;number&gt;.</font>
<font color="#009900">    %</font>
<font color="#009900">    \ifnum\lccode\expandafter`\thearg=0\relax</font>
<font color="#009900">      \numericenumerate % a number (we hope)</font>
<font color="#009900">    \else</font>
<font color="#009900">      % It's a letter.</font>
<font color="#009900">      \ifnum\lccode\expandafter`\thearg=\expandafter`\thearg\relax</font>
<font color="#009900">        \lowercaseenumerate % lowercase letter</font>
<font color="#009900">      \else</font>
<font color="#009900">        \uppercaseenumerate % uppercase letter</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \else</font>
<font color="#009900">    % Multiple tokens in the argument.  We hope it's a number.</font>
<font color="#009900">    \numericenumerate</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% An @enumerate whose labels are integers.  The starting integer is</font>
<font color="#009900">% given in \thearg.</font>
<font color="#009900">%</font>
<font color="#009900">\def\numericenumerate{%</font>
<font color="#009900">  \itemno = \thearg</font>
<font color="#009900">  \startenumeration{\the\itemno}%</font>
<font color="#009900">}</font>

<font color="#009900">% The starting (lowercase) letter is in \thearg.</font>
<font color="#009900">\def\lowercaseenumerate{%</font>
<font color="#009900">  \itemno = \expandafter`\thearg</font>
<font color="#009900">  \startenumeration{%</font>
<font color="#009900">    % Be sure we're not beyond the end of the alphabet.</font>
<font color="#009900">    \ifnum\itemno=0</font>
<font color="#009900">      \errmessage{No more lowercase letters in @enumerate; get a bigger</font>
<font color="#009900">                  alphabet}%</font>
<font color="#009900">    \fi</font>
<font color="#009900">    \char\lccode\itemno</font>
<font color="#009900">  }%</font>
<font color="#009900">}</font>

<font color="#009900">% The starting (uppercase) letter is in \thearg.</font>
<font color="#009900">\def\uppercaseenumerate{%</font>
<font color="#009900">  \itemno = \expandafter`\thearg</font>
<font color="#009900">  \startenumeration{%</font>
<font color="#009900">    % Be sure we're not beyond the end of the alphabet.</font>
<font color="#009900">    \ifnum\itemno=0</font>
<font color="#009900">      \errmessage{No more uppercase letters in @enumerate; get a bigger</font>
<font color="#009900">                  alphabet}</font>
<font color="#009900">    \fi</font>
<font color="#009900">    \char\uccode\itemno</font>
<font color="#009900">  }%</font>
<font color="#009900">}</font>

<font color="#009900">% Call \doitemize, adding a period to the first argument and supplying the</font>
<font color="#009900">% common last two arguments.  Also subtract one from the initial value in</font>
<font color="#009900">% \itemno, since @item increments \itemno.</font>
<font color="#009900">%</font>
<font color="#009900">\def\startenumeration#1{%</font>
<font color="#009900">  \advance\itemno by -1</font>
<font color="#009900">  \doitemize{#1.}\flushcr</font>
<font color="#009900">}</font>

<font color="#009900">% @alphaenumerate and @capsenumerate are abbreviations for giving an arg</font>
<font color="#009900">% to @enumerate.</font>
<font color="#009900">%</font>
<font color="#009900">\def\alphaenumerate{\enumerate{a}}</font>
<font color="#009900">\def\capsenumerate{\enumerate{A}}</font>
<font color="#009900">\def\Ealphaenumerate{\Eenumerate}</font>
<font color="#009900">\def\Ecapsenumerate{\Eenumerate}</font>


<font color="#009900">% @multitable macros</font>
<font color="#009900">% Amy Hendrickson, 8/18/94, 3/6/96</font>
<font color="#009900">%</font>
<font color="#009900">% @multitable ... @end multitable will make as many columns as desired.</font>
<font color="#009900">% Contents of each column will wrap at width given in preamble.  Width</font>
<font color="#009900">% can be specified either with sample text given in a template line,</font>
<font color="#009900">% or in percent of \hsize, the current width of text on page.</font>

<font color="#009900">% Table can continue over pages but will only break between lines.</font>

<font color="#009900">% To make preamble:</font>
<font color="#009900">%</font>
<font color="#009900">% Either define widths of columns in terms of percent of \hsize:</font>
<font color="#009900">%   @multitable @columnfractions .25 .3 .45</font>
<font color="#009900">%   @item ...</font>
<font color="#009900">%</font>
<font color="#009900">%   Numbers following @columnfractions are the percent of the total</font>
<font color="#009900">%   current hsize to be used for each column. You may use as many</font>
<font color="#009900">%   columns as desired.</font>


<font color="#009900">% Or use a template:</font>
<font color="#009900">%   @multitable {Column 1 template} {Column 2 template} {Column 3 template}</font>
<font color="#009900">%   @item ...</font>
<font color="#009900">%   using the widest term desired in each column.</font>

<font color="#009900">% Each new table line starts with @item, each subsequent new column</font>
<font color="#009900">% starts with @tab. Empty columns may be produced by supplying @tab's</font>
<font color="#009900">% with nothing between them for as many times as empty columns are needed,</font>
<font color="#009900">% ie, @tab@tab@tab will produce two empty columns.</font>

<font color="#009900">% @item, @tab do not need to be on their own lines, but it will not hurt</font>
<font color="#009900">% if they are.</font>

<font color="#009900">% Sample multitable:</font>

<font color="#009900">%   @multitable {Column 1 template} {Column 2 template} {Column 3 template}</font>
<font color="#009900">%   @item first col stuff @tab second col stuff @tab third col</font>
<font color="#009900">%   @item</font>
<font color="#009900">%   first col stuff</font>
<font color="#009900">%   @tab</font>
<font color="#009900">%   second col stuff</font>
<font color="#009900">%   @tab</font>
<font color="#009900">%   third col</font>
<font color="#009900">%   @item first col stuff @tab second col stuff</font>
<font color="#009900">%   @tab Many paragraphs of text may be used in any column.</font>
<font color="#009900">%</font>
<font color="#009900">%         They will wrap at the width determined by the template.</font>
<font color="#009900">%   @item@tab@tab This will be in third column.</font>
<font color="#009900">%   @end multitable</font>

<font color="#009900">% Default dimensions may be reset by user.</font>
<font color="#009900">% @multitableparskip is vertical space between paragraphs in table.</font>
<font color="#009900">% @multitableparindent is paragraph indent in table.</font>
<font color="#009900">% @multitablecolmargin is horizontal space to be left between columns.</font>
<font color="#009900">% @multitablelinespace is space to leave between table items, baseline</font>
<font color="#009900">%                                                            to baseline.</font>
<font color="#009900">%   0pt means it depends on current normal line spacing.</font>
<font color="#009900">%</font>
<font color="#009900">\newskip\multitableparskip</font>
<font color="#009900">\newskip\multitableparindent</font>
<font color="#009900">\newdimen\multitablecolspace</font>
<font color="#009900">\newskip\multitablelinespace</font>
<font color="#009900">\multitableparskip=0pt</font>
<font color="#009900">\multitableparindent=6pt</font>
<font color="#009900">\multitablecolspace=12pt</font>
<font color="#009900">\multitablelinespace=0pt</font>

<font color="#009900">% Macros used to set up halign preamble:</font>
<font color="#009900">%</font>
<font color="#009900">\let\endsetuptable\relax</font>
<font color="#009900">\def\xendsetuptable{\endsetuptable}</font>
<font color="#009900">\let\columnfractions\relax</font>
<font color="#009900">\def\xcolumnfractions{\columnfractions}</font>
<font color="#009900">\newif\ifsetpercent</font>

<font color="#009900">% #1 is the @columnfraction, usually a decimal number like .5, but might</font>
<font color="#009900">% be just 1.  We just use it, whatever it is.</font>
<font color="#009900">%</font>
<font color="#009900">\def\pickupwholefraction#1 {%</font>
<font color="#009900">  \global\advance\colcount by 1</font>
<font color="#009900">  \expandafter\xdef\csname col\the\colcount\endcsname{#1\hsize}%</font>
<font color="#009900">  \setuptable</font>
<font color="#009900">}</font>

<font color="#009900">\newcount\colcount</font>
<font color="#009900">\def\setuptable#1{%</font>
<font color="#009900">  \def\firstarg{#1}%</font>
<font color="#009900">  \ifx\firstarg\xendsetuptable</font>
<font color="#009900">    \let\go = \relax</font>
<font color="#009900">  \else</font>
<font color="#009900">    \ifx\firstarg\xcolumnfractions</font>
<font color="#009900">      \global\setpercenttrue</font>
<font color="#009900">    \else</font>
<font color="#009900">      \ifsetpercent</font>
<font color="#009900">         \let\go\pickupwholefraction</font>
<font color="#009900">      \else</font>
<font color="#009900">         \global\advance\colcount by 1</font>
<font color="#009900">         \setbox0=\hbox{#1\unskip\space}% Add a normal word space as a</font>
<font color="#009900">                   % separator; typically that is always in the input, anyway.</font>
<font color="#009900">         \expandafter\xdef\csname col\the\colcount\endcsname{\the\wd0}%</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \fi</font>
<font color="#009900">    \ifx\go\pickupwholefraction</font>
<font color="#009900">      % Put the argument back for the \pickupwholefraction call, so</font>
<font color="#009900">      % we'll always have a period there to be parsed.</font>
<font color="#009900">      \def\go{\pickupwholefraction#1}%</font>
<font color="#009900">    \else</font>
<font color="#009900">      \let\go = \setuptable</font>
<font color="#009900">    \fi%</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \go</font>
<font color="#009900">}</font>

<font color="#009900">% multitable-only commands.</font>
<font color="#009900">%</font>
<font color="#009900">% @headitem starts a heading row, which we typeset in bold.</font>
<font color="#009900">% Assignments have to be global since we are inside the implicit group</font>
<font color="#009900">% of an alignment entry.  \everycr resets \everytab so we don't have to</font>
<font color="#009900">% undo it ourselves.</font>
<font color="#009900">\def\headitemfont{\b}% for people to use in the template row; not changeable</font>
<font color="#009900">\def\headitem{%</font>
<font color="#009900">  \checkenv\multitable</font>
<font color="#009900">  \crcr</font>
<font color="#009900">  \global\everytab={\bf}% can't use \headitemfont since the parsing differs</font>
<font color="#009900">  \the\everytab % for the first item</font>
<font color="#009900">}%</font>
<font color="#009900">%</font>
<font color="#009900">% A \tab used to include \hskip1sp.  But then the space in a template</font>
<font color="#009900">% line is not enough.  That is bad.  So let's go back to just `&amp;' until</font>
<font color="#009900">% we again encounter the problem the 1sp was intended to solve.</font>
<font color="#009900">%					--karl, nathan@acm.org, 20apr99.</font>
<font color="#009900">\def\tab{\checkenv\multitable &amp;\the\everytab}%</font>

<font color="#009900">% @multitable ... @end multitable definitions:</font>
<font color="#009900">%</font>
<font color="#009900">\newtoks\everytab  % insert after every tab.</font>
<font color="#009900">%</font>
<font color="#009900">\envdef\multitable{%</font>
<font color="#009900">  \vskip\parskip</font>
<font color="#009900">  \startsavinginserts</font>
<font color="#009900">  %</font>
<font color="#009900">  % @item within a multitable starts a normal row.</font>
<font color="#009900">  % We use \def instead of \let so that if one of the multitable entries</font>
<font color="#009900">  % contains an @itemize, we don't choke on the \item (seen as \crcr aka</font>
<font color="#009900">  % \endtemplate) expanding \doitemize.</font>
<font color="#009900">  \def\item{\crcr}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \tolerance=9500</font>
<font color="#009900">  \hbadness=9500</font>
<font color="#009900">  \setmultitablespacing</font>
<font color="#009900">  \parskip=\multitableparskip</font>
<font color="#009900">  \parindent=\multitableparindent</font>
<font color="#009900">  \overfullrule=0pt</font>
<font color="#009900">  \global\colcount=0</font>
<font color="#009900">  %</font>
<font color="#009900">  \everycr = {%</font>
<font color="#009900">    \noalign{%</font>
<font color="#009900">      \global\everytab={}%</font>
<font color="#009900">      \global\colcount=0 % Reset the column counter.</font>
<font color="#009900">      % Check for saved footnotes, etc.</font>
<font color="#009900">      \checkinserts</font>
<font color="#009900">      % Keeps underfull box messages off when table breaks over pages.</font>
<font color="#009900">      %\filbreak</font>
<font color="#009900">	% Maybe so, but it also creates really weird page breaks when the</font>
<font color="#009900">	% table breaks over pages. Wouldn't \vfil be better?  Wait until the</font>
<font color="#009900">	% problem manifests itself, so it can be fixed for real --karl.</font>
<font color="#009900">    }%</font>
<font color="#009900">  }%</font>
<font color="#009900">  %</font>
<font color="#009900">  \parsearg\domultitable</font>
<font color="#009900">}</font>
<font color="#009900">\def\domultitable#1{%</font>
<font color="#009900">  % To parse everything between @multitable and @item:</font>
<font color="#009900">  \setuptable#1 \endsetuptable</font>
<font color="#009900">  %</font>
<font color="#009900">  % This preamble sets up a generic column definition, which will</font>
<font color="#009900">  % be used as many times as user calls for columns.</font>
<font color="#009900">  % \vtop will set a single line and will also let text wrap and</font>
<font color="#009900">  % continue for many paragraphs if desired.</font>
<font color="#009900">  \halign\bgroup &amp;%</font>
<font color="#009900">    \global\advance\colcount by 1</font>
<font color="#009900">    \multistrut</font>
<font color="#009900">    \vtop{%</font>
<font color="#009900">      % Use the current \colcount to find the correct column width:</font>
<font color="#009900">      \hsize=\expandafter\csname col\the\colcount\endcsname</font>
<font color="#009900">      %</font>
<font color="#009900">      % In order to keep entries from bumping into each other</font>
<font color="#009900">      % we will add a \leftskip of \multitablecolspace to all columns after</font>
<font color="#009900">      % the first one.</font>
<font color="#009900">      %</font>
<font color="#009900">      % If a template has been used, we will add \multitablecolspace</font>
<font color="#009900">      % to the width of each template entry.</font>
<font color="#009900">      %</font>
<font color="#009900">      % If the user has set preamble in terms of percent of \hsize we will</font>
<font color="#009900">      % use that dimension as the width of the column, and the \leftskip</font>
<font color="#009900">      % will keep entries from bumping into each other.  Table will start at</font>
<font color="#009900">      % left margin and final column will justify at right margin.</font>
<font color="#009900">      %</font>
<font color="#009900">      % Make sure we don't inherit \rightskip from the outer environment.</font>
<font color="#009900">      \rightskip=0pt</font>
<font color="#009900">      \ifnum\colcount=1</font>
<font color="#009900">	% The first column will be indented with the surrounding text.</font>
<font color="#009900">	\advance\hsize by\leftskip</font>
<font color="#009900">      \else</font>
<font color="#009900">	\ifsetpercent \else</font>
<font color="#009900">	  % If user has not set preamble in terms of percent of \hsize</font>
<font color="#009900">	  % we will advance \hsize by \multitablecolspace.</font>
<font color="#009900">	  \advance\hsize by \multitablecolspace</font>
<font color="#009900">	\fi</font>
<font color="#009900">       % In either case we will make \leftskip=\multitablecolspace:</font>
<font color="#009900">      \leftskip=\multitablecolspace</font>
<font color="#009900">      \fi</font>
<font color="#009900">      % Ignoring space at the beginning and end avoids an occasional spurious</font>
<font color="#009900">      % blank line, when TeX decides to break the line at the space before the</font>
<font color="#009900">      % box from the multistrut, so the strut ends up on a line by itself.</font>
<font color="#009900">      % For example:</font>
<font color="#009900">      % @multitable @columnfractions .11 .89</font>
<font color="#009900">      % @item @code{#}</font>
<font color="#009900">      % @tab Legal holiday which is valid in major parts of the whole country.</font>
<font color="#009900">      % Is automatically provided with highlighting sequences respectively</font>
<font color="#009900">      % marking characters.</font>
<font color="#009900">      \noindent\ignorespaces##\unskip\multistrut</font>
<font color="#009900">    }\cr</font>
<font color="#009900">}</font>
<font color="#009900">\def\Emultitable{%</font>
<font color="#009900">  \crcr</font>
<font color="#009900">  \egroup % end the \halign</font>
<font color="#009900">  \global\setpercentfalse</font>
<font color="#009900">}</font>

<font color="#009900">\def\setmultitablespacing{%</font>
<font color="#009900">  \def\multistrut{\strut}% just use the standard line spacing</font>
<font color="#009900">  %</font>
<font color="#009900">  % Compute \multitablelinespace (if not defined by user) for use in</font>
<font color="#009900">  % \multitableparskip calculation.  We used define \multistrut based on</font>
<font color="#009900">  % this, but (ironically) that caused the spacing to be off.</font>
<font color="#009900">  % See bug-texinfo report from Werner Lemberg, 31 Oct 2004 12:52:20 +0100.</font>
<font color="#009900">\ifdim\multitablelinespace=0pt</font>
<font color="#009900">\setbox0=\vbox{X}\global\multitablelinespace=\the\baselineskip</font>
<font color="#009900">\global\advance\multitablelinespace by-\ht0</font>
<font color="#009900">\fi</font>
<font color="#009900">% Test to see if parskip is larger than space between lines of</font>
<font color="#009900">% table. If not, do nothing.</font>
<font color="#009900">%        If so, set to same dimension as multitablelinespace.</font>
<font color="#009900">\ifdim\multitableparskip&gt;\multitablelinespace</font>
<font color="#009900">\global\multitableparskip=\multitablelinespace</font>
<font color="#009900">\global\advance\multitableparskip-7pt % to keep parskip somewhat smaller</font>
<font color="#009900">                                      % than skip between lines in the table.</font>
<font color="#009900">\fi%</font>
<font color="#009900">\ifdim\multitableparskip=0pt</font>
<font color="#009900">\global\multitableparskip=\multitablelinespace</font>
<font color="#009900">\global\advance\multitableparskip-7pt % to keep parskip somewhat smaller</font>
<font color="#009900">                                      % than skip between lines in the table.</font>
<font color="#009900">\fi}</font>


<font color="#009900">\message{conditionals,}</font>

<font color="#009900">% @iftex, @ifnotdocbook, @ifnothtml, @ifnotinfo, @ifnotplaintext,</font>
<font color="#009900">% @ifnotxml always succeed.  They currently do nothing; we don't</font>
<font color="#009900">% attempt to check whether the conditionals are properly nested.  But we</font>
<font color="#009900">% have to remember that they are conditionals, so that @end doesn't</font>
<font color="#009900">% attempt to close an environment group.</font>
<font color="#009900">%</font>
<font color="#009900">\def\makecond#1{%</font>
<font color="#009900">  \expandafter\let\csname #1\endcsname = \relax</font>
<font color="#009900">  \expandafter\let\csname iscond.#1\endcsname = 1</font>
<font color="#009900">}</font>
<font color="#009900">\makecond{iftex}</font>
<font color="#009900">\makecond{ifnotdocbook}</font>
<font color="#009900">\makecond{ifnothtml}</font>
<font color="#009900">\makecond{ifnotinfo}</font>
<font color="#009900">\makecond{ifnotplaintext}</font>
<font color="#009900">\makecond{ifnotxml}</font>

<font color="#009900">% Ignore @ignore, @ifhtml, @ifinfo, and the like.</font>
<font color="#009900">%</font>
<font color="#009900">\def\direntry{\doignore{direntry}}</font>
<font color="#009900">\def\documentdescription{\doignore{documentdescription}}</font>
<font color="#009900">\def\docbook{\doignore{docbook}}</font>
<font color="#009900">\def\html{\doignore{html}}</font>
<font color="#009900">\def\ifdocbook{\doignore{ifdocbook}}</font>
<font color="#009900">\def\ifhtml{\doignore{ifhtml}}</font>
<font color="#009900">\def\ifinfo{\doignore{ifinfo}}</font>
<font color="#009900">\def\ifnottex{\doignore{ifnottex}}</font>
<font color="#009900">\def\ifplaintext{\doignore{ifplaintext}}</font>
<font color="#009900">\def\ifxml{\doignore{ifxml}}</font>
<font color="#009900">\def\ignore{\doignore{ignore}}</font>
<font color="#009900">\def\menu{\doignore{menu}}</font>
<font color="#009900">\def\xml{\doignore{xml}}</font>

<font color="#009900">% Ignore text until a line `@end #1', keeping track of nested conditionals.</font>
<font color="#009900">%</font>
<font color="#009900">% A count to remember the depth of nesting.</font>
<font color="#009900">\newcount\doignorecount</font>

<font color="#009900">\def\doignore#1{\begingroup</font>
<font color="#009900">  % Scan in ``verbatim'' mode:</font>
<font color="#009900">  \obeylines</font>
<font color="#009900">  \catcode`\@ = \other</font>
<font color="#009900">  \catcode`\{ = \other</font>
<font color="#009900">  \catcode`\} = \other</font>
<font color="#009900">  %</font>
<font color="#009900">  % Make sure that spaces turn into tokens that match what \doignoretext wants.</font>
<font color="#009900">  \spaceisspace</font>
<font color="#009900">  %</font>
<font color="#009900">  % Count number of #1's that we've seen.</font>
<font color="#009900">  \doignorecount = 0</font>
<font color="#009900">  %</font>
<font color="#009900">  % Swallow text until we reach the matching `@end #1'.</font>
<font color="#009900">  \dodoignore{#1}%</font>
<font color="#009900">}</font>

<font color="#009900">{ \catcode`_=11 % We want to use \_STOP_ which cannot appear in texinfo source.</font>
<font color="#009900">  \obeylines %</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef\dodoignore#1{%</font>
<font color="#009900">    % #1 contains the command name as a string, e.g., `ifinfo'.</font>
<font color="#009900">    %</font>
<font color="#009900">    % Define a command to find the next `@end #1'.</font>
<font color="#009900">    \long\def\doignoretext##1^^M@end #1{%</font>
<font color="#009900">      \doignoretextyyy##1^^M@#1\_STOP_}%</font>
<font color="#009900">    %</font>
<font color="#009900">    % And this command to find another #1 command, at the beginning of a</font>
<font color="#009900">    % line.  (Otherwise, we would consider a line `@c @ifset', for</font>
<font color="#009900">    % example, to count as an @ifset for nesting.)</font>
<font color="#009900">    \long\def\doignoretextyyy##1^^M@#1##2\_STOP_{\doignoreyyy{##2}\_STOP_}%</font>
<font color="#009900">    %</font>
<font color="#009900">    % And now expand that command.</font>
<font color="#009900">    \doignoretext ^^M%</font>
<font color="#009900">  }%</font>
<font color="#009900">}</font>

<font color="#009900">\def\doignoreyyy#1{%</font>
<font color="#009900">  \def\temp{#1}%</font>
<font color="#009900">  \ifx\temp\empty			% Nothing found.</font>
<font color="#009900">    \let\next\doignoretextzzz</font>
<font color="#009900">  \else					% Found a nested condition, ...</font>
<font color="#009900">    \advance\doignorecount by 1</font>
<font color="#009900">    \let\next\doignoretextyyy		% ..., look for another.</font>
<font color="#009900">    % If we're here, #1 ends with ^^M\ifinfo (for example).</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \next #1% the token \_STOP_ is present just after this macro.</font>
<font color="#009900">}</font>

<font color="#009900">% We have to swallow the remaining "\_STOP_".</font>
<font color="#009900">%</font>
<font color="#009900">\def\doignoretextzzz#1{%</font>
<font color="#009900">  \ifnum\doignorecount = 0	% We have just found the outermost @end.</font>
<font color="#009900">    \let\next\enddoignore</font>
<font color="#009900">  \else				% Still inside a nested condition.</font>
<font color="#009900">    \advance\doignorecount by -1</font>
<font color="#009900">    \let\next\doignoretext      % Look for the next @end.</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \next</font>
<font color="#009900">}</font>

<font color="#009900">% Finish off ignored text.</font>
<font color="#009900">{ \obeylines%</font>
<font color="#009900">  % Ignore anything after the last `@end #1'; this matters in verbatim</font>
<font color="#009900">  % environments, where otherwise the newline after an ignored conditional</font>
<font color="#009900">  % would result in a blank line in the output.</font>
<font color="#009900">  \gdef\enddoignore#1^^M{\endgroup\ignorespaces}%</font>
<font color="#009900">}</font>


<font color="#009900">% @set VAR sets the variable VAR to an empty value.</font>
<font color="#009900">% @set VAR REST-OF-LINE sets VAR to the value REST-OF-LINE.</font>
<font color="#009900">%</font>
<font color="#009900">% Since we want to separate VAR from REST-OF-LINE (which might be</font>
<font color="#009900">% empty), we can't just use \parsearg; we have to insert a space of our</font>
<font color="#009900">% own to delimit the rest of the line, and then take it out again if we</font>
<font color="#009900">% didn't need it.</font>
<font color="#009900">% We rely on the fact that \parsearg sets \catcode`\ =10.</font>
<font color="#009900">%</font>
<font color="#009900">\parseargdef\set{\setyyy#1 \endsetyyy}</font>
<font color="#009900">\def\setyyy#1 #2\endsetyyy{%</font>
<font color="#009900">  {%</font>
<font color="#009900">    \makevalueexpandable</font>
<font color="#009900">    \def\temp{#2}%</font>
<font color="#009900">    \edef\next{\gdef\makecsname{SET#1}}%</font>
<font color="#009900">    \ifx\temp\empty</font>
<font color="#009900">      \next{}%</font>
<font color="#009900">    \else</font>
<font color="#009900">      \setzzz#2\endsetzzz</font>
<font color="#009900">    \fi</font>
<font color="#009900">  }%</font>
<font color="#009900">}</font>
<font color="#009900">% Remove the trailing space \setxxx inserted.</font>
<font color="#009900">\def\setzzz#1 \endsetzzz{\next{#1}}</font>

<font color="#009900">% @clear VAR clears (i.e., unsets) the variable VAR.</font>
<font color="#009900">%</font>
<font color="#009900">\parseargdef\clear{%</font>
<font color="#009900">  {%</font>
<font color="#009900">    \makevalueexpandable</font>
<font color="#009900">    \global\expandafter\let\csname SET#1\endcsname=\relax</font>
<font color="#009900">  }%</font>
<font color="#009900">}</font>

<font color="#009900">% @value{foo} gets the text saved in variable foo.</font>
<font color="#009900">\def\value{\begingroup\makevalueexpandable\valuexxx}</font>
<font color="#009900">\def\valuexxx#1{\expandablevalue{#1}\endgroup}</font>
<font color="#009900">{</font>
<font color="#009900">  \catcode`\- = \active \catcode`\_ = \active</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef\makevalueexpandable{%</font>
<font color="#009900">    \let\value = \expandablevalue</font>
<font color="#009900">    % We don't want these characters active, ...</font>
<font color="#009900">    \catcode`\-=\other \catcode`\_=\other</font>
<font color="#009900">    % ..., but we might end up with active ones in the argument if</font>
<font color="#009900">    % we're called from @code, as @code{@value{foo-bar_}}, though.</font>
<font color="#009900">    % So \let them to their normal equivalents.</font>
<font color="#009900">    \let-\realdash \let_\normalunderscore</font>
<font color="#009900">  }</font>
<font color="#009900">}</font>

<font color="#009900">% We have this subroutine so that we can handle at least some @value's</font>
<font color="#009900">% properly in indexes (we call \makevalueexpandable in \indexdummies).</font>
<font color="#009900">% The command has to be fully expandable (if the variable is set), since</font>
<font color="#009900">% the result winds up in the index file.  This means that if the</font>
<font color="#009900">% variable's value contains other Texinfo commands, it's almost certain</font>
<font color="#009900">% it will fail (although perhaps we could fix that with sufficient work</font>
<font color="#009900">% to do a one-level expansion on the result, instead of complete).</font>
<font color="#009900">%</font>
<font color="#009900">\def\expandablevalue#1{%</font>
<font color="#009900">  \expandafter\ifx\csname SET#1\endcsname\relax</font>
<font color="#009900">    {[No value for ``#1'']}%</font>
<font color="#009900">    \message{Variable `#1', used in @value, is not set.}%</font>
<font color="#009900">  \else</font>
<font color="#009900">    \csname SET#1\endcsname</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% @ifset VAR ... @end ifset reads the `...' iff VAR has been defined</font>
<font color="#009900">% with @set.</font>
<font color="#009900">%</font>
<font color="#009900">% To get special treatment of `@end ifset,' call \makeond and the redefine.</font>
<font color="#009900">%</font>
<font color="#009900">\makecond{ifset}</font>
<font color="#009900">\def\ifset{\parsearg{\doifset{\let\next=\ifsetfail}}}</font>
<font color="#009900">\def\doifset#1#2{%</font>
<font color="#009900">  {%</font>
<font color="#009900">    \makevalueexpandable</font>
<font color="#009900">    \let\next=\empty</font>
<font color="#009900">    \expandafter\ifx\csname SET#2\endcsname\relax</font>
<font color="#009900">      #1% If not set, redefine \next.</font>
<font color="#009900">    \fi</font>
<font color="#009900">    \expandafter</font>
<font color="#009900">  }\next</font>
<font color="#009900">}</font>
<font color="#009900">\def\ifsetfail{\doignore{ifset}}</font>

<font color="#009900">% @ifclear VAR ... @end ifclear reads the `...' iff VAR has never been</font>
<font color="#009900">% defined with @set, or has been undefined with @clear.</font>
<font color="#009900">%</font>
<font color="#009900">% The `\else' inside the `\doifset' parameter is a trick to reuse the</font>
<font color="#009900">% above code: if the variable is not set, do nothing, if it is set,</font>
<font color="#009900">% then redefine \next to \ifclearfail.</font>
<font color="#009900">%</font>
<font color="#009900">\makecond{ifclear}</font>
<font color="#009900">\def\ifclear{\parsearg{\doifset{\else \let\next=\ifclearfail}}}</font>
<font color="#009900">\def\ifclearfail{\doignore{ifclear}}</font>

<font color="#009900">% @dircategory CATEGORY  -- specify a category of the dir file</font>
<font color="#009900">% which this file should belong to.  Ignore this in TeX.</font>
<font color="#009900">\let\dircategory=\comment</font>

<font color="#009900">% @defininfoenclose.</font>
<font color="#009900">\let\definfoenclose=\comment</font>


<font color="#009900">\message{indexing,}</font>
<font color="#009900">% Index generation facilities</font>

<font color="#009900">% Define \newwrite to be identical to plain tex's \newwrite</font>
<font color="#009900">% except not \outer, so it can be used within macros and \if's.</font>
<font color="#009900">\edef\newwrite{\makecsname{ptexnewwrite}}</font>

<font color="#009900">% \newindex {foo} defines an index named foo.</font>
<font color="#009900">% It automatically defines \fooindex such that</font>
<font color="#009900">% \fooindex ...rest of line... puts an entry in the index foo.</font>
<font color="#009900">% It also defines \fooindfile to be the number of the output channel for</font>
<font color="#009900">% the file that accumulates this index.  The file's extension is foo.</font>
<font color="#009900">% The name of an index should be no more than 2 characters long</font>
<font color="#009900">% for the sake of vms.</font>
<font color="#009900">%</font>
<font color="#009900">\def\newindex#1{%</font>
<font color="#009900">  \iflinks</font>
<font color="#009900">    \expandafter\newwrite \csname#1indfile\endcsname</font>
<font color="#009900">    \openout \csname#1indfile\endcsname \jobname.#1 % Open the file</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \expandafter\xdef\csname#1index\endcsname{%     % Define @#1index</font>
<font color="#009900">    \noexpand\doindex{#1}}</font>
<font color="#009900">}</font>

<font color="#009900">% @defindex foo  ==  \newindex{foo}</font>
<font color="#009900">%</font>
<font color="#009900">\def\defindex{\parsearg\newindex}</font>

<font color="#009900">% Define @defcodeindex, like @defindex except put all entries in @code.</font>
<font color="#009900">%</font>
<font color="#009900">\def\defcodeindex{\parsearg\newcodeindex}</font>
<font color="#009900">%</font>
<font color="#009900">\def\newcodeindex#1{%</font>
<font color="#009900">  \iflinks</font>
<font color="#009900">    \expandafter\newwrite \csname#1indfile\endcsname</font>
<font color="#009900">    \openout \csname#1indfile\endcsname \jobname.#1</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \expandafter\xdef\csname#1index\endcsname{%</font>
<font color="#009900">    \noexpand\docodeindex{#1}}%</font>
<font color="#009900">}</font>


<font color="#009900">% @synindex foo bar    makes index foo feed into index bar.</font>
<font color="#009900">% Do this instead of @defindex foo if you don't want it as a separate index.</font>
<font color="#009900">%</font>
<font color="#009900">% @syncodeindex foo bar   similar, but put all entries made for index foo</font>
<font color="#009900">% inside @code.</font>
<font color="#009900">%</font>
<font color="#009900">\def\synindex#1 #2 {\dosynindex\doindex{#1}{#2}}</font>
<font color="#009900">\def\syncodeindex#1 #2 {\dosynindex\docodeindex{#1}{#2}}</font>

<font color="#009900">% #1 is \doindex or \docodeindex, #2 the index getting redefined (foo),</font>
<font color="#009900">% #3 the target index (bar).</font>
<font color="#009900">\def\dosynindex#1#2#3{%</font>
<font color="#009900">  % Only do \closeout if we haven't already done it, else we'll end up</font>
<font color="#009900">  % closing the target index.</font>
<font color="#009900">  \expandafter \ifx\csname donesynindex#2\endcsname \relax</font>
<font color="#009900">    % The \closeout helps reduce unnecessary open files; the limit on the</font>
<font color="#009900">    % Acorn RISC OS is a mere 16 files.</font>
<font color="#009900">    \expandafter\closeout\csname#2indfile\endcsname</font>
<font color="#009900">    \expandafter\let\csname donesynindex#2\endcsname = 1</font>
<font color="#009900">  \fi</font>
<font color="#009900">  % redefine \fooindfile:</font>
<font color="#009900">  \expandafter\let\expandafter\temp\expandafter=\csname#3indfile\endcsname</font>
<font color="#009900">  \expandafter\let\csname#2indfile\endcsname=\temp</font>
<font color="#009900">  % redefine \fooindex:</font>
<font color="#009900">  \expandafter\xdef\csname#2index\endcsname{\noexpand#1{#3}}%</font>
<font color="#009900">}</font>

<font color="#009900">% Define \doindex, the driver for all \fooindex macros.</font>
<font color="#009900">% Argument #1 is generated by the calling \fooindex macro,</font>
<font color="#009900">%  and it is "foo", the name of the index.</font>

<font color="#009900">% \doindex just uses \parsearg; it calls \doind for the actual work.</font>
<font color="#009900">% This is because \doind is more useful to call from other macros.</font>

<font color="#009900">% There is also \dosubind {index}{topic}{subtopic}</font>
<font color="#009900">% which makes an entry in a two-level index such as the operation index.</font>

<font color="#009900">\def\doindex#1{\edef\indexname{#1}\parsearg\singleindexer}</font>
<font color="#009900">\def\singleindexer #1{\doind{\indexname}{#1}}</font>

<font color="#009900">% like the previous two, but they put @code around the argument.</font>
<font color="#009900">\def\docodeindex#1{\edef\indexname{#1}\parsearg\singlecodeindexer}</font>
<font color="#009900">\def\singlecodeindexer #1{\doind{\indexname}{\code{#1}}}</font>

<font color="#009900">% Take care of Texinfo commands that can appear in an index entry.</font>
<font color="#009900">% Since there are some commands we want to expand, and others we don't,</font>
<font color="#009900">% we have to laboriously prevent expansion for those that we don't.</font>
<font color="#009900">%</font>
<font color="#009900">\def\indexdummies{%</font>
<font color="#009900">  \escapechar = `\\     % use backslash in output files.</font>
<font color="#009900">  \def\@{@}% change to @@ when we switch to @ as escape char in index files.</font>
<font color="#009900">  \def\ {\realbackslash\space }%</font>
<font color="#009900">  %</font>
<font color="#009900">  % Need these unexpandable (because we define \tt as a dummy)</font>
<font color="#009900">  % definitions when @{ or @} appear in index entry text.  Also, more</font>
<font color="#009900">  % complicated, when \tex is in effect and \{ is a \delimiter again.</font>
<font color="#009900">  % We can't use \lbracecmd and \rbracecmd because texindex assumes</font>
<font color="#009900">  % braces and backslashes are used only as delimiters.  Perhaps we</font>
<font color="#009900">  % should define @lbrace and @rbrace commands a la @comma.</font>
<font color="#009900">  \def\{{{\tt\char123}}%</font>
<font color="#009900">  \def\}{{\tt\char125}}%</font>
<font color="#009900">  %</font>
<font color="#009900">  % I don't entirely understand this, but when an index entry is</font>
<font color="#009900">  % generated from a macro call, the \endinput which \scanmacro inserts</font>
<font color="#009900">  % causes processing to be prematurely terminated.  This is,</font>
<font color="#009900">  % apparently, because \indexsorttmp is fully expanded, and \endinput</font>
<font color="#009900">  % is an expandable command.  The redefinition below makes \endinput</font>
<font color="#009900">  % disappear altogether for that purpose -- although logging shows that</font>
<font color="#009900">  % processing continues to some further point.  On the other hand, it</font>
<font color="#009900">  % seems \endinput does not hurt in the printed index arg, since that</font>
<font color="#009900">  % is still getting written without apparent harm.</font>
<font color="#009900">  %</font>
<font color="#009900">  % Sample source (mac-idx3.tex, reported by Graham Percival to</font>
<font color="#009900">  % help-texinfo, 22may06):</font>
<font color="#009900">  % @macro funindex {WORD}</font>
<font color="#009900">  % @findex xyz</font>
<font color="#009900">  % @end macro</font>
<font color="#009900">  % ...</font>
<font color="#009900">  % @funindex commtest</font>
<font color="#009900">  %</font>
<font color="#009900">  % The above is not enough to reproduce the bug, but it gives the flavor.</font>
<font color="#009900">  %</font>
<font color="#009900">  % Sample whatsit resulting:</font>
<font color="#009900">  % .@write3{\entry{xyz}{@folio }{@code {xyz@endinput }}}</font>
<font color="#009900">  %</font>
<font color="#009900">  % So:</font>
<font color="#009900">  \let\endinput = \empty</font>
<font color="#009900">  %</font>
<font color="#009900">  % Do the redefinitions.</font>
<font color="#009900">  \commondummies</font>
<font color="#009900">}</font>

<font color="#009900">% For the aux and toc files, @ is the escape character.  So we want to</font>
<font color="#009900">% redefine everything using @ as the escape character (instead of</font>
<font color="#009900">% \realbackslash, still used for index files).  When everything uses @,</font>
<font color="#009900">% this will be simpler.</font>
<font color="#009900">%</font>
<font color="#009900">\def\atdummies{%</font>
<font color="#009900">  \def\@{@@}%</font>
<font color="#009900">  \def\ {@ }%</font>
<font color="#009900">  \let\{ = \lbraceatcmd</font>
<font color="#009900">  \let\} = \rbraceatcmd</font>
<font color="#009900">  %</font>
<font color="#009900">  % Do the redefinitions.</font>
<font color="#009900">  \commondummies</font>
<font color="#009900">  \otherbackslash</font>
<font color="#009900">}</font>

<font color="#009900">% Called from \indexdummies and \atdummies.</font>
<font color="#009900">%</font>
<font color="#009900">\def\commondummies{%</font>
<font color="#009900">  %</font>
<font color="#009900">  % \definedummyword defines \#1 as \string\#1\space, thus effectively</font>
<font color="#009900">  % preventing its expansion.  This is used only for control words,</font>
<font color="#009900">  % not control letters, because the \space would be incorrect for</font>
<font color="#009900">  % control characters, but is needed to separate the control word</font>
<font color="#009900">  % from whatever follows.</font>
<font color="#009900">  %</font>
<font color="#009900">  % For control letters, we have \definedummyletter, which omits the</font>
<font color="#009900">  % space.</font>
<font color="#009900">  %</font>
<font color="#009900">  % These can be used both for control words that take an argument and</font>
<font color="#009900">  % those that do not.  If it is followed by {arg} in the input, then</font>
<font color="#009900">  % that will dutifully get written to the index (or wherever).</font>
<font color="#009900">  %</font>
<font color="#009900">  \def\definedummyword  ##1{\def##1{\string##1\space}}%</font>
<font color="#009900">  \def\definedummyletter##1{\def##1{\string##1}}%</font>
<font color="#009900">  \let\definedummyaccent\definedummyletter</font>
<font color="#009900">  %</font>
<font color="#009900">  \commondummiesnofonts</font>
<font color="#009900">  %</font>
<font color="#009900">  \definedummyletter\_%</font>
<font color="#009900">  \definedummyletter\-%</font>
<font color="#009900">  %</font>
<font color="#009900">  % Non-English letters.</font>
<font color="#009900">  \definedummyword\AA</font>
<font color="#009900">  \definedummyword\AE</font>
<font color="#009900">  \definedummyword\DH</font>
<font color="#009900">  \definedummyword\L</font>
<font color="#009900">  \definedummyword\O</font>
<font color="#009900">  \definedummyword\OE</font>
<font color="#009900">  \definedummyword\TH</font>
<font color="#009900">  \definedummyword\aa</font>
<font color="#009900">  \definedummyword\ae</font>
<font color="#009900">  \definedummyword\dh</font>
<font color="#009900">  \definedummyword\exclamdown</font>
<font color="#009900">  \definedummyword\l</font>
<font color="#009900">  \definedummyword\o</font>
<font color="#009900">  \definedummyword\oe</font>
<font color="#009900">  \definedummyword\ordf</font>
<font color="#009900">  \definedummyword\ordm</font>
<font color="#009900">  \definedummyword\questiondown</font>
<font color="#009900">  \definedummyword\ss</font>
<font color="#009900">  \definedummyword\th</font>
<font color="#009900">  %</font>
<font color="#009900">  % Although these internal commands shouldn't show up, sometimes they do.</font>
<font color="#009900">  \definedummyword\bf</font>
<font color="#009900">  \definedummyword\gtr</font>
<font color="#009900">  \definedummyword\hat</font>
<font color="#009900">  \definedummyword\less</font>
<font color="#009900">  \definedummyword\sf</font>
<font color="#009900">  \definedummyword\sl</font>
<font color="#009900">  \definedummyword\tclose</font>
<font color="#009900">  \definedummyword\tt</font>
<font color="#009900">  %</font>
<font color="#009900">  \definedummyword\LaTeX</font>
<font color="#009900">  \definedummyword\TeX</font>
<font color="#009900">  %</font>
<font color="#009900">  % Assorted special characters.</font>
<font color="#009900">  \definedummyword\arrow</font>
<font color="#009900">  \definedummyword\bullet</font>
<font color="#009900">  \definedummyword\comma</font>
<font color="#009900">  \definedummyword\copyright</font>
<font color="#009900">  \definedummyword\registeredsymbol</font>
<font color="#009900">  \definedummyword\dots</font>
<font color="#009900">  \definedummyword\enddots</font>
<font color="#009900">  \definedummyword\entrybreak</font>
<font color="#009900">  \definedummyword\equiv</font>
<font color="#009900">  \definedummyword\error</font>
<font color="#009900">  \definedummyword\euro</font>
<font color="#009900">  \definedummyword\expansion</font>
<font color="#009900">  \definedummyword\geq</font>
<font color="#009900">  \definedummyword\guillemetleft</font>
<font color="#009900">  \definedummyword\guillemetright</font>
<font color="#009900">  \definedummyword\guilsinglleft</font>
<font color="#009900">  \definedummyword\guilsinglright</font>
<font color="#009900">  \definedummyword\leq</font>
<font color="#009900">  \definedummyword\minus</font>
<font color="#009900">  \definedummyword\ogonek</font>
<font color="#009900">  \definedummyword\pounds</font>
<font color="#009900">  \definedummyword\point</font>
<font color="#009900">  \definedummyword\print</font>
<font color="#009900">  \definedummyword\quotedblbase</font>
<font color="#009900">  \definedummyword\quotedblleft</font>
<font color="#009900">  \definedummyword\quotedblright</font>
<font color="#009900">  \definedummyword\quoteleft</font>
<font color="#009900">  \definedummyword\quoteright</font>
<font color="#009900">  \definedummyword\quotesinglbase</font>
<font color="#009900">  \definedummyword\result</font>
<font color="#009900">  \definedummyword\textdegree</font>
<font color="#009900">  %</font>
<font color="#009900">  % We want to disable all macros so that they are not expanded by \write.</font>
<font color="#009900">  \macrolist</font>
<font color="#009900">  %</font>
<font color="#009900">  \normalturnoffactive</font>
<font color="#009900">  %</font>
<font color="#009900">  % Handle some cases of @value -- where it does not contain any</font>
<font color="#009900">  % (non-fully-expandable) commands.</font>
<font color="#009900">  \makevalueexpandable</font>
<font color="#009900">}</font>

<font color="#009900">% \commondummiesnofonts: common to \commondummies and \indexnofonts.</font>
<font color="#009900">%</font>
<font color="#009900">\def\commondummiesnofonts{%</font>
<font color="#009900">  % Control letters and accents.</font>
<font color="#009900">  \definedummyletter\!%</font>
<font color="#009900">  \definedummyaccent\"%</font>
<font color="#009900">  \definedummyaccent\'%</font>
<font color="#009900">  \definedummyletter\*%</font>
<font color="#009900">  \definedummyaccent\,%</font>
<font color="#009900">  \definedummyletter\.%</font>
<font color="#009900">  \definedummyletter\/%</font>
<font color="#009900">  \definedummyletter\:%</font>
<font color="#009900">  \definedummyaccent\=%</font>
<font color="#009900">  \definedummyletter\?%</font>
<font color="#009900">  \definedummyaccent\^%</font>
<font color="#009900">  \definedummyaccent\`%</font>
<font color="#009900">  \definedummyaccent\~%</font>
<font color="#009900">  \definedummyword\u</font>
<font color="#009900">  \definedummyword\v</font>
<font color="#009900">  \definedummyword\H</font>
<font color="#009900">  \definedummyword\dotaccent</font>
<font color="#009900">  \definedummyword\ogonek</font>
<font color="#009900">  \definedummyword\ringaccent</font>
<font color="#009900">  \definedummyword\tieaccent</font>
<font color="#009900">  \definedummyword\ubaraccent</font>
<font color="#009900">  \definedummyword\udotaccent</font>
<font color="#009900">  \definedummyword\dotless</font>
<font color="#009900">  %</font>
<font color="#009900">  % Texinfo font commands.</font>
<font color="#009900">  \definedummyword\b</font>
<font color="#009900">  \definedummyword\i</font>
<font color="#009900">  \definedummyword\r</font>
<font color="#009900">  \definedummyword\sansserif</font>
<font color="#009900">  \definedummyword\sc</font>
<font color="#009900">  \definedummyword\slanted</font>
<font color="#009900">  \definedummyword\t</font>
<font color="#009900">  %</font>
<font color="#009900">  % Commands that take arguments.</font>
<font color="#009900">  \definedummyword\acronym</font>
<font color="#009900">  \definedummyword\anchor</font>
<font color="#009900">  \definedummyword\cite</font>
<font color="#009900">  \definedummyword\code</font>
<font color="#009900">  \definedummyword\command</font>
<font color="#009900">  \definedummyword\dfn</font>
<font color="#009900">  \definedummyword\dmn</font>
<font color="#009900">  \definedummyword\email</font>
<font color="#009900">  \definedummyword\emph</font>
<font color="#009900">  \definedummyword\env</font>
<font color="#009900">  \definedummyword\file</font>
<font color="#009900">  \definedummyword\indicateurl</font>
<font color="#009900">  \definedummyword\kbd</font>
<font color="#009900">  \definedummyword\key</font>
<font color="#009900">  \definedummyword\math</font>
<font color="#009900">  \definedummyword\option</font>
<font color="#009900">  \definedummyword\pxref</font>
<font color="#009900">  \definedummyword\ref</font>
<font color="#009900">  \definedummyword\samp</font>
<font color="#009900">  \definedummyword\strong</font>
<font color="#009900">  \definedummyword\tie</font>
<font color="#009900">  \definedummyword\uref</font>
<font color="#009900">  \definedummyword\url</font>
<font color="#009900">  \definedummyword\var</font>
<font color="#009900">  \definedummyword\verb</font>
<font color="#009900">  \definedummyword\w</font>
<font color="#009900">  \definedummyword\xref</font>
<font color="#009900">}</font>

<font color="#009900">% \indexnofonts is used when outputting the strings to sort the index</font>
<font color="#009900">% by, and when constructing control sequence names.  It eliminates all</font>
<font color="#009900">% control sequences and just writes whatever the best ASCII sort string</font>
<font color="#009900">% would be for a given command (usually its argument).</font>
<font color="#009900">%</font>
<font color="#009900">\def\indexnofonts{%</font>
<font color="#009900">  % Accent commands should become @asis.</font>
<font color="#009900">  \def\definedummyaccent##1{\let##1\asis}%</font>
<font color="#009900">  % We can just ignore other control letters.</font>
<font color="#009900">  \def\definedummyletter##1{\let##1\empty}%</font>
<font color="#009900">  % All control words become @asis by default; overrides below.</font>
<font color="#009900">  \let\definedummyword\definedummyaccent</font>
<font color="#009900">  %</font>
<font color="#009900">  \commondummiesnofonts</font>
<font color="#009900">  %</font>
<font color="#009900">  % Don't no-op \tt, since it isn't a user-level command</font>
<font color="#009900">  % and is used in the definitions of the active chars like &lt;, &gt;, |, etc.</font>
<font color="#009900">  % Likewise with the other plain tex font commands.</font>
<font color="#009900">  %\let\tt=\asis</font>
<font color="#009900">  %</font>
<font color="#009900">  \def\ { }%</font>
<font color="#009900">  \def\@{@}%</font>
<font color="#009900">  \def\_{\normalunderscore}%</font>
<font color="#009900">  \def\-{}% @- shouldn't affect sorting</font>
<font color="#009900">  %</font>
<font color="#009900">  % Unfortunately, texindex is not prepared to handle braces in the</font>
<font color="#009900">  % content at all.  So for index sorting, we map @{ and @} to strings</font>
<font color="#009900">  % starting with |, since that ASCII character is between ASCII { and }.</font>
<font color="#009900">  \def\{{|a}%</font>
<font color="#009900">  \def\}{|b}%</font>
<font color="#009900">  %</font>
<font color="#009900">  % Non-English letters.</font>
<font color="#009900">  \def\AA{AA}%</font>
<font color="#009900">  \def\AE{AE}%</font>
<font color="#009900">  \def\DH{DZZ}%</font>
<font color="#009900">  \def\L{L}%</font>
<font color="#009900">  \def\OE{OE}%</font>
<font color="#009900">  \def\O{O}%</font>
<font color="#009900">  \def\TH{ZZZ}%</font>
<font color="#009900">  \def\aa{aa}%</font>
<font color="#009900">  \def\ae{ae}%</font>
<font color="#009900">  \def\dh{dzz}%</font>
<font color="#009900">  \def\exclamdown{!}%</font>
<font color="#009900">  \def\l{l}%</font>
<font color="#009900">  \def\oe{oe}%</font>
<font color="#009900">  \def\ordf{a}%</font>
<font color="#009900">  \def\ordm{o}%</font>
<font color="#009900">  \def\o{o}%</font>
<font color="#009900">  \def\questiondown{?}%</font>
<font color="#009900">  \def\ss{ss}%</font>
<font color="#009900">  \def\th{zzz}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \def\LaTeX{LaTeX}%</font>
<font color="#009900">  \def\TeX{TeX}%</font>
<font color="#009900">  %</font>
<font color="#009900">  % Assorted special characters.</font>
<font color="#009900">  % (The following {} will end up in the sort string, but that's ok.)</font>
<font color="#009900">  \def\arrow{-&gt;}%</font>
<font color="#009900">  \def\bullet{bullet}%</font>
<font color="#009900">  \def\comma{,}%</font>
<font color="#009900">  \def\copyright{copyright}%</font>
<font color="#009900">  \def\dots{...}%</font>
<font color="#009900">  \def\enddots{...}%</font>
<font color="#009900">  \def\equiv{==}%</font>
<font color="#009900">  \def\error{error}%</font>
<font color="#009900">  \def\euro{euro}%</font>
<font color="#009900">  \def\expansion{==&gt;}%</font>
<font color="#009900">  \def\geq{&gt;=}%</font>
<font color="#009900">  \def\guillemetleft{&lt;&lt;}%</font>
<font color="#009900">  \def\guillemetright{&gt;&gt;}%</font>
<font color="#009900">  \def\guilsinglleft{&lt;}%</font>
<font color="#009900">  \def\guilsinglright{&gt;}%</font>
<font color="#009900">  \def\leq{&lt;=}%</font>
<font color="#009900">  \def\minus{-}%</font>
<font color="#009900">  \def\point{.}%</font>
<font color="#009900">  \def\pounds{pounds}%</font>
<font color="#009900">  \def\print{-|}%</font>
<font color="#009900">  \def\quotedblbase{"}%</font>
<font color="#009900">  \def\quotedblleft{"}%</font>
<font color="#009900">  \def\quotedblright{"}%</font>
<font color="#009900">  \def\quoteleft{`}%</font>
<font color="#009900">  \def\quoteright{'}%</font>
<font color="#009900">  \def\quotesinglbase{,}%</font>
<font color="#009900">  \def\registeredsymbol{R}%</font>
<font color="#009900">  \def\result{=&gt;}%</font>
<font color="#009900">  \def\textdegree{o}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \expandafter\ifx\csname SETtxiindexlquoteignore\endcsname\relax</font>
<font color="#009900">  \else \indexlquoteignore \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  % We need to get rid of all macros, leaving only the arguments (if present).</font>
<font color="#009900">  % Of course this is not nearly correct, but it is the best we can do for now.</font>
<font color="#009900">  % makeinfo does not expand macros in the argument to @deffn, which ends up</font>
<font color="#009900">  % writing an index entry, and texindex isn't prepared for an index sort entry</font>
<font color="#009900">  % that starts with \.</font>
<font color="#009900">  %</font>
<font color="#009900">  % Since macro invocations are followed by braces, we can just redefine them</font>
<font color="#009900">  % to take a single TeX argument.  The case of a macro invocation that</font>
<font color="#009900">  % goes to end-of-line is not handled.</font>
<font color="#009900">  %</font>
<font color="#009900">  \macrolist</font>
<font color="#009900">}</font>

<font color="#009900">% Undocumented (for FSFS 2nd ed.): @set txiindexlquoteignore makes us</font>
<font color="#009900">% ignore left quotes in the sort term.</font>
<font color="#009900">{\catcode`\`=\active</font>
<font color="#009900"> \gdef\indexlquoteignore{\let`=\empty}}</font>

<font color="#009900">\let\indexbackslash=0  %overridden during \printindex.</font>
<font color="#009900">\let\SETmarginindex=\relax % put index entries in margin (undocumented)?</font>

<font color="#009900">% Most index entries go through here, but \dosubind is the general case.</font>
<font color="#009900">% #1 is the index name, #2 is the entry text.</font>
<font color="#009900">\def\doind#1#2{\dosubind{#1}{#2}{}}</font>

<font color="#009900">% Workhorse for all \fooindexes.</font>
<font color="#009900">% #1 is name of index, #2 is stuff to put there, #3 is subentry --</font>
<font color="#009900">% empty if called from \doind, as we usually are (the main exception</font>
<font color="#009900">% is with most defuns, which call us directly).</font>
<font color="#009900">%</font>
<font color="#009900">\def\dosubind#1#2#3{%</font>
<font color="#009900">  \iflinks</font>
<font color="#009900">  {%</font>
<font color="#009900">    % Store the main index entry text (including the third arg).</font>
<font color="#009900">    \toks0 = {#2}%</font>
<font color="#009900">    % If third arg is present, precede it with a space.</font>
<font color="#009900">    \def\thirdarg{#3}%</font>
<font color="#009900">    \ifx\thirdarg\empty \else</font>
<font color="#009900">      \toks0 = \expandafter{\the\toks0 \space #3}%</font>
<font color="#009900">    \fi</font>
<font color="#009900">    %</font>
<font color="#009900">    \edef\writeto{\csname#1indfile\endcsname}%</font>
<font color="#009900">    %</font>
<font color="#009900">    \safewhatsit\dosubindwrite</font>
<font color="#009900">  }%</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% Write the entry in \toks0 to the index file:</font>
<font color="#009900">%</font>
<font color="#009900">\def\dosubindwrite{%</font>
<font color="#009900">  % Put the index entry in the margin if desired.</font>
<font color="#009900">  \ifx\SETmarginindex\relax\else</font>
<font color="#009900">    \insert\margin{\hbox{\vrule height8pt depth3pt width0pt \the\toks0}}%</font>
<font color="#009900">  \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  % Remember, we are within a group.</font>
<font color="#009900">  \indexdummies % Must do this here, since \bf, etc expand at this stage</font>
<font color="#009900">  \def\backslashcurfont{\indexbackslash}% \indexbackslash isn't defined now</font>
<font color="#009900">      % so it will be output as is; and it will print as backslash.</font>
<font color="#009900">  %</font>
<font color="#009900">  % Process the index entry with all font commands turned off, to</font>
<font color="#009900">  % get the string to sort by.</font>
<font color="#009900">  {\indexnofonts</font>
<font color="#009900">   \edef\temp{\the\toks0}% need full expansion</font>
<font color="#009900">   \xdef\indexsorttmp{\temp}%</font>
<font color="#009900">  }%</font>
<font color="#009900">  %</font>
<font color="#009900">  % Set up the complete index entry, with both the sort key and</font>
<font color="#009900">  % the original text, including any font commands.  We write</font>
<font color="#009900">  % three arguments to \entry to the .?? file (four in the</font>
<font color="#009900">  % subentry case), texindex reduces to two when writing the .??s</font>
<font color="#009900">  % sorted result.</font>
<font color="#009900">  \edef\temp{%</font>
<font color="#009900">    \write\writeto{%</font>
<font color="#009900">      \string\entry{\indexsorttmp}{\noexpand\folio}{\the\toks0}}%</font>
<font color="#009900">  }%</font>
<font color="#009900">  \temp</font>
<font color="#009900">}</font>

<font color="#009900">% Take care of unwanted page breaks/skips around a whatsit:</font>
<font color="#009900">%</font>
<font color="#009900">% If a skip is the last thing on the list now, preserve it</font>
<font color="#009900">% by backing up by \lastskip, doing the \write, then inserting</font>
<font color="#009900">% the skip again.  Otherwise, the whatsit generated by the</font>
<font color="#009900">% \write or \pdfdest will make \lastskip zero.  The result is that</font>
<font color="#009900">% sequences like this:</font>
<font color="#009900">% @end defun</font>
<font color="#009900">% @tindex whatever</font>
<font color="#009900">% @defun ...</font>
<font color="#009900">% will have extra space inserted, because the \medbreak in the</font>
<font color="#009900">% start of the @defun won't see the skip inserted by the @end of</font>
<font color="#009900">% the previous defun.</font>
<font color="#009900">%</font>
<font color="#009900">% But don't do any of this if we're not in vertical mode.  We</font>
<font color="#009900">% don't want to do a \vskip and prematurely end a paragraph.</font>
<font color="#009900">%</font>
<font color="#009900">% Avoid page breaks due to these extra skips, too.</font>
<font color="#009900">%</font>
<font color="#009900">% But wait, there is a catch there:</font>
<font color="#009900">% We'll have to check whether \lastskip is zero skip.  \ifdim is not</font>
<font color="#009900">% sufficient for this purpose, as it ignores stretch and shrink parts</font>
<font color="#009900">% of the skip.  The only way seems to be to check the textual</font>
<font color="#009900">% representation of the skip.</font>
<font color="#009900">%</font>
<font color="#009900">% The following is almost like \def\zeroskipmacro{0.0pt} except that</font>
<font color="#009900">% the ``p'' and ``t'' characters have catcode \other, not 11 (letter).</font>
<font color="#009900">%</font>
<font color="#009900">\edef\zeroskipmacro{\expandafter\the\csname z@skip\endcsname}</font>
<font color="#009900">%</font>
<font color="#009900">\newskip\whatsitskip</font>
<font color="#009900">\newcount\whatsitpenalty</font>
<font color="#009900">%</font>
<font color="#009900">% ..., ready, GO:</font>
<font color="#009900">%</font>
<font color="#009900">\def\safewhatsit#1{\ifhmode</font>
<font color="#009900">  #1%</font>
<font color="#009900"> \else</font>
<font color="#009900">  % \lastskip and \lastpenalty cannot both be nonzero simultaneously.</font>
<font color="#009900">  \whatsitskip = \lastskip</font>
<font color="#009900">  \edef\lastskipmacro{\the\lastskip}%</font>
<font color="#009900">  \whatsitpenalty = \lastpenalty</font>
<font color="#009900">  %</font>
<font color="#009900">  % If \lastskip is nonzero, that means the last item was a</font>
<font color="#009900">  % skip.  And since a skip is discardable, that means this</font>
<font color="#009900">  % -\whatsitskip glue we're inserting is preceded by a</font>
<font color="#009900">  % non-discardable item, therefore it is not a potential</font>
<font color="#009900">  % breakpoint, therefore no \nobreak needed.</font>
<font color="#009900">  \ifx\lastskipmacro\zeroskipmacro</font>
<font color="#009900">  \else</font>
<font color="#009900">    \vskip-\whatsitskip</font>
<font color="#009900">  \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  #1%</font>
<font color="#009900">  %</font>
<font color="#009900">  \ifx\lastskipmacro\zeroskipmacro</font>
<font color="#009900">    % If \lastskip was zero, perhaps the last item was a penalty, and</font>
<font color="#009900">    % perhaps it was &gt;=10000, e.g., a \nobreak.  In that case, we want</font>
<font color="#009900">    % to re-insert the same penalty (values &gt;10000 are used for various</font>
<font color="#009900">    % signals); since we just inserted a non-discardable item, any</font>
<font color="#009900">    % following glue (such as a \parskip) would be a breakpoint.  For example:</font>
<font color="#009900">    %   @deffn deffn-whatever</font>
<font color="#009900">    %   @vindex index-whatever</font>
<font color="#009900">    %   Description.</font>
<font color="#009900">    % would allow a break between the index-whatever whatsit</font>
<font color="#009900">    % and the "Description." paragraph.</font>
<font color="#009900">    \ifnum\whatsitpenalty&gt;9999 \penalty\whatsitpenalty \fi</font>
<font color="#009900">  \else</font>
<font color="#009900">    % On the other hand, if we had a nonzero \lastskip,</font>
<font color="#009900">    % this make-up glue would be preceded by a non-discardable item</font>
<font color="#009900">    % (the whatsit from the \write), so we must insert a \nobreak.</font>
<font color="#009900">    \nobreak\vskip\whatsitskip</font>
<font color="#009900">  \fi</font>
<font color="#009900">\fi}</font>

<font color="#009900">% The index entry written in the file actually looks like</font>
<font color="#009900">%  \entry {sortstring}{page}{topic}</font>
<font color="#009900">% or</font>
<font color="#009900">%  \entry {sortstring}{page}{topic}{subtopic}</font>
<font color="#009900">% The texindex program reads in these files and writes files</font>
<font color="#009900">% containing these kinds of lines:</font>
<font color="#009900">%  \initial {c}</font>
<font color="#009900">%     before the first topic whose initial is c</font>
<font color="#009900">%  \entry {topic}{pagelist}</font>
<font color="#009900">%     for a topic that is used without subtopics</font>
<font color="#009900">%  \primary {topic}</font>
<font color="#009900">%     for the beginning of a topic that is used with subtopics</font>
<font color="#009900">%  \secondary {subtopic}{pagelist}</font>
<font color="#009900">%     for each subtopic.</font>

<font color="#009900">% Define the user-accessible indexing commands</font>
<font color="#009900">% @findex, @vindex, @kindex, @cindex.</font>

<font color="#009900">\def\findex {\fnindex}</font>
<font color="#009900">\def\kindex {\kyindex}</font>
<font color="#009900">\def\cindex {\cpindex}</font>
<font color="#009900">\def\vindex {\vrindex}</font>
<font color="#009900">\def\tindex {\tpindex}</font>
<font color="#009900">\def\pindex {\pgindex}</font>

<font color="#009900">\def\cindexsub {\begingroup\obeylines\cindexsub}</font>
<font color="#009900">{\obeylines %</font>
<font color="#009900">\gdef\cindexsub "#1" #2^^M{\endgroup %</font>
<font color="#009900">\dosubind{cp}{#2}{#1}}}</font>

<font color="#009900">% Define the macros used in formatting output of the sorted index material.</font>

<font color="#009900">% @printindex causes a particular index (the ??s file) to get printed.</font>
<font color="#009900">% It does not print any chapter heading (usually an @unnumbered).</font>
<font color="#009900">%</font>
<font color="#009900">\parseargdef\printindex{\begingroup</font>
<font color="#009900">  \dobreak \chapheadingskip{10000}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \smallfonts \rm</font>
<font color="#009900">  \tolerance = 9500</font>
<font color="#009900">  \plainfrenchspacing</font>
<font color="#009900">  \everypar = {}% don't want the \kern\-parindent from indentation suppression.</font>
<font color="#009900">  %</font>
<font color="#009900">  % See if the index file exists and is nonempty.</font>
<font color="#009900">  % Change catcode of @ here so that if the index file contains</font>
<font color="#009900">  % \initial {@}</font>
<font color="#009900">  % as its first line, TeX doesn't complain about mismatched braces</font>
<font color="#009900">  % (because it thinks @} is a control sequence).</font>
<font color="#009900">  \catcode`\@ = 11</font>
<font color="#009900">  \openin 1 \jobname.#1s</font>
<font color="#009900">  \ifeof 1</font>
<font color="#009900">    % \enddoublecolumns gets confused if there is no text in the index,</font>
<font color="#009900">    % and it loses the chapter title and the aux file entries for the</font>
<font color="#009900">    % index.  The easiest way to prevent this problem is to make sure</font>
<font color="#009900">    % there is some text.</font>
<font color="#009900">    \putwordIndexNonexistent</font>
<font color="#009900">  \else</font>
<font color="#009900">    %</font>
<font color="#009900">    % If the index file exists but is empty, then \openin leaves \ifeof</font>
<font color="#009900">    % false.  We have to make TeX try to read something from the file, so</font>
<font color="#009900">    % it can discover if there is anything in it.</font>
<font color="#009900">    \read 1 to \temp</font>
<font color="#009900">    \ifeof 1</font>
<font color="#009900">      \putwordIndexIsEmpty</font>
<font color="#009900">    \else</font>
<font color="#009900">      % Index files are almost Texinfo source, but we use \ as the escape</font>
<font color="#009900">      % character.  It would be better to use @, but that's too big a change</font>
<font color="#009900">      % to make right now.</font>
<font color="#009900">      \def\indexbackslash{\backslashcurfont}%</font>
<font color="#009900">      \catcode`\\ = 0</font>
<font color="#009900">      \escapechar = `\\</font>
<font color="#009900">      \begindoublecolumns</font>
<font color="#009900">      \input \jobname.#1s</font>
<font color="#009900">      \enddoublecolumns</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \closein 1</font>
<font color="#009900">\endgroup}</font>

<font color="#009900">% These macros are used by the sorted index file itself.</font>
<font color="#009900">% Change them to control the appearance of the index.</font>

<font color="#009900">\def\initial#1{{%</font>
<font color="#009900">  % Some minor font changes for the special characters.</font>
<font color="#009900">  \let\tentt=\sectt \let\tt=\sectt \let\sf=\sectt</font>
<font color="#009900">  %</font>
<font color="#009900">  % Remove any glue we may have, we'll be inserting our own.</font>
<font color="#009900">  \removelastskip</font>
<font color="#009900">  %</font>
<font color="#009900">  % We like breaks before the index initials, so insert a bonus.</font>
<font color="#009900">  \nobreak</font>
<font color="#009900">  \vskip 0pt plus 3\baselineskip</font>
<font color="#009900">  \penalty 0</font>
<font color="#009900">  \vskip 0pt plus -3\baselineskip</font>
<font color="#009900">  %</font>
<font color="#009900">  % Typeset the initial.  Making this add up to a whole number of</font>
<font color="#009900">  % baselineskips increases the chance of the dots lining up from column</font>
<font color="#009900">  % to column.  It still won't often be perfect, because of the stretch</font>
<font color="#009900">  % we need before each entry, but it's better.</font>
<font color="#009900">  %</font>
<font color="#009900">  % No shrink because it confuses \balancecolumns.</font>
<font color="#009900">  \vskip 1.67\baselineskip plus .5\baselineskip</font>
<font color="#009900">  \leftline{\secbf #1}%</font>
<font color="#009900">  % Do our best not to break after the initial.</font>
<font color="#009900">  \nobreak</font>
<font color="#009900">  \vskip .33\baselineskip plus .1\baselineskip</font>
<font color="#009900">}}</font>

<font color="#009900">% \entry typesets a paragraph consisting of the text (#1), dot leaders, and</font>
<font color="#009900">% then page number (#2) flushed to the right margin.  It is used for index</font>
<font color="#009900">% and table of contents entries.  The paragraph is indented by \leftskip.</font>
<font color="#009900">%</font>
<font color="#009900">% A straightforward implementation would start like this:</font>
<font color="#009900">%	\def\entry#1#2{...</font>
<font color="#009900">% But this freezes the catcodes in the argument, and can cause problems to</font>
<font color="#009900">% @code, which sets - active.  This problem was fixed by a kludge---</font>
<font color="#009900">% ``-'' was active throughout whole index, but this isn't really right.</font>
<font color="#009900">% The right solution is to prevent \entry from swallowing the whole text.</font>
<font color="#009900">%                                 --kasal, 21nov03</font>
<font color="#009900">\def\entry{%</font>
<font color="#009900">  \begingroup</font>
<font color="#009900">    %</font>
<font color="#009900">    % Start a new paragraph if necessary, so our assignments below can't</font>
<font color="#009900">    % affect previous text.</font>
<font color="#009900">    \par</font>
<font color="#009900">    %</font>
<font color="#009900">    % Do not fill out the last line with white space.</font>
<font color="#009900">    \parfillskip = 0in</font>
<font color="#009900">    %</font>
<font color="#009900">    % No extra space above this paragraph.</font>
<font color="#009900">    \parskip = 0in</font>
<font color="#009900">    %</font>
<font color="#009900">    % Do not prefer a separate line ending with a hyphen to fewer lines.</font>
<font color="#009900">    \finalhyphendemerits = 0</font>
<font color="#009900">    %</font>
<font color="#009900">    % \hangindent is only relevant when the entry text and page number</font>
<font color="#009900">    % don't both fit on one line.  In that case, bob suggests starting the</font>
<font color="#009900">    % dots pretty far over on the line.  Unfortunately, a large</font>
<font color="#009900">    % indentation looks wrong when the entry text itself is broken across</font>
<font color="#009900">    % lines.  So we use a small indentation and put up with long leaders.</font>
<font color="#009900">    %</font>
<font color="#009900">    % \hangafter is reset to 1 (which is the value we want) at the start</font>
<font color="#009900">    % of each paragraph, so we need not do anything with that.</font>
<font color="#009900">    \hangindent = 2em</font>
<font color="#009900">    %</font>
<font color="#009900">    % When the entry text needs to be broken, just fill out the first line</font>
<font color="#009900">    % with blank space.</font>
<font color="#009900">    \rightskip = 0pt plus1fil</font>
<font color="#009900">    %</font>
<font color="#009900">    % A bit of stretch before each entry for the benefit of balancing</font>
<font color="#009900">    % columns.</font>
<font color="#009900">    \vskip 0pt plus1pt</font>
<font color="#009900">    %</font>
<font color="#009900">    % When reading the text of entry, convert explicit line breaks</font>
<font color="#009900">    % from @* into spaces.  The user might give these in long section</font>
<font color="#009900">    % titles, for instance.</font>
<font color="#009900">    \def\*{\unskip\space\ignorespaces}%</font>
<font color="#009900">    \def\entrybreak{\hfil\break}%</font>
<font color="#009900">    %</font>
<font color="#009900">    % Swallow the left brace of the text (first parameter):</font>
<font color="#009900">    \afterassignment\doentry</font>
<font color="#009900">    \let\temp =</font>
<font color="#009900">}</font>
<font color="#009900">\def\entrybreak{\unskip\space\ignorespaces}%</font>
<font color="#009900">\def\doentry{%</font>
<font color="#009900">    \bgroup % Instead of the swallowed brace.</font>
<font color="#009900">      \noindent</font>
<font color="#009900">      \aftergroup\finishentry</font>
<font color="#009900">      % And now comes the text of the entry.</font>
<font color="#009900">}</font>
<font color="#009900">\def\finishentry#1{%</font>
<font color="#009900">    % #1 is the page number.</font>
<font color="#009900">    %</font>
<font color="#009900">    % The following is kludged to not output a line of dots in the index if</font>
<font color="#009900">    % there are no page numbers.  The next person who breaks this will be</font>
<font color="#009900">    % cursed by a Unix daemon.</font>
<font color="#009900">    \setbox\boxA = \hbox{#1}%</font>
<font color="#009900">    \ifdim\wd\boxA = 0pt</font>
<font color="#009900">      \ %</font>
<font color="#009900">    \else</font>
<font color="#009900">      %</font>
<font color="#009900">      % If we must, put the page number on a line of its own, and fill out</font>
<font color="#009900">      % this line with blank space.  (The \hfil is overwhelmed with the</font>
<font color="#009900">      % fill leaders glue in \indexdotfill if the page number does fit.)</font>
<font color="#009900">      \hfil\penalty50</font>
<font color="#009900">      \null\nobreak\indexdotfill % Have leaders before the page number.</font>
<font color="#009900">      %</font>
<font color="#009900">      % The `\ ' here is removed by the implicit \unskip that TeX does as</font>
<font color="#009900">      % part of (the primitive) \par.  Without it, a spurious underfull</font>
<font color="#009900">      % \hbox ensues.</font>
<font color="#009900">      \ifpdf</font>
<font color="#009900">	\pdfgettoks#1.%</font>
<font color="#009900">	\ \the\toksA</font>
<font color="#009900">      \else</font>
<font color="#009900">	\ #1%</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \fi</font>
<font color="#009900">    \par</font>
<font color="#009900">  \endgroup</font>
<font color="#009900">}</font>

<font color="#009900">% Like plain.tex's \dotfill, except uses up at least 1 em.</font>
<font color="#009900">\def\indexdotfill{\cleaders</font>
<font color="#009900">  \hbox{$\mathsurround=0pt \mkern1.5mu.\mkern1.5mu$}\hskip 1em plus 1fill}</font>

<font color="#009900">\def\primary #1{\line{#1\hfil}}</font>

<font color="#009900">\newskip\secondaryindent \secondaryindent=0.5cm</font>
<font color="#009900">\def\secondary#1#2{{%</font>
<font color="#009900">  \parfillskip=0in</font>
<font color="#009900">  \parskip=0in</font>
<font color="#009900">  \hangindent=1in</font>
<font color="#009900">  \hangafter=1</font>
<font color="#009900">  \noindent\hskip\secondaryindent\hbox{#1}\indexdotfill</font>
<font color="#009900">  \ifpdf</font>
<font color="#009900">    \pdfgettoks#2.\ \the\toksA % The page number ends the paragraph.</font>
<font color="#009900">  \else</font>
<font color="#009900">    #2</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \par</font>
<font color="#009900">}}</font>

<font color="#009900">% Define two-column mode, which we use to typeset indexes.</font>
<font color="#009900">% Adapted from the TeXbook, page 416, which is to say,</font>
<font color="#009900">% the manmac.tex format used to print the TeXbook itself.</font>
<font color="#009900">\catcode`\@=11</font>

<font color="#009900">\newbox\partialpage</font>
<font color="#009900">\newdimen\doublecolumnhsize</font>

<font color="#009900">\def\begindoublecolumns{\begingroup % ended by \enddoublecolumns</font>
<font color="#009900">  % Grab any single-column material above us.</font>
<font color="#009900">  \output = {%</font>
<font color="#009900">    %</font>
<font color="#009900">    % Here is a possibility not foreseen in manmac: if we accumulate a</font>
<font color="#009900">    % whole lot of material, we might end up calling this \output</font>
<font color="#009900">    % routine twice in a row (see the doublecol-lose test, which is</font>
<font color="#009900">    % essentially a couple of indexes with @setchapternewpage off).  In</font>
<font color="#009900">    % that case we just ship out what is in \partialpage with the normal</font>
<font color="#009900">    % output routine.  Generally, \partialpage will be empty when this</font>
<font color="#009900">    % runs and this will be a no-op.  See the indexspread.tex test case.</font>
<font color="#009900">    \ifvoid\partialpage \else</font>
<font color="#009900">      \onepageout{\pagecontents\partialpage}%</font>
<font color="#009900">    \fi</font>
<font color="#009900">    %</font>
<font color="#009900">    \global\setbox\partialpage = \vbox{%</font>
<font color="#009900">      % Unvbox the main output page.</font>
<font color="#009900">      \unvbox\PAGE</font>
<font color="#009900">      \kern-\topskip \kern\baselineskip</font>
<font color="#009900">    }%</font>
<font color="#009900">  }%</font>
<font color="#009900">  \eject % run that output routine to set \partialpage</font>
<font color="#009900">  %</font>
<font color="#009900">  % Use the double-column output routine for subsequent pages.</font>
<font color="#009900">  \output = {\doublecolumnout}%</font>
<font color="#009900">  %</font>
<font color="#009900">  % Change the page size parameters.  We could do this once outside this</font>
<font color="#009900">  % routine, in each of @smallbook, @afourpaper, and the default 8.5x11</font>
<font color="#009900">  % format, but then we repeat the same computation.  Repeating a couple</font>
<font color="#009900">  % of assignments once per index is clearly meaningless for the</font>
<font color="#009900">  % execution time, so we may as well do it in one place.</font>
<font color="#009900">  %</font>
<font color="#009900">  % First we halve the line length, less a little for the gutter between</font>
<font color="#009900">  % the columns.  We compute the gutter based on the line length, so it</font>
<font color="#009900">  % changes automatically with the paper format.  The magic constant</font>
<font color="#009900">  % below is chosen so that the gutter has the same value (well, +-&lt;1pt)</font>
<font color="#009900">  % as it did when we hard-coded it.</font>
<font color="#009900">  %</font>
<font color="#009900">  % We put the result in a separate register, \doublecolumhsize, so we</font>
<font color="#009900">  % can restore it in \pagesofar, after \hsize itself has (potentially)</font>
<font color="#009900">  % been clobbered.</font>
<font color="#009900">  %</font>
<font color="#009900">  \doublecolumnhsize = \hsize</font>
<font color="#009900">    \advance\doublecolumnhsize by -.04154\hsize</font>
<font color="#009900">    \divide\doublecolumnhsize by 2</font>
<font color="#009900">  \hsize = \doublecolumnhsize</font>
<font color="#009900">  %</font>
<font color="#009900">  % Double the \vsize as well.  (We don't need a separate register here,</font>
<font color="#009900">  % since nobody clobbers \vsize.)</font>
<font color="#009900">  \vsize = 2\vsize</font>
<font color="#009900">}</font>

<font color="#009900">% The double-column output routine for all double-column pages except</font>
<font color="#009900">% the last.</font>
<font color="#009900">%</font>
<font color="#009900">\def\doublecolumnout{%</font>
<font color="#009900">  \splittopskip=\topskip \splitmaxdepth=\maxdepth</font>
<font color="#009900">  % Get the available space for the double columns -- the normal</font>
<font color="#009900">  % (undoubled) page height minus any material left over from the</font>
<font color="#009900">  % previous page.</font>
<font color="#009900">  \dimen@ = \vsize</font>
<font color="#009900">  \divide\dimen@ by 2</font>
<font color="#009900">  \advance\dimen@ by -\ht\partialpage</font>
<font color="#009900">  %</font>
<font color="#009900">  % box0 will be the left-hand column, box2 the right.</font>
<font color="#009900">  \setbox0=\vsplit255 to\dimen@ \setbox2=\vsplit255 to\dimen@</font>
<font color="#009900">  \onepageout\pagesofar</font>
<font color="#009900">  \unvbox255</font>
<font color="#009900">  \penalty\outputpenalty</font>
<font color="#009900">}</font>
<font color="#009900">%</font>
<font color="#009900">% Re-output the contents of the output page -- any previous material,</font>
<font color="#009900">% followed by the two boxes we just split, in box0 and box2.</font>
<font color="#009900">\def\pagesofar{%</font>
<font color="#009900">  \unvbox\partialpage</font>
<font color="#009900">  %</font>
<font color="#009900">  \hsize = \doublecolumnhsize</font>
<font color="#009900">  \wd0=\hsize \wd2=\hsize</font>
<font color="#009900">  \hbox to\pagewidth{\box0\hfil\box2}%</font>
<font color="#009900">}</font>
<font color="#009900">%</font>
<font color="#009900">% All done with double columns.</font>
<font color="#009900">\def\enddoublecolumns{%</font>
<font color="#009900">  % The following penalty ensures that the page builder is exercised</font>
<font color="#009900">  % _before_ we change the output routine.  This is necessary in the</font>
<font color="#009900">  % following situation:</font>
<font color="#009900">  %</font>
<font color="#009900">  % The last section of the index consists only of a single entry.</font>
<font color="#009900">  % Before this section, \pagetotal is less than \pagegoal, so no</font>
<font color="#009900">  % break occurs before the last section starts.  However, the last</font>
<font color="#009900">  % section, consisting of \initial and the single \entry, does not</font>
<font color="#009900">  % fit on the page and has to be broken off.  Without the following</font>
<font color="#009900">  % penalty the page builder will not be exercised until \eject</font>
<font color="#009900">  % below, and by that time we'll already have changed the output</font>
<font color="#009900">  % routine to the \balancecolumns version, so the next-to-last</font>
<font color="#009900">  % double-column page will be processed with \balancecolumns, which</font>
<font color="#009900">  % is wrong:  The two columns will go to the main vertical list, with</font>
<font color="#009900">  % the broken-off section in the recent contributions.  As soon as</font>
<font color="#009900">  % the output routine finishes, TeX starts reconsidering the page</font>
<font color="#009900">  % break.  The two columns and the broken-off section both fit on the</font>
<font color="#009900">  % page, because the two columns now take up only half of the page</font>
<font color="#009900">  % goal.  When TeX sees \eject from below which follows the final</font>
<font color="#009900">  % section, it invokes the new output routine that we've set after</font>
<font color="#009900">  % \balancecolumns below; \onepageout will try to fit the two columns</font>
<font color="#009900">  % and the final section into the vbox of \pageheight (see</font>
<font color="#009900">  % \pagebody), causing an overfull box.</font>
<font color="#009900">  %</font>
<font color="#009900">  % Note that glue won't work here, because glue does not exercise the</font>
<font color="#009900">  % page builder, unlike penalties (see The TeXbook, pp. 280-281).</font>
<font color="#009900">  \penalty0</font>
<font color="#009900">  %</font>
<font color="#009900">  \output = {%</font>
<font color="#009900">    % Split the last of the double-column material.  Leave it on the</font>
<font color="#009900">    % current page, no automatic page break.</font>
<font color="#009900">    \balancecolumns</font>
<font color="#009900">    %</font>
<font color="#009900">    % If we end up splitting too much material for the current page,</font>
<font color="#009900">    % though, there will be another page break right after this \output</font>
<font color="#009900">    % invocation ends.  Having called \balancecolumns once, we do not</font>
<font color="#009900">    % want to call it again.  Therefore, reset \output to its normal</font>
<font color="#009900">    % definition right away.  (We hope \balancecolumns will never be</font>
<font color="#009900">    % called on to balance too much material, but if it is, this makes</font>
<font color="#009900">    % the output somewhat more palatable.)</font>
<font color="#009900">    \global\output = {\onepageout{\pagecontents\PAGE}}%</font>
<font color="#009900">  }%</font>
<font color="#009900">  \eject</font>
<font color="#009900">  \endgroup % started in \begindoublecolumns</font>
<font color="#009900">  %</font>
<font color="#009900">  % \pagegoal was set to the doubled \vsize above, since we restarted</font>
<font color="#009900">  % the current page.  We're now back to normal single-column</font>
<font color="#009900">  % typesetting, so reset \pagegoal to the normal \vsize (after the</font>
<font color="#009900">  % \endgroup where \vsize got restored).</font>
<font color="#009900">  \pagegoal = \vsize</font>
<font color="#009900">}</font>
<font color="#009900">%</font>
<font color="#009900">% Called at the end of the double column material.</font>
<font color="#009900">\def\balancecolumns{%</font>
<font color="#009900">  \setbox0 = \vbox{\unvbox255}% like \box255 but more efficient, see p.120.</font>
<font color="#009900">  \dimen@ = \ht0</font>
<font color="#009900">  \advance\dimen@ by \topskip</font>
<font color="#009900">  \advance\dimen@ by-\baselineskip</font>
<font color="#009900">  \divide\dimen@ by 2 % target to split to</font>
<font color="#009900">  %debug\message{final 2-column material height=\the\ht0, target=\the\dimen@.}%</font>
<font color="#009900">  \splittopskip = \topskip</font>
<font color="#009900">  % Loop until we get a decent breakpoint.</font>
<font color="#009900">  {%</font>
<font color="#009900">    \vbadness = 10000</font>
<font color="#009900">    \loop</font>
<font color="#009900">      \global\setbox3 = \copy0</font>
<font color="#009900">      \global\setbox1 = \vsplit3 to \dimen@</font>
<font color="#009900">    \ifdim\ht3&gt;\dimen@</font>
<font color="#009900">      \global\advance\dimen@ by 1pt</font>
<font color="#009900">    \repeat</font>
<font color="#009900">  }%</font>
<font color="#009900">  %debug\message{split to \the\dimen@, column heights: \the\ht1, \the\ht3.}%</font>
<font color="#009900">  \setbox0=\vbox to\dimen@{\unvbox1}%</font>
<font color="#009900">  \setbox2=\vbox to\dimen@{\unvbox3}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \pagesofar</font>
<font color="#009900">}</font>
<font color="#009900">\catcode`\@ = \other</font>


<font color="#009900">\message{sectioning,}</font>
<font color="#009900">% Chapters, sections, etc.</font>

<font color="#009900">% Let's start with @part.</font>
<font color="#009900">\outer\parseargdef\part{\partzzz{#1}}</font>
<font color="#009900">\def\partzzz#1{%</font>
<font color="#009900">  \chapoddpage</font>
<font color="#009900">  \null</font>
<font color="#009900">  \vskip.3\vsize  % move it down on the page a bit</font>
<font color="#009900">  \begingroup</font>
<font color="#009900">    \noindent \titlefonts\rmisbold #1\par % the text</font>
<font color="#009900">    \let\lastnode=\empty      % no node to associate with</font>
<font color="#009900">    \writetocentry{part}{#1}{}% but put it in the toc</font>
<font color="#009900">    \headingsoff              % no headline or footline on the part page</font>
<font color="#009900">    \chapoddpage</font>
<font color="#009900">  \endgroup</font>
<font color="#009900">}</font>

<font color="#009900">% \unnumberedno is an oxymoron.  But we count the unnumbered</font>
<font color="#009900">% sections so that we can refer to them unambiguously in the pdf</font>
<font color="#009900">% outlines by their "section number".  We avoid collisions with chapter</font>
<font color="#009900">% numbers by starting them at 10000.  (If a document ever has 10000</font>
<font color="#009900">% chapters, we're in trouble anyway, I'm sure.)</font>
<font color="#009900">\newcount\unnumberedno \unnumberedno = 10000</font>
<font color="#009900">\newcount\chapno</font>
<font color="#009900">\newcount\secno        \secno=0</font>
<font color="#009900">\newcount\subsecno     \subsecno=0</font>
<font color="#009900">\newcount\subsubsecno  \subsubsecno=0</font>

<font color="#009900">% This counter is funny since it counts through charcodes of letters A, B, ...</font>
<font color="#009900">\newcount\appendixno  \appendixno = `\@</font>
<font color="#009900">%</font>
<font color="#009900">% \def\appendixletter{\char\the\appendixno}</font>
<font color="#009900">% We do the following ugly conditional instead of the above simple</font>
<font color="#009900">% construct for the sake of pdftex, which needs the actual</font>
<font color="#009900">% letter in the expansion, not just typeset.</font>
<font color="#009900">%</font>
<font color="#009900">\def\appendixletter{%</font>
<font color="#009900">  \ifnum\appendixno=`A A%</font>
<font color="#009900">  \else\ifnum\appendixno=`B B%</font>
<font color="#009900">  \else\ifnum\appendixno=`C C%</font>
<font color="#009900">  \else\ifnum\appendixno=`D D%</font>
<font color="#009900">  \else\ifnum\appendixno=`E E%</font>
<font color="#009900">  \else\ifnum\appendixno=`F F%</font>
<font color="#009900">  \else\ifnum\appendixno=`G G%</font>
<font color="#009900">  \else\ifnum\appendixno=`H H%</font>
<font color="#009900">  \else\ifnum\appendixno=`I I%</font>
<font color="#009900">  \else\ifnum\appendixno=`J J%</font>
<font color="#009900">  \else\ifnum\appendixno=`K K%</font>
<font color="#009900">  \else\ifnum\appendixno=`L L%</font>
<font color="#009900">  \else\ifnum\appendixno=`M M%</font>
<font color="#009900">  \else\ifnum\appendixno=`N N%</font>
<font color="#009900">  \else\ifnum\appendixno=`O O%</font>
<font color="#009900">  \else\ifnum\appendixno=`P P%</font>
<font color="#009900">  \else\ifnum\appendixno=`Q Q%</font>
<font color="#009900">  \else\ifnum\appendixno=`R R%</font>
<font color="#009900">  \else\ifnum\appendixno=`S S%</font>
<font color="#009900">  \else\ifnum\appendixno=`T T%</font>
<font color="#009900">  \else\ifnum\appendixno=`U U%</font>
<font color="#009900">  \else\ifnum\appendixno=`V V%</font>
<font color="#009900">  \else\ifnum\appendixno=`W W%</font>
<font color="#009900">  \else\ifnum\appendixno=`X X%</font>
<font color="#009900">  \else\ifnum\appendixno=`Y Y%</font>
<font color="#009900">  \else\ifnum\appendixno=`Z Z%</font>
<font color="#009900">  % The \the is necessary, despite appearances, because \appendixletter is</font>
<font color="#009900">  % expanded while writing the .toc file.  \char\appendixno is not</font>
<font color="#009900">  % expandable, thus it is written literally, thus all appendixes come out</font>
<font color="#009900">  % with the same letter (or @) in the toc without it.</font>
<font color="#009900">  \else\char\the\appendixno</font>
<font color="#009900">  \fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi</font>
<font color="#009900">  \fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi}</font>

<font color="#009900">% Each @chapter defines these (using marks) as the number+name, number</font>
<font color="#009900">% and name of the chapter.  Page headings and footings can use</font>
<font color="#009900">% these.  @section does likewise.</font>
<font color="#009900">\def\thischapter{}</font>
<font color="#009900">\def\thischapternum{}</font>
<font color="#009900">\def\thischaptername{}</font>
<font color="#009900">\def\thissection{}</font>
<font color="#009900">\def\thissectionnum{}</font>
<font color="#009900">\def\thissectionname{}</font>

<font color="#009900">\newcount\absseclevel % used to calculate proper heading level</font>
<font color="#009900">\newcount\secbase\secbase=0 % @raisesections/@lowersections modify this count</font>

<font color="#009900">% @raisesections: treat @section as chapter, @subsection as section, etc.</font>
<font color="#009900">\def\raisesections{\global\advance\secbase by -1}</font>
<font color="#009900">\let\up=\raisesections % original BFox name</font>

<font color="#009900">% @lowersections: treat @chapter as section, @section as subsection, etc.</font>
<font color="#009900">\def\lowersections{\global\advance\secbase by 1}</font>
<font color="#009900">\let\down=\lowersections % original BFox name</font>

<font color="#009900">% we only have subsub.</font>
<font color="#009900">\chardef\maxseclevel = 3</font>
<font color="#009900">%</font>
<font color="#009900">% A numbered section within an unnumbered changes to unnumbered too.</font>
<font color="#009900">% To achieve this, remember the "biggest" unnum. sec. we are currently in:</font>
<font color="#009900">\chardef\unnlevel = \maxseclevel</font>
<font color="#009900">%</font>
<font color="#009900">% Trace whether the current chapter is an appendix or not:</font>
<font color="#009900">% \chapheadtype is "N" or "A", unnumbered chapters are ignored.</font>
<font color="#009900">\def\chapheadtype{N}</font>

<font color="#009900">% Choose a heading macro</font>
<font color="#009900">% #1 is heading type</font>
<font color="#009900">% #2 is heading level</font>
<font color="#009900">% #3 is text for heading</font>
<font color="#009900">\def\genhead#1#2#3{%</font>
<font color="#009900">  % Compute the abs. sec. level:</font>
<font color="#009900">  \absseclevel=#2</font>
<font color="#009900">  \advance\absseclevel by \secbase</font>
<font color="#009900">  % Make sure \absseclevel doesn't fall outside the range:</font>
<font color="#009900">  \ifnum \absseclevel &lt; 0</font>
<font color="#009900">    \absseclevel = 0</font>
<font color="#009900">  \else</font>
<font color="#009900">    \ifnum \absseclevel &gt; 3</font>
<font color="#009900">      \absseclevel = 3</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">  % The heading type:</font>
<font color="#009900">  \def\headtype{#1}%</font>
<font color="#009900">  \if \headtype U%</font>
<font color="#009900">    \ifnum \absseclevel &lt; \unnlevel</font>
<font color="#009900">      \chardef\unnlevel = \absseclevel</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \else</font>
<font color="#009900">    % Check for appendix sections:</font>
<font color="#009900">    \ifnum \absseclevel = 0</font>
<font color="#009900">      \edef\chapheadtype{\headtype}%</font>
<font color="#009900">    \else</font>
<font color="#009900">      \if \headtype A\if \chapheadtype N%</font>
<font color="#009900">	\errmessage{@appendix... within a non-appendix chapter}%</font>
<font color="#009900">      \fi\fi</font>
<font color="#009900">    \fi</font>
<font color="#009900">    % Check for numbered within unnumbered:</font>
<font color="#009900">    \ifnum \absseclevel &gt; \unnlevel</font>
<font color="#009900">      \def\headtype{U}%</font>
<font color="#009900">    \else</font>
<font color="#009900">      \chardef\unnlevel = 3</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">  % Now print the heading:</font>
<font color="#009900">  \if \headtype U%</font>
<font color="#009900">    \ifcase\absseclevel</font>
<font color="#009900">	\unnumberedzzz{#3}%</font>
<font color="#009900">    \or \unnumberedseczzz{#3}%</font>
<font color="#009900">    \or \unnumberedsubseczzz{#3}%</font>
<font color="#009900">    \or \unnumberedsubsubseczzz{#3}%</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \else</font>
<font color="#009900">    \if \headtype A%</font>
<font color="#009900">      \ifcase\absseclevel</font>
<font color="#009900">	  \appendixzzz{#3}%</font>
<font color="#009900">      \or \appendixsectionzzz{#3}%</font>
<font color="#009900">      \or \appendixsubseczzz{#3}%</font>
<font color="#009900">      \or \appendixsubsubseczzz{#3}%</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \else</font>
<font color="#009900">      \ifcase\absseclevel</font>
<font color="#009900">	  \chapterzzz{#3}%</font>
<font color="#009900">      \or \seczzz{#3}%</font>
<font color="#009900">      \or \numberedsubseczzz{#3}%</font>
<font color="#009900">      \or \numberedsubsubseczzz{#3}%</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \suppressfirstparagraphindent</font>
<font color="#009900">}</font>

<font color="#009900">% an interface:</font>
<font color="#009900">\def\numhead{\genhead N}</font>
<font color="#009900">\def\apphead{\genhead A}</font>
<font color="#009900">\def\unnmhead{\genhead U}</font>

<font color="#009900">% @chapter, @appendix, @unnumbered.  Increment top-level counter, reset</font>
<font color="#009900">% all lower-level sectioning counters to zero.</font>
<font color="#009900">%</font>
<font color="#009900">% Also set \chaplevelprefix, which we prepend to @float sequence numbers</font>
<font color="#009900">% (e.g., figures), q.v.  By default (before any chapter), that is empty.</font>
<font color="#009900">\let\chaplevelprefix = \empty</font>
<font color="#009900">%</font>
<font color="#009900">\outer\parseargdef\chapter{\numhead0{#1}} % normally numhead0 calls chapterzzz</font>
<font color="#009900">\def\chapterzzz#1{%</font>
<font color="#009900">  % section resetting is \global in case the chapter is in a group, such</font>
<font color="#009900">  % as an @include file.</font>
<font color="#009900">  \global\secno=0 \global\subsecno=0 \global\subsubsecno=0</font>
<font color="#009900">    \global\advance\chapno by 1</font>
<font color="#009900">  %</font>
<font color="#009900">  % Used for \float.</font>
<font color="#009900">  \gdef\chaplevelprefix{\the\chapno.}%</font>
<font color="#009900">  \resetallfloatnos</font>
<font color="#009900">  %</font>
<font color="#009900">  % \putwordChapter can contain complex things in translations.</font>
<font color="#009900">  \toks0=\expandafter{\putwordChapter}%</font>
<font color="#009900">  \message{\the\toks0 \space \the\chapno}%</font>
<font color="#009900">  %</font>
<font color="#009900">  % Write the actual heading.</font>
<font color="#009900">  \chapmacro{#1}{Ynumbered}{\the\chapno}%</font>
<font color="#009900">  %</font>
<font color="#009900">  % So @section and the like are numbered underneath this chapter.</font>
<font color="#009900">  \global\let\section = \numberedsec</font>
<font color="#009900">  \global\let\subsection = \numberedsubsec</font>
<font color="#009900">  \global\let\subsubsection = \numberedsubsubsec</font>
<font color="#009900">}</font>

<font color="#009900">\outer\parseargdef\appendix{\apphead0{#1}} % normally calls appendixzzz</font>
<font color="#009900">%</font>
<font color="#009900">\def\appendixzzz#1{%</font>
<font color="#009900">  \global\secno=0 \global\subsecno=0 \global\subsubsecno=0</font>
<font color="#009900">    \global\advance\appendixno by 1</font>
<font color="#009900">  \gdef\chaplevelprefix{\appendixletter.}%</font>
<font color="#009900">  \resetallfloatnos</font>
<font color="#009900">  %</font>
<font color="#009900">  % \putwordAppendix can contain complex things in translations.</font>
<font color="#009900">  \toks0=\expandafter{\putwordAppendix}%</font>
<font color="#009900">  \message{\the\toks0 \space \appendixletter}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \chapmacro{#1}{Yappendix}{\appendixletter}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \global\let\section = \appendixsec</font>
<font color="#009900">  \global\let\subsection = \appendixsubsec</font>
<font color="#009900">  \global\let\subsubsection = \appendixsubsubsec</font>
<font color="#009900">}</font>

<font color="#009900">% normally unnmhead0 calls unnumberedzzz:</font>
<font color="#009900">\outer\parseargdef\unnumbered{\unnmhead0{#1}}</font>
<font color="#009900">\def\unnumberedzzz#1{%</font>
<font color="#009900">  \global\secno=0 \global\subsecno=0 \global\subsubsecno=0</font>
<font color="#009900">    \global\advance\unnumberedno by 1</font>
<font color="#009900">  %</font>
<font color="#009900">  % Since an unnumbered has no number, no prefix for figures.</font>
<font color="#009900">  \global\let\chaplevelprefix = \empty</font>
<font color="#009900">  \resetallfloatnos</font>
<font color="#009900">  %</font>
<font color="#009900">  % This used to be simply \message{#1}, but TeX fully expands the</font>
<font color="#009900">  % argument to \message.  Therefore, if #1 contained @-commands, TeX</font>
<font color="#009900">  % expanded them.  For example, in `@unnumbered The @cite{Book}', TeX</font>
<font color="#009900">  % expanded @cite (which turns out to cause errors because \cite is meant</font>
<font color="#009900">  % to be executed, not expanded).</font>
<font color="#009900">  %</font>
<font color="#009900">  % Anyway, we don't want the fully-expanded definition of @cite to appear</font>
<font color="#009900">  % as a result of the \message, we just want `@cite' itself.  We use</font>
<font color="#009900">  % \the&lt;toks register&gt; to achieve this: TeX expands \the&lt;toks&gt; only once,</font>
<font color="#009900">  % simply yielding the contents of &lt;toks register&gt;.  (We also do this for</font>
<font color="#009900">  % the toc entries.)</font>
<font color="#009900">  \toks0 = {#1}%</font>
<font color="#009900">  \message{(\the\toks0)}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \chapmacro{#1}{Ynothing}{\the\unnumberedno}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \global\let\section = \unnumberedsec</font>
<font color="#009900">  \global\let\subsection = \unnumberedsubsec</font>
<font color="#009900">  \global\let\subsubsection = \unnumberedsubsubsec</font>
<font color="#009900">}</font>

<font color="#009900">% @centerchap is like @unnumbered, but the heading is centered.</font>
<font color="#009900">\outer\parseargdef\centerchap{%</font>
<font color="#009900">  % Well, we could do the following in a group, but that would break</font>
<font color="#009900">  % an assumption that \chapmacro is called at the outermost level.</font>
<font color="#009900">  % Thus we are safer this way:		--kasal, 24feb04</font>
<font color="#009900">  \let\centerparametersmaybe = \centerparameters</font>
<font color="#009900">  \unnmhead0{#1}%</font>
<font color="#009900">  \let\centerparametersmaybe = \relax</font>
<font color="#009900">}</font>

<font color="#009900">% @top is like @unnumbered.</font>
<font color="#009900">\let\top\unnumbered</font>

<font color="#009900">% Sections.</font>
<font color="#009900">% </font>
<font color="#009900">\outer\parseargdef\numberedsec{\numhead1{#1}} % normally calls seczzz</font>
<font color="#009900">\def\seczzz#1{%</font>
<font color="#009900">  \global\subsecno=0 \global\subsubsecno=0  \global\advance\secno by 1</font>
<font color="#009900">  \sectionheading{#1}{sec}{Ynumbered}{\the\chapno.\the\secno}%</font>
<font color="#009900">}</font>

<font color="#009900">% normally calls appendixsectionzzz:</font>
<font color="#009900">\outer\parseargdef\appendixsection{\apphead1{#1}}</font>
<font color="#009900">\def\appendixsectionzzz#1{%</font>
<font color="#009900">  \global\subsecno=0 \global\subsubsecno=0  \global\advance\secno by 1</font>
<font color="#009900">  \sectionheading{#1}{sec}{Yappendix}{\appendixletter.\the\secno}%</font>
<font color="#009900">}</font>
<font color="#009900">\let\appendixsec\appendixsection</font>

<font color="#009900">% normally calls unnumberedseczzz:</font>
<font color="#009900">\outer\parseargdef\unnumberedsec{\unnmhead1{#1}}</font>
<font color="#009900">\def\unnumberedseczzz#1{%</font>
<font color="#009900">  \global\subsecno=0 \global\subsubsecno=0  \global\advance\secno by 1</font>
<font color="#009900">  \sectionheading{#1}{sec}{Ynothing}{\the\unnumberedno.\the\secno}%</font>
<font color="#009900">}</font>

<font color="#009900">% Subsections.</font>
<font color="#009900">% </font>
<font color="#009900">% normally calls numberedsubseczzz:</font>
<font color="#009900">\outer\parseargdef\numberedsubsec{\numhead2{#1}}</font>
<font color="#009900">\def\numberedsubseczzz#1{%</font>
<font color="#009900">  \global\subsubsecno=0  \global\advance\subsecno by 1</font>
<font color="#009900">  \sectionheading{#1}{subsec}{Ynumbered}{\the\chapno.\the\secno.\the\subsecno}%</font>
<font color="#009900">}</font>

<font color="#009900">% normally calls appendixsubseczzz:</font>
<font color="#009900">\outer\parseargdef\appendixsubsec{\apphead2{#1}}</font>
<font color="#009900">\def\appendixsubseczzz#1{%</font>
<font color="#009900">  \global\subsubsecno=0  \global\advance\subsecno by 1</font>
<font color="#009900">  \sectionheading{#1}{subsec}{Yappendix}%</font>
<font color="#009900">                 {\appendixletter.\the\secno.\the\subsecno}%</font>
<font color="#009900">}</font>

<font color="#009900">% normally calls unnumberedsubseczzz:</font>
<font color="#009900">\outer\parseargdef\unnumberedsubsec{\unnmhead2{#1}}</font>
<font color="#009900">\def\unnumberedsubseczzz#1{%</font>
<font color="#009900">  \global\subsubsecno=0  \global\advance\subsecno by 1</font>
<font color="#009900">  \sectionheading{#1}{subsec}{Ynothing}%</font>
<font color="#009900">                 {\the\unnumberedno.\the\secno.\the\subsecno}%</font>
<font color="#009900">}</font>

<font color="#009900">% Subsubsections.</font>
<font color="#009900">% </font>
<font color="#009900">% normally numberedsubsubseczzz:</font>
<font color="#009900">\outer\parseargdef\numberedsubsubsec{\numhead3{#1}}</font>
<font color="#009900">\def\numberedsubsubseczzz#1{%</font>
<font color="#009900">  \global\advance\subsubsecno by 1</font>
<font color="#009900">  \sectionheading{#1}{subsubsec}{Ynumbered}%</font>
<font color="#009900">                 {\the\chapno.\the\secno.\the\subsecno.\the\subsubsecno}%</font>
<font color="#009900">}</font>

<font color="#009900">% normally appendixsubsubseczzz:</font>
<font color="#009900">\outer\parseargdef\appendixsubsubsec{\apphead3{#1}}</font>
<font color="#009900">\def\appendixsubsubseczzz#1{%</font>
<font color="#009900">  \global\advance\subsubsecno by 1</font>
<font color="#009900">  \sectionheading{#1}{subsubsec}{Yappendix}%</font>
<font color="#009900">                 {\appendixletter.\the\secno.\the\subsecno.\the\subsubsecno}%</font>
<font color="#009900">}</font>

<font color="#009900">% normally unnumberedsubsubseczzz:</font>
<font color="#009900">\outer\parseargdef\unnumberedsubsubsec{\unnmhead3{#1}}</font>
<font color="#009900">\def\unnumberedsubsubseczzz#1{%</font>
<font color="#009900">  \global\advance\subsubsecno by 1</font>
<font color="#009900">  \sectionheading{#1}{subsubsec}{Ynothing}%</font>
<font color="#009900">                 {\the\unnumberedno.\the\secno.\the\subsecno.\the\subsubsecno}%</font>
<font color="#009900">}</font>

<font color="#009900">% These macros control what the section commands do, according</font>
<font color="#009900">% to what kind of chapter we are in (ordinary, appendix, or unnumbered).</font>
<font color="#009900">% Define them by default for a numbered chapter.</font>
<font color="#009900">\let\section = \numberedsec</font>
<font color="#009900">\let\subsection = \numberedsubsec</font>
<font color="#009900">\let\subsubsection = \numberedsubsubsec</font>

<font color="#009900">% Define @majorheading, @heading and @subheading</font>

<font color="#009900">% NOTE on use of \vbox for chapter headings, section headings, and such:</font>
<font color="#009900">%       1) We use \vbox rather than the earlier \line to permit</font>
<font color="#009900">%          overlong headings to fold.</font>
<font color="#009900">%       2) \hyphenpenalty is set to 10000 because hyphenation in a</font>
<font color="#009900">%          heading is obnoxious; this forbids it.</font>
<font color="#009900">%       3) Likewise, headings look best if no \parindent is used, and</font>
<font color="#009900">%          if justification is not attempted.  Hence \raggedright.</font>

<font color="#009900">\def\majorheading{%</font>
<font color="#009900">  {\advance\chapheadingskip by 10pt \chapbreak }%</font>
<font color="#009900">  \parsearg\chapheadingzzz</font>
<font color="#009900">}</font>

<font color="#009900">\def\chapheading{\chapbreak \parsearg\chapheadingzzz}</font>
<font color="#009900">\def\chapheadingzzz#1{%</font>
<font color="#009900">  {\chapfonts \vbox{\hyphenpenalty=10000\tolerance=5000</font>
<font color="#009900">                    \parindent=0pt\ptexraggedright</font>
<font color="#009900">                    \rmisbold #1\hfill}}%</font>
<font color="#009900">  \bigskip \par\penalty 200\relax</font>
<font color="#009900">  \suppressfirstparagraphindent</font>
<font color="#009900">}</font>

<font color="#009900">% @heading, @subheading, @subsubheading.</font>
<font color="#009900">\parseargdef\heading{\sectionheading{#1}{sec}{Yomitfromtoc}{}</font>
<font color="#009900">  \suppressfirstparagraphindent}</font>
<font color="#009900">\parseargdef\subheading{\sectionheading{#1}{subsec}{Yomitfromtoc}{}</font>
<font color="#009900">  \suppressfirstparagraphindent}</font>
<font color="#009900">\parseargdef\subsubheading{\sectionheading{#1}{subsubsec}{Yomitfromtoc}{}</font>
<font color="#009900">  \suppressfirstparagraphindent}</font>

<font color="#009900">% These macros generate a chapter, section, etc. heading only</font>
<font color="#009900">% (including whitespace, linebreaking, etc. around it),</font>
<font color="#009900">% given all the information in convenient, parsed form.</font>

<font color="#009900">% Args are the skip and penalty (usually negative)</font>
<font color="#009900">\def\dobreak#1#2{\par\ifdim\lastskip&lt;#1\removelastskip\penalty#2\vskip#1\fi}</font>

<font color="#009900">% Parameter controlling skip before chapter headings (if needed)</font>
<font color="#009900">\newskip\chapheadingskip</font>

<font color="#009900">% Define plain chapter starts, and page on/off switching for it.</font>
<font color="#009900">\def\chapbreak{\dobreak \chapheadingskip {-4000}}</font>
<font color="#009900">\def\chappager{\par\vfill\supereject}</font>
<font color="#009900">% Because \domark is called before \chapoddpage, the filler page will</font>
<font color="#009900">% get the headings for the next chapter, which is wrong.  But we don't</font>
<font color="#009900">% care -- we just disable all headings on the filler page.</font>
<font color="#009900">\def\chapoddpage{%</font>
<font color="#009900">  \chappager</font>
<font color="#009900">  \ifodd\pageno \else</font>
<font color="#009900">    \begingroup</font>
<font color="#009900">      \headingsoff</font>
<font color="#009900">      \null</font>
<font color="#009900">      \chappager</font>
<font color="#009900">    \endgroup</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">\def\setchapternewpage #1 {\csname CHAPPAG#1\endcsname}</font>

<font color="#009900">\def\CHAPPAGoff{%</font>
<font color="#009900">\global\let\contentsalignmacro = \chappager</font>
<font color="#009900">\global\let\pchapsepmacro=\chapbreak</font>
<font color="#009900">\global\let\pagealignmacro=\chappager}</font>

<font color="#009900">\def\CHAPPAGon{%</font>
<font color="#009900">\global\let\contentsalignmacro = \chappager</font>
<font color="#009900">\global\let\pchapsepmacro=\chappager</font>
<font color="#009900">\global\let\pagealignmacro=\chappager</font>
<font color="#009900">\global\def\HEADINGSon{\HEADINGSsingle}}</font>

<font color="#009900">\def\CHAPPAGodd{%</font>
<font color="#009900">\global\let\contentsalignmacro = \chapoddpage</font>
<font color="#009900">\global\let\pchapsepmacro=\chapoddpage</font>
<font color="#009900">\global\let\pagealignmacro=\chapoddpage</font>
<font color="#009900">\global\def\HEADINGSon{\HEADINGSdouble}}</font>

<font color="#009900">\CHAPPAGon</font>

<font color="#009900">% Chapter opening.</font>
<font color="#009900">%</font>
<font color="#009900">% #1 is the text, #2 is the section type (Ynumbered, Ynothing,</font>
<font color="#009900">% Yappendix, Yomitfromtoc), #3 the chapter number.</font>
<font color="#009900">%</font>
<font color="#009900">% To test against our argument.</font>
<font color="#009900">\def\Ynothingkeyword{Ynothing}</font>
<font color="#009900">\def\Yomitfromtockeyword{Yomitfromtoc}</font>
<font color="#009900">\def\Yappendixkeyword{Yappendix}</font>
<font color="#009900">%</font>
<font color="#009900">\def\chapmacro#1#2#3{%</font>
<font color="#009900">  % Insert the first mark before the heading break (see notes for \domark).</font>
<font color="#009900">  \let\prevchapterdefs=\lastchapterdefs</font>
<font color="#009900">  \let\prevsectiondefs=\lastsectiondefs</font>
<font color="#009900">  \gdef\lastsectiondefs{\gdef\thissectionname{}\gdef\thissectionnum{}%</font>
<font color="#009900">                        \gdef\thissection{}}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \def\temptype{#2}%</font>
<font color="#009900">  \ifx\temptype\Ynothingkeyword</font>
<font color="#009900">    \gdef\lastchapterdefs{\gdef\thischaptername{#1}\gdef\thischapternum{}%</font>
<font color="#009900">                          \gdef\thischapter{\thischaptername}}%</font>
<font color="#009900">  \else\ifx\temptype\Yomitfromtockeyword</font>
<font color="#009900">    \gdef\lastchapterdefs{\gdef\thischaptername{#1}\gdef\thischapternum{}%</font>
<font color="#009900">                          \gdef\thischapter{}}%</font>
<font color="#009900">  \else\ifx\temptype\Yappendixkeyword</font>
<font color="#009900">    \toks0={#1}%</font>
<font color="#009900">    \xdef\lastchapterdefs{%</font>
<font color="#009900">      \gdef\noexpand\thischaptername{\the\toks0}%</font>
<font color="#009900">      \gdef\noexpand\thischapternum{\appendixletter}%</font>
<font color="#009900">      % \noexpand\putwordAppendix avoids expanding indigestible</font>
<font color="#009900">      % commands in some of the translations.</font>
<font color="#009900">      \gdef\noexpand\thischapter{\noexpand\putwordAppendix{}</font>
<font color="#009900">                                 \noexpand\thischapternum:</font>
<font color="#009900">                                 \noexpand\thischaptername}%</font>
<font color="#009900">    }%</font>
<font color="#009900">  \else</font>
<font color="#009900">    \toks0={#1}%</font>
<font color="#009900">    \xdef\lastchapterdefs{%</font>
<font color="#009900">      \gdef\noexpand\thischaptername{\the\toks0}%</font>
<font color="#009900">      \gdef\noexpand\thischapternum{\the\chapno}%</font>
<font color="#009900">      % \noexpand\putwordChapter avoids expanding indigestible</font>
<font color="#009900">      % commands in some of the translations.</font>
<font color="#009900">      \gdef\noexpand\thischapter{\noexpand\putwordChapter{}</font>
<font color="#009900">                                 \noexpand\thischapternum:</font>
<font color="#009900">                                 \noexpand\thischaptername}%</font>
<font color="#009900">    }%</font>
<font color="#009900">  \fi\fi\fi</font>
<font color="#009900">  %</font>
<font color="#009900">  % Output the mark.  Pass it through \safewhatsit, to take care of</font>
<font color="#009900">  % the preceding space.</font>
<font color="#009900">  \safewhatsit\domark</font>
<font color="#009900">  %</font>
<font color="#009900">  % Insert the chapter heading break.</font>
<font color="#009900">  \pchapsepmacro</font>
<font color="#009900">  %</font>
<font color="#009900">  % Now the second mark, after the heading break.  No break points</font>
<font color="#009900">  % between here and the heading.</font>
<font color="#009900">  \let\prevchapterdefs=\lastchapterdefs</font>
<font color="#009900">  \let\prevsectiondefs=\lastsectiondefs</font>
<font color="#009900">  \domark</font>
<font color="#009900">  %</font>
<font color="#009900">  {%</font>
<font color="#009900">    \chapfonts \rmisbold</font>
<font color="#009900">    %</font>
<font color="#009900">    % Have to define \lastsection before calling \donoderef, because the</font>
<font color="#009900">    % xref code eventually uses it.  On the other hand, it has to be called</font>
<font color="#009900">    % after \pchapsepmacro, or the headline will change too soon.</font>
<font color="#009900">    \gdef\lastsection{#1}%</font>
<font color="#009900">    %</font>
<font color="#009900">    % Only insert the separating space if we have a chapter/appendix</font>
<font color="#009900">    % number, and don't print the unnumbered ``number''.</font>
<font color="#009900">    \ifx\temptype\Ynothingkeyword</font>
<font color="#009900">      \setbox0 = \hbox{}%</font>
<font color="#009900">      \def\toctype{unnchap}%</font>
<font color="#009900">    \else\ifx\temptype\Yomitfromtockeyword</font>
<font color="#009900">      \setbox0 = \hbox{}% contents like unnumbered, but no toc entry</font>
<font color="#009900">      \def\toctype{omit}%</font>
<font color="#009900">    \else\ifx\temptype\Yappendixkeyword</font>
<font color="#009900">      \setbox0 = \hbox{\putwordAppendix{} #3\enspace}%</font>
<font color="#009900">      \def\toctype{app}%</font>
<font color="#009900">    \else</font>
<font color="#009900">      \setbox0 = \hbox{#3\enspace}%</font>
<font color="#009900">      \def\toctype{numchap}%</font>
<font color="#009900">    \fi\fi\fi</font>
<font color="#009900">    %</font>
<font color="#009900">    % Write the toc entry for this chapter.  Must come before the</font>
<font color="#009900">    % \donoderef, because we include the current node name in the toc</font>
<font color="#009900">    % entry, and \donoderef resets it to empty.</font>
<font color="#009900">    \writetocentry{\toctype}{#1}{#3}%</font>
<font color="#009900">    %</font>
<font color="#009900">    % For pdftex, we have to write out the node definition (aka, make</font>
<font color="#009900">    % the pdfdest) after any page break, but before the actual text has</font>
<font color="#009900">    % been typeset.  If the destination for the pdf outline is after the</font>
<font color="#009900">    % text, then jumping from the outline may wind up with the text not</font>
<font color="#009900">    % being visible, for instance under high magnification.</font>
<font color="#009900">    \donoderef{#2}%</font>
<font color="#009900">    %</font>
<font color="#009900">    % Typeset the actual heading.</font>
<font color="#009900">    \nobreak % Avoid page breaks at the interline glue.</font>
<font color="#009900">    \vbox{\hyphenpenalty=10000 \tolerance=5000 \parindent=0pt \ptexraggedright</font>
<font color="#009900">          \hangindent=\wd0 \centerparametersmaybe</font>
<font color="#009900">          \unhbox0 #1\par}%</font>
<font color="#009900">  }%</font>
<font color="#009900">  \nobreak\bigskip % no page break after a chapter title</font>
<font color="#009900">  \nobreak</font>
<font color="#009900">}</font>

<font color="#009900">% @centerchap -- centered and unnumbered.</font>
<font color="#009900">\let\centerparametersmaybe = \relax</font>
<font color="#009900">\def\centerparameters{%</font>
<font color="#009900">  \advance\rightskip by 3\rightskip</font>
<font color="#009900">  \leftskip = \rightskip</font>
<font color="#009900">  \parfillskip = 0pt</font>
<font color="#009900">}</font>


<font color="#009900">% I don't think this chapter style is supported any more, so I'm not</font>
<font color="#009900">% updating it with the new noderef stuff.  We'll see.  --karl, 11aug03.</font>
<font color="#009900">%</font>
<font color="#009900">\def\setchapterstyle #1 {\csname CHAPF#1\endcsname}</font>
<font color="#009900">%</font>
<font color="#009900">\def\unnchfopen #1{%</font>
<font color="#009900">\chapoddpage {\chapfonts \vbox{\hyphenpenalty=10000\tolerance=5000</font>
<font color="#009900">                       \parindent=0pt\ptexraggedright</font>
<font color="#009900">                       \rmisbold #1\hfill}}\bigskip \par\nobreak</font>
<font color="#009900">}</font>
<font color="#009900">\def\chfopen #1#2{\chapoddpage {\chapfonts</font>
<font color="#009900">\vbox to 3in{\vfil \hbox to\hsize{\hfil #2} \hbox to\hsize{\hfil #1} \vfil}}%</font>
<font color="#009900">\par\penalty 5000 %</font>
<font color="#009900">}</font>
<font color="#009900">\def\centerchfopen #1{%</font>
<font color="#009900">\chapoddpage {\chapfonts \vbox{\hyphenpenalty=10000\tolerance=5000</font>
<font color="#009900">                       \parindent=0pt</font>
<font color="#009900">                       \hfill {\rmisbold #1}\hfill}}\bigskip \par\nobreak</font>
<font color="#009900">}</font>
<font color="#009900">\def\CHAPFopen{%</font>
<font color="#009900">  \global\let\chapmacro=\chfopen</font>
<font color="#009900">  \global\let\centerchapmacro=\centerchfopen}</font>


<font color="#009900">% Section titles.  These macros combine the section number parts and</font>
<font color="#009900">% call the generic \sectionheading to do the printing.</font>
<font color="#009900">%</font>
<font color="#009900">\newskip\secheadingskip</font>
<font color="#009900">\def\secheadingbreak{\dobreak \secheadingskip{-1000}}</font>

<font color="#009900">% Subsection titles.</font>
<font color="#009900">\newskip\subsecheadingskip</font>
<font color="#009900">\def\subsecheadingbreak{\dobreak \subsecheadingskip{-500}}</font>

<font color="#009900">% Subsubsection titles.</font>
<font color="#009900">\def\subsubsecheadingskip{\subsecheadingskip}</font>
<font color="#009900">\def\subsubsecheadingbreak{\subsecheadingbreak}</font>


<font color="#009900">% Print any size, any type, section title.</font>
<font color="#009900">%</font>
<font color="#009900">% #1 is the text, #2 is the section level (sec/subsec/subsubsec), #3 is</font>
<font color="#009900">% the section type for xrefs (Ynumbered, Ynothing, Yappendix), #4 is the</font>
<font color="#009900">% section number.</font>
<font color="#009900">%</font>
<font color="#009900">\def\seckeyword{sec}</font>
<font color="#009900">%</font>
<font color="#009900">\def\sectionheading#1#2#3#4{%</font>
<font color="#009900">  {%</font>
<font color="#009900">    \checkenv{}% should not be in an environment.</font>
<font color="#009900">    %</font>
<font color="#009900">    % Switch to the right set of fonts.</font>
<font color="#009900">    \csname #2fonts\endcsname \rmisbold</font>
<font color="#009900">    %</font>
<font color="#009900">    \def\sectionlevel{#2}%</font>
<font color="#009900">    \def\temptype{#3}%</font>
<font color="#009900">    %</font>
<font color="#009900">    % Insert first mark before the heading break (see notes for \domark).</font>
<font color="#009900">    \let\prevsectiondefs=\lastsectiondefs</font>
<font color="#009900">    \ifx\temptype\Ynothingkeyword</font>
<font color="#009900">      \ifx\sectionlevel\seckeyword</font>
<font color="#009900">        \gdef\lastsectiondefs{\gdef\thissectionname{#1}\gdef\thissectionnum{}%</font>
<font color="#009900">                              \gdef\thissection{\thissectionname}}%</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \else\ifx\temptype\Yomitfromtockeyword</font>
<font color="#009900">      % Don't redefine \thissection.</font>
<font color="#009900">    \else\ifx\temptype\Yappendixkeyword</font>
<font color="#009900">      \ifx\sectionlevel\seckeyword</font>
<font color="#009900">        \toks0={#1}%</font>
<font color="#009900">        \xdef\lastsectiondefs{%</font>
<font color="#009900">          \gdef\noexpand\thissectionname{\the\toks0}%</font>
<font color="#009900">          \gdef\noexpand\thissectionnum{#4}%</font>
<font color="#009900">          % \noexpand\putwordSection avoids expanding indigestible</font>
<font color="#009900">          % commands in some of the translations.</font>
<font color="#009900">          \gdef\noexpand\thissection{\noexpand\putwordSection{}</font>
<font color="#009900">                                     \noexpand\thissectionnum:</font>
<font color="#009900">                                     \noexpand\thissectionname}%</font>
<font color="#009900">        }%</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \else</font>
<font color="#009900">      \ifx\sectionlevel\seckeyword</font>
<font color="#009900">        \toks0={#1}%</font>
<font color="#009900">        \xdef\lastsectiondefs{%</font>
<font color="#009900">          \gdef\noexpand\thissectionname{\the\toks0}%</font>
<font color="#009900">          \gdef\noexpand\thissectionnum{#4}%</font>
<font color="#009900">          % \noexpand\putwordSection avoids expanding indigestible</font>
<font color="#009900">          % commands in some of the translations.</font>
<font color="#009900">          \gdef\noexpand\thissection{\noexpand\putwordSection{}</font>
<font color="#009900">                                     \noexpand\thissectionnum:</font>
<font color="#009900">                                     \noexpand\thissectionname}%</font>
<font color="#009900">        }%</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \fi\fi\fi</font>
<font color="#009900">    %</font>
<font color="#009900">    % Go into vertical mode.  Usually we'll already be there, but we</font>
<font color="#009900">    % don't want the following whatsit to end up in a preceding paragraph</font>
<font color="#009900">    % if the document didn't happen to have a blank line.</font>
<font color="#009900">    \par</font>
<font color="#009900">    %</font>
<font color="#009900">    % Output the mark.  Pass it through \safewhatsit, to take care of</font>
<font color="#009900">    % the preceding space.</font>
<font color="#009900">    \safewhatsit\domark</font>
<font color="#009900">    %</font>
<font color="#009900">    % Insert space above the heading.</font>
<font color="#009900">    \csname #2headingbreak\endcsname</font>
<font color="#009900">    %</font>
<font color="#009900">    % Now the second mark, after the heading break.  No break points</font>
<font color="#009900">    % between here and the heading.</font>
<font color="#009900">    \let\prevsectiondefs=\lastsectiondefs</font>
<font color="#009900">    \domark</font>
<font color="#009900">    %</font>
<font color="#009900">    % Only insert the space after the number if we have a section number.</font>
<font color="#009900">    \ifx\temptype\Ynothingkeyword</font>
<font color="#009900">      \setbox0 = \hbox{}%</font>
<font color="#009900">      \def\toctype{unn}%</font>
<font color="#009900">      \gdef\lastsection{#1}%</font>
<font color="#009900">    \else\ifx\temptype\Yomitfromtockeyword</font>
<font color="#009900">      % for @headings -- no section number, don't include in toc,</font>
<font color="#009900">      % and don't redefine \lastsection.</font>
<font color="#009900">      \setbox0 = \hbox{}%</font>
<font color="#009900">      \def\toctype{omit}%</font>
<font color="#009900">      \let\sectionlevel=\empty</font>
<font color="#009900">    \else\ifx\temptype\Yappendixkeyword</font>
<font color="#009900">      \setbox0 = \hbox{#4\enspace}%</font>
<font color="#009900">      \def\toctype{app}%</font>
<font color="#009900">      \gdef\lastsection{#1}%</font>
<font color="#009900">    \else</font>
<font color="#009900">      \setbox0 = \hbox{#4\enspace}%</font>
<font color="#009900">      \def\toctype{num}%</font>
<font color="#009900">      \gdef\lastsection{#1}%</font>
<font color="#009900">    \fi\fi\fi</font>
<font color="#009900">    %</font>
<font color="#009900">    % Write the toc entry (before \donoderef).  See comments in \chapmacro.</font>
<font color="#009900">    \writetocentry{\toctype\sectionlevel}{#1}{#4}%</font>
<font color="#009900">    %</font>
<font color="#009900">    % Write the node reference (= pdf destination for pdftex).</font>
<font color="#009900">    % Again, see comments in \chapmacro.</font>
<font color="#009900">    \donoderef{#3}%</font>
<font color="#009900">    %</font>
<font color="#009900">    % Interline glue will be inserted when the vbox is completed.</font>
<font color="#009900">    % That glue will be a valid breakpoint for the page, since it'll be</font>
<font color="#009900">    % preceded by a whatsit (usually from the \donoderef, or from the</font>
<font color="#009900">    % \writetocentry if there was no node).  We don't want to allow that</font>
<font color="#009900">    % break, since then the whatsits could end up on page n while the</font>
<font color="#009900">    % section is on page n+1, thus toc/etc. are wrong.  Debian bug 276000.</font>
<font color="#009900">    \nobreak</font>
<font color="#009900">    %</font>
<font color="#009900">    % Output the actual section heading.</font>
<font color="#009900">    \vbox{\hyphenpenalty=10000 \tolerance=5000 \parindent=0pt \ptexraggedright</font>
<font color="#009900">          \hangindent=\wd0  % zero if no section number</font>
<font color="#009900">          \unhbox0 #1}%</font>
<font color="#009900">  }%</font>
<font color="#009900">  % Add extra space after the heading -- half of whatever came above it.</font>
<font color="#009900">  % Don't allow stretch, though.</font>
<font color="#009900">  \kern .5 \csname #2headingskip\endcsname</font>
<font color="#009900">  %</font>
<font color="#009900">  % Do not let the kern be a potential breakpoint, as it would be if it</font>
<font color="#009900">  % was followed by glue.</font>
<font color="#009900">  \nobreak</font>
<font color="#009900">  %</font>
<font color="#009900">  % We'll almost certainly start a paragraph next, so don't let that</font>
<font color="#009900">  % glue accumulate.  (Not a breakpoint because it's preceded by a</font>
<font color="#009900">  % discardable item.)  However, when a paragraph is not started next</font>
<font color="#009900">  % (\startdefun, \cartouche, \center, etc.), this needs to be wiped out</font>
<font color="#009900">  % or the negative glue will cause weirdly wrong output, typically</font>
<font color="#009900">  % obscuring the section heading with something else.</font>
<font color="#009900">  \vskip-\parskip</font>
<font color="#009900">  %</font>
<font color="#009900">  % This is so the last item on the main vertical list is a known</font>
<font color="#009900">  % \penalty &gt; 10000, so \startdefun, etc., can recognize the situation</font>
<font color="#009900">  % and do the needful.</font>
<font color="#009900">  \penalty 10001</font>
<font color="#009900">}</font>


<font color="#009900">\message{toc,}</font>
<font color="#009900">% Table of contents.</font>
<font color="#009900">\newwrite\tocfile</font>

<font color="#009900">% Write an entry to the toc file, opening it if necessary.</font>
<font color="#009900">% Called from @chapter, etc.</font>
<font color="#009900">%</font>
<font color="#009900">% Example usage: \writetocentry{sec}{Section Name}{\the\chapno.\the\secno}</font>
<font color="#009900">% We append the current node name (if any) and page number as additional</font>
<font color="#009900">% arguments for the \{chap,sec,...}entry macros which will eventually</font>
<font color="#009900">% read this.  The node name is used in the pdf outlines as the</font>
<font color="#009900">% destination to jump to.</font>
<font color="#009900">%</font>
<font color="#009900">% We open the .toc file for writing here instead of at @setfilename (or</font>
<font color="#009900">% any other fixed time) so that @contents can be anywhere in the document.</font>
<font color="#009900">% But if #1 is `omit', then we don't do anything.  This is used for the</font>
<font color="#009900">% table of contents chapter openings themselves.</font>
<font color="#009900">%</font>
<font color="#009900">\newif\iftocfileopened</font>
<font color="#009900">\def\omitkeyword{omit}%</font>
<font color="#009900">%</font>
<font color="#009900">\def\writetocentry#1#2#3{%</font>
<font color="#009900">  \edef\writetoctype{#1}%</font>
<font color="#009900">  \ifx\writetoctype\omitkeyword \else</font>
<font color="#009900">    \iftocfileopened\else</font>
<font color="#009900">      \immediate\openout\tocfile = \jobname.toc</font>
<font color="#009900">      \global\tocfileopenedtrue</font>
<font color="#009900">    \fi</font>
<font color="#009900">    %</font>
<font color="#009900">    \iflinks</font>
<font color="#009900">      {\atdummies</font>
<font color="#009900">       \edef\temp{%</font>
<font color="#009900">         \write\tocfile{@#1entry{#2}{#3}{\lastnode}{\noexpand\folio}}}%</font>
<font color="#009900">       \temp</font>
<font color="#009900">      }%</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  % Tell \shipout to create a pdf destination on each page, if we're</font>
<font color="#009900">  % writing pdf.  These are used in the table of contents.  We can't</font>
<font color="#009900">  % just write one on every page because the title pages are numbered</font>
<font color="#009900">  % 1 and 2 (the page numbers aren't printed), and so are the first</font>
<font color="#009900">  % two pages of the document.  Thus, we'd have two destinations named</font>
<font color="#009900">  % `1', and two named `2'.</font>
<font color="#009900">  \ifpdf \global\pdfmakepagedesttrue \fi</font>
<font color="#009900">}</font>


<font color="#009900">% These characters do not print properly in the Computer Modern roman</font>
<font color="#009900">% fonts, so we must take special care.  This is more or less redundant</font>
<font color="#009900">% with the Texinfo input format setup at the end of this file.</font>
<font color="#009900">%</font>
<font color="#009900">\def\activecatcodes{%</font>
<font color="#009900">  \catcode`\"=\active</font>
<font color="#009900">  \catcode`\$=\active</font>
<font color="#009900">  \catcode`\&lt;=\active</font>
<font color="#009900">  \catcode`\&gt;=\active</font>
<font color="#009900">  \catcode`\\=\active</font>
<font color="#009900">  \catcode`\^=\active</font>
<font color="#009900">  \catcode`\_=\active</font>
<font color="#009900">  \catcode`\|=\active</font>
<font color="#009900">  \catcode`\~=\active</font>
<font color="#009900">}</font>


<font color="#009900">% Read the toc file, which is essentially Texinfo input.</font>
<font color="#009900">\def\readtocfile{%</font>
<font color="#009900">  \setupdatafile</font>
<font color="#009900">  \activecatcodes</font>
<font color="#009900">  \input \tocreadfilename</font>
<font color="#009900">}</font>

<font color="#009900">\newskip\contentsrightmargin \contentsrightmargin=1in</font>
<font color="#009900">\newcount\savepageno</font>
<font color="#009900">\newcount\lastnegativepageno \lastnegativepageno = -1</font>

<font color="#009900">% Prepare to read what we've written to \tocfile.</font>
<font color="#009900">%</font>
<font color="#009900">\def\startcontents#1{%</font>
<font color="#009900">  % If @setchapternewpage on, and @headings double, the contents should</font>
<font color="#009900">  % start on an odd page, unlike chapters.  Thus, we maintain</font>
<font color="#009900">  % \contentsalignmacro in parallel with \pagealignmacro.</font>
<font color="#009900">  % From: Torbjorn Granlund &lt;tege@matematik.su.se&gt;</font>
<font color="#009900">  \contentsalignmacro</font>
<font color="#009900">  \immediate\closeout\tocfile</font>
<font color="#009900">  %</font>
<font color="#009900">  % Don't need to put `Contents' or `Short Contents' in the headline.</font>
<font color="#009900">  % It is abundantly clear what they are.</font>
<font color="#009900">  \chapmacro{#1}{Yomitfromtoc}{}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \savepageno = \pageno</font>
<font color="#009900">  \begingroup                  % Set up to handle contents files properly.</font>
<font color="#009900">    \raggedbottom              % Worry more about breakpoints than the bottom.</font>
<font color="#009900">    \advance\hsize by -\contentsrightmargin % Don't use the full line length.</font>
<font color="#009900">    %</font>
<font color="#009900">    % Roman numerals for page numbers.</font>
<font color="#009900">    \ifnum \pageno&gt;0 \global\pageno = \lastnegativepageno \fi</font>
<font color="#009900">}</font>

<font color="#009900">% redefined for the two-volume lispref.  We always output on</font>
<font color="#009900">% \jobname.toc even if this is redefined.</font>
<font color="#009900">%</font>
<font color="#009900">\def\tocreadfilename{\jobname.toc}</font>

<font color="#009900">% Normal (long) toc.</font>
<font color="#009900">%</font>
<font color="#009900">\def\contents{%</font>
<font color="#009900">  \startcontents{\putwordTOC}%</font>
<font color="#009900">    \openin 1 \tocreadfilename\space</font>
<font color="#009900">    \ifeof 1 \else</font>
<font color="#009900">      \readtocfile</font>
<font color="#009900">    \fi</font>
<font color="#009900">    \vfill \eject</font>
<font color="#009900">    \contentsalignmacro % in case @setchapternewpage odd is in effect</font>
<font color="#009900">    \ifeof 1 \else</font>
<font color="#009900">      \pdfmakeoutlines</font>
<font color="#009900">    \fi</font>
<font color="#009900">    \closein 1</font>
<font color="#009900">  \endgroup</font>
<font color="#009900">  \lastnegativepageno = \pageno</font>
<font color="#009900">  \global\pageno = \savepageno</font>
<font color="#009900">}</font>

<font color="#009900">% And just the chapters.</font>
<font color="#009900">\def\summarycontents{%</font>
<font color="#009900">  \startcontents{\putwordShortTOC}%</font>
<font color="#009900">    %</font>
<font color="#009900">    \let\partentry = \shortpartentry</font>
<font color="#009900">    \let\numchapentry = \shortchapentry</font>
<font color="#009900">    \let\appentry = \shortchapentry</font>
<font color="#009900">    \let\unnchapentry = \shortunnchapentry</font>
<font color="#009900">    % We want a true roman here for the page numbers.</font>
<font color="#009900">    \secfonts</font>
<font color="#009900">    \let\rm=\shortcontrm \let\bf=\shortcontbf</font>
<font color="#009900">    \let\sl=\shortcontsl \let\tt=\shortconttt</font>
<font color="#009900">    \rm</font>
<font color="#009900">    \hyphenpenalty = 10000</font>
<font color="#009900">    \advance\baselineskip by 1pt % Open it up a little.</font>
<font color="#009900">    \def\numsecentry##1##2##3##4{}</font>
<font color="#009900">    \let\appsecentry = \numsecentry</font>
<font color="#009900">    \let\unnsecentry = \numsecentry</font>
<font color="#009900">    \let\numsubsecentry = \numsecentry</font>
<font color="#009900">    \let\appsubsecentry = \numsecentry</font>
<font color="#009900">    \let\unnsubsecentry = \numsecentry</font>
<font color="#009900">    \let\numsubsubsecentry = \numsecentry</font>
<font color="#009900">    \let\appsubsubsecentry = \numsecentry</font>
<font color="#009900">    \let\unnsubsubsecentry = \numsecentry</font>
<font color="#009900">    \openin 1 \tocreadfilename\space</font>
<font color="#009900">    \ifeof 1 \else</font>
<font color="#009900">      \readtocfile</font>
<font color="#009900">    \fi</font>
<font color="#009900">    \closein 1</font>
<font color="#009900">    \vfill \eject</font>
<font color="#009900">    \contentsalignmacro % in case @setchapternewpage odd is in effect</font>
<font color="#009900">  \endgroup</font>
<font color="#009900">  \lastnegativepageno = \pageno</font>
<font color="#009900">  \global\pageno = \savepageno</font>
<font color="#009900">}</font>
<font color="#009900">\let\shortcontents = \summarycontents</font>

<font color="#009900">% Typeset the label for a chapter or appendix for the short contents.</font>
<font color="#009900">% The arg is, e.g., `A' for an appendix, or `3' for a chapter.</font>
<font color="#009900">%</font>
<font color="#009900">\def\shortchaplabel#1{%</font>
<font color="#009900">  % This space should be enough, since a single number is .5em, and the</font>
<font color="#009900">  % widest letter (M) is 1em, at least in the Computer Modern fonts.</font>
<font color="#009900">  % But use \hss just in case.</font>
<font color="#009900">  % (This space doesn't include the extra space that gets added after</font>
<font color="#009900">  % the label; that gets put in by \shortchapentry above.)</font>
<font color="#009900">  %</font>
<font color="#009900">  % We'd like to right-justify chapter numbers, but that looks strange</font>
<font color="#009900">  % with appendix letters.  And right-justifying numbers and</font>
<font color="#009900">  % left-justifying letters looks strange when there is less than 10</font>
<font color="#009900">  % chapters.  Have to read the whole toc once to know how many chapters</font>
<font color="#009900">  % there are before deciding ...</font>
<font color="#009900">  \hbox to 1em{#1\hss}%</font>
<font color="#009900">}</font>

<font color="#009900">% These macros generate individual entries in the table of contents.</font>
<font color="#009900">% The first argument is the chapter or section name.</font>
<font color="#009900">% The last argument is the page number.</font>
<font color="#009900">% The arguments in between are the chapter number, section number, ...</font>

<font color="#009900">% Parts, in the main contents.  Replace the part number, which doesn't</font>
<font color="#009900">% exist, with an empty box.  Let's hope all the numbers have the same width.</font>
<font color="#009900">% Also ignore the page number, which is conventionally not printed.</font>
<font color="#009900">\def\numeralbox{\setbox0=\hbox{8}\hbox to \wd0{\hfil}}</font>
<font color="#009900">\def\partentry#1#2#3#4{\dochapentry{\numeralbox\labelspace#1}{}}</font>
<font color="#009900">%</font>
<font color="#009900">% Parts, in the short toc.</font>
<font color="#009900">\def\shortpartentry#1#2#3#4{%</font>
<font color="#009900">  \penalty-300</font>
<font color="#009900">  \vskip.5\baselineskip plus.15\baselineskip minus.1\baselineskip</font>
<font color="#009900">  \shortchapentry{{\bf #1}}{\numeralbox}{}{}%</font>
<font color="#009900">}</font>

<font color="#009900">% Chapters, in the main contents.</font>
<font color="#009900">\def\numchapentry#1#2#3#4{\dochapentry{#2\labelspace#1}{#4}}</font>
<font color="#009900">%</font>
<font color="#009900">% Chapters, in the short toc.</font>
<font color="#009900">% See comments in \dochapentry re vbox and related settings.</font>
<font color="#009900">\def\shortchapentry#1#2#3#4{%</font>
<font color="#009900">  \tocentry{\shortchaplabel{#2}\labelspace #1}{\doshortpageno\bgroup#4\egroup}%</font>
<font color="#009900">}</font>

<font color="#009900">% Appendices, in the main contents.</font>
<font color="#009900">% Need the word Appendix, and a fixed-size box.</font>
<font color="#009900">%</font>
<font color="#009900">\def\appendixbox#1{%</font>
<font color="#009900">  % We use M since it's probably the widest letter.</font>
<font color="#009900">  \setbox0 = \hbox{\putwordAppendix{} M}%</font>
<font color="#009900">  \hbox to \wd0{\putwordAppendix{} #1\hss}}</font>
<font color="#009900">%</font>
<font color="#009900">\def\appentry#1#2#3#4{\dochapentry{\appendixbox{#2}\labelspace#1}{#4}}</font>

<font color="#009900">% Unnumbered chapters.</font>
<font color="#009900">\def\unnchapentry#1#2#3#4{\dochapentry{#1}{#4}}</font>
<font color="#009900">\def\shortunnchapentry#1#2#3#4{\tocentry{#1}{\doshortpageno\bgroup#4\egroup}}</font>

<font color="#009900">% Sections.</font>
<font color="#009900">\def\numsecentry#1#2#3#4{\dosecentry{#2\labelspace#1}{#4}}</font>
<font color="#009900">\let\appsecentry=\numsecentry</font>
<font color="#009900">\def\unnsecentry#1#2#3#4{\dosecentry{#1}{#4}}</font>

<font color="#009900">% Subsections.</font>
<font color="#009900">\def\numsubsecentry#1#2#3#4{\dosubsecentry{#2\labelspace#1}{#4}}</font>
<font color="#009900">\let\appsubsecentry=\numsubsecentry</font>
<font color="#009900">\def\unnsubsecentry#1#2#3#4{\dosubsecentry{#1}{#4}}</font>

<font color="#009900">% And subsubsections.</font>
<font color="#009900">\def\numsubsubsecentry#1#2#3#4{\dosubsubsecentry{#2\labelspace#1}{#4}}</font>
<font color="#009900">\let\appsubsubsecentry=\numsubsubsecentry</font>
<font color="#009900">\def\unnsubsubsecentry#1#2#3#4{\dosubsubsecentry{#1}{#4}}</font>

<font color="#009900">% This parameter controls the indentation of the various levels.</font>
<font color="#009900">% Same as \defaultparindent.</font>
<font color="#009900">\newdimen\tocindent \tocindent = 15pt</font>

<font color="#009900">% Now for the actual typesetting. In all these, #1 is the text and #2 is the</font>
<font color="#009900">% page number.</font>
<font color="#009900">%</font>
<font color="#009900">% If the toc has to be broken over pages, we want it to be at chapters</font>
<font color="#009900">% if at all possible; hence the \penalty.</font>
<font color="#009900">\def\dochapentry#1#2{%</font>
<font color="#009900">   \penalty-300 \vskip1\baselineskip plus.33\baselineskip minus.25\baselineskip</font>
<font color="#009900">   \begingroup</font>
<font color="#009900">     \chapentryfonts</font>
<font color="#009900">     \tocentry{#1}{\dopageno\bgroup#2\egroup}%</font>
<font color="#009900">   \endgroup</font>
<font color="#009900">   \nobreak\vskip .25\baselineskip plus.1\baselineskip</font>
<font color="#009900">}</font>

<font color="#009900">\def\dosecentry#1#2{\begingroup</font>
<font color="#009900">  \secentryfonts \leftskip=\tocindent</font>
<font color="#009900">  \tocentry{#1}{\dopageno\bgroup#2\egroup}%</font>
<font color="#009900">\endgroup}</font>

<font color="#009900">\def\dosubsecentry#1#2{\begingroup</font>
<font color="#009900">  \subsecentryfonts \leftskip=2\tocindent</font>
<font color="#009900">  \tocentry{#1}{\dopageno\bgroup#2\egroup}%</font>
<font color="#009900">\endgroup}</font>

<font color="#009900">\def\dosubsubsecentry#1#2{\begingroup</font>
<font color="#009900">  \subsubsecentryfonts \leftskip=3\tocindent</font>
<font color="#009900">  \tocentry{#1}{\dopageno\bgroup#2\egroup}%</font>
<font color="#009900">\endgroup}</font>

<font color="#009900">% We use the same \entry macro as for the index entries.</font>
<font color="#009900">\let\tocentry = \entry</font>

<font color="#009900">% Space between chapter (or whatever) number and the title.</font>
<font color="#009900">\def\labelspace{\hskip1em \relax}</font>

<font color="#009900">\def\dopageno#1{{\rm #1}}</font>
<font color="#009900">\def\doshortpageno#1{{\rm #1}}</font>

<font color="#009900">\def\chapentryfonts{\secfonts \rm}</font>
<font color="#009900">\def\secentryfonts{\textfonts}</font>
<font color="#009900">\def\subsecentryfonts{\textfonts}</font>
<font color="#009900">\def\subsubsecentryfonts{\textfonts}</font>


<font color="#009900">\message{environments,}</font>
<font color="#009900">% @foo ... @end foo.</font>

<font color="#009900">% @tex ... @end tex    escapes into raw TeX temporarily.</font>
<font color="#009900">% One exception: @ is still an escape character, so that @end tex works.</font>
<font color="#009900">% But \@ or @@ will get a plain @ character.</font>

<font color="#009900">\envdef\tex{%</font>
<font color="#009900">  \setupmarkupstyle{tex}%</font>
<font color="#009900">  \catcode `\\=0 \catcode `\{=1 \catcode `\}=2</font>
<font color="#009900">  \catcode `\$=3 \catcode `\&amp;=4 \catcode `\#=6</font>
<font color="#009900">  \catcode `\^=7 \catcode `\_=8 \catcode `\~=\active \let~=\tie</font>
<font color="#009900">  \catcode `\%=14</font>
<font color="#009900">  \catcode `\+=\other</font>
<font color="#009900">  \catcode `\"=\other</font>
<font color="#009900">  \catcode `\|=\other</font>
<font color="#009900">  \catcode `\&lt;=\other</font>
<font color="#009900">  \catcode `\&gt;=\other</font>
<font color="#009900">  \catcode`\`=\other</font>
<font color="#009900">  \catcode`\'=\other</font>
<font color="#009900">  \escapechar=`\\</font>
<font color="#009900">  %</font>
<font color="#009900">  % ' is active in math mode (mathcode"8000).  So reset it, and all our</font>
<font color="#009900">  % other math active characters (just in case), to plain's definitions.</font>
<font color="#009900">  \mathactive</font>
<font color="#009900">  %</font>
<font color="#009900">  \let\b=\ptexb</font>
<font color="#009900">  \let\bullet=\ptexbullet</font>
<font color="#009900">  \let\c=\ptexc</font>
<font color="#009900">  \let\,=\ptexcomma</font>
<font color="#009900">  \let\.=\ptexdot</font>
<font color="#009900">  \let\dots=\ptexdots</font>
<font color="#009900">  \let\equiv=\ptexequiv</font>
<font color="#009900">  \let\!=\ptexexclam</font>
<font color="#009900">  \let\i=\ptexi</font>
<font color="#009900">  \let\indent=\ptexindent</font>
<font color="#009900">  \let\noindent=\ptexnoindent</font>
<font color="#009900">  \let\{=\ptexlbrace</font>
<font color="#009900">  \let\+=\tabalign</font>
<font color="#009900">  \let\}=\ptexrbrace</font>
<font color="#009900">  \let\/=\ptexslash</font>
<font color="#009900">  \let\*=\ptexstar</font>
<font color="#009900">  \let\t=\ptext</font>
<font color="#009900">  \expandafter \let\csname top\endcsname=\ptextop  % outer</font>
<font color="#009900">  \let\frenchspacing=\plainfrenchspacing</font>
<font color="#009900">  %</font>
<font color="#009900">  \def\endldots{\mathinner{\ldots\ldots\ldots\ldots}}%</font>
<font color="#009900">  \def\enddots{\relax\ifmmode\endldots\else$\mathsurround=0pt \endldots\,$\fi}%</font>
<font color="#009900">  \def\@{@}%</font>
<font color="#009900">}</font>
<font color="#009900">% There is no need to define \Etex.</font>

<font color="#009900">% Define @lisp ... @end lisp.</font>
<font color="#009900">% @lisp environment forms a group so it can rebind things,</font>
<font color="#009900">% including the definition of @end lisp (which normally is erroneous).</font>

<font color="#009900">% Amount to narrow the margins by for @lisp.</font>
<font color="#009900">\newskip\lispnarrowing \lispnarrowing=0.4in</font>

<font color="#009900">% This is the definition that ^^M gets inside @lisp, @example, and other</font>
<font color="#009900">% such environments.  \null is better than a space, since it doesn't</font>
<font color="#009900">% have any width.</font>
<font color="#009900">\def\lisppar{\null\endgraf}</font>

<font color="#009900">% This space is always present above and below environments.</font>
<font color="#009900">\newskip\envskipamount \envskipamount = 0pt</font>

<font color="#009900">% Make spacing and below environment symmetrical.  We use \parskip here</font>
<font color="#009900">% to help in doing that, since in @example-like environments \parskip</font>
<font color="#009900">% is reset to zero; thus the \afterenvbreak inserts no space -- but the</font>
<font color="#009900">% start of the next paragraph will insert \parskip.</font>
<font color="#009900">%</font>
<font color="#009900">\def\aboveenvbreak{{%</font>
<font color="#009900">  % =10000 instead of &lt;10000 because of a special case in \itemzzz and</font>
<font color="#009900">  % \sectionheading, q.v.</font>
<font color="#009900">  \ifnum \lastpenalty=10000 \else</font>
<font color="#009900">    \advance\envskipamount by \parskip</font>
<font color="#009900">    \endgraf</font>
<font color="#009900">    \ifdim\lastskip&lt;\envskipamount</font>
<font color="#009900">      \removelastskip</font>
<font color="#009900">      % it's not a good place to break if the last penalty was \nobreak</font>
<font color="#009900">      % or better ...</font>
<font color="#009900">      \ifnum\lastpenalty&lt;10000 \penalty-50 \fi</font>
<font color="#009900">      \vskip\envskipamount</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">}}</font>

<font color="#009900">\let\afterenvbreak = \aboveenvbreak</font>

<font color="#009900">% \nonarrowing is a flag.  If "set", @lisp etc don't narrow margins; it will</font>
<font color="#009900">% also clear it, so that its embedded environments do the narrowing again.</font>
<font color="#009900">\let\nonarrowing=\relax</font>

<font color="#009900">% @cartouche ... @end cartouche: draw rectangle w/rounded corners around</font>
<font color="#009900">% environment contents.</font>
<font color="#009900">\font\circle=lcircle10</font>
<font color="#009900">\newdimen\circthick</font>
<font color="#009900">\newdimen\cartouter\newdimen\cartinner</font>
<font color="#009900">\newskip\normbskip\newskip\normpskip\newskip\normlskip</font>
<font color="#009900">\circthick=\fontdimen8\circle</font>
<font color="#009900">%</font>
<font color="#009900">\def\ctl{{\circle\char'013\hskip -6pt}}% 6pt from pl file: 1/2charwidth</font>
<font color="#009900">\def\ctr{{\hskip 6pt\circle\char'010}}</font>
<font color="#009900">\def\cbl{{\circle\char'012\hskip -6pt}}</font>
<font color="#009900">\def\cbr{{\hskip 6pt\circle\char'011}}</font>
<font color="#009900">\def\carttop{\hbox to \cartouter{\hskip\lskip</font>
<font color="#009900">        \ctl\leaders\hrule height\circthick\hfil\ctr</font>
<font color="#009900">        \hskip\rskip}}</font>
<font color="#009900">\def\cartbot{\hbox to \cartouter{\hskip\lskip</font>
<font color="#009900">        \cbl\leaders\hrule height\circthick\hfil\cbr</font>
<font color="#009900">        \hskip\rskip}}</font>
<font color="#009900">%</font>
<font color="#009900">\newskip\lskip\newskip\rskip</font>

<font color="#009900">\envdef\cartouche{%</font>
<font color="#009900">  \ifhmode\par\fi  % can't be in the midst of a paragraph.</font>
<font color="#009900">  \startsavinginserts</font>
<font color="#009900">  \lskip=\leftskip \rskip=\rightskip</font>
<font color="#009900">  \leftskip=0pt\rightskip=0pt % we want these *outside*.</font>
<font color="#009900">  \cartinner=\hsize \advance\cartinner by-\lskip</font>
<font color="#009900">  \advance\cartinner by-\rskip</font>
<font color="#009900">  \cartouter=\hsize</font>
<font color="#009900">  \advance\cartouter by 18.4pt	% allow for 3pt kerns on either</font>
<font color="#009900">				% side, and for 6pt waste from</font>
<font color="#009900">				% each corner char, and rule thickness</font>
<font color="#009900">  \normbskip=\baselineskip \normpskip=\parskip \normlskip=\lineskip</font>
<font color="#009900">  % Flag to tell @lisp, etc., not to narrow margin.</font>
<font color="#009900">  \let\nonarrowing = t%</font>
<font color="#009900">  %</font>
<font color="#009900">  % If this cartouche directly follows a sectioning command, we need the</font>
<font color="#009900">  % \parskip glue (backspaced over by default) or the cartouche can</font>
<font color="#009900">  % collide with the section heading.</font>
<font color="#009900">  \ifnum\lastpenalty&gt;10000 \vskip\parskip \penalty\lastpenalty \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  \vbox\bgroup</font>
<font color="#009900">      \baselineskip=0pt\parskip=0pt\lineskip=0pt</font>
<font color="#009900">      \carttop</font>
<font color="#009900">      \hbox\bgroup</font>
<font color="#009900">	  \hskip\lskip</font>
<font color="#009900">	  \vrule\kern3pt</font>
<font color="#009900">	  \vbox\bgroup</font>
<font color="#009900">	      \kern3pt</font>
<font color="#009900">	      \hsize=\cartinner</font>
<font color="#009900">	      \baselineskip=\normbskip</font>
<font color="#009900">	      \lineskip=\normlskip</font>
<font color="#009900">	      \parskip=\normpskip</font>
<font color="#009900">	      \vskip -\parskip</font>
<font color="#009900">	      \comment % For explanation, see the end of def\group.</font>
<font color="#009900">}</font>
<font color="#009900">\def\Ecartouche{%</font>
<font color="#009900">              \ifhmode\par\fi</font>
<font color="#009900">	      \kern3pt</font>
<font color="#009900">	  \egroup</font>
<font color="#009900">	  \kern3pt\vrule</font>
<font color="#009900">	  \hskip\rskip</font>
<font color="#009900">      \egroup</font>
<font color="#009900">      \cartbot</font>
<font color="#009900">  \egroup</font>
<font color="#009900">  \checkinserts</font>
<font color="#009900">}</font>


<font color="#009900">% This macro is called at the beginning of all the @example variants,</font>
<font color="#009900">% inside a group.</font>
<font color="#009900">\newdimen\nonfillparindent</font>
<font color="#009900">\def\nonfillstart{%</font>
<font color="#009900">  \aboveenvbreak</font>
<font color="#009900">  \hfuzz = 12pt % Don't be fussy</font>
<font color="#009900">  \sepspaces % Make spaces be word-separators rather than space tokens.</font>
<font color="#009900">  \let\par = \lisppar % don't ignore blank lines</font>
<font color="#009900">  \obeylines % each line of input is a line of output</font>
<font color="#009900">  \parskip = 0pt</font>
<font color="#009900">  % Turn off paragraph indentation but redefine \indent to emulate</font>
<font color="#009900">  % the normal \indent.</font>
<font color="#009900">  \nonfillparindent=\parindent</font>
<font color="#009900">  \parindent = 0pt</font>
<font color="#009900">  \let\indent\nonfillindent</font>
<font color="#009900">  %</font>
<font color="#009900">  \emergencystretch = 0pt % don't try to avoid overfull boxes</font>
<font color="#009900">  \ifx\nonarrowing\relax</font>
<font color="#009900">    \advance \leftskip by \lispnarrowing</font>
<font color="#009900">    \exdentamount=\lispnarrowing</font>
<font color="#009900">  \else</font>
<font color="#009900">    \let\nonarrowing = \relax</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \let\exdent=\nofillexdent</font>
<font color="#009900">}</font>

<font color="#009900">\begingroup</font>
<font color="#009900">\obeyspaces</font>
<font color="#009900">% We want to swallow spaces (but not other tokens) after the fake</font>
<font color="#009900">% @indent in our nonfill-environments, where spaces are normally</font>
<font color="#009900">% active and set to @tie, resulting in them not being ignored after</font>
<font color="#009900">% @indent.</font>
<font color="#009900">\gdef\nonfillindent{\futurelet\temp\nonfillindentcheck}%</font>
<font color="#009900">\gdef\nonfillindentcheck{%</font>
<font color="#009900">\ifx\temp %</font>
<font color="#009900">\expandafter\nonfillindentgobble%</font>
<font color="#009900">\else%</font>
<font color="#009900">\leavevmode\nonfillindentbox%</font>
<font color="#009900">\fi%</font>
<font color="#009900">}%</font>
<font color="#009900">\endgroup</font>
<font color="#009900">\def\nonfillindentgobble#1{\nonfillindent}</font>
<font color="#009900">\def\nonfillindentbox{\hbox to \nonfillparindent{\hss}}</font>

<font color="#009900">% If you want all examples etc. small: @set dispenvsize small.</font>
<font color="#009900">% If you want even small examples the full size: @set dispenvsize nosmall.</font>
<font color="#009900">% This affects the following displayed environments:</font>
<font color="#009900">%    @example, @display, @format, @lisp</font>
<font color="#009900">%</font>
<font color="#009900">\def\smallword{small}</font>
<font color="#009900">\def\nosmallword{nosmall}</font>
<font color="#009900">\let\SETdispenvsize\relax</font>
<font color="#009900">\def\setnormaldispenv{%</font>
<font color="#009900">  \ifx\SETdispenvsize\smallword</font>
<font color="#009900">    % end paragraph for sake of leading, in case document has no blank</font>
<font color="#009900">    % line.  This is redundant with what happens in \aboveenvbreak, but</font>
<font color="#009900">    % we need to do it before changing the fonts, and it's inconvenient</font>
<font color="#009900">    % to change the fonts afterward.</font>
<font color="#009900">    \ifnum \lastpenalty=10000 \else \endgraf \fi</font>
<font color="#009900">    \smallexamplefonts \rm</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>
<font color="#009900">\def\setsmalldispenv{%</font>
<font color="#009900">  \ifx\SETdispenvsize\nosmallword</font>
<font color="#009900">  \else</font>
<font color="#009900">    \ifnum \lastpenalty=10000 \else \endgraf \fi</font>
<font color="#009900">    \smallexamplefonts \rm</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% We often define two environments, @foo and @smallfoo.</font>
<font color="#009900">% Let's do it in one command.  #1 is the env name, #2 the definition.</font>
<font color="#009900">\def\makedispenvdef#1#2{%</font>
<font color="#009900">  \expandafter\envdef\csname#1\endcsname {\setnormaldispenv #2}%</font>
<font color="#009900">  \expandafter\envdef\csname small#1\endcsname {\setsmalldispenv #2}%</font>
<font color="#009900">  \expandafter\let\csname E#1\endcsname \afterenvbreak</font>
<font color="#009900">  \expandafter\let\csname Esmall#1\endcsname \afterenvbreak</font>
<font color="#009900">}</font>

<font color="#009900">% Define two environment synonyms (#1 and #2) for an environment.</font>
<font color="#009900">\def\maketwodispenvdef#1#2#3{%</font>
<font color="#009900">  \makedispenvdef{#1}{#3}%</font>
<font color="#009900">  \makedispenvdef{#2}{#3}%</font>
<font color="#009900">}</font>
<font color="#009900">%</font>
<font color="#009900">% @lisp: indented, narrowed, typewriter font;</font>
<font color="#009900">% @example: same as @lisp.</font>
<font color="#009900">%</font>
<font color="#009900">% @smallexample and @smalllisp: use smaller fonts.</font>
<font color="#009900">% Originally contributed by Pavel@xerox.</font>
<font color="#009900">%</font>
<font color="#009900">\maketwodispenvdef{lisp}{example}{%</font>
<font color="#009900">  \nonfillstart</font>
<font color="#009900">  \tt\setupmarkupstyle{example}%</font>
<font color="#009900">  \let\kbdfont = \kbdexamplefont % Allow @kbd to do something special.</font>
<font color="#009900">  \gobble % eat return</font>
<font color="#009900">}</font>
<font color="#009900">% @display/@smalldisplay: same as @lisp except keep current font.</font>
<font color="#009900">%</font>
<font color="#009900">\makedispenvdef{display}{%</font>
<font color="#009900">  \nonfillstart</font>
<font color="#009900">  \gobble</font>
<font color="#009900">}</font>

<font color="#009900">% @format/@smallformat: same as @display except don't narrow margins.</font>
<font color="#009900">%</font>
<font color="#009900">\makedispenvdef{format}{%</font>
<font color="#009900">  \let\nonarrowing = t%</font>
<font color="#009900">  \nonfillstart</font>
<font color="#009900">  \gobble</font>
<font color="#009900">}</font>

<font color="#009900">% @flushleft: same as @format, but doesn't obey \SETdispenvsize.</font>
<font color="#009900">\envdef\flushleft{%</font>
<font color="#009900">  \let\nonarrowing = t%</font>
<font color="#009900">  \nonfillstart</font>
<font color="#009900">  \gobble</font>
<font color="#009900">}</font>
<font color="#009900">\let\Eflushleft = \afterenvbreak</font>

<font color="#009900">% @flushright.</font>
<font color="#009900">%</font>
<font color="#009900">\envdef\flushright{%</font>
<font color="#009900">  \let\nonarrowing = t%</font>
<font color="#009900">  \nonfillstart</font>
<font color="#009900">  \advance\leftskip by 0pt plus 1fill\relax</font>
<font color="#009900">  \gobble</font>
<font color="#009900">}</font>
<font color="#009900">\let\Eflushright = \afterenvbreak</font>


<font color="#009900">% @raggedright does more-or-less normal line breaking but no right</font>
<font color="#009900">% justification.  From plain.tex.</font>
<font color="#009900">\envdef\raggedright{%</font>
<font color="#009900">  \rightskip0pt plus2em \spaceskip.3333em \xspaceskip.5em\relax</font>
<font color="#009900">}</font>
<font color="#009900">\let\Eraggedright\par</font>

<font color="#009900">\envdef\raggedleft{%</font>
<font color="#009900">  \parindent=0pt \leftskip0pt plus2em</font>
<font color="#009900">  \spaceskip.3333em \xspaceskip.5em \parfillskip=0pt</font>
<font color="#009900">  \hbadness=10000 % Last line will usually be underfull, so turn off</font>
<font color="#009900">                  % badness reporting.</font>
<font color="#009900">}</font>
<font color="#009900">\let\Eraggedleft\par</font>

<font color="#009900">\envdef\raggedcenter{%</font>
<font color="#009900">  \parindent=0pt \rightskip0pt plus1em \leftskip0pt plus1em</font>
<font color="#009900">  \spaceskip.3333em \xspaceskip.5em \parfillskip=0pt</font>
<font color="#009900">  \hbadness=10000 % Last line will usually be underfull, so turn off</font>
<font color="#009900">                  % badness reporting.</font>
<font color="#009900">}</font>
<font color="#009900">\let\Eraggedcenter\par</font>


<font color="#009900">% @quotation does normal linebreaking (hence we can't use \nonfillstart)</font>
<font color="#009900">% and narrows the margins.  We keep \parskip nonzero in general, since</font>
<font color="#009900">% we're doing normal filling.  So, when using \aboveenvbreak and</font>
<font color="#009900">% \afterenvbreak, temporarily make \parskip 0.</font>
<font color="#009900">%</font>
<font color="#009900">\makedispenvdef{quotation}{\quotationstart}</font>
<font color="#009900">%</font>
<font color="#009900">\def\quotationstart{%</font>
<font color="#009900">  {\parskip=0pt \aboveenvbreak}% because \aboveenvbreak inserts \parskip</font>
<font color="#009900">  \parindent=0pt</font>
<font color="#009900">  %</font>
<font color="#009900">  % @cartouche defines \nonarrowing to inhibit narrowing at next level down.</font>
<font color="#009900">  \ifx\nonarrowing\relax</font>
<font color="#009900">    \advance\leftskip by \lispnarrowing</font>
<font color="#009900">    \advance\rightskip by \lispnarrowing</font>
<font color="#009900">    \exdentamount = \lispnarrowing</font>
<font color="#009900">  \else</font>
<font color="#009900">    \let\nonarrowing = \relax</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \parsearg\quotationlabel</font>
<font color="#009900">}</font>

<font color="#009900">% We have retained a nonzero parskip for the environment, since we're</font>
<font color="#009900">% doing normal filling.</font>
<font color="#009900">%</font>
<font color="#009900">\def\Equotation{%</font>
<font color="#009900">  \par</font>
<font color="#009900">  \ifx\quotationauthor\thisisundefined\else</font>
<font color="#009900">    % indent a bit.</font>
<font color="#009900">    \leftline{\kern 2\leftskip \sl ---\quotationauthor}%</font>
<font color="#009900">  \fi</font>
<font color="#009900">  {\parskip=0pt \afterenvbreak}%</font>
<font color="#009900">}</font>
<font color="#009900">\def\Esmallquotation{\Equotation}</font>

<font color="#009900">% If we're given an argument, typeset it in bold with a colon after.</font>
<font color="#009900">\def\quotationlabel#1{%</font>
<font color="#009900">  \def\temp{#1}%</font>
<font color="#009900">  \ifx\temp\empty \else</font>
<font color="#009900">    {\bf #1: }%</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>


<font color="#009900">% LaTeX-like @verbatim...@end verbatim and @verb{&lt;char&gt;...&lt;char&gt;}</font>
<font color="#009900">% If we want to allow any &lt;char&gt; as delimiter,</font>
<font color="#009900">% we need the curly braces so that makeinfo sees the @verb command, eg:</font>
<font color="#009900">% `@verbx...x' would look like the '@verbx' command.  --janneke@gnu.org</font>
<font color="#009900">%</font>
<font color="#009900">% [Knuth]: Donald Ervin Knuth, 1996.  The TeXbook.</font>
<font color="#009900">%</font>
<font color="#009900">% [Knuth] p.344; only we need to do the other characters Texinfo sets</font>
<font color="#009900">% active too.  Otherwise, they get lost as the first character on a</font>
<font color="#009900">% verbatim line.</font>
<font color="#009900">\def\dospecials{%</font>
<font color="#009900">  \do\ \do\\\do\{\do\}\do\$\do\&amp;%</font>
<font color="#009900">  \do\#\do\^\do\^^K\do\_\do\^^A\do\%\do\~%</font>
<font color="#009900">  \do\&lt;\do\&gt;\do\|\do\@\do+\do\"%</font>
<font color="#009900">  % Don't do the quotes -- if we do, @set txicodequoteundirected and</font>
<font color="#009900">  % @set txicodequotebacktick will not have effect on @verb and</font>
<font color="#009900">  % @verbatim, and ?` and !` ligatures won't get disabled.</font>
<font color="#009900">  %\do\`\do\'%</font>
<font color="#009900">}</font>
<font color="#009900">%</font>
<font color="#009900">% [Knuth] p. 380</font>
<font color="#009900">\def\uncatcodespecials{%</font>
<font color="#009900">  \def\do##1{\catcode`##1=\other}\dospecials}</font>
<font color="#009900">%</font>
<font color="#009900">% Setup for the @verb command.</font>
<font color="#009900">%</font>
<font color="#009900">% Eight spaces for a tab</font>
<font color="#009900">\begingroup</font>
<font color="#009900">  \catcode`\^^I=\active</font>
<font color="#009900">  \gdef\tabeightspaces{\catcode`\^^I=\active\def^^I{\ \ \ \ \ \ \ \ }}</font>
<font color="#009900">\endgroup</font>
<font color="#009900">%</font>
<font color="#009900">\def\setupverb{%</font>
<font color="#009900">  \tt  % easiest (and conventionally used) font for verbatim</font>
<font color="#009900">  \def\par{\leavevmode\endgraf}%</font>
<font color="#009900">  \setupmarkupstyle{verb}%</font>
<font color="#009900">  \tabeightspaces</font>
<font color="#009900">  % Respect line breaks,</font>
<font color="#009900">  % print special symbols as themselves, and</font>
<font color="#009900">  % make each space count</font>
<font color="#009900">  % must do in this order:</font>
<font color="#009900">  \obeylines \uncatcodespecials \sepspaces</font>
<font color="#009900">}</font>

<font color="#009900">% Setup for the @verbatim environment</font>
<font color="#009900">%</font>
<font color="#009900">% Real tab expansion.</font>
<font color="#009900">\newdimen\tabw \setbox0=\hbox{\tt\space} \tabw=8\wd0 % tab amount</font>
<font color="#009900">%</font>
<font color="#009900">% We typeset each line of the verbatim in an \hbox, so we can handle</font>
<font color="#009900">% tabs.  The \global is in case the verbatim line starts with an accent,</font>
<font color="#009900">% or some other command that starts with a begin-group.  Otherwise, the</font>
<font color="#009900">% entire \verbbox would disappear at the corresponding end-group, before</font>
<font color="#009900">% it is typeset.  Meanwhile, we can't have nested verbatim commands</font>
<font color="#009900">% (can we?), so the \global won't be overwriting itself.</font>
<font color="#009900">\newbox\verbbox</font>
<font color="#009900">\def\starttabbox{\global\setbox\verbbox=\hbox\bgroup}</font>
<font color="#009900">%</font>
<font color="#009900">\begingroup</font>
<font color="#009900">  \catcode`\^^I=\active</font>
<font color="#009900">  \gdef\tabexpand{%</font>
<font color="#009900">    \catcode`\^^I=\active</font>
<font color="#009900">    \def^^I{\leavevmode\egroup</font>
<font color="#009900">      \dimen\verbbox=\wd\verbbox % the width so far, or since the previous tab</font>
<font color="#009900">      \divide\dimen\verbbox by\tabw</font>
<font color="#009900">      \multiply\dimen\verbbox by\tabw % compute previous multiple of \tabw</font>
<font color="#009900">      \advance\dimen\verbbox by\tabw  % advance to next multiple of \tabw</font>
<font color="#009900">      \wd\verbbox=\dimen\verbbox \box\verbbox \starttabbox</font>
<font color="#009900">    }%</font>
<font color="#009900">  }</font>
<font color="#009900">\endgroup</font>

<font color="#009900">% start the verbatim environment.</font>
<font color="#009900">\def\setupverbatim{%</font>
<font color="#009900">  \let\nonarrowing = t%</font>
<font color="#009900">  \nonfillstart</font>
<font color="#009900">  \tt % easiest (and conventionally used) font for verbatim</font>
<font color="#009900">  % The \leavevmode here is for blank lines.  Otherwise, we would</font>
<font color="#009900">  % never \starttabox and the \egroup would end verbatim mode.</font>
<font color="#009900">  \def\par{\leavevmode\egroup\box\verbbox\endgraf}%</font>
<font color="#009900">  \tabexpand</font>
<font color="#009900">  \setupmarkupstyle{verbatim}%</font>
<font color="#009900">  % Respect line breaks,</font>
<font color="#009900">  % print special symbols as themselves, and</font>
<font color="#009900">  % make each space count.</font>
<font color="#009900">  % Must do in this order:</font>
<font color="#009900">  \obeylines \uncatcodespecials \sepspaces</font>
<font color="#009900">  \everypar{\starttabbox}%</font>
<font color="#009900">}</font>

<font color="#009900">% Do the @verb magic: verbatim text is quoted by unique</font>
<font color="#009900">% delimiter characters.  Before first delimiter expect a</font>
<font color="#009900">% right brace, after last delimiter expect closing brace:</font>
<font color="#009900">%</font>
<font color="#009900">%    \def\doverb'{'&lt;char&gt;#1&lt;char&gt;'}'{#1}</font>
<font color="#009900">%</font>
<font color="#009900">% [Knuth] p. 382; only eat outer {}</font>
<font color="#009900">\begingroup</font>
<font color="#009900">  \catcode`[=1\catcode`]=2\catcode`\{=\other\catcode`\}=\other</font>
<font color="#009900">  \gdef\doverb{#1[\def\next##1#1}[##1\endgroup]\next]</font>
<font color="#009900">\endgroup</font>
<font color="#009900">%</font>
<font color="#009900">\def\verb{\begingroup\setupverb\doverb}</font>
<font color="#009900">%</font>
<font color="#009900">%</font>
<font color="#009900">% Do the @verbatim magic: define the macro \doverbatim so that</font>
<font color="#009900">% the (first) argument ends when '@end verbatim' is reached, ie:</font>
<font color="#009900">%</font>
<font color="#009900">%     \def\doverbatim#1@end verbatim{#1}</font>
<font color="#009900">%</font>
<font color="#009900">% For Texinfo it's a lot easier than for LaTeX,</font>
<font color="#009900">% because texinfo's \verbatim doesn't stop at '\end{verbatim}':</font>
<font color="#009900">% we need not redefine '\', '{' and '}'.</font>
<font color="#009900">%</font>
<font color="#009900">% Inspired by LaTeX's verbatim command set [latex.ltx]</font>
<font color="#009900">%</font>
<font color="#009900">\begingroup</font>
<font color="#009900">  \catcode`\ =\active</font>
<font color="#009900">  \obeylines %</font>
<font color="#009900">  % ignore everything up to the first ^^M, that's the newline at the end</font>
<font color="#009900">  % of the @verbatim input line itself.  Otherwise we get an extra blank</font>
<font color="#009900">  % line in the output.</font>
<font color="#009900">  \xdef\doverbatim#1^^M#2@end verbatim{#2\noexpand\end\gobble verbatim}%</font>
<font color="#009900">  % We really want {...\end verbatim} in the body of the macro, but</font>
<font color="#009900">  % without the active space; thus we have to use \xdef and \gobble.</font>
<font color="#009900">\endgroup</font>
<font color="#009900">%</font>
<font color="#009900">\envdef\verbatim{%</font>
<font color="#009900">    \setupverbatim\doverbatim</font>
<font color="#009900">}</font>
<font color="#009900">\let\Everbatim = \afterenvbreak</font>


<font color="#009900">% @verbatiminclude FILE - insert text of file in verbatim environment.</font>
<font color="#009900">%</font>
<font color="#009900">\def\verbatiminclude{\parseargusing\filenamecatcodes\doverbatiminclude}</font>
<font color="#009900">%</font>
<font color="#009900">\def\doverbatiminclude#1{%</font>
<font color="#009900">  {%</font>
<font color="#009900">    \makevalueexpandable</font>
<font color="#009900">    \setupverbatim</font>
<font color="#009900">    \indexnofonts       % Allow `@@' and other weird things in file names.</font>
<font color="#009900">    \wlog{texinfo.tex: doing @verbatiminclude of #1^^J}%</font>
<font color="#009900">    \input #1</font>
<font color="#009900">    \afterenvbreak</font>
<font color="#009900">  }%</font>
<font color="#009900">}</font>

<font color="#009900">% @copying ... @end copying.</font>
<font color="#009900">% Save the text away for @insertcopying later.</font>
<font color="#009900">%</font>
<font color="#009900">% We save the uninterpreted tokens, rather than creating a box.</font>
<font color="#009900">% Saving the text in a box would be much easier, but then all the</font>
<font color="#009900">% typesetting commands (@smallbook, font changes, etc.) have to be done</font>
<font color="#009900">% beforehand -- and a) we want @copying to be done first in the source</font>
<font color="#009900">% file; b) letting users define the frontmatter in as flexible order as</font>
<font color="#009900">% possible is very desirable.</font>
<font color="#009900">%</font>
<font color="#009900">\def\copying{\checkenv{}\begingroup\scanargctxt\docopying}</font>
<font color="#009900">\def\docopying#1@end copying{\endgroup\def\copyingtext{#1}}</font>
<font color="#009900">%</font>
<font color="#009900">\def\insertcopying{%</font>
<font color="#009900">  \begingroup</font>
<font color="#009900">    \parindent = 0pt  % paragraph indentation looks wrong on title page</font>
<font color="#009900">    \scanexp\copyingtext</font>
<font color="#009900">  \endgroup</font>
<font color="#009900">}</font>


<font color="#009900">\message{defuns,}</font>
<font color="#009900">% @defun etc.</font>

<font color="#009900">\newskip\defbodyindent \defbodyindent=.4in</font>
<font color="#009900">\newskip\defargsindent \defargsindent=50pt</font>
<font color="#009900">\newskip\deflastargmargin \deflastargmargin=18pt</font>
<font color="#009900">\newcount\defunpenalty</font>

<font color="#009900">% Start the processing of @deffn:</font>
<font color="#009900">\def\startdefun{%</font>
<font color="#009900">  \ifnum\lastpenalty&lt;10000</font>
<font color="#009900">    \medbreak</font>
<font color="#009900">    \defunpenalty=10003 % Will keep this @deffn together with the</font>
<font color="#009900">                        % following @def command, see below.</font>
<font color="#009900">  \else</font>
<font color="#009900">    % If there are two @def commands in a row, we'll have a \nobreak,</font>
<font color="#009900">    % which is there to keep the function description together with its</font>
<font color="#009900">    % header.  But if there's nothing but headers, we need to allow a</font>
<font color="#009900">    % break somewhere.  Check specifically for penalty 10002, inserted</font>
<font color="#009900">    % by \printdefunline, instead of 10000, since the sectioning</font>
<font color="#009900">    % commands also insert a nobreak penalty, and we don't want to allow</font>
<font color="#009900">    % a break between a section heading and a defun.</font>
<font color="#009900">    %</font>
<font color="#009900">    % As a further refinement, we avoid "club" headers by signalling</font>
<font color="#009900">    % with penalty of 10003 after the very first @deffn in the</font>
<font color="#009900">    % sequence (see above), and penalty of 10002 after any following</font>
<font color="#009900">    % @def command.</font>
<font color="#009900">    \ifnum\lastpenalty=10002 \penalty2000 \else \defunpenalty=10002 \fi</font>
<font color="#009900">    %</font>
<font color="#009900">    % Similarly, after a section heading, do not allow a break.</font>
<font color="#009900">    % But do insert the glue.</font>
<font color="#009900">    \medskip  % preceded by discardable penalty, so not a breakpoint</font>
<font color="#009900">  \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  \parindent=0in</font>
<font color="#009900">  \advance\leftskip by \defbodyindent</font>
<font color="#009900">  \exdentamount=\defbodyindent</font>
<font color="#009900">}</font>

<font color="#009900">\def\dodefunx#1{%</font>
<font color="#009900">  % First, check whether we are in the right environment:</font>
<font color="#009900">  \checkenv#1%</font>
<font color="#009900">  %</font>
<font color="#009900">  % As above, allow line break if we have multiple x headers in a row.</font>
<font color="#009900">  % It's not a great place, though.</font>
<font color="#009900">  \ifnum\lastpenalty=10002 \penalty3000 \else \defunpenalty=10002 \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  % And now, it's time to reuse the body of the original defun:</font>
<font color="#009900">  \expandafter\gobbledefun#1%</font>
<font color="#009900">}</font>
<font color="#009900">\def\gobbledefun#1\startdefun{}</font>

<font color="#009900">% \printdefunline \deffnheader{text}</font>
<font color="#009900">%</font>
<font color="#009900">\def\printdefunline#1#2{%</font>
<font color="#009900">  \begingroup</font>
<font color="#009900">    % call \deffnheader:</font>
<font color="#009900">    #1#2 \endheader</font>
<font color="#009900">    % common ending:</font>
<font color="#009900">    \interlinepenalty = 10000</font>
<font color="#009900">    \advance\rightskip by 0pt plus 1fil\relax</font>
<font color="#009900">    \endgraf</font>
<font color="#009900">    \nobreak\vskip -\parskip</font>
<font color="#009900">    \penalty\defunpenalty  % signal to \startdefun and \dodefunx</font>
<font color="#009900">    % Some of the @defun-type tags do not enable magic parentheses,</font>
<font color="#009900">    % rendering the following check redundant.  But we don't optimize.</font>
<font color="#009900">    \checkparencounts</font>
<font color="#009900">  \endgroup</font>
<font color="#009900">}</font>

<font color="#009900">\def\Edefun{\endgraf\medbreak}</font>

<font color="#009900">% \makedefun{deffn} creates \deffn, \deffnx and \Edeffn;</font>
<font color="#009900">% the only thing remaining is to define \deffnheader.</font>
<font color="#009900">%</font>
<font color="#009900">\def\makedefun#1{%</font>
<font color="#009900">  \expandafter\let\csname E#1\endcsname = \Edefun</font>
<font color="#009900">  \edef\temp{\noexpand\domakedefun</font>
<font color="#009900">    \makecsname{#1}\makecsname{#1x}\makecsname{#1header}}%</font>
<font color="#009900">  \temp</font>
<font color="#009900">}</font>

<font color="#009900">% \domakedefun \deffn \deffnx \deffnheader</font>
<font color="#009900">%</font>
<font color="#009900">% Define \deffn and \deffnx, without parameters.</font>
<font color="#009900">% \deffnheader has to be defined explicitly.</font>
<font color="#009900">%</font>
<font color="#009900">\def\domakedefun#1#2#3{%</font>
<font color="#009900">  \envdef#1{%</font>
<font color="#009900">    \startdefun</font>
<font color="#009900">    \doingtypefnfalse    % distinguish typed functions from all else</font>
<font color="#009900">    \parseargusing\activeparens{\printdefunline#3}%</font>
<font color="#009900">  }%</font>
<font color="#009900">  \def#2{\dodefunx#1}%</font>
<font color="#009900">  \def#3%</font>
<font color="#009900">}</font>

<font color="#009900">\newif\ifdoingtypefn       % doing typed function?</font>
<font color="#009900">\newif\ifrettypeownline    % typeset return type on its own line?</font>

<font color="#009900">% @deftypefnnewline on|off says whether the return type of typed functions</font>
<font color="#009900">% are printed on their own line.  This affects @deftypefn, @deftypefun,</font>
<font color="#009900">% @deftypeop, and @deftypemethod.</font>
<font color="#009900">% </font>
<font color="#009900">\parseargdef\deftypefnnewline{%</font>
<font color="#009900">  \def\temp{#1}%</font>
<font color="#009900">  \ifx\temp\onword</font>
<font color="#009900">    \expandafter\let\csname SETtxideftypefnnl\endcsname</font>
<font color="#009900">      = \empty</font>
<font color="#009900">  \else\ifx\temp\offword</font>
<font color="#009900">    \expandafter\let\csname SETtxideftypefnnl\endcsname</font>
<font color="#009900">      = \relax</font>
<font color="#009900">  \else</font>
<font color="#009900">    \errhelp = \EMsimple</font>
<font color="#009900">    \errmessage{Unknown @txideftypefnnl value `\temp',</font>
<font color="#009900">                must be on|off}%</font>
<font color="#009900">  \fi\fi</font>
<font color="#009900">}</font>

<font color="#009900">% Untyped functions:</font>

<font color="#009900">% @deffn category name args</font>
<font color="#009900">\makedefun{deffn}{\deffngeneral{}}</font>

<font color="#009900">% @deffn category class name args</font>
<font color="#009900">\makedefun{defop}#1 {\defopon{#1\ \putwordon}}</font>

<font color="#009900">% \defopon {category on}class name args</font>
<font color="#009900">\def\defopon#1#2 {\deffngeneral{\putwordon\ \code{#2}}{#1\ \code{#2}} }</font>

<font color="#009900">% \deffngeneral {subind}category name args</font>
<font color="#009900">%</font>
<font color="#009900">\def\deffngeneral#1#2 #3 #4\endheader{%</font>
<font color="#009900">  % Remember that \dosubind{fn}{foo}{} is equivalent to \doind{fn}{foo}.</font>
<font color="#009900">  \dosubind{fn}{\code{#3}}{#1}%</font>
<font color="#009900">  \defname{#2}{}{#3}\magicamp\defunargs{#4\unskip}%</font>
<font color="#009900">}</font>

<font color="#009900">% Typed functions:</font>

<font color="#009900">% @deftypefn category type name args</font>
<font color="#009900">\makedefun{deftypefn}{\deftypefngeneral{}}</font>

<font color="#009900">% @deftypeop category class type name args</font>
<font color="#009900">\makedefun{deftypeop}#1 {\deftypeopon{#1\ \putwordon}}</font>

<font color="#009900">% \deftypeopon {category on}class type name args</font>
<font color="#009900">\def\deftypeopon#1#2 {\deftypefngeneral{\putwordon\ \code{#2}}{#1\ \code{#2}} }</font>

<font color="#009900">% \deftypefngeneral {subind}category type name args</font>
<font color="#009900">%</font>
<font color="#009900">\def\deftypefngeneral#1#2 #3 #4 #5\endheader{%</font>
<font color="#009900">  \dosubind{fn}{\code{#4}}{#1}%</font>
<font color="#009900">  \doingtypefntrue</font>
<font color="#009900">  \defname{#2}{#3}{#4}\defunargs{#5\unskip}%</font>
<font color="#009900">}</font>

<font color="#009900">% Typed variables:</font>

<font color="#009900">% @deftypevr category type var args</font>
<font color="#009900">\makedefun{deftypevr}{\deftypecvgeneral{}}</font>

<font color="#009900">% @deftypecv category class type var args</font>
<font color="#009900">\makedefun{deftypecv}#1 {\deftypecvof{#1\ \putwordof}}</font>

<font color="#009900">% \deftypecvof {category of}class type var args</font>
<font color="#009900">\def\deftypecvof#1#2 {\deftypecvgeneral{\putwordof\ \code{#2}}{#1\ \code{#2}} }</font>

<font color="#009900">% \deftypecvgeneral {subind}category type var args</font>
<font color="#009900">%</font>
<font color="#009900">\def\deftypecvgeneral#1#2 #3 #4 #5\endheader{%</font>
<font color="#009900">  \dosubind{vr}{\code{#4}}{#1}%</font>
<font color="#009900">  \defname{#2}{#3}{#4}\defunargs{#5\unskip}%</font>
<font color="#009900">}</font>

<font color="#009900">% Untyped variables:</font>

<font color="#009900">% @defvr category var args</font>
<font color="#009900">\makedefun{defvr}#1 {\deftypevrheader{#1} {} }</font>

<font color="#009900">% @defcv category class var args</font>
<font color="#009900">\makedefun{defcv}#1 {\defcvof{#1\ \putwordof}}</font>

<font color="#009900">% \defcvof {category of}class var args</font>
<font color="#009900">\def\defcvof#1#2 {\deftypecvof{#1}#2 {} }</font>

<font color="#009900">% Types:</font>

<font color="#009900">% @deftp category name args</font>
<font color="#009900">\makedefun{deftp}#1 #2 #3\endheader{%</font>
<font color="#009900">  \doind{tp}{\code{#2}}%</font>
<font color="#009900">  \defname{#1}{}{#2}\defunargs{#3\unskip}%</font>
<font color="#009900">}</font>

<font color="#009900">% Remaining @defun-like shortcuts:</font>
<font color="#009900">\makedefun{defun}{\deffnheader{\putwordDeffunc} }</font>
<font color="#009900">\makedefun{defmac}{\deffnheader{\putwordDefmac} }</font>
<font color="#009900">\makedefun{defspec}{\deffnheader{\putwordDefspec} }</font>
<font color="#009900">\makedefun{deftypefun}{\deftypefnheader{\putwordDeffunc} }</font>
<font color="#009900">\makedefun{defvar}{\defvrheader{\putwordDefvar} }</font>
<font color="#009900">\makedefun{defopt}{\defvrheader{\putwordDefopt} }</font>
<font color="#009900">\makedefun{deftypevar}{\deftypevrheader{\putwordDefvar} }</font>
<font color="#009900">\makedefun{defmethod}{\defopon\putwordMethodon}</font>
<font color="#009900">\makedefun{deftypemethod}{\deftypeopon\putwordMethodon}</font>
<font color="#009900">\makedefun{defivar}{\defcvof\putwordInstanceVariableof}</font>
<font color="#009900">\makedefun{deftypeivar}{\deftypecvof\putwordInstanceVariableof}</font>

<font color="#009900">% \defname, which formats the name of the @def (not the args).</font>
<font color="#009900">% #1 is the category, such as "Function".</font>
<font color="#009900">% #2 is the return type, if any.</font>
<font color="#009900">% #3 is the function name.</font>
<font color="#009900">%</font>
<font color="#009900">% We are followed by (but not passed) the arguments, if any.</font>
<font color="#009900">%</font>
<font color="#009900">\def\defname#1#2#3{%</font>
<font color="#009900">  \par</font>
<font color="#009900">  % Get the values of \leftskip and \rightskip as they were outside the @def...</font>
<font color="#009900">  \advance\leftskip by -\defbodyindent</font>
<font color="#009900">  %</font>
<font color="#009900">  % Determine if we are typesetting the return type of a typed function</font>
<font color="#009900">  % on a line by itself.</font>
<font color="#009900">  \rettypeownlinefalse</font>
<font color="#009900">  \ifdoingtypefn  % doing a typed function specifically?</font>
<font color="#009900">    % then check user option for putting return type on its own line:</font>
<font color="#009900">    \expandafter\ifx\csname SETtxideftypefnnl\endcsname\relax \else</font>
<font color="#009900">      \rettypeownlinetrue</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  % How we'll format the category name.  Putting it in brackets helps</font>
<font color="#009900">  % distinguish it from the body text that may end up on the next line</font>
<font color="#009900">  % just below it.</font>
<font color="#009900">  \def\temp{#1}%</font>
<font color="#009900">  \setbox0=\hbox{\kern\deflastargmargin \ifx\temp\empty\else [\rm\temp]\fi}</font>
<font color="#009900">  %</font>
<font color="#009900">  % Figure out line sizes for the paragraph shape.  We'll always have at</font>
<font color="#009900">  % least two.</font>
<font color="#009900">  \tempnum = 2</font>
<font color="#009900">  %</font>
<font color="#009900">  % The first line needs space for \box0; but if \rightskip is nonzero,</font>
<font color="#009900">  % we need only space for the part of \box0 which exceeds it:</font>
<font color="#009900">  \dimen0=\hsize  \advance\dimen0 by -\wd0  \advance\dimen0 by \rightskip</font>
<font color="#009900">  %</font>
<font color="#009900">  % If doing a return type on its own line, we'll have another line.</font>
<font color="#009900">  \ifrettypeownline</font>
<font color="#009900">    \advance\tempnum by 1</font>
<font color="#009900">    \def\maybeshapeline{0in \hsize}%</font>
<font color="#009900">  \else</font>
<font color="#009900">    \def\maybeshapeline{}%</font>
<font color="#009900">  \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  % The continuations:</font>
<font color="#009900">  \dimen2=\hsize  \advance\dimen2 by -\defargsindent</font>
<font color="#009900">  %</font>
<font color="#009900">  % The final paragraph shape:</font>
<font color="#009900">  \parshape \tempnum  0in \dimen0  \maybeshapeline  \defargsindent \dimen2</font>
<font color="#009900">  %</font>
<font color="#009900">  % Put the category name at the right margin.</font>
<font color="#009900">  \noindent</font>
<font color="#009900">  \hbox to 0pt{%</font>
<font color="#009900">    \hfil\box0 \kern-\hsize</font>
<font color="#009900">    % \hsize has to be shortened this way:</font>
<font color="#009900">    \kern\leftskip</font>
<font color="#009900">    % Intentionally do not respect \rightskip, since we need the space.</font>
<font color="#009900">  }%</font>
<font color="#009900">  %</font>
<font color="#009900">  % Allow all lines to be underfull without complaint:</font>
<font color="#009900">  \tolerance=10000 \hbadness=10000</font>
<font color="#009900">  \exdentamount=\defbodyindent</font>
<font color="#009900">  {%</font>
<font color="#009900">    % defun fonts. We use typewriter by default (used to be bold) because:</font>
<font color="#009900">    % . we're printing identifiers, they should be in tt in principle.</font>
<font color="#009900">    % . in languages with many accents, such as Czech or French, it's</font>
<font color="#009900">    %   common to leave accents off identifiers.  The result looks ok in</font>
<font color="#009900">    %   tt, but exceedingly strange in rm.</font>
<font color="#009900">    % . we don't want -- and --- to be treated as ligatures.</font>
<font color="#009900">    % . this still does not fix the ?` and !` ligatures, but so far no</font>
<font color="#009900">    %   one has made identifiers using them :).</font>
<font color="#009900">    \df \tt</font>
<font color="#009900">    \def\temp{#2}% text of the return type</font>
<font color="#009900">    \ifx\temp\empty\else</font>
<font color="#009900">      \tclose{\temp}% typeset the return type</font>
<font color="#009900">      \ifrettypeownline</font>
<font color="#009900">        % put return type on its own line; prohibit line break following:</font>
<font color="#009900">        \hfil\vadjust{\nobreak}\break  </font>
<font color="#009900">      \else</font>
<font color="#009900">        \space  % type on same line, so just followed by a space</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \fi           % no return type</font>
<font color="#009900">    #3% output function name</font>
<font color="#009900">  }%</font>
<font color="#009900">  {\rm\enskip}% hskip 0.5 em of \tenrm</font>
<font color="#009900">  %</font>
<font color="#009900">  \boldbrax</font>
<font color="#009900">  % arguments will be output next, if any.</font>
<font color="#009900">}</font>

<font color="#009900">% Print arguments in slanted roman (not ttsl), inconsistently with using</font>
<font color="#009900">% tt for the name.  This is because literal text is sometimes needed in</font>
<font color="#009900">% the argument list (groff manual), and ttsl and tt are not very</font>
<font color="#009900">% distinguishable.  Prevent hyphenation at `-' chars.</font>
<font color="#009900">%</font>
<font color="#009900">\def\defunargs#1{%</font>
<font color="#009900">  % use sl by default (not ttsl),</font>
<font color="#009900">  % tt for the names.</font>
<font color="#009900">  \df \sl \hyphenchar\font=0</font>
<font color="#009900">  %</font>
<font color="#009900">  % On the other hand, if an argument has two dashes (for instance), we</font>
<font color="#009900">  % want a way to get ttsl.  Let's try @var for that.</font>
<font color="#009900">  \def\var##1{{\setupmarkupstyle{var}\ttslanted{##1}}}%</font>
<font color="#009900">  #1%</font>
<font color="#009900">  \sl\hyphenchar\font=45</font>
<font color="#009900">}</font>

<font color="#009900">% We want ()&amp;[] to print specially on the defun line.</font>
<font color="#009900">%</font>
<font color="#009900">\def\activeparens{%</font>
<font color="#009900">  \catcode`\(=\active \catcode`\)=\active</font>
<font color="#009900">  \catcode`\[=\active \catcode`\]=\active</font>
<font color="#009900">  \catcode`\&amp;=\active</font>
<font color="#009900">}</font>

<font color="#009900">% Make control sequences which act like normal parenthesis chars.</font>
<font color="#009900">\let\lparen = ( \let\rparen = )</font>

<font color="#009900">% Be sure that we always have a definition for `(', etc.  For example,</font>
<font color="#009900">% if the fn name has parens in it, \boldbrax will not be in effect yet,</font>
<font color="#009900">% so TeX would otherwise complain about undefined control sequence.</font>
<font color="#009900">{</font>
<font color="#009900">  \activeparens</font>
<font color="#009900">  \global\let(=\lparen \global\let)=\rparen</font>
<font color="#009900">  \global\let[=\lbrack \global\let]=\rbrack</font>
<font color="#009900">  \global\let&amp; = \&amp;</font>

<font color="#009900">  \gdef\boldbrax{\let(=\opnr\let)=\clnr\let[=\lbrb\let]=\rbrb}</font>
<font color="#009900">  \gdef\magicamp{\let&amp;=\amprm}</font>
<font color="#009900">}</font>

<font color="#009900">\newcount\parencount</font>

<font color="#009900">% If we encounter &amp;foo, then turn on ()-hacking afterwards</font>
<font color="#009900">\newif\ifampseen</font>
<font color="#009900">\def\amprm#1 {\ampseentrue{\bf\&amp;#1 }}</font>

<font color="#009900">\def\parenfont{%</font>
<font color="#009900">  \ifampseen</font>
<font color="#009900">    % At the first level, print parens in roman,</font>
<font color="#009900">    % otherwise use the default font.</font>
<font color="#009900">    \ifnum \parencount=1 \rm \fi</font>
<font color="#009900">  \else</font>
<font color="#009900">    % The \sf parens (in \boldbrax) actually are a little bolder than</font>
<font color="#009900">    % the contained text.  This is especially needed for [ and ] .</font>
<font color="#009900">    \sf</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>
<font color="#009900">\def\infirstlevel#1{%</font>
<font color="#009900">  \ifampseen</font>
<font color="#009900">    \ifnum\parencount=1</font>
<font color="#009900">      #1%</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>
<font color="#009900">\def\bfafterword#1 {#1 \bf}</font>

<font color="#009900">\def\opnr{%</font>
<font color="#009900">  \global\advance\parencount by 1</font>
<font color="#009900">  {\parenfont(}%</font>
<font color="#009900">  \infirstlevel \bfafterword</font>
<font color="#009900">}</font>
<font color="#009900">\def\clnr{%</font>
<font color="#009900">  {\parenfont)}%</font>
<font color="#009900">  \infirstlevel \sl</font>
<font color="#009900">  \global\advance\parencount by -1</font>
<font color="#009900">}</font>

<font color="#009900">\newcount\brackcount</font>
<font color="#009900">\def\lbrb{%</font>
<font color="#009900">  \global\advance\brackcount by 1</font>
<font color="#009900">  {\bf[}%</font>
<font color="#009900">}</font>
<font color="#009900">\def\rbrb{%</font>
<font color="#009900">  {\bf]}%</font>
<font color="#009900">  \global\advance\brackcount by -1</font>
<font color="#009900">}</font>

<font color="#009900">\def\checkparencounts{%</font>
<font color="#009900">  \ifnum\parencount=0 \else \badparencount \fi</font>
<font color="#009900">  \ifnum\brackcount=0 \else \badbrackcount \fi</font>
<font color="#009900">}</font>
<font color="#009900">% these should not use \errmessage; the glibc manual, at least, actually</font>
<font color="#009900">% has such constructs (when documenting function pointers).</font>
<font color="#009900">\def\badparencount{%</font>
<font color="#009900">  \message{Warning: unbalanced parentheses in @def...}%</font>
<font color="#009900">  \global\parencount=0</font>
<font color="#009900">}</font>
<font color="#009900">\def\badbrackcount{%</font>
<font color="#009900">  \message{Warning: unbalanced square brackets in @def...}%</font>
<font color="#009900">  \global\brackcount=0</font>
<font color="#009900">}</font>


<font color="#009900">\message{macros,}</font>
<font color="#009900">% @macro.</font>

<font color="#009900">% To do this right we need a feature of e-TeX, \scantokens,</font>
<font color="#009900">% which we arrange to emulate with a temporary file in ordinary TeX.</font>
<font color="#009900">\ifx\eTeXversion\thisisundefined</font>
<font color="#009900">  \newwrite\macscribble</font>
<font color="#009900">  \def\scantokens#1{%</font>
<font color="#009900">    \toks0={#1}%</font>
<font color="#009900">    \immediate\openout\macscribble=\jobname.tmp</font>
<font color="#009900">    \immediate\write\macscribble{\the\toks0}%</font>
<font color="#009900">    \immediate\closeout\macscribble</font>
<font color="#009900">    \input \jobname.tmp</font>
<font color="#009900">  }</font>
<font color="#009900">\fi</font>

<font color="#009900">\def\scanmacro#1{\begingroup</font>
<font color="#009900">  \newlinechar`\^^M</font>
<font color="#009900">  \let\xeatspaces\eatspaces</font>
<font color="#009900">  %</font>
<font color="#009900">  % Undo catcode changes of \startcontents and \doprintindex</font>
<font color="#009900">  % When called from @insertcopying or (short)caption, we need active</font>
<font color="#009900">  % backslash to get it printed correctly.  Previously, we had</font>
<font color="#009900">  % \catcode`\\=\other instead.  We'll see whether a problem appears</font>
<font color="#009900">  % with macro expansion.				--kasal, 19aug04</font>
<font color="#009900">  \catcode`\@=0 \catcode`\\=\active \escapechar=`\@</font>
<font color="#009900">  %</font>
<font color="#009900">  % ... and for \example:</font>
<font color="#009900">  \spaceisspace</font>
<font color="#009900">  %</font>
<font color="#009900">  % The \empty here causes a following catcode 5 newline to be eaten as</font>
<font color="#009900">  % part of reading whitespace after a control sequence.  It does not</font>
<font color="#009900">  % eat a catcode 13 newline.  There's no good way to handle the two</font>
<font color="#009900">  % cases (untried: maybe e-TeX's \everyeof could help, though plain TeX</font>
<font color="#009900">  % would then have different behavior).  See the Macro Details node in</font>
<font color="#009900">  % the manual for the workaround we recommend for macros and</font>
<font color="#009900">  % line-oriented commands.</font>
<font color="#009900">  % </font>
<font color="#009900">  \scantokens{#1\empty}%</font>
<font color="#009900">\endgroup}</font>

<font color="#009900">\def\scanexp#1{%</font>
<font color="#009900">  \edef\temp{\noexpand\scanmacro{#1}}%</font>
<font color="#009900">  \temp</font>
<font color="#009900">}</font>

<font color="#009900">\newcount\paramno   % Count of parameters</font>
<font color="#009900">\newtoks\macname    % Macro name</font>
<font color="#009900">\newif\ifrecursive  % Is it recursive?</font>

<font color="#009900">% List of all defined macros in the form</font>
<font color="#009900">%    \definedummyword\macro1\definedummyword\macro2...</font>
<font color="#009900">% Currently is also contains all @aliases; the list can be split</font>
<font color="#009900">% if there is a need.</font>
<font color="#009900">\def\macrolist{}</font>

<font color="#009900">% Add the macro to \macrolist</font>
<font color="#009900">\def\addtomacrolist#1{\expandafter \addtomacrolistxxx \csname#1\endcsname}</font>
<font color="#009900">\def\addtomacrolistxxx#1{%</font>
<font color="#009900">     \toks0 = \expandafter{\macrolist\definedummyword#1}%</font>
<font color="#009900">     \xdef\macrolist{\the\toks0}%</font>
<font color="#009900">}</font>

<font color="#009900">% Utility routines.</font>
<font color="#009900">% This does \let #1 = #2, with \csnames; that is,</font>
<font color="#009900">%   \let \csname#1\endcsname = \csname#2\endcsname</font>
<font color="#009900">% (except of course we have to play expansion games).</font>
<font color="#009900">%</font>
<font color="#009900">\def\cslet#1#2{%</font>
<font color="#009900">  \expandafter\let</font>
<font color="#009900">  \csname#1\expandafter\endcsname</font>
<font color="#009900">  \csname#2\endcsname</font>
<font color="#009900">}</font>

<font color="#009900">% Trim leading and trailing spaces off a string.</font>
<font color="#009900">% Concepts from aro-bend problem 15 (see CTAN).</font>
<font color="#009900">{\catcode`\@=11</font>
<font color="#009900">\gdef\eatspaces #1{\expandafter\trim@\expandafter{#1 }}</font>
<font color="#009900">\gdef\trim@ #1{\trim@@ @#1 @ #1 @ @@}</font>
<font color="#009900">\gdef\trim@@ #1@ #2@ #3@@{\trim@@@\empty #2 @}</font>
<font color="#009900">\def\unbrace#1{#1}</font>
<font color="#009900">\unbrace{\gdef\trim@@@ #1 } #2@{#1}</font>
<font color="#009900">}</font>

<font color="#009900">% Trim a single trailing ^^M off a string.</font>
<font color="#009900">{\catcode`\^^M=\other \catcode`\Q=3%</font>
<font color="#009900">\gdef\eatcr #1{\eatcra #1Q^^MQ}%</font>
<font color="#009900">\gdef\eatcra#1^^MQ{\eatcrb#1Q}%</font>
<font color="#009900">\gdef\eatcrb#1Q#2Q{#1}%</font>
<font color="#009900">}</font>

<font color="#009900">% Macro bodies are absorbed as an argument in a context where</font>
<font color="#009900">% all characters are catcode 10, 11 or 12, except \ which is active</font>
<font color="#009900">% (as in normal texinfo). It is necessary to change the definition of \</font>
<font color="#009900">% to recognize macro arguments; this is the job of \mbodybackslash.</font>
<font color="#009900">%</font>
<font color="#009900">% Non-ASCII encodings make 8-bit characters active, so un-activate</font>
<font color="#009900">% them to avoid their expansion.  Must do this non-globally, to</font>
<font color="#009900">% confine the change to the current group.</font>
<font color="#009900">%</font>
<font color="#009900">% It's necessary to have hard CRs when the macro is executed. This is</font>
<font color="#009900">% done by making ^^M (\endlinechar) catcode 12 when reading the macro</font>
<font color="#009900">% body, and then making it the \newlinechar in \scanmacro.</font>
<font color="#009900">%</font>
<font color="#009900">\def\scanctxt{% used as subroutine</font>
<font color="#009900">  \catcode`\"=\other</font>
<font color="#009900">  \catcode`\+=\other</font>
<font color="#009900">  \catcode`\&lt;=\other</font>
<font color="#009900">  \catcode`\&gt;=\other</font>
<font color="#009900">  \catcode`\@=\other</font>
<font color="#009900">  \catcode`\^=\other</font>
<font color="#009900">  \catcode`\_=\other</font>
<font color="#009900">  \catcode`\|=\other</font>
<font color="#009900">  \catcode`\~=\other</font>
<font color="#009900">  \ifx\declaredencoding\ascii \else \setnonasciicharscatcodenonglobal\other \fi</font>
<font color="#009900">}</font>

<font color="#009900">\def\scanargctxt{% used for copying and captions, not macros.</font>
<font color="#009900">  \scanctxt</font>
<font color="#009900">  \catcode`\\=\other</font>
<font color="#009900">  \catcode`\^^M=\other</font>
<font color="#009900">}</font>

<font color="#009900">\def\macrobodyctxt{% used for @macro definitions</font>
<font color="#009900">  \scanctxt</font>
<font color="#009900">  \catcode`\{=\other</font>
<font color="#009900">  \catcode`\}=\other</font>
<font color="#009900">  \catcode`\^^M=\other</font>
<font color="#009900">  \usembodybackslash</font>
<font color="#009900">}</font>

<font color="#009900">\def\macroargctxt{% used when scanning invocations</font>
<font color="#009900">  \scanctxt</font>
<font color="#009900">  \catcode`\\=0</font>
<font color="#009900">}</font>
<font color="#009900">% why catcode 0 for \ in the above?  To recognize \\ \{ \} as "escapes"</font>
<font color="#009900">% for the single characters \ { }.  Thus, we end up with the "commands"</font>
<font color="#009900">% that would be written @\ @{ @} in a Texinfo document.</font>
<font color="#009900">% </font>
<font color="#009900">% We already have @{ and @}.  For @\, we define it here, and only for</font>
<font color="#009900">% this purpose, to produce a typewriter backslash (so, the @\ that we</font>
<font color="#009900">% define for @math can't be used with @macro calls):</font>
<font color="#009900">%</font>
<font color="#009900">\def\\{\normalbackslash}%</font>
<font color="#009900">% </font>
<font color="#009900">% We would like to do this for \, too, since that is what makeinfo does.</font>
<font color="#009900">% But it is not possible, because Texinfo already has a command @, for a</font>
<font color="#009900">% cedilla accent.  Documents must use @comma{} instead.</font>
<font color="#009900">%</font>
<font color="#009900">% \anythingelse will almost certainly be an error of some kind.</font>


<font color="#009900">% \mbodybackslash is the definition of \ in @macro bodies.</font>
<font color="#009900">% It maps \foo\ =&gt; \csname macarg.foo\endcsname =&gt; #N</font>
<font color="#009900">% where N is the macro parameter number.</font>
<font color="#009900">% We define \csname macarg.\endcsname to be \realbackslash, so</font>
<font color="#009900">% \\ in macro replacement text gets you a backslash.</font>
<font color="#009900">%</font>
<font color="#009900">{\catcode`@=0 @catcode`@\=@active</font>
<font color="#009900"> @gdef@usembodybackslash{@let\=@mbodybackslash}</font>
<font color="#009900"> @gdef@mbodybackslash#1\{@csname macarg.#1@endcsname}</font>
<font color="#009900">}</font>
<font color="#009900">\expandafter\def\csname macarg.\endcsname{\realbackslash}</font>

<font color="#009900">\def\margbackslash#1{\char`\#1 }</font>

<font color="#009900">\def\macro{\recursivefalse\parsearg\macroxxx}</font>
<font color="#009900">\def\rmacro{\recursivetrue\parsearg\macroxxx}</font>

<font color="#009900">\def\macroxxx#1{%</font>
<font color="#009900">  \getargs{#1}% now \macname is the macname and \argl the arglist</font>
<font color="#009900">  \ifx\argl\empty       % no arguments</font>
<font color="#009900">     \paramno=0\relax</font>
<font color="#009900">  \else</font>
<font color="#009900">     \expandafter\parsemargdef \argl;%</font>
<font color="#009900">     \if\paramno&gt;256\relax</font>
<font color="#009900">       \ifx\eTeXversion\thisisundefined</font>
<font color="#009900">         \errhelp = \EMsimple</font>
<font color="#009900">         \errmessage{You need eTeX to compile a file with macros with more than 256 arguments}</font>
<font color="#009900">       \fi</font>
<font color="#009900">     \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \if1\csname ismacro.\the\macname\endcsname</font>
<font color="#009900">     \message{Warning: redefining \the\macname}%</font>
<font color="#009900">  \else</font>
<font color="#009900">     \expandafter\ifx\csname \the\macname\endcsname \relax</font>
<font color="#009900">     \else \errmessage{Macro name \the\macname\space already defined}\fi</font>
<font color="#009900">     \global\cslet{macsave.\the\macname}{\the\macname}%</font>
<font color="#009900">     \global\expandafter\let\csname ismacro.\the\macname\endcsname=1%</font>
<font color="#009900">     \addtomacrolist{\the\macname}%</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \begingroup \macrobodyctxt</font>
<font color="#009900">  \ifrecursive \expandafter\parsermacbody</font>
<font color="#009900">  \else \expandafter\parsemacbody</font>
<font color="#009900">  \fi}</font>

<font color="#009900">\parseargdef\unmacro{%</font>
<font color="#009900">  \if1\csname ismacro.#1\endcsname</font>
<font color="#009900">    \global\cslet{#1}{macsave.#1}%</font>
<font color="#009900">    \global\expandafter\let \csname ismacro.#1\endcsname=0%</font>
<font color="#009900">    % Remove the macro name from \macrolist:</font>
<font color="#009900">    \begingroup</font>
<font color="#009900">      \expandafter\let\csname#1\endcsname \relax</font>
<font color="#009900">      \let\definedummyword\unmacrodo</font>
<font color="#009900">      \xdef\macrolist{\macrolist}%</font>
<font color="#009900">    \endgroup</font>
<font color="#009900">  \else</font>
<font color="#009900">    \errmessage{Macro #1 not defined}%</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% Called by \do from \dounmacro on each macro.  The idea is to omit any</font>
<font color="#009900">% macro definitions that have been changed to \relax.</font>
<font color="#009900">%</font>
<font color="#009900">\def\unmacrodo#1{%</font>
<font color="#009900">  \ifx #1\relax</font>
<font color="#009900">    % remove this</font>
<font color="#009900">  \else</font>
<font color="#009900">    \noexpand\definedummyword \noexpand#1%</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% This makes use of the obscure feature that if the last token of a</font>
<font color="#009900">% &lt;parameter list&gt; is #, then the preceding argument is delimited by</font>
<font color="#009900">% an opening brace, and that opening brace is not consumed.</font>
<font color="#009900">\def\getargs#1{\getargsxxx#1{}}</font>
<font color="#009900">\def\getargsxxx#1#{\getmacname #1 \relax\getmacargs}</font>
<font color="#009900">\def\getmacname#1 #2\relax{\macname={#1}}</font>
<font color="#009900">\def\getmacargs#1{\def\argl{#1}}</font>

<font color="#009900">% For macro processing make @ a letter so that we can make Texinfo private macro names.</font>
<font color="#009900">\edef\texiatcatcode{\the\catcode`\@}</font>
<font color="#009900">\catcode `@=11\relax</font>

<font color="#009900">% Parse the optional {params} list.  Set up \paramno and \paramlist</font>
<font color="#009900">% so \defmacro knows what to do.  Define \macarg.BLAH for each BLAH</font>
<font color="#009900">% in the params list to some hook where the argument si to be expanded.  If</font>
<font color="#009900">% there are less than 10 arguments that hook is to be replaced by ##N where N</font>
<font color="#009900">% is the position in that list, that is to say the macro arguments are to be</font>
<font color="#009900">% defined `a la TeX in the macro body.  </font>
<font color="#009900">%</font>
<font color="#009900">% That gets used by \mbodybackslash (above).</font>
<font color="#009900">%</font>
<font color="#009900">% We need to get `macro parameter char #' into several definitions.</font>
<font color="#009900">% The technique used is stolen from LaTeX: let \hash be something</font>
<font color="#009900">% unexpandable, insert that wherever you need a #, and then redefine</font>
<font color="#009900">% it to # just before using the token list produced.</font>
<font color="#009900">%</font>
<font color="#009900">% The same technique is used to protect \eatspaces till just before</font>
<font color="#009900">% the macro is used.</font>
<font color="#009900">%</font>
<font color="#009900">% If there are 10 or more arguments, a different technique is used, where the</font>
<font color="#009900">% hook remains in the body, and when macro is to be expanded the body is</font>
<font color="#009900">% processed again to replace the arguments.</font>
<font color="#009900">%</font>
<font color="#009900">% In that case, the hook is \the\toks N-1, and we simply set \toks N-1 to the</font>
<font color="#009900">% argument N value and then \edef  the body (nothing else will expand because of</font>
<font color="#009900">% the catcode regime underwhich the body was input).</font>
<font color="#009900">%</font>
<font color="#009900">% If you compile with TeX (not eTeX), and you have macros with 10 or more</font>
<font color="#009900">% arguments, you need that no macro has more than 256 arguments, otherwise an</font>
<font color="#009900">% error is produced.</font>
<font color="#009900">\def\parsemargdef#1;{%</font>
<font color="#009900">  \paramno=0\def\paramlist{}%</font>
<font color="#009900">  \let\hash\relax</font>
<font color="#009900">  \let\xeatspaces\relax</font>
<font color="#009900">  \parsemargdefxxx#1,;,%</font>
<font color="#009900">  % In case that there are 10 or more arguments we parse again the arguments</font>
<font color="#009900">  % list to set new definitions for the \macarg.BLAH macros corresponding to</font>
<font color="#009900">  % each BLAH argument. It was anyhow needed to parse already once this list</font>
<font color="#009900">  % in order to count the arguments, and as macros with at most 9 arguments</font>
<font color="#009900">  % are by far more frequent than macro with 10 or more arguments, defining</font>
<font color="#009900">  % twice the \macarg.BLAH macros does not cost too much processing power.</font>
<font color="#009900">  \ifnum\paramno&lt;10\relax\else</font>
<font color="#009900">    \paramno0\relax</font>
<font color="#009900">    \parsemmanyargdef@@#1,;,% 10 or more arguments</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>
<font color="#009900">\def\parsemargdefxxx#1,{%</font>
<font color="#009900">  \if#1;\let\next=\relax</font>
<font color="#009900">  \else \let\next=\parsemargdefxxx</font>
<font color="#009900">    \advance\paramno by 1</font>
<font color="#009900">    \expandafter\edef\csname macarg.\eatspaces{#1}\endcsname</font>
<font color="#009900">        {\xeatspaces{\hash\the\paramno}}%</font>
<font color="#009900">    \edef\paramlist{\paramlist\hash\the\paramno,}%</font>
<font color="#009900">  \fi\next}</font>

<font color="#009900">\def\parsemmanyargdef@@#1,{%</font>
<font color="#009900">  \if#1;\let\next=\relax</font>
<font color="#009900">  \else </font>
<font color="#009900">    \let\next=\parsemmanyargdef@@</font>
<font color="#009900">    \edef\tempb{\eatspaces{#1}}%</font>
<font color="#009900">    \expandafter\def\expandafter\tempa</font>
<font color="#009900">       \expandafter{\csname macarg.\tempb\endcsname}%</font>
<font color="#009900">    % Note that we need some extra \noexpand\noexpand, this is because we</font>
<font color="#009900">    % don't want \the  to be expanded in the \parsermacbody  as it uses an</font>
<font color="#009900">    % \xdef .</font>
<font color="#009900">    \expandafter\edef\tempa</font>
<font color="#009900">      {\noexpand\noexpand\noexpand\the\toks\the\paramno}%</font>
<font color="#009900">    \advance\paramno by 1\relax</font>
<font color="#009900">  \fi\next}</font>

<font color="#009900">% These two commands read recursive and nonrecursive macro bodies.</font>
<font color="#009900">% (They're different since rec and nonrec macros end differently.)</font>
<font color="#009900">%</font>

<font color="#009900">\catcode `\@\texiatcatcode</font>
<font color="#009900">\long\def\parsemacbody#1@end macro%</font>
<font color="#009900">{\xdef\temp{\eatcr{#1}}\endgroup\defmacro}%</font>
<font color="#009900">\long\def\parsermacbody#1@end rmacro%</font>
<font color="#009900">{\xdef\temp{\eatcr{#1}}\endgroup\defmacro}%</font>
<font color="#009900">\catcode `\@=11\relax</font>

<font color="#009900">\let\endargs@\relax</font>
<font color="#009900">\let\nil@\relax</font>
<font color="#009900">\def\nilm@{\nil@}%</font>
<font color="#009900">\long\def\nillm@{\nil@}%</font>

<font color="#009900">% This macro is expanded during the Texinfo macro expansion, not during its</font>
<font color="#009900">% definition.  It gets all the arguments values and assigns them to macros</font>
<font color="#009900">% macarg.ARGNAME</font>
<font color="#009900">%</font>
<font color="#009900">% #1 is the macro name</font>
<font color="#009900">% #2 is the list of argument names</font>
<font color="#009900">% #3 is the list of argument values</font>
<font color="#009900">\def\getargvals@#1#2#3{%</font>
<font color="#009900">  \def\macargdeflist@{}%</font>
<font color="#009900">  \def\saveparamlist@{#2}% Need to keep a copy for parameter expansion.</font>
<font color="#009900">  \def\paramlist{#2,\nil@}%</font>
<font color="#009900">  \def\macroname{#1}%</font>
<font color="#009900">  \begingroup</font>
<font color="#009900">  \macroargctxt</font>
<font color="#009900">  \def\argvaluelist{#3,\nil@}%</font>
<font color="#009900">  \def\@tempa{#3}%</font>
<font color="#009900">  \ifx\@tempa\empty</font>
<font color="#009900">    \setemptyargvalues@</font>
<font color="#009900">  \else</font>
<font color="#009900">    \getargvals@@</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% </font>
<font color="#009900">\def\getargvals@@{%</font>
<font color="#009900">  \ifx\paramlist\nilm@</font>
<font color="#009900">      % Some sanity check needed here that \argvaluelist is also empty.</font>
<font color="#009900">      \ifx\argvaluelist\nillm@</font>
<font color="#009900">      \else</font>
<font color="#009900">        \errhelp = \EMsimple</font>
<font color="#009900">        \errmessage{Too many arguments in macro `\macroname'!}%</font>
<font color="#009900">      \fi</font>
<font color="#009900">      \let\next\macargexpandinbody@</font>
<font color="#009900">  \else</font>
<font color="#009900">    \ifx\argvaluelist\nillm@</font>
<font color="#009900">       % No more arguments values passed to macro.  Set remaining named-arg</font>
<font color="#009900">       % macros to empty.</font>
<font color="#009900">       \let\next\setemptyargvalues@</font>
<font color="#009900">    \else</font>
<font color="#009900">      % pop current arg name into \@tempb</font>
<font color="#009900">      \def\@tempa##1{\pop@{\@tempb}{\paramlist}##1\endargs@}%</font>
<font color="#009900">      \expandafter\@tempa\expandafter{\paramlist}%</font>
<font color="#009900">       % pop current argument value into \@tempc</font>
<font color="#009900">      \def\@tempa##1{\longpop@{\@tempc}{\argvaluelist}##1\endargs@}%</font>
<font color="#009900">      \expandafter\@tempa\expandafter{\argvaluelist}%</font>
<font color="#009900">       % Here \@tempb is the current arg name and \@tempc is the current arg value.</font>
<font color="#009900">       % First place the new argument macro definition into \@tempd</font>
<font color="#009900">       \expandafter\macname\expandafter{\@tempc}%</font>
<font color="#009900">       \expandafter\let\csname macarg.\@tempb\endcsname\relax</font>
<font color="#009900">       \expandafter\def\expandafter\@tempe\expandafter{%</font>
<font color="#009900">         \csname macarg.\@tempb\endcsname}%</font>
<font color="#009900">       \edef\@tempd{\long\def\@tempe{\the\macname}}%</font>
<font color="#009900">       \push@\@tempd\macargdeflist@</font>
<font color="#009900">       \let\next\getargvals@@</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \next</font>
<font color="#009900">}</font>

<font color="#009900">\def\push@#1#2{%</font>
<font color="#009900">  \expandafter\expandafter\expandafter\def</font>
<font color="#009900">  \expandafter\expandafter\expandafter#2%</font>
<font color="#009900">  \expandafter\expandafter\expandafter{%</font>
<font color="#009900">  \expandafter#1#2}%</font>
<font color="#009900">}</font>

<font color="#009900">% Replace arguments by their values in the macro body, and place the result</font>
<font color="#009900">% in macro \@tempa</font>
<font color="#009900">\def\macvalstoargs@{%</font>
<font color="#009900">  %  To do this we use the property that token registers that are \the'ed</font>
<font color="#009900">  % within an \edef  expand only once. So we are going to place all argument</font>
<font color="#009900">  % values into respective token registers.</font>
<font color="#009900">  %</font>
<font color="#009900">  % First we save the token context, and initialize argument numbering.</font>
<font color="#009900">  \begingroup</font>
<font color="#009900">    \paramno0\relax</font>
<font color="#009900">    % Then, for each argument number #N, we place the corresponding argument</font>
<font color="#009900">    % value into a new token list register \toks#N</font>
<font color="#009900">    \expandafter\putargsintokens@\saveparamlist@,;,%</font>
<font color="#009900">    % Then, we expand the body so that argument are replaced by their</font>
<font color="#009900">    % values. The trick for values not to be expanded themselves is that they</font>
<font color="#009900">    % are within tokens and that tokens expand only once in an \edef .</font>
<font color="#009900">    \edef\@tempc{\csname mac.\macroname .body\endcsname}%</font>
<font color="#009900">    % Now we restore the token stack pointer to free the token list registers</font>
<font color="#009900">    % which we have used, but we make sure that expanded body is saved after</font>
<font color="#009900">    % group.</font>
<font color="#009900">    \expandafter</font>
<font color="#009900">  \endgroup</font>
<font color="#009900">  \expandafter\def\expandafter\@tempa\expandafter{\@tempc}%</font>
<font color="#009900">  }</font>

<font color="#009900">\def\macargexpandinbody@{% </font>
<font color="#009900">  %% Define the named-macro outside of this group and then close this group. </font>
<font color="#009900">  \expandafter</font>
<font color="#009900">  \endgroup</font>
<font color="#009900">  \macargdeflist@</font>
<font color="#009900">  % First the replace in body the macro arguments by their values, the result</font>
<font color="#009900">  % is in \@tempa .</font>
<font color="#009900">  \macvalstoargs@</font>
<font color="#009900">  % Then we point at the \norecurse or \gobble (for recursive) macro value</font>
<font color="#009900">  % with \@tempb .</font>
<font color="#009900">  \expandafter\let\expandafter\@tempb\csname mac.\macroname .recurse\endcsname</font>
<font color="#009900">  % Depending on whether it is recursive or not, we need some tailing</font>
<font color="#009900">  % \egroup .</font>
<font color="#009900">  \ifx\@tempb\gobble</font>
<font color="#009900">     \let\@tempc\relax</font>
<font color="#009900">  \else</font>
<font color="#009900">     \let\@tempc\egroup</font>
<font color="#009900">  \fi</font>
<font color="#009900">  % And now we do the real job:</font>
<font color="#009900">  \edef\@tempd{\noexpand\@tempb{\macroname}\noexpand\scanmacro{\@tempa}\@tempc}%</font>
<font color="#009900">  \@tempd</font>
<font color="#009900">}</font>

<font color="#009900">\def\putargsintokens@#1,{%</font>
<font color="#009900">  \if#1;\let\next\relax</font>
<font color="#009900">  \else</font>
<font color="#009900">    \let\next\putargsintokens@</font>
<font color="#009900">    % First we allocate the new token list register, and give it a temporary</font>
<font color="#009900">    % alias \@tempb .</font>
<font color="#009900">    \toksdef\@tempb\the\paramno</font>
<font color="#009900">    % Then we place the argument value into that token list register.</font>
<font color="#009900">    \expandafter\let\expandafter\@tempa\csname macarg.#1\endcsname</font>
<font color="#009900">    \expandafter\@tempb\expandafter{\@tempa}%</font>
<font color="#009900">    \advance\paramno by 1\relax</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \next</font>
<font color="#009900">}</font>

<font color="#009900">% Save the token stack pointer into macro #1</font>
<font color="#009900">\def\texisavetoksstackpoint#1{\edef#1{\the\@cclvi}}</font>
<font color="#009900">% Restore the token stack pointer from number in macro #1</font>
<font color="#009900">\def\texirestoretoksstackpoint#1{\expandafter\mathchardef\expandafter\@cclvi#1\relax}</font>
<font color="#009900">% newtoks that can be used non \outer .</font>
<font color="#009900">\def\texinonouternewtoks{\alloc@ 5\toks \toksdef \@cclvi}</font>

<font color="#009900">% Tailing missing arguments are set to empty</font>
<font color="#009900">\def\setemptyargvalues@{%</font>
<font color="#009900">  \ifx\paramlist\nilm@</font>
<font color="#009900">    \let\next\macargexpandinbody@</font>
<font color="#009900">  \else</font>
<font color="#009900">    \expandafter\setemptyargvaluesparser@\paramlist\endargs@</font>
<font color="#009900">    \let\next\setemptyargvalues@</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \next</font>
<font color="#009900">}</font>

<font color="#009900">\def\setemptyargvaluesparser@#1,#2\endargs@{%</font>
<font color="#009900">  \expandafter\def\expandafter\@tempa\expandafter{%</font>
<font color="#009900">    \expandafter\def\csname macarg.#1\endcsname{}}%</font>
<font color="#009900">  \push@\@tempa\macargdeflist@</font>
<font color="#009900">  \def\paramlist{#2}%</font>
<font color="#009900">}</font>

<font color="#009900">% #1 is the element target macro</font>
<font color="#009900">% #2 is the list macro</font>
<font color="#009900">% #3,#4\endargs@ is the list value</font>
<font color="#009900">\def\pop@#1#2#3,#4\endargs@{%</font>
<font color="#009900">   \def#1{#3}%</font>
<font color="#009900">   \def#2{#4}%</font>
<font color="#009900">}</font>
<font color="#009900">\long\def\longpop@#1#2#3,#4\endargs@{%</font>
<font color="#009900">   \long\def#1{#3}%</font>
<font color="#009900">   \long\def#2{#4}%</font>
<font color="#009900">}</font>

<font color="#009900">% This defines a Texinfo @macro. There are eight cases: recursive and</font>
<font color="#009900">% nonrecursive macros of zero, one, up to nine, and many arguments.</font>
<font color="#009900">% Much magic with \expandafter here.</font>
<font color="#009900">% \xdef is used so that macro definitions will survive the file</font>
<font color="#009900">% they're defined in; @include reads the file inside a group.</font>
<font color="#009900">%</font>
<font color="#009900">\def\defmacro{%</font>
<font color="#009900">  \let\hash=##% convert placeholders to macro parameter chars</font>
<font color="#009900">  \ifrecursive</font>
<font color="#009900">    \ifcase\paramno</font>
<font color="#009900">    % 0</font>
<font color="#009900">      \expandafter\xdef\csname\the\macname\endcsname{%</font>
<font color="#009900">        \noexpand\scanmacro{\temp}}%</font>
<font color="#009900">    \or % 1</font>
<font color="#009900">      \expandafter\xdef\csname\the\macname\endcsname{%</font>
<font color="#009900">         \bgroup\noexpand\macroargctxt</font>
<font color="#009900">         \noexpand\braceorline</font>
<font color="#009900">         \expandafter\noexpand\csname\the\macname xxx\endcsname}%</font>
<font color="#009900">      \expandafter\xdef\csname\the\macname xxx\endcsname##1{%</font>
<font color="#009900">         \egroup\noexpand\scanmacro{\temp}}%</font>
<font color="#009900">    \else</font>
<font color="#009900">      \ifnum\paramno&lt;10\relax % at most 9</font>
<font color="#009900">        \expandafter\xdef\csname\the\macname\endcsname{%</font>
<font color="#009900">           \bgroup\noexpand\macroargctxt</font>
<font color="#009900">           \noexpand\csname\the\macname xx\endcsname}%</font>
<font color="#009900">        \expandafter\xdef\csname\the\macname xx\endcsname##1{%</font>
<font color="#009900">            \expandafter\noexpand\csname\the\macname xxx\endcsname ##1,}%</font>
<font color="#009900">        \expandafter\expandafter</font>
<font color="#009900">        \expandafter\xdef</font>
<font color="#009900">        \expandafter\expandafter</font>
<font color="#009900">          \csname\the\macname xxx\endcsname</font>
<font color="#009900">            \paramlist{\egroup\noexpand\scanmacro{\temp}}%</font>
<font color="#009900">      \else % 10 or more</font>
<font color="#009900">        \expandafter\xdef\csname\the\macname\endcsname{%</font>
<font color="#009900">          \noexpand\getargvals@{\the\macname}{\argl}%</font>
<font color="#009900">        }%    </font>
<font color="#009900">        \global\expandafter\let\csname mac.\the\macname .body\endcsname\temp</font>
<font color="#009900">        \global\expandafter\let\csname mac.\the\macname .recurse\endcsname\gobble</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \else</font>
<font color="#009900">    \ifcase\paramno</font>
<font color="#009900">    % 0</font>
<font color="#009900">      \expandafter\xdef\csname\the\macname\endcsname{%</font>
<font color="#009900">        \noexpand\norecurse{\the\macname}%</font>
<font color="#009900">        \noexpand\scanmacro{\temp}\egroup}%</font>
<font color="#009900">    \or % 1</font>
<font color="#009900">      \expandafter\xdef\csname\the\macname\endcsname{%</font>
<font color="#009900">         \bgroup\noexpand\macroargctxt</font>
<font color="#009900">         \noexpand\braceorline</font>
<font color="#009900">         \expandafter\noexpand\csname\the\macname xxx\endcsname}%</font>
<font color="#009900">      \expandafter\xdef\csname\the\macname xxx\endcsname##1{%</font>
<font color="#009900">        \egroup</font>
<font color="#009900">        \noexpand\norecurse{\the\macname}%</font>
<font color="#009900">        \noexpand\scanmacro{\temp}\egroup}%</font>
<font color="#009900">    \else % at most 9</font>
<font color="#009900">      \ifnum\paramno&lt;10\relax</font>
<font color="#009900">        \expandafter\xdef\csname\the\macname\endcsname{%</font>
<font color="#009900">           \bgroup\noexpand\macroargctxt</font>
<font color="#009900">           \expandafter\noexpand\csname\the\macname xx\endcsname}%</font>
<font color="#009900">        \expandafter\xdef\csname\the\macname xx\endcsname##1{%</font>
<font color="#009900">            \expandafter\noexpand\csname\the\macname xxx\endcsname ##1,}%</font>
<font color="#009900">        \expandafter\expandafter</font>
<font color="#009900">        \expandafter\xdef</font>
<font color="#009900">        \expandafter\expandafter</font>
<font color="#009900">        \csname\the\macname xxx\endcsname</font>
<font color="#009900">        \paramlist{%</font>
<font color="#009900">            \egroup</font>
<font color="#009900">            \noexpand\norecurse{\the\macname}%</font>
<font color="#009900">            \noexpand\scanmacro{\temp}\egroup}%</font>
<font color="#009900">      \else % 10 or more:</font>
<font color="#009900">        \expandafter\xdef\csname\the\macname\endcsname{%</font>
<font color="#009900">          \noexpand\getargvals@{\the\macname}{\argl}%</font>
<font color="#009900">        }%</font>
<font color="#009900">        \global\expandafter\let\csname mac.\the\macname .body\endcsname\temp</font>
<font color="#009900">        \global\expandafter\let\csname mac.\the\macname .recurse\endcsname\norecurse</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi}</font>

<font color="#009900">\catcode `\@\texiatcatcode\relax</font>

<font color="#009900">\def\norecurse#1{\bgroup\cslet{#1}{macsave.#1}}</font>

<font color="#009900">% \braceorline decides whether the next nonwhitespace character is a</font>
<font color="#009900">% {.  If so it reads up to the closing }, if not, it reads the whole</font>
<font color="#009900">% line.  Whatever was read is then fed to the next control sequence</font>
<font color="#009900">% as an argument (by \parsebrace or \parsearg).</font>
<font color="#009900">% </font>
<font color="#009900">\def\braceorline#1{\let\macnamexxx=#1\futurelet\nchar\braceorlinexxx}</font>
<font color="#009900">\def\braceorlinexxx{%</font>
<font color="#009900">  \ifx\nchar\bgroup\else</font>
<font color="#009900">    \expandafter\parsearg</font>
<font color="#009900">  \fi \macnamexxx}</font>


<font color="#009900">% @alias.</font>
<font color="#009900">% We need some trickery to remove the optional spaces around the equal</font>
<font color="#009900">% sign.  Make them active and then expand them all to nothing.</font>
<font color="#009900">%</font>
<font color="#009900">\def\alias{\parseargusing\obeyspaces\aliasxxx}</font>
<font color="#009900">\def\aliasxxx #1{\aliasyyy#1\relax}</font>
<font color="#009900">\def\aliasyyy #1=#2\relax{%</font>
<font color="#009900">  {%</font>
<font color="#009900">    \expandafter\let\obeyedspace=\empty</font>
<font color="#009900">    \addtomacrolist{#1}%</font>
<font color="#009900">    \xdef\next{\global\let\makecsname{#1}=\makecsname{#2}}%</font>
<font color="#009900">  }%</font>
<font color="#009900">  \next</font>
<font color="#009900">}</font>


<font color="#009900">\message{cross references,}</font>

<font color="#009900">\newwrite\auxfile</font>
<font color="#009900">\newif\ifhavexrefs    % True if xref values are known.</font>
<font color="#009900">\newif\ifwarnedxrefs  % True if we warned once that they aren't known.</font>

<font color="#009900">% @inforef is relatively simple.</font>
<font color="#009900">\def\inforef #1{\inforefzzz #1,,,,**}</font>
<font color="#009900">\def\inforefzzz #1,#2,#3,#4**{%</font>
<font color="#009900">  \putwordSee{} \putwordInfo{} \putwordfile{} \file{\ignorespaces #3{}},</font>
<font color="#009900">  node \samp{\ignorespaces#1{}}}</font>

<font color="#009900">% @node's only job in TeX is to define \lastnode, which is used in</font>
<font color="#009900">% cross-references.  The @node line might or might not have commas, and</font>
<font color="#009900">% might or might not have spaces before the first comma, like:</font>
<font color="#009900">% @node foo , bar , ...</font>
<font color="#009900">% We don't want such trailing spaces in the node name.</font>
<font color="#009900">%</font>
<font color="#009900">\parseargdef\node{\checkenv{}\donode #1 ,\finishnodeparse}</font>
<font color="#009900">%</font>
<font color="#009900">% also remove a trailing comma, in case of something like this:</font>
<font color="#009900">% @node Help-Cross,  ,  , Cross-refs</font>
<font color="#009900">\def\donode#1 ,#2\finishnodeparse{\dodonode #1,\finishnodeparse}</font>
<font color="#009900">\def\dodonode#1,#2\finishnodeparse{\gdef\lastnode{#1}}</font>

<font color="#009900">\let\nwnode=\node</font>
<font color="#009900">\let\lastnode=\empty</font>

<font color="#009900">% Write a cross-reference definition for the current node.  #1 is the</font>
<font color="#009900">% type (Ynumbered, Yappendix, Ynothing).</font>
<font color="#009900">%</font>
<font color="#009900">\def\donoderef#1{%</font>
<font color="#009900">  \ifx\lastnode\empty\else</font>
<font color="#009900">    \setref{\lastnode}{#1}%</font>
<font color="#009900">    \global\let\lastnode=\empty</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% @anchor{NAME} -- define xref target at arbitrary point.</font>
<font color="#009900">%</font>
<font color="#009900">\newcount\savesfregister</font>
<font color="#009900">%</font>
<font color="#009900">\def\savesf{\relax \ifhmode \savesfregister=\spacefactor \fi}</font>
<font color="#009900">\def\restoresf{\relax \ifhmode \spacefactor=\savesfregister \fi}</font>
<font color="#009900">\def\anchor#1{\savesf \setref{#1}{Ynothing}\restoresf \ignorespaces}</font>

<font color="#009900">% \setref{NAME}{SNT} defines a cross-reference point NAME (a node or an</font>
<font color="#009900">% anchor), which consists of three parts:</font>
<font color="#009900">% 1) NAME-title - the current sectioning name taken from \lastsection,</font>
<font color="#009900">%                 or the anchor name.</font>
<font color="#009900">% 2) NAME-snt   - section number and type, passed as the SNT arg, or</font>
<font color="#009900">%                 empty for anchors.</font>
<font color="#009900">% 3) NAME-pg    - the page number.</font>
<font color="#009900">%</font>
<font color="#009900">% This is called from \donoderef, \anchor, and \dofloat.  In the case of</font>
<font color="#009900">% floats, there is an additional part, which is not written here:</font>
<font color="#009900">% 4) NAME-lof   - the text as it should appear in a @listoffloats.</font>
<font color="#009900">%</font>
<font color="#009900">\def\setref#1#2{%</font>
<font color="#009900">  \pdfmkdest{#1}%</font>
<font color="#009900">  \iflinks</font>
<font color="#009900">    {%</font>
<font color="#009900">      \atdummies  % preserve commands, but don't expand them</font>
<font color="#009900">      \edef\writexrdef##1##2{%</font>
<font color="#009900">	\write\auxfile{@xrdef{#1-% #1 of \setref, expanded by the \edef</font>
<font color="#009900">	  ##1}{##2}}% these are parameters of \writexrdef</font>
<font color="#009900">      }%</font>
<font color="#009900">      \toks0 = \expandafter{\lastsection}%</font>
<font color="#009900">      \immediate \writexrdef{title}{\the\toks0 }%</font>
<font color="#009900">      \immediate \writexrdef{snt}{\csname #2\endcsname}% \Ynumbered etc.</font>
<font color="#009900">      \safewhatsit{\writexrdef{pg}{\folio}}% will be written later, at \shipout</font>
<font color="#009900">    }%</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% @xrefautosectiontitle on|off says whether @section(ing) names are used</font>
<font color="#009900">% automatically in xrefs, if the third arg is not explicitly specified.</font>
<font color="#009900">% This was provided as a "secret" @set xref-automatic-section-title</font>
<font color="#009900">% variable, now it's official.</font>
<font color="#009900">% </font>
<font color="#009900">\parseargdef\xrefautomaticsectiontitle{%</font>
<font color="#009900">  \def\temp{#1}%</font>
<font color="#009900">  \ifx\temp\onword</font>
<font color="#009900">    \expandafter\let\csname SETxref-automatic-section-title\endcsname</font>
<font color="#009900">      = \empty</font>
<font color="#009900">  \else\ifx\temp\offword</font>
<font color="#009900">    \expandafter\let\csname SETxref-automatic-section-title\endcsname</font>
<font color="#009900">      = \relax</font>
<font color="#009900">  \else</font>
<font color="#009900">    \errhelp = \EMsimple</font>
<font color="#009900">    \errmessage{Unknown @xrefautomaticsectiontitle value `\temp',</font>
<font color="#009900">                must be on|off}%</font>
<font color="#009900">  \fi\fi</font>
<font color="#009900">}</font>


<font color="#009900">% @xref, @pxref, and @ref generate cross-references.  For \xrefX, #1 is</font>
<font color="#009900">% the node name, #2 the name of the Info cross-reference, #3 the printed</font>
<font color="#009900">% node name, #4 the name of the Info file, #5 the name of the printed</font>
<font color="#009900">% manual.  All but the node name can be omitted.</font>
<font color="#009900">%</font>
<font color="#009900">\def\pxref#1{\putwordsee{} \xrefX[#1,,,,,,,]}</font>
<font color="#009900">\def\xref#1{\putwordSee{} \xrefX[#1,,,,,,,]}</font>
<font color="#009900">\def\ref#1{\xrefX[#1,,,,,,,]}</font>
<font color="#009900">%</font>
<font color="#009900">\newbox\topbox</font>
<font color="#009900">\newbox\printedrefnamebox</font>
<font color="#009900">\newbox\printedmanualbox</font>
<font color="#009900">%</font>
<font color="#009900">\def\xrefX[#1,#2,#3,#4,#5,#6]{\begingroup</font>
<font color="#009900">  \unsepspaces</font>
<font color="#009900">  %</font>
<font color="#009900">  \def\printedrefname{\ignorespaces #3}%</font>
<font color="#009900">  \setbox\printedrefnamebox = \hbox{\printedrefname\unskip}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \def\printedmanual{\ignorespaces #5}%</font>
<font color="#009900">  \setbox\printedmanualbox  = \hbox{\printedmanual\unskip}%</font>
<font color="#009900">  %</font>
<font color="#009900">  % If the printed reference name (arg #3) was not explicitly given in</font>
<font color="#009900">  % the @xref, figure out what we want to use.</font>
<font color="#009900">  \ifdim \wd\printedrefnamebox = 0pt</font>
<font color="#009900">    % No printed node name was explicitly given.</font>
<font color="#009900">    \expandafter\ifx\csname SETxref-automatic-section-title\endcsname \relax</font>
<font color="#009900">      % Not auto section-title: use node name inside the square brackets.</font>
<font color="#009900">      \def\printedrefname{\ignorespaces #1}%</font>
<font color="#009900">    \else</font>
<font color="#009900">      % Auto section-title: use chapter/section title inside</font>
<font color="#009900">      % the square brackets if we have it.</font>
<font color="#009900">      \ifdim \wd\printedmanualbox &gt; 0pt</font>
<font color="#009900">        % It is in another manual, so we don't have it; use node name.</font>
<font color="#009900">        \def\printedrefname{\ignorespaces #1}%</font>
<font color="#009900">      \else</font>
<font color="#009900">        \ifhavexrefs</font>
<font color="#009900">          % We (should) know the real title if we have the xref values.</font>
<font color="#009900">          \def\printedrefname{\refx{#1-title}{}}%</font>
<font color="#009900">        \else</font>
<font color="#009900">          % Otherwise just copy the Info node name.</font>
<font color="#009900">          \def\printedrefname{\ignorespaces #1}%</font>
<font color="#009900">        \fi%</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  % Make link in pdf output.</font>
<font color="#009900">  \ifpdf</font>
<font color="#009900">    {\indexnofonts</font>
<font color="#009900">     \turnoffactive</font>
<font color="#009900">     \makevalueexpandable</font>
<font color="#009900">     % This expands tokens, so do it after making catcode changes, so _</font>
<font color="#009900">     % etc. don't get their TeX definitions.</font>
<font color="#009900">     \getfilename{#4}%</font>
<font color="#009900">     %</font>
<font color="#009900">     \edef\pdfxrefdest{#1}%</font>
<font color="#009900">     \txiescapepdf\pdfxrefdest</font>
<font color="#009900">     %</font>
<font color="#009900">     \leavevmode</font>
<font color="#009900">     \startlink attr{/Border [0 0 0]}%</font>
<font color="#009900">     \ifnum\filenamelength&gt;0</font>
<font color="#009900">       goto file{\the\filename.pdf} name{\pdfxrefdest}%</font>
<font color="#009900">     \else</font>
<font color="#009900">       goto name{\pdfmkpgn{\pdfxrefdest}}%</font>
<font color="#009900">     \fi</font>
<font color="#009900">    }%</font>
<font color="#009900">    \setcolor{\linkcolor}%</font>
<font color="#009900">  \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  % Float references are printed completely differently: "Figure 1.2"</font>
<font color="#009900">  % instead of "[somenode], p.3".  We distinguish them by the</font>
<font color="#009900">  % LABEL-title being set to a magic string.</font>
<font color="#009900">  {%</font>
<font color="#009900">    % Have to otherify everything special to allow the \csname to</font>
<font color="#009900">    % include an _ in the xref name, etc.</font>
<font color="#009900">    \indexnofonts</font>
<font color="#009900">    \turnoffactive</font>
<font color="#009900">    \expandafter\global\expandafter\let\expandafter\Xthisreftitle</font>
<font color="#009900">      \csname XR#1-title\endcsname</font>
<font color="#009900">  }%</font>
<font color="#009900">  \iffloat\Xthisreftitle</font>
<font color="#009900">    % If the user specified the print name (third arg) to the ref,</font>
<font color="#009900">    % print it instead of our usual "Figure 1.2".</font>
<font color="#009900">    \ifdim\wd\printedrefnamebox = 0pt</font>
<font color="#009900">      \refx{#1-snt}{}%</font>
<font color="#009900">    \else</font>
<font color="#009900">      \printedrefname</font>
<font color="#009900">    \fi</font>
<font color="#009900">    %</font>
<font color="#009900">    % if the user also gave the printed manual name (fifth arg), append</font>
<font color="#009900">    % "in MANUALNAME".</font>
<font color="#009900">    \ifdim \wd\printedmanualbox &gt; 0pt</font>
<font color="#009900">      \space \putwordin{} \cite{\printedmanual}%</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \else</font>
<font color="#009900">    % node/anchor (non-float) references.</font>
<font color="#009900">    % </font>
<font color="#009900">    % If we use \unhbox to print the node names, TeX does not insert</font>
<font color="#009900">    % empty discretionaries after hyphens, which means that it will not</font>
<font color="#009900">    % find a line break at a hyphen in a node names.  Since some manuals</font>
<font color="#009900">    % are best written with fairly long node names, containing hyphens,</font>
<font color="#009900">    % this is a loss.  Therefore, we give the text of the node name</font>
<font color="#009900">    % again, so it is as if TeX is seeing it for the first time.</font>
<font color="#009900">    % </font>
<font color="#009900">    % Cross-manual reference.  Only include the "Section ``foo'' in" if</font>
<font color="#009900">    % the foo is neither missing or Top.  Thus, @xref{,,,foo,The Foo Manual}</font>
<font color="#009900">    % outputs simply "see The Foo Manual".</font>
<font color="#009900">    \ifdim \wd\printedmanualbox &gt; 0pt</font>
<font color="#009900">      % What is the 7sp about?  The idea is that we also want to omit</font>
<font color="#009900">      % the Section part if we would be printing "Top", since they are</font>
<font color="#009900">      % clearly trying to refer to the whole manual.  But, this being</font>
<font color="#009900">      % TeX, we can't easily compare strings while ignoring the possible</font>
<font color="#009900">      % spaces before and after in the input.  By adding the arbitrary</font>
<font color="#009900">      % 7sp, we make it much less likely that a real node name would</font>
<font color="#009900">      % happen to have the same width as "Top" (e.g., in a monospaced font).</font>
<font color="#009900">      % I hope it will never happen in practice.</font>
<font color="#009900">      % </font>
<font color="#009900">      % For the same basic reason, we retypeset the "Top" at every</font>
<font color="#009900">      % reference, since the current font is indeterminate.</font>
<font color="#009900">      % </font>
<font color="#009900">      \setbox\topbox = \hbox{Top\kern7sp}%</font>
<font color="#009900">      \setbox2 = \hbox{\ignorespaces \printedrefname \unskip \kern7sp}%</font>
<font color="#009900">      \ifdim \wd2 &gt; 7sp</font>
<font color="#009900">        \ifdim \wd2 = \wd\topbox \else</font>
<font color="#009900">          \putwordSection{} ``\printedrefname'' \putwordin{}\space</font>
<font color="#009900">        \fi</font>
<font color="#009900">      \fi</font>
<font color="#009900">      \cite{\printedmanual}%</font>
<font color="#009900">    \else</font>
<font color="#009900">      % Reference in this manual.</font>
<font color="#009900">      %</font>
<font color="#009900">      % _ (for example) has to be the character _ for the purposes of the</font>
<font color="#009900">      % control sequence corresponding to the node, but it has to expand</font>
<font color="#009900">      % into the usual \leavevmode...\vrule stuff for purposes of</font>
<font color="#009900">      % printing. So we \turnoffactive for the \refx-snt, back on for the</font>
<font color="#009900">      % printing, back off for the \refx-pg.</font>
<font color="#009900">      {\turnoffactive</font>
<font color="#009900">       % Only output a following space if the -snt ref is nonempty; for</font>
<font color="#009900">       % @unnumbered and @anchor, it won't be.</font>
<font color="#009900">       \setbox2 = \hbox{\ignorespaces \refx{#1-snt}{}}%</font>
<font color="#009900">       \ifdim \wd2 &gt; 0pt \refx{#1-snt}\space\fi</font>
<font color="#009900">      }%</font>
<font color="#009900">      % output the `[mynode]' via the macro below so it can be overridden.</font>
<font color="#009900">      \xrefprintnodename\printedrefname</font>
<font color="#009900">      %</font>
<font color="#009900">      % But we always want a comma and a space:</font>
<font color="#009900">      ,\space</font>
<font color="#009900">      %</font>
<font color="#009900">      % output the `page 3'.</font>
<font color="#009900">      \turnoffactive \putwordpage\tie\refx{#1-pg}{}%</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \endlink</font>
<font color="#009900">\endgroup}</font>

<font color="#009900">% This macro is called from \xrefX for the `[nodename]' part of xref</font>
<font color="#009900">% output.  It's a separate macro only so it can be changed more easily,</font>
<font color="#009900">% since square brackets don't work well in some documents.  Particularly</font>
<font color="#009900">% one that Bob is working on :).</font>
<font color="#009900">%</font>
<font color="#009900">\def\xrefprintnodename#1{[#1]}</font>

<font color="#009900">% Things referred to by \setref.</font>
<font color="#009900">%</font>
<font color="#009900">\def\Ynothing{}</font>
<font color="#009900">\def\Yomitfromtoc{}</font>
<font color="#009900">\def\Ynumbered{%</font>
<font color="#009900">  \ifnum\secno=0</font>
<font color="#009900">    \putwordChapter@tie \the\chapno</font>
<font color="#009900">  \else \ifnum\subsecno=0</font>
<font color="#009900">    \putwordSection@tie \the\chapno.\the\secno</font>
<font color="#009900">  \else \ifnum\subsubsecno=0</font>
<font color="#009900">    \putwordSection@tie \the\chapno.\the\secno.\the\subsecno</font>
<font color="#009900">  \else</font>
<font color="#009900">    \putwordSection@tie \the\chapno.\the\secno.\the\subsecno.\the\subsubsecno</font>
<font color="#009900">  \fi\fi\fi</font>
<font color="#009900">}</font>
<font color="#009900">\def\Yappendix{%</font>
<font color="#009900">  \ifnum\secno=0</font>
<font color="#009900">     \putwordAppendix@tie @char\the\appendixno{}%</font>
<font color="#009900">  \else \ifnum\subsecno=0</font>
<font color="#009900">     \putwordSection@tie @char\the\appendixno.\the\secno</font>
<font color="#009900">  \else \ifnum\subsubsecno=0</font>
<font color="#009900">    \putwordSection@tie @char\the\appendixno.\the\secno.\the\subsecno</font>
<font color="#009900">  \else</font>
<font color="#009900">    \putwordSection@tie</font>
<font color="#009900">      @char\the\appendixno.\the\secno.\the\subsecno.\the\subsubsecno</font>
<font color="#009900">  \fi\fi\fi</font>
<font color="#009900">}</font>

<font color="#009900">% Define \refx{NAME}{SUFFIX} to reference a cross-reference string named NAME.</font>
<font color="#009900">% If its value is nonempty, SUFFIX is output afterward.</font>
<font color="#009900">%</font>
<font color="#009900">\def\refx#1#2{%</font>
<font color="#009900">  {%</font>
<font color="#009900">    \indexnofonts</font>
<font color="#009900">    \otherbackslash</font>
<font color="#009900">    \expandafter\global\expandafter\let\expandafter\thisrefX</font>
<font color="#009900">      \csname XR#1\endcsname</font>
<font color="#009900">  }%</font>
<font color="#009900">  \ifx\thisrefX\relax</font>
<font color="#009900">    % If not defined, say something at least.</font>
<font color="#009900">    \angleleft un\-de\-fined\angleright</font>
<font color="#009900">    \iflinks</font>
<font color="#009900">      \ifhavexrefs</font>
<font color="#009900">        {\toks0 = {#1}% avoid expansion of possibly-complex value</font>
<font color="#009900">         \message{\linenumber Undefined cross reference `\the\toks0'.}}%</font>
<font color="#009900">      \else</font>
<font color="#009900">        \ifwarnedxrefs\else</font>
<font color="#009900">          \global\warnedxrefstrue</font>
<font color="#009900">          \message{Cross reference values unknown; you must run TeX again.}%</font>
<font color="#009900">        \fi</font>
<font color="#009900">      \fi</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \else</font>
<font color="#009900">    % It's defined, so just use it.</font>
<font color="#009900">    \thisrefX</font>
<font color="#009900">  \fi</font>
<font color="#009900">  #2% Output the suffix in any case.</font>
<font color="#009900">}</font>

<font color="#009900">% This is the macro invoked by entries in the aux file.  Usually it's</font>
<font color="#009900">% just a \def (we prepend XR to the control sequence name to avoid</font>
<font color="#009900">% collisions).  But if this is a float type, we have more work to do.</font>
<font color="#009900">%</font>
<font color="#009900">\def\xrdef#1#2{%</font>
<font color="#009900">  {% The node name might contain 8-bit characters, which in our current</font>
<font color="#009900">   % implementation are changed to commands like @'e.  Don't let these</font>
<font color="#009900">   % mess up the control sequence name.</font>
<font color="#009900">    \indexnofonts</font>
<font color="#009900">    \turnoffactive</font>
<font color="#009900">    \xdef\safexrefname{#1}%</font>
<font color="#009900">  }%</font>
<font color="#009900">  %</font>
<font color="#009900">  \expandafter\gdef\csname XR\safexrefname\endcsname{#2}% remember this xref</font>
<font color="#009900">  %</font>
<font color="#009900">  % Was that xref control sequence that we just defined for a float?</font>
<font color="#009900">  \expandafter\iffloat\csname XR\safexrefname\endcsname</font>
<font color="#009900">    % it was a float, and we have the (safe) float type in \iffloattype.</font>
<font color="#009900">    \expandafter\let\expandafter\floatlist</font>
<font color="#009900">      \csname floatlist\iffloattype\endcsname</font>
<font color="#009900">    %</font>
<font color="#009900">    % Is this the first time we've seen this float type?</font>
<font color="#009900">    \expandafter\ifx\floatlist\relax</font>
<font color="#009900">      \toks0 = {\do}% yes, so just \do</font>
<font color="#009900">    \else</font>
<font color="#009900">      % had it before, so preserve previous elements in list.</font>
<font color="#009900">      \toks0 = \expandafter{\floatlist\do}%</font>
<font color="#009900">    \fi</font>
<font color="#009900">    %</font>
<font color="#009900">    % Remember this xref in the control sequence \floatlistFLOATTYPE,</font>
<font color="#009900">    % for later use in \listoffloats.</font>
<font color="#009900">    \expandafter\xdef\csname floatlist\iffloattype\endcsname{\the\toks0</font>
<font color="#009900">      {\safexrefname}}%</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% Read the last existing aux file, if any.  No error if none exists.</font>
<font color="#009900">%</font>
<font color="#009900">\def\tryauxfile{%</font>
<font color="#009900">  \openin 1 \jobname.aux</font>
<font color="#009900">  \ifeof 1 \else</font>
<font color="#009900">    \readdatafile{aux}%</font>
<font color="#009900">    \global\havexrefstrue</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \closein 1</font>
<font color="#009900">}</font>

<font color="#009900">\def\setupdatafile{%</font>
<font color="#009900">  \catcode`\^^@=\other</font>
<font color="#009900">  \catcode`\^^A=\other</font>
<font color="#009900">  \catcode`\^^B=\other</font>
<font color="#009900">  \catcode`\^^C=\other</font>
<font color="#009900">  \catcode`\^^D=\other</font>
<font color="#009900">  \catcode`\^^E=\other</font>
<font color="#009900">  \catcode`\^^F=\other</font>
<font color="#009900">  \catcode`\^^G=\other</font>
<font color="#009900">  \catcode`\^^H=\other</font>
<font color="#009900">  \catcode`\^^K=\other</font>
<font color="#009900">  \catcode`\^^L=\other</font>
<font color="#009900">  \catcode`\^^N=\other</font>
<font color="#009900">  \catcode`\^^P=\other</font>
<font color="#009900">  \catcode`\^^Q=\other</font>
<font color="#009900">  \catcode`\^^R=\other</font>
<font color="#009900">  \catcode`\^^S=\other</font>
<font color="#009900">  \catcode`\^^T=\other</font>
<font color="#009900">  \catcode`\^^U=\other</font>
<font color="#009900">  \catcode`\^^V=\other</font>
<font color="#009900">  \catcode`\^^W=\other</font>
<font color="#009900">  \catcode`\^^X=\other</font>
<font color="#009900">  \catcode`\^^Z=\other</font>
<font color="#009900">  \catcode`\^^[=\other</font>
<font color="#009900">  \catcode`\^^\=\other</font>
<font color="#009900">  \catcode`\^^]=\other</font>
<font color="#009900">  \catcode`\^^^=\other</font>
<font color="#009900">  \catcode`\^^_=\other</font>
<font color="#009900">  % It was suggested to set the catcode of ^ to 7, which would allow ^^e4 etc.</font>
<font color="#009900">  % in xref tags, i.e., node names.  But since ^^e4 notation isn't</font>
<font color="#009900">  % supported in the main text, it doesn't seem desirable.  Furthermore,</font>
<font color="#009900">  % that is not enough: for node names that actually contain a ^</font>
<font color="#009900">  % character, we would end up writing a line like this: 'xrdef {'hat</font>
<font color="#009900">  % b-title}{'hat b} and \xrdef does a \csname...\endcsname on the first</font>
<font color="#009900">  % argument, and \hat is not an expandable control sequence.  It could</font>
<font color="#009900">  % all be worked out, but why?  Either we support ^^ or we don't.</font>
<font color="#009900">  %</font>
<font color="#009900">  % The other change necessary for this was to define \auxhat:</font>
<font color="#009900">  % \def\auxhat{\def^{'hat }}% extra space so ok if followed by letter</font>
<font color="#009900">  % and then to call \auxhat in \setq.</font>
<font color="#009900">  %</font>
<font color="#009900">  \catcode`\^=\other</font>
<font color="#009900">  %</font>
<font color="#009900">  % Special characters.  Should be turned off anyway, but...</font>
<font color="#009900">  \catcode`\~=\other</font>
<font color="#009900">  \catcode`\[=\other</font>
<font color="#009900">  \catcode`\]=\other</font>
<font color="#009900">  \catcode`\"=\other</font>
<font color="#009900">  \catcode`\_=\other</font>
<font color="#009900">  \catcode`\|=\other</font>
<font color="#009900">  \catcode`\&lt;=\other</font>
<font color="#009900">  \catcode`\&gt;=\other</font>
<font color="#009900">  \catcode`\$=\other</font>
<font color="#009900">  \catcode`\#=\other</font>
<font color="#009900">  \catcode`\&amp;=\other</font>
<font color="#009900">  \catcode`\%=\other</font>
<font color="#009900">  \catcode`+=\other % avoid \+ for paranoia even though we've turned it off</font>
<font color="#009900">  %</font>
<font color="#009900">  % This is to support \ in node names and titles, since the \</font>
<font color="#009900">  % characters end up in a \csname.  It's easier than</font>
<font color="#009900">  % leaving it active and making its active definition an actual \</font>
<font color="#009900">  % character.  What I don't understand is why it works in the *value*</font>
<font color="#009900">  % of the xrdef.  Seems like it should be a catcode12 \, and that</font>
<font color="#009900">  % should not typeset properly.  But it works, so I'm moving on for</font>
<font color="#009900">  % now.  --karl, 15jan04.</font>
<font color="#009900">  \catcode`\\=\other</font>
<font color="#009900">  %</font>
<font color="#009900">  % Make the characters 128-255 be printing characters.</font>
<font color="#009900">  {%</font>
<font color="#009900">    \count1=128</font>
<font color="#009900">    \def\loop{%</font>
<font color="#009900">      \catcode\count1=\other</font>
<font color="#009900">      \advance\count1 by 1</font>
<font color="#009900">      \ifnum \count1&lt;256 \loop \fi</font>
<font color="#009900">    }%</font>
<font color="#009900">  }%</font>
<font color="#009900">  %</font>
<font color="#009900">  % @ is our escape character in .aux files, and we need braces.</font>
<font color="#009900">  \catcode`\{=1</font>
<font color="#009900">  \catcode`\}=2</font>
<font color="#009900">  \catcode`\@=0</font>
<font color="#009900">}</font>

<font color="#009900">\def\readdatafile#1{%</font>
<font color="#009900">\begingroup</font>
<font color="#009900">  \setupdatafile</font>
<font color="#009900">  \input\jobname.#1</font>
<font color="#009900">\endgroup}</font>


<font color="#009900">\message{insertions,}</font>
<font color="#009900">% including footnotes.</font>

<font color="#009900">\newcount \footnoteno</font>

<font color="#009900">% The trailing space in the following definition for supereject is</font>
<font color="#009900">% vital for proper filling; pages come out unaligned when you do a</font>
<font color="#009900">% pagealignmacro call if that space before the closing brace is</font>
<font color="#009900">% removed. (Generally, numeric constants should always be followed by a</font>
<font color="#009900">% space to prevent strange expansion errors.)</font>
<font color="#009900">\def\supereject{\par\penalty -20000\footnoteno =0 }</font>

<font color="#009900">% @footnotestyle is meaningful for Info output only.</font>
<font color="#009900">\let\footnotestyle=\comment</font>

<font color="#009900">{\catcode `\@=11</font>
<font color="#009900">%</font>
<font color="#009900">% Auto-number footnotes.  Otherwise like plain.</font>
<font color="#009900">\gdef\footnote{%</font>
<font color="#009900">  \let\indent=\ptexindent</font>
<font color="#009900">  \let\noindent=\ptexnoindent</font>
<font color="#009900">  \global\advance\footnoteno by \@ne</font>
<font color="#009900">  \edef\thisfootno{$^{\the\footnoteno}$}%</font>
<font color="#009900">  %</font>
<font color="#009900">  % In case the footnote comes at the end of a sentence, preserve the</font>
<font color="#009900">  % extra spacing after we do the footnote number.</font>
<font color="#009900">  \let\@sf\empty</font>
<font color="#009900">  \ifhmode\edef\@sf{\spacefactor\the\spacefactor}\ptexslash\fi</font>
<font color="#009900">  %</font>
<font color="#009900">  % Remove inadvertent blank space before typesetting the footnote number.</font>
<font color="#009900">  \unskip</font>
<font color="#009900">  \thisfootno\@sf</font>
<font color="#009900">  \dofootnote</font>
<font color="#009900">}%</font>

<font color="#009900">% Don't bother with the trickery in plain.tex to not require the</font>
<font color="#009900">% footnote text as a parameter.  Our footnotes don't need to be so general.</font>
<font color="#009900">%</font>
<font color="#009900">% Oh yes, they do; otherwise, @ifset (and anything else that uses</font>
<font color="#009900">% \parseargline) fails inside footnotes because the tokens are fixed when</font>
<font color="#009900">% the footnote is read.  --karl, 16nov96.</font>
<font color="#009900">%</font>
<font color="#009900">\gdef\dofootnote{%</font>
<font color="#009900">  \insert\footins\bgroup</font>
<font color="#009900">  % We want to typeset this text as a normal paragraph, even if the</font>
<font color="#009900">  % footnote reference occurs in (for example) a display environment.</font>
<font color="#009900">  % So reset some parameters.</font>
<font color="#009900">  \hsize=\pagewidth</font>
<font color="#009900">  \interlinepenalty\interfootnotelinepenalty</font>
<font color="#009900">  \splittopskip\ht\strutbox % top baseline for broken footnotes</font>
<font color="#009900">  \splitmaxdepth\dp\strutbox</font>
<font color="#009900">  \floatingpenalty\@MM</font>
<font color="#009900">  \leftskip\z@skip</font>
<font color="#009900">  \rightskip\z@skip</font>
<font color="#009900">  \spaceskip\z@skip</font>
<font color="#009900">  \xspaceskip\z@skip</font>
<font color="#009900">  \parindent\defaultparindent</font>
<font color="#009900">  %</font>
<font color="#009900">  \smallfonts \rm</font>
<font color="#009900">  %</font>
<font color="#009900">  % Because we use hanging indentation in footnotes, a @noindent appears</font>
<font color="#009900">  % to exdent this text, so make it be a no-op.  makeinfo does not use</font>
<font color="#009900">  % hanging indentation so @noindent can still be needed within footnote</font>
<font color="#009900">  % text after an @example or the like (not that this is good style).</font>
<font color="#009900">  \let\noindent = \relax</font>
<font color="#009900">  %</font>
<font color="#009900">  % Hang the footnote text off the number.  Use \everypar in case the</font>
<font color="#009900">  % footnote extends for more than one paragraph.</font>
<font color="#009900">  \everypar = {\hang}%</font>
<font color="#009900">  \textindent{\thisfootno}%</font>
<font color="#009900">  %</font>
<font color="#009900">  % Don't crash into the line above the footnote text.  Since this</font>
<font color="#009900">  % expands into a box, it must come within the paragraph, lest it</font>
<font color="#009900">  % provide a place where TeX can split the footnote.</font>
<font color="#009900">  \footstrut</font>
<font color="#009900">  %</font>
<font color="#009900">  % Invoke rest of plain TeX footnote routine.</font>
<font color="#009900">  \futurelet\next\fo@t</font>
<font color="#009900">}</font>
<font color="#009900">}%end \catcode `\@=11</font>

<font color="#009900">% In case a @footnote appears in a vbox, save the footnote text and create</font>
<font color="#009900">% the real \insert just after the vbox finished.  Otherwise, the insertion</font>
<font color="#009900">% would be lost.</font>
<font color="#009900">% Similarly, if a @footnote appears inside an alignment, save the footnote</font>
<font color="#009900">% text to a box and make the \insert when a row of the table is finished.</font>
<font color="#009900">% And the same can be done for other insert classes.  --kasal, 16nov03.</font>

<font color="#009900">% Replace the \insert primitive by a cheating macro.</font>
<font color="#009900">% Deeper inside, just make sure that the saved insertions are not spilled</font>
<font color="#009900">% out prematurely.</font>
<font color="#009900">%</font>
<font color="#009900">\def\startsavinginserts{%</font>
<font color="#009900">  \ifx \insert\ptexinsert</font>
<font color="#009900">    \let\insert\saveinsert</font>
<font color="#009900">  \else</font>
<font color="#009900">    \let\checkinserts\relax</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% This \insert replacement works for both \insert\footins{foo} and</font>
<font color="#009900">% \insert\footins\bgroup foo\egroup, but it doesn't work for \insert27{foo}.</font>
<font color="#009900">%</font>
<font color="#009900">\def\saveinsert#1{%</font>
<font color="#009900">  \edef\next{\noexpand\savetobox \makeSAVEname#1}%</font>
<font color="#009900">  \afterassignment\next</font>
<font color="#009900">  % swallow the left brace</font>
<font color="#009900">  \let\temp =</font>
<font color="#009900">}</font>
<font color="#009900">\def\makeSAVEname#1{\makecsname{SAVE\expandafter\gobble\string#1}}</font>
<font color="#009900">\def\savetobox#1{\global\setbox#1 = \vbox\bgroup \unvbox#1}</font>

<font color="#009900">\def\checksaveins#1{\ifvoid#1\else \placesaveins#1\fi}</font>

<font color="#009900">\def\placesaveins#1{%</font>
<font color="#009900">  \ptexinsert \csname\expandafter\gobblesave\string#1\endcsname</font>
<font color="#009900">    {\box#1}%</font>
<font color="#009900">}</font>

<font color="#009900">% eat @SAVE -- beware, all of them have catcode \other:</font>
<font color="#009900">{</font>
<font color="#009900">  \def\dospecials{\do S\do A\do V\do E} \uncatcodespecials  %  ;-)</font>
<font color="#009900">  \gdef\gobblesave @SAVE{}</font>
<font color="#009900">}</font>

<font color="#009900">% initialization:</font>
<font color="#009900">\def\newsaveins #1{%</font>
<font color="#009900">  \edef\next{\noexpand\newsaveinsX \makeSAVEname#1}%</font>
<font color="#009900">  \next</font>
<font color="#009900">}</font>
<font color="#009900">\def\newsaveinsX #1{%</font>
<font color="#009900">  \csname newbox\endcsname #1%</font>
<font color="#009900">  \expandafter\def\expandafter\checkinserts\expandafter{\checkinserts</font>
<font color="#009900">    \checksaveins #1}%</font>
<font color="#009900">}</font>

<font color="#009900">% initialize:</font>
<font color="#009900">\let\checkinserts\empty</font>
<font color="#009900">\newsaveins\footins</font>
<font color="#009900">\newsaveins\margin</font>


<font color="#009900">% @image.  We use the macros from epsf.tex to support this.</font>
<font color="#009900">% If epsf.tex is not installed and @image is used, we complain.</font>
<font color="#009900">%</font>
<font color="#009900">% Check for and read epsf.tex up front.  If we read it only at @image</font>
<font color="#009900">% time, we might be inside a group, and then its definitions would get</font>
<font color="#009900">% undone and the next image would fail.</font>
<font color="#009900">\openin 1 = epsf.tex</font>
<font color="#009900">\ifeof 1 \else</font>
<font color="#009900">  % Do not bother showing banner with epsf.tex v2.7k (available in</font>
<font color="#009900">  % doc/epsf.tex and on ctan).</font>
<font color="#009900">  \def\epsfannounce{\toks0 = }%</font>
<font color="#009900">  \input epsf.tex</font>
<font color="#009900">\fi</font>
<font color="#009900">\closein 1</font>
<font color="#009900">%</font>
<font color="#009900">% We will only complain once about lack of epsf.tex.</font>
<font color="#009900">\newif\ifwarnednoepsf</font>
<font color="#009900">\newhelp\noepsfhelp{epsf.tex must be installed for images to</font>
<font color="#009900">  work.  It is also included in the Texinfo distribution, or you can get</font>
<font color="#009900">  it from ftp://tug.org/tex/epsf.tex.}</font>
<font color="#009900">%</font>
<font color="#009900">\def\image#1{%</font>
<font color="#009900">  \ifx\epsfbox\thisisundefined</font>
<font color="#009900">    \ifwarnednoepsf \else</font>
<font color="#009900">      \errhelp = \noepsfhelp</font>
<font color="#009900">      \errmessage{epsf.tex not found, images will be ignored}%</font>
<font color="#009900">      \global\warnednoepsftrue</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \else</font>
<font color="#009900">    \imagexxx #1,,,,,\finish</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>
<font color="#009900">%</font>
<font color="#009900">% Arguments to @image:</font>
<font color="#009900">% #1 is (mandatory) image filename; we tack on .eps extension.</font>
<font color="#009900">% #2 is (optional) width, #3 is (optional) height.</font>
<font color="#009900">% #4 is (ignored optional) html alt text.</font>
<font color="#009900">% #5 is (ignored optional) extension.</font>
<font color="#009900">% #6 is just the usual extra ignored arg for parsing stuff.</font>
<font color="#009900">\newif\ifimagevmode</font>
<font color="#009900">\def\imagexxx#1,#2,#3,#4,#5,#6\finish{\begingroup</font>
<font color="#009900">  \catcode`\^^M = 5     % in case we're inside an example</font>
<font color="#009900">  \normalturnoffactive  % allow _ et al. in names</font>
<font color="#009900">  % If the image is by itself, center it.</font>
<font color="#009900">  \ifvmode</font>
<font color="#009900">    \imagevmodetrue</font>
<font color="#009900">  \else \ifx\centersub\centerV</font>
<font color="#009900">    % for @center @image, we need a vbox so we can have our vertical space</font>
<font color="#009900">    \imagevmodetrue</font>
<font color="#009900">    \vbox\bgroup % vbox has better behavior than vtop herev</font>
<font color="#009900">  \fi\fi</font>
<font color="#009900">  %</font>
<font color="#009900">  \ifimagevmode</font>
<font color="#009900">    \nobreak\medskip</font>
<font color="#009900">    % Usually we'll have text after the image which will insert</font>
<font color="#009900">    % \parskip glue, so insert it here too to equalize the space</font>
<font color="#009900">    % above and below.</font>
<font color="#009900">    \nobreak\vskip\parskip</font>
<font color="#009900">    \nobreak</font>
<font color="#009900">  \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  % Leave vertical mode so that indentation from an enclosing</font>
<font color="#009900">  %  environment such as @quotation is respected.</font>
<font color="#009900">  % However, if we're at the top level, we don't want the</font>
<font color="#009900">  %  normal paragraph indentation.</font>
<font color="#009900">  % On the other hand, if we are in the case of @center @image, we don't</font>
<font color="#009900">  %  want to start a paragraph, which will create a hsize-width box and</font>
<font color="#009900">  %  eradicate the centering.</font>
<font color="#009900">  \ifx\centersub\centerV\else \noindent \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  % Output the image.</font>
<font color="#009900">  \ifpdf</font>
<font color="#009900">    \dopdfimage{#1}{#2}{#3}%</font>
<font color="#009900">  \else</font>
<font color="#009900">    % \epsfbox itself resets \epsf?size at each figure.</font>
<font color="#009900">    \setbox0 = \hbox{\ignorespaces #2}\ifdim\wd0 &gt; 0pt \epsfxsize=#2\relax \fi</font>
<font color="#009900">    \setbox0 = \hbox{\ignorespaces #3}\ifdim\wd0 &gt; 0pt \epsfysize=#3\relax \fi</font>
<font color="#009900">    \epsfbox{#1.eps}%</font>
<font color="#009900">  \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  \ifimagevmode</font>
<font color="#009900">    \medskip  % space after a standalone image</font>
<font color="#009900">  \fi  </font>
<font color="#009900">  \ifx\centersub\centerV \egroup \fi</font>
<font color="#009900">\endgroup}</font>


<font color="#009900">% @float FLOATTYPE,LABEL,LOC ... @end float for displayed figures, tables,</font>
<font color="#009900">% etc.  We don't actually implement floating yet, we always include the</font>
<font color="#009900">% float "here".  But it seemed the best name for the future.</font>
<font color="#009900">%</font>
<font color="#009900">\envparseargdef\float{\eatcommaspace\eatcommaspace\dofloat#1, , ,\finish}</font>

<font color="#009900">% There may be a space before second and/or third parameter; delete it.</font>
<font color="#009900">\def\eatcommaspace#1, {#1,}</font>

<font color="#009900">% #1 is the optional FLOATTYPE, the text label for this float, typically</font>
<font color="#009900">% "Figure", "Table", "Example", etc.  Can't contain commas.  If omitted,</font>
<font color="#009900">% this float will not be numbered and cannot be referred to.</font>
<font color="#009900">%</font>
<font color="#009900">% #2 is the optional xref label.  Also must be present for the float to</font>
<font color="#009900">% be referable.</font>
<font color="#009900">%</font>
<font color="#009900">% #3 is the optional positioning argument; for now, it is ignored.  It</font>
<font color="#009900">% will somehow specify the positions allowed to float to (here, top, bottom).</font>
<font color="#009900">%</font>
<font color="#009900">% We keep a separate counter for each FLOATTYPE, which we reset at each</font>
<font color="#009900">% chapter-level command.</font>
<font color="#009900">\let\resetallfloatnos=\empty</font>
<font color="#009900">%</font>
<font color="#009900">\def\dofloat#1,#2,#3,#4\finish{%</font>
<font color="#009900">  \let\thiscaption=\empty</font>
<font color="#009900">  \let\thisshortcaption=\empty</font>
<font color="#009900">  %</font>
<font color="#009900">  % don't lose footnotes inside @float.</font>
<font color="#009900">  %</font>
<font color="#009900">  % BEWARE: when the floats start float, we have to issue warning whenever an</font>
<font color="#009900">  % insert appears inside a float which could possibly float. --kasal, 26may04</font>
<font color="#009900">  %</font>
<font color="#009900">  \startsavinginserts</font>
<font color="#009900">  %</font>
<font color="#009900">  % We can't be used inside a paragraph.</font>
<font color="#009900">  \par</font>
<font color="#009900">  %</font>
<font color="#009900">  \vtop\bgroup</font>
<font color="#009900">    \def\floattype{#1}%</font>
<font color="#009900">    \def\floatlabel{#2}%</font>
<font color="#009900">    \def\floatloc{#3}% we do nothing with this yet.</font>
<font color="#009900">    %</font>
<font color="#009900">    \ifx\floattype\empty</font>
<font color="#009900">      \let\safefloattype=\empty</font>
<font color="#009900">    \else</font>
<font color="#009900">      {%</font>
<font color="#009900">        % the floattype might have accents or other special characters,</font>
<font color="#009900">        % but we need to use it in a control sequence name.</font>
<font color="#009900">        \indexnofonts</font>
<font color="#009900">        \turnoffactive</font>
<font color="#009900">        \xdef\safefloattype{\floattype}%</font>
<font color="#009900">      }%</font>
<font color="#009900">    \fi</font>
<font color="#009900">    %</font>
<font color="#009900">    % If label is given but no type, we handle that as the empty type.</font>
<font color="#009900">    \ifx\floatlabel\empty \else</font>
<font color="#009900">      % We want each FLOATTYPE to be numbered separately (Figure 1,</font>
<font color="#009900">      % Table 1, Figure 2, ...).  (And if no label, no number.)</font>
<font color="#009900">      %</font>
<font color="#009900">      \expandafter\getfloatno\csname\safefloattype floatno\endcsname</font>
<font color="#009900">      \global\advance\floatno by 1</font>
<font color="#009900">      %</font>
<font color="#009900">      {%</font>
<font color="#009900">        % This magic value for \lastsection is output by \setref as the</font>
<font color="#009900">        % XREFLABEL-title value.  \xrefX uses it to distinguish float</font>
<font color="#009900">        % labels (which have a completely different output format) from</font>
<font color="#009900">        % node and anchor labels.  And \xrdef uses it to construct the</font>
<font color="#009900">        % lists of floats.</font>
<font color="#009900">        %</font>
<font color="#009900">        \edef\lastsection{\floatmagic=\safefloattype}%</font>
<font color="#009900">        \setref{\floatlabel}{Yfloat}%</font>
<font color="#009900">      }%</font>
<font color="#009900">    \fi</font>
<font color="#009900">    %</font>
<font color="#009900">    % start with \parskip glue, I guess.</font>
<font color="#009900">    \vskip\parskip</font>
<font color="#009900">    %</font>
<font color="#009900">    % Don't suppress indentation if a float happens to start a section.</font>
<font color="#009900">    \restorefirstparagraphindent</font>
<font color="#009900">}</font>

<font color="#009900">% we have these possibilities:</font>
<font color="#009900">% @float Foo,lbl &amp; @caption{Cap}: Foo 1.1: Cap</font>
<font color="#009900">% @float Foo,lbl &amp; no caption:    Foo 1.1</font>
<font color="#009900">% @float Foo &amp; @caption{Cap}:     Foo: Cap</font>
<font color="#009900">% @float Foo &amp; no caption:        Foo</font>
<font color="#009900">% @float ,lbl &amp; Caption{Cap}:     1.1: Cap</font>
<font color="#009900">% @float ,lbl &amp; no caption:       1.1</font>
<font color="#009900">% @float &amp; @caption{Cap}:         Cap</font>
<font color="#009900">% @float &amp; no caption:</font>
<font color="#009900">%</font>
<font color="#009900">\def\Efloat{%</font>
<font color="#009900">    \let\floatident = \empty</font>
<font color="#009900">    %</font>
<font color="#009900">    % In all cases, if we have a float type, it comes first.</font>
<font color="#009900">    \ifx\floattype\empty \else \def\floatident{\floattype}\fi</font>
<font color="#009900">    %</font>
<font color="#009900">    % If we have an xref label, the number comes next.</font>
<font color="#009900">    \ifx\floatlabel\empty \else</font>
<font color="#009900">      \ifx\floattype\empty \else % if also had float type, need tie first.</font>
<font color="#009900">        \appendtomacro\floatident{\tie}%</font>
<font color="#009900">      \fi</font>
<font color="#009900">      % the number.</font>
<font color="#009900">      \appendtomacro\floatident{\chaplevelprefix\the\floatno}%</font>
<font color="#009900">    \fi</font>
<font color="#009900">    %</font>
<font color="#009900">    % Start the printed caption with what we've constructed in</font>
<font color="#009900">    % \floatident, but keep it separate; we need \floatident again.</font>
<font color="#009900">    \let\captionline = \floatident</font>
<font color="#009900">    %</font>
<font color="#009900">    \ifx\thiscaption\empty \else</font>
<font color="#009900">      \ifx\floatident\empty \else</font>
<font color="#009900">	\appendtomacro\captionline{: }% had ident, so need a colon between</font>
<font color="#009900">      \fi</font>
<font color="#009900">      %</font>
<font color="#009900">      % caption text.</font>
<font color="#009900">      \appendtomacro\captionline{\scanexp\thiscaption}%</font>
<font color="#009900">    \fi</font>
<font color="#009900">    %</font>
<font color="#009900">    % If we have anything to print, print it, with space before.</font>
<font color="#009900">    % Eventually this needs to become an \insert.</font>
<font color="#009900">    \ifx\captionline\empty \else</font>
<font color="#009900">      \vskip.5\parskip</font>
<font color="#009900">      \captionline</font>
<font color="#009900">      %</font>
<font color="#009900">      % Space below caption.</font>
<font color="#009900">      \vskip\parskip</font>
<font color="#009900">    \fi</font>
<font color="#009900">    %</font>
<font color="#009900">    % If have an xref label, write the list of floats info.  Do this</font>
<font color="#009900">    % after the caption, to avoid chance of it being a breakpoint.</font>
<font color="#009900">    \ifx\floatlabel\empty \else</font>
<font color="#009900">      % Write the text that goes in the lof to the aux file as</font>
<font color="#009900">      % \floatlabel-lof.  Besides \floatident, we include the short</font>
<font color="#009900">      % caption if specified, else the full caption if specified, else nothing.</font>
<font color="#009900">      {%</font>
<font color="#009900">        \atdummies</font>
<font color="#009900">        %</font>
<font color="#009900">        % since we read the caption text in the macro world, where ^^M</font>
<font color="#009900">        % is turned into a normal character, we have to scan it back, so</font>
<font color="#009900">        % we don't write the literal three characters "^^M" into the aux file.</font>
<font color="#009900">	\scanexp{%</font>
<font color="#009900">	  \xdef\noexpand\gtemp{%</font>
<font color="#009900">	    \ifx\thisshortcaption\empty</font>
<font color="#009900">	      \thiscaption</font>
<font color="#009900">	    \else</font>
<font color="#009900">	      \thisshortcaption</font>
<font color="#009900">	    \fi</font>
<font color="#009900">	  }%</font>
<font color="#009900">	}%</font>
<font color="#009900">        \immediate\write\auxfile{@xrdef{\floatlabel-lof}{\floatident</font>
<font color="#009900">	  \ifx\gtemp\empty \else : \gtemp \fi}}%</font>
<font color="#009900">      }%</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \egroup  % end of \vtop</font>
<font color="#009900">  %</font>
<font color="#009900">  % place the captured inserts</font>
<font color="#009900">  %</font>
<font color="#009900">  % BEWARE: when the floats start floating, we have to issue warning</font>
<font color="#009900">  % whenever an insert appears inside a float which could possibly</font>
<font color="#009900">  % float. --kasal, 26may04</font>
<font color="#009900">  %</font>
<font color="#009900">  \checkinserts</font>
<font color="#009900">}</font>

<font color="#009900">% Append the tokens #2 to the definition of macro #1, not expanding either.</font>
<font color="#009900">%</font>
<font color="#009900">\def\appendtomacro#1#2{%</font>
<font color="#009900">  \expandafter\def\expandafter#1\expandafter{#1#2}%</font>
<font color="#009900">}</font>

<font color="#009900">% @caption, @shortcaption</font>
<font color="#009900">%</font>
<font color="#009900">\def\caption{\docaption\thiscaption}</font>
<font color="#009900">\def\shortcaption{\docaption\thisshortcaption}</font>
<font color="#009900">\def\docaption{\checkenv\float \bgroup\scanargctxt\defcaption}</font>
<font color="#009900">\def\defcaption#1#2{\egroup \def#1{#2}}</font>

<font color="#009900">% The parameter is the control sequence identifying the counter we are</font>
<font color="#009900">% going to use.  Create it if it doesn't exist and assign it to \floatno.</font>
<font color="#009900">\def\getfloatno#1{%</font>
<font color="#009900">  \ifx#1\relax</font>
<font color="#009900">      % Haven't seen this figure type before.</font>
<font color="#009900">      \csname newcount\endcsname #1%</font>
<font color="#009900">      %</font>
<font color="#009900">      % Remember to reset this floatno at the next chap.</font>
<font color="#009900">      \expandafter\gdef\expandafter\resetallfloatnos</font>
<font color="#009900">        \expandafter{\resetallfloatnos #1=0 }%</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \let\floatno#1%</font>
<font color="#009900">}</font>

<font color="#009900">% \setref calls this to get the XREFLABEL-snt value.  We want an @xref</font>
<font color="#009900">% to the FLOATLABEL to expand to "Figure 3.1".  We call \setref when we</font>
<font color="#009900">% first read the @float command.</font>
<font color="#009900">%</font>
<font color="#009900">\def\Yfloat{\floattype@tie \chaplevelprefix\the\floatno}%</font>

<font color="#009900">% Magic string used for the XREFLABEL-title value, so \xrefX can</font>
<font color="#009900">% distinguish floats from other xref types.</font>
<font color="#009900">\def\floatmagic{!!float!!}</font>

<font color="#009900">% #1 is the control sequence we are passed; we expand into a conditional</font>
<font color="#009900">% which is true if #1 represents a float ref.  That is, the magic</font>
<font color="#009900">% \lastsection value which we \setref above.</font>
<font color="#009900">%</font>
<font color="#009900">\def\iffloat#1{\expandafter\doiffloat#1==\finish}</font>
<font color="#009900">%</font>
<font color="#009900">% #1 is (maybe) the \floatmagic string.  If so, #2 will be the</font>
<font color="#009900">% (safe) float type for this float.  We set \iffloattype to #2.</font>
<font color="#009900">%</font>
<font color="#009900">\def\doiffloat#1=#2=#3\finish{%</font>
<font color="#009900">  \def\temp{#1}%</font>
<font color="#009900">  \def\iffloattype{#2}%</font>
<font color="#009900">  \ifx\temp\floatmagic</font>
<font color="#009900">}</font>

<font color="#009900">% @listoffloats FLOATTYPE - print a list of floats like a table of contents.</font>
<font color="#009900">%</font>
<font color="#009900">\parseargdef\listoffloats{%</font>
<font color="#009900">  \def\floattype{#1}% floattype</font>
<font color="#009900">  {%</font>
<font color="#009900">    % the floattype might have accents or other special characters,</font>
<font color="#009900">    % but we need to use it in a control sequence name.</font>
<font color="#009900">    \indexnofonts</font>
<font color="#009900">    \turnoffactive</font>
<font color="#009900">    \xdef\safefloattype{\floattype}%</font>
<font color="#009900">  }%</font>
<font color="#009900">  %</font>
<font color="#009900">  % \xrdef saves the floats as a \do-list in \floatlistSAFEFLOATTYPE.</font>
<font color="#009900">  \expandafter\ifx\csname floatlist\safefloattype\endcsname \relax</font>
<font color="#009900">    \ifhavexrefs</font>
<font color="#009900">      % if the user said @listoffloats foo but never @float foo.</font>
<font color="#009900">      \message{\linenumber No `\safefloattype' floats to list.}%</font>
<font color="#009900">    \fi</font>
<font color="#009900">  \else</font>
<font color="#009900">    \begingroup</font>
<font color="#009900">      \leftskip=\tocindent  % indent these entries like a toc</font>
<font color="#009900">      \let\do=\listoffloatsdo</font>
<font color="#009900">      \csname floatlist\safefloattype\endcsname</font>
<font color="#009900">    \endgroup</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<font color="#009900">% This is called on each entry in a list of floats.  We're passed the</font>
<font color="#009900">% xref label, in the form LABEL-title, which is how we save it in the</font>
<font color="#009900">% aux file.  We strip off the -title and look up \XRLABEL-lof, which</font>
<font color="#009900">% has the text we're supposed to typeset here.</font>
<font color="#009900">%</font>
<font color="#009900">% Figures without xref labels will not be included in the list (since</font>
<font color="#009900">% they won't appear in the aux file).</font>
<font color="#009900">%</font>
<font color="#009900">\def\listoffloatsdo#1{\listoffloatsdoentry#1\finish}</font>
<font color="#009900">\def\listoffloatsdoentry#1-title\finish{{%</font>
<font color="#009900">  % Can't fully expand XR#1-lof because it can contain anything.  Just</font>
<font color="#009900">  % pass the control sequence.  On the other hand, XR#1-pg is just the</font>
<font color="#009900">  % page number, and we want to fully expand that so we can get a link</font>
<font color="#009900">  % in pdf output.</font>
<font color="#009900">  \toksA = \expandafter{\csname XR#1-lof\endcsname}%</font>
<font color="#009900">  %</font>
<font color="#009900">  % use the same \entry macro we use to generate the TOC and index.</font>
<font color="#009900">  \edef\writeentry{\noexpand\entry{\the\toksA}{\csname XR#1-pg\endcsname}}%</font>
<font color="#009900">  \writeentry</font>
<font color="#009900">}}</font>


<font color="#009900">\message{localization,}</font>

<font color="#009900">% For single-language documents, @documentlanguage is usually given very</font>
<font color="#009900">% early, just after @documentencoding.  Single argument is the language</font>
<font color="#009900">% (de) or locale (de_DE) abbreviation.</font>
<font color="#009900">%</font>
<font color="#009900">{</font>
<font color="#009900">  \catcode`\_ = \active</font>
<font color="#009900">  \globaldefs=1</font>
<font color="#009900">\parseargdef\documentlanguage{\begingroup</font>
<font color="#009900">  \let_=\normalunderscore  % normal _ character for filenames</font>
<font color="#009900">  \tex % read txi-??.tex file in plain TeX.</font>
<font color="#009900">    % Read the file by the name they passed if it exists.</font>
<font color="#009900">    \openin 1 txi-#1.tex</font>
<font color="#009900">    \ifeof 1</font>
<font color="#009900">      \documentlanguagetrywithoutunderscore{#1_\finish}%</font>
<font color="#009900">    \else</font>
<font color="#009900">      \globaldefs = 1  % everything in the txi-LL files needs to persist</font>
<font color="#009900">      \input txi-#1.tex</font>
<font color="#009900">    \fi</font>
<font color="#009900">    \closein 1</font>
<font color="#009900">  \endgroup % end raw TeX</font>
<font color="#009900">\endgroup}</font>
<font color="#009900">%</font>
<font color="#009900">% If they passed de_DE, and txi-de_DE.tex doesn't exist,</font>
<font color="#009900">% try txi-de.tex.</font>
<font color="#009900">%</font>
<font color="#009900">\gdef\documentlanguagetrywithoutunderscore#1_#2\finish{%</font>
<font color="#009900">  \openin 1 txi-#1.tex</font>
<font color="#009900">  \ifeof 1</font>
<font color="#009900">    \errhelp = \nolanghelp</font>
<font color="#009900">    \errmessage{Cannot read language file txi-#1.tex}%</font>
<font color="#009900">  \else</font>
<font color="#009900">    \globaldefs = 1  % everything in the txi-LL files needs to persist</font>
<font color="#009900">    \input txi-#1.tex</font>
<font color="#009900">  \fi</font>
<font color="#009900">  \closein 1</font>
<font color="#009900">}</font>
<font color="#009900">}% end of special _ catcode</font>
<font color="#009900">%</font>
<font color="#009900">\newhelp\nolanghelp{The given language definition file cannot be found or</font>
<font color="#009900">is empty.  Maybe you need to install it?  Putting it in the current</font>
<font color="#009900">directory should work if nowhere else does.}</font>

<font color="#009900">% This macro is called from txi-??.tex files; the first argument is the</font>
<font color="#009900">% \language name to set (without the "\lang@" prefix), the second and</font>
<font color="#009900">% third args are \{left,right}</font>hyphenmin.
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% The language names to pass are determined when the format is built.</font></i>
<i><font color="#9A1900">% See the etex.log file created at that time, e.g.,</font></i>
<i><font color="#9A1900">% /usr/local/texlive/2008/texmf-var/web2c/pdftex/etex.log.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% With TeX Live 2008, etex now includes hyphenation patterns for all</font></i>
<i><font color="#9A1900">% available languages.  This means we can support hyphenation in</font></i>
<i><font color="#9A1900">% Texinfo, at least to some extent.  (This still doesn't solve the</font></i>
<i><font color="#9A1900">% accented characters problem.)</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\catcode</font></b><font color="#FF0000">`@=11</font>
<font color="#FF0000">\def\txisetlanguage#1#2#3{%</font>
<font color="#FF0000">  % do not set the language if the name is undefined in the current TeX.</font>
<font color="#FF0000">  \expandafter\ifx\csname lang@#1\endcsname \relax</font>
<font color="#FF0000">    \message{no patterns for #1}%</font>
<font color="#FF0000">  \else</font>
<font color="#FF0000">    \global\language = \csname lang@#1\endcsname</font>
<font color="#FF0000">  \fi</font>
<font color="#FF0000">  % but there is no harm in adjusting the hyphenmin values regardless.</font>
<font color="#FF0000">  \global\lefthyphenmin = #2\relax</font>
<font color="#FF0000">  \global\righthyphenmin = #3\relax</font>
<font color="#FF0000">}</font>

<font color="#FF0000">% Helpers for encodings.</font>
<font color="#FF0000">% Set the catcode of characters 128 through 255 to the specified number.</font>
<font color="#FF0000">%</font>
<font color="#FF0000">\def\setnonasciicharscatcode#1{%</font>
<font color="#FF0000">   \count255=128</font>
<font color="#FF0000">   \loop\ifnum\count255&lt;256</font>
<font color="#FF0000">      \global\catcode\count255=#1\relax</font>
<font color="#FF0000">      \advance\count255 by 1</font>
<font color="#FF0000">   \repeat</font>
<font color="#FF0000">}</font>

<font color="#FF0000">\def\setnonasciicharscatcodenonglobal#1{%</font>
<font color="#FF0000">   \count255=128</font>
<font color="#FF0000">   \loop\ifnum\count255&lt;256</font>
<font color="#FF0000">      \catcode\count255=#1\relax</font>
<font color="#FF0000">      \advance\count255 by 1</font>
<font color="#FF0000">   \repeat</font>
<font color="#FF0000">}</font>

<font color="#FF0000">% @documentencoding sets the definition of non-ASCII characters</font>
<font color="#FF0000">% according to the specified encoding.</font>
<font color="#FF0000">%</font>
<font color="#FF0000">\parseargdef\documentencoding{%</font>
<font color="#FF0000">  % Encoding being declared for the document.</font>
<font color="#FF0000">  \def\declaredencoding{\csname #1.enc\endcsname}%</font>
<font color="#FF0000">  %</font>
<font color="#FF0000">  % Supported encodings: names converted to tokens in order to be able</font>
<font color="#FF0000">  % to compare them with \ifx.</font>
<font color="#FF0000">  \def\ascii{\csname US-ASCII.enc\endcsname}%</font>
<font color="#FF0000">  \def\latnine{\csname ISO-8859-15.enc\endcsname}%</font>
<font color="#FF0000">  \def\latone{\csname ISO-8859-1.enc\endcsname}%</font>
<font color="#FF0000">  \def\lattwo{\csname ISO-8859-2.enc\endcsname}%</font>
<font color="#FF0000">  \def\utfeight{\csname UTF-8.enc\endcsname}%</font>
<font color="#FF0000">  %</font>
<font color="#FF0000">  \ifx \declaredencoding \ascii</font>
<font color="#FF0000">     \asciichardefs</font>
<font color="#FF0000">  %</font>
<font color="#FF0000">  \else \ifx \declaredencoding \lattwo</font>
<font color="#FF0000">     \setnonasciicharscatcode\active</font>
<font color="#FF0000">     \lattwochardefs</font>
<font color="#FF0000">  %</font>
<font color="#FF0000">  \else \ifx \declaredencoding \latone</font>
<font color="#FF0000">     \setnonasciicharscatcode\active</font>
<font color="#FF0000">     \latonechardefs</font>
<font color="#FF0000">  %</font>
<font color="#FF0000">  \else \ifx \declaredencoding \latnine</font>
<font color="#FF0000">     \setnonasciicharscatcode\active</font>
<font color="#FF0000">     \latninechardefs</font>
<font color="#FF0000">  %</font>
<font color="#FF0000">  \else \ifx \declaredencoding \utfeight</font>
<font color="#FF0000">     \setnonasciicharscatcode\active</font>
<font color="#FF0000">     \utfeightchardefs</font>
<font color="#FF0000">  %</font>
<font color="#FF0000">  \else</font>
<font color="#FF0000">    \message{Unknown document encoding #1, ignoring.}%</font>
<font color="#FF0000">  %</font>
<font color="#FF0000">  \fi % utfeight</font>
<font color="#FF0000">  \fi % latnine</font>
<font color="#FF0000">  \fi % latone</font>
<font color="#FF0000">  \fi % lattwo</font>
<font color="#FF0000">  \fi % ascii</font>
<font color="#FF0000">}</font>

<font color="#FF0000">% A message to be logged when using a character that isn'</font>t available
<i><font color="#9A1900">% the default font encoding (OT1).</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def\missingcharmsg</font></b>#1<font color="#009900">{\message{Character missing in OT1 encoding: #1.}}</font>

<i><font color="#9A1900">% Take account of \c (plain) vs. \, (Texinfo) difference.</font></i>
<b><font color="#0000FF">\def\cedilla</font></b>#1<font color="#009900">{\ifx\c\ptexc\c{#1}\else\,{#1}\fi}</font>

<i><font color="#9A1900">% First, make active non-ASCII characters in order for them to be</font></i>
<i><font color="#9A1900">% correctly categorized when TeX reads the replacement text of</font></i>
<i><font color="#9A1900">% macros containing the character definitions.</font></i>
<b><font color="#0000FF">\setnonasciicharscatcode\active</font></b>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% Latin1 (ISO-8859-1) character definitions.</font></i>
<b><font color="#0000FF">\def\latonechardefs</font></b><font color="#009900">{%</font>
<font color="#009900">  \gdef^^a0{\tie}</font>
<font color="#009900">  \gdef^^a1{\exclamdown}</font>
<font color="#009900">  \gdef^^a2{\missingcharmsg{CENT SIGN}}</font>
<font color="#009900">  \gdef^^a3{{\pounds}}</font>
<font color="#009900">  \gdef^^a4{\missingcharmsg{CURRENCY SIGN}}</font>
<font color="#009900">  \gdef^^a5{\missingcharmsg{YEN SIGN}}</font>
<font color="#009900">  \gdef^^a6{\missingcharmsg{BROKEN BAR}}</font>
<font color="#009900">  \gdef^^a7{\S}</font>
<font color="#009900">  \gdef^^a8{\"{}}</font>
<font color="#009900">  \gdef^^a9{\copyright}</font>
<font color="#009900">  \gdef^^aa{\ordf}</font>
<font color="#009900">  \gdef^^ab{\guillemetleft}</font>
<font color="#009900">  \gdef^^ac{$\lnot$}</font>
<font color="#009900">  \gdef^^ad{\-}</font>
<font color="#009900">  \gdef^^ae{\registeredsymbol}</font>
<font color="#009900">  \gdef^^af{\={}}</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef^^b0{\textdegree}</font>
<font color="#009900">  \gdef^^b1{$\pm$}</font>
<font color="#009900">  \gdef^^b2{$^2$}</font>
<font color="#009900">  \gdef^^b3{$^3$}</font>
<font color="#009900">  \gdef^^b4{\'{}}</font>
<font color="#009900">  \gdef^^b5{$\mu$}</font>
<font color="#009900">  \gdef^^b6{\P}</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef^^b7{$^.$}</font>
<font color="#009900">  \gdef^^b8{\cedilla\ }</font>
<font color="#009900">  \gdef^^b9{$^1$}</font>
<font color="#009900">  \gdef^^ba{\ordm}</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef^^bb{\guillemetright}</font>
<font color="#009900">  \gdef^^bc{$1\over4$}</font>
<font color="#009900">  \gdef^^bd{$1\over2$}</font>
<font color="#009900">  \gdef^^be{$3\over4$}</font>
<font color="#009900">  \gdef^^bf{\questiondown}</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef^^c0{\`A}</font>
<font color="#009900">  \gdef^^c1{\'A}</font>
<font color="#009900">  \gdef^^c2{\^A}</font>
<font color="#009900">  \gdef^^c3{\~A}</font>
<font color="#009900">  \gdef^^c4{\"A}</font>
<font color="#009900">  \gdef^^c5{\ringaccent A}</font>
<font color="#009900">  \gdef^^c6{\AE}</font>
<font color="#009900">  \gdef^^c7{\cedilla C}</font>
<font color="#009900">  \gdef^^c8{\`E}</font>
<font color="#009900">  \gdef^^c9{\'E}</font>
<font color="#009900">  \gdef^^ca{\^E}</font>
<font color="#009900">  \gdef^^cb{\"E}</font>
<font color="#009900">  \gdef^^cc{\`I}</font>
<font color="#009900">  \gdef^^cd{\'I}</font>
<font color="#009900">  \gdef^^ce{\^I}</font>
<font color="#009900">  \gdef^^cf{\"I}</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef^^d0{\DH}</font>
<font color="#009900">  \gdef^^d1{\~N}</font>
<font color="#009900">  \gdef^^d2{\`O}</font>
<font color="#009900">  \gdef^^d3{\'O}</font>
<font color="#009900">  \gdef^^d4{\^O}</font>
<font color="#009900">  \gdef^^d5{\~O}</font>
<font color="#009900">  \gdef^^d6{\"O}</font>
<font color="#009900">  \gdef^^d7{$\times$}</font>
<font color="#009900">  \gdef^^d8{\O}</font>
<font color="#009900">  \gdef^^d9{\`U}</font>
<font color="#009900">  \gdef^^da{\'U}</font>
<font color="#009900">  \gdef^^db{\^U}</font>
<font color="#009900">  \gdef^^dc{\"U}</font>
<font color="#009900">  \gdef^^dd{\'Y}</font>
<font color="#009900">  \gdef^^de{\TH}</font>
<font color="#009900">  \gdef^^df{\ss}</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef^^e0{\`a}</font>
<font color="#009900">  \gdef^^e1{\'a}</font>
<font color="#009900">  \gdef^^e2{\^a}</font>
<font color="#009900">  \gdef^^e3{\~a}</font>
<font color="#009900">  \gdef^^e4{\"a}</font>
<font color="#009900">  \gdef^^e5{\ringaccent a}</font>
<font color="#009900">  \gdef^^e6{\ae}</font>
<font color="#009900">  \gdef^^e7{\cedilla c}</font>
<font color="#009900">  \gdef^^e8{\`e}</font>
<font color="#009900">  \gdef^^e9{\'e}</font>
<font color="#009900">  \gdef^^ea{\^e}</font>
<font color="#009900">  \gdef^^eb{\"e}</font>
<font color="#009900">  \gdef^^ec{\`{\dotless i}}</font>
<font color="#009900">  \gdef^^ed{\'{\dotless i}}</font>
<font color="#009900">  \gdef^^ee{\^{\dotless i}}</font>
<font color="#009900">  \gdef^^ef{\"{\dotless i}}</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef^^f0{\dh}</font>
<font color="#009900">  \gdef^^f1{\~n}</font>
<font color="#009900">  \gdef^^f2{\`o}</font>
<font color="#009900">  \gdef^^f3{\'o}</font>
<font color="#009900">  \gdef^^f4{\^o}</font>
<font color="#009900">  \gdef^^f5{\~o}</font>
<font color="#009900">  \gdef^^f6{\"o}</font>
<font color="#009900">  \gdef^^f7{$\div$}</font>
<font color="#009900">  \gdef^^f8{\o}</font>
<font color="#009900">  \gdef^^f9{\`u}</font>
<font color="#009900">  \gdef^^fa{\'u}</font>
<font color="#009900">  \gdef^^fb{\^u}</font>
<font color="#009900">  \gdef^^fc{\"u}</font>
<font color="#009900">  \gdef^^fd{\'y}</font>
<font color="#009900">  \gdef^^fe{\th}</font>
<font color="#009900">  \gdef^^ff{\"y}</font>
<font color="#009900">}</font>

<i><font color="#9A1900">% Latin9 (ISO-8859-15) encoding character definitions.</font></i>
<b><font color="#0000FF">\def\latninechardefs</font></b><font color="#009900">{%</font>
<font color="#009900">  % Encoding is almost identical to Latin1.</font>
<font color="#009900">  \latonechardefs</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef^^a4{\euro}</font>
<font color="#009900">  \gdef^^a6{\v S}</font>
<font color="#009900">  \gdef^^a8{\v s}</font>
<font color="#009900">  \gdef^^b4{\v Z}</font>
<font color="#009900">  \gdef^^b8{\v z}</font>
<font color="#009900">  \gdef^^bc{\OE}</font>
<font color="#009900">  \gdef^^bd{\oe}</font>
<font color="#009900">  \gdef^^be{\"Y}</font>
<font color="#009900">}</font>

<i><font color="#9A1900">% Latin2 (ISO-8859-2) character definitions.</font></i>
<b><font color="#0000FF">\def\lattwochardefs</font></b><font color="#009900">{%</font>
<font color="#009900">  \gdef^^a0{\tie}</font>
<font color="#009900">  \gdef^^a1{\ogonek{A}}</font>
<font color="#009900">  \gdef^^a2{\u{}}</font>
<font color="#009900">  \gdef^^a3{\L}</font>
<font color="#009900">  \gdef^^a4{\missingcharmsg{CURRENCY SIGN}}</font>
<font color="#009900">  \gdef^^a5{\v L}</font>
<font color="#009900">  \gdef^^a6{\'S}</font>
<font color="#009900">  \gdef^^a7{\S}</font>
<font color="#009900">  \gdef^^a8{\"{}}</font>
<font color="#009900">  \gdef^^a9{\v S}</font>
<font color="#009900">  \gdef^^aa{\cedilla S}</font>
<font color="#009900">  \gdef^^ab{\v T}</font>
<font color="#009900">  \gdef^^ac{\'Z}</font>
<font color="#009900">  \gdef^^ad{\-}</font>
<font color="#009900">  \gdef^^ae{\v Z}</font>
<font color="#009900">  \gdef^^af{\dotaccent Z}</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef^^b0{\textdegree}</font>
<font color="#009900">  \gdef^^b1{\ogonek{a}}</font>
<font color="#009900">  \gdef^^b2{\ogonek{ }}</font>
<font color="#009900">  \gdef^^b3{\l}</font>
<font color="#009900">  \gdef^^b4{\'{}}</font>
<font color="#009900">  \gdef^^b5{\v l}</font>
<font color="#009900">  \gdef^^b6{\'s}</font>
<font color="#009900">  \gdef^^b7{\v{}}</font>
<font color="#009900">  \gdef^^b8{\cedilla\ }</font>
<font color="#009900">  \gdef^^b9{\v s}</font>
<font color="#009900">  \gdef^^ba{\cedilla s}</font>
<font color="#009900">  \gdef^^bb{\v t}</font>
<font color="#009900">  \gdef^^bc{\'z}</font>
<font color="#009900">  \gdef^^bd{\H{}}</font>
<font color="#009900">  \gdef^^be{\v z}</font>
<font color="#009900">  \gdef^^bf{\dotaccent z}</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef^^c0{\'R}</font>
<font color="#009900">  \gdef^^c1{\'A}</font>
<font color="#009900">  \gdef^^c2{\^A}</font>
<font color="#009900">  \gdef^^c3{\u A}</font>
<font color="#009900">  \gdef^^c4{\"A}</font>
<font color="#009900">  \gdef^^c5{\'L}</font>
<font color="#009900">  \gdef^^c6{\'C}</font>
<font color="#009900">  \gdef^^c7{\cedilla C}</font>
<font color="#009900">  \gdef^^c8{\v C}</font>
<font color="#009900">  \gdef^^c9{\'E}</font>
<font color="#009900">  \gdef^^ca{\ogonek{E}}</font>
<font color="#009900">  \gdef^^cb{\"E}</font>
<font color="#009900">  \gdef^^cc{\v E}</font>
<font color="#009900">  \gdef^^cd{\'I}</font>
<font color="#009900">  \gdef^^ce{\^I}</font>
<font color="#009900">  \gdef^^cf{\v D}</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef^^d0{\DH}</font>
<font color="#009900">  \gdef^^d1{\'N}</font>
<font color="#009900">  \gdef^^d2{\v N}</font>
<font color="#009900">  \gdef^^d3{\'O}</font>
<font color="#009900">  \gdef^^d4{\^O}</font>
<font color="#009900">  \gdef^^d5{\H O}</font>
<font color="#009900">  \gdef^^d6{\"O}</font>
<font color="#009900">  \gdef^^d7{$\times$}</font>
<font color="#009900">  \gdef^^d8{\v R}</font>
<font color="#009900">  \gdef^^d9{\ringaccent U}</font>
<font color="#009900">  \gdef^^da{\'U}</font>
<font color="#009900">  \gdef^^db{\H U}</font>
<font color="#009900">  \gdef^^dc{\"U}</font>
<font color="#009900">  \gdef^^dd{\'Y}</font>
<font color="#009900">  \gdef^^de{\cedilla T}</font>
<font color="#009900">  \gdef^^df{\ss}</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef^^e0{\'r}</font>
<font color="#009900">  \gdef^^e1{\'a}</font>
<font color="#009900">  \gdef^^e2{\^a}</font>
<font color="#009900">  \gdef^^e3{\u a}</font>
<font color="#009900">  \gdef^^e4{\"a}</font>
<font color="#009900">  \gdef^^e5{\'l}</font>
<font color="#009900">  \gdef^^e6{\'c}</font>
<font color="#009900">  \gdef^^e7{\cedilla c}</font>
<font color="#009900">  \gdef^^e8{\v c}</font>
<font color="#009900">  \gdef^^e9{\'e}</font>
<font color="#009900">  \gdef^^ea{\ogonek{e}}</font>
<font color="#009900">  \gdef^^eb{\"e}</font>
<font color="#009900">  \gdef^^ec{\v e}</font>
<font color="#009900">  \gdef^^ed{\'{\dotless{i}}}</font>
<font color="#009900">  \gdef^^ee{\^{\dotless{i}}}</font>
<font color="#009900">  \gdef^^ef{\v d}</font>
<font color="#009900">  %</font>
<font color="#009900">  \gdef^^f0{\dh}</font>
<font color="#009900">  \gdef^^f1{\'n}</font>
<font color="#009900">  \gdef^^f2{\v n}</font>
<font color="#009900">  \gdef^^f3{\'o}</font>
<font color="#009900">  \gdef^^f4{\^o}</font>
<font color="#009900">  \gdef^^f5{\H o}</font>
<font color="#009900">  \gdef^^f6{\"o}</font>
<font color="#009900">  \gdef^^f7{$\div$}</font>
<font color="#009900">  \gdef^^f8{\v r}</font>
<font color="#009900">  \gdef^^f9{\ringaccent u}</font>
<font color="#009900">  \gdef^^fa{\'u}</font>
<font color="#009900">  \gdef^^fb{\H u}</font>
<font color="#009900">  \gdef^^fc{\"u}</font>
<font color="#009900">  \gdef^^fd{\'y}</font>
<font color="#009900">  \gdef^^fe{\cedilla t}</font>
<font color="#009900">  \gdef^^ff{\dotaccent{}}</font>
<font color="#009900">}</font>

<i><font color="#9A1900">% UTF-8 character definitions.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% This code to support UTF-8 is based on LaTeX's utf8.def, with some</font></i>
<i><font color="#9A1900">% changes for Texinfo conventions.  It is included here under the GPL by</font></i>
<i><font color="#9A1900">% permission from Frank Mittelbach and the LaTeX team.</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\newcount\countUTFx</font></b>
<b><font color="#0000FF">\newcount\countUTFy</font></b>
<b><font color="#0000FF">\newcount\countUTFz</font></b>

<b><font color="#0000FF">\gdef\UTFviiiTwoOctets</font></b>#1#2<font color="#009900">{\expandafter</font>
<font color="#009900">   \UTFviiiDefined\csname u8:#1\string #2\endcsname}</font>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\gdef\UTFviiiThreeOctets</font></b>#1#2#3<font color="#009900">{\expandafter</font>
<font color="#009900">   \UTFviiiDefined\csname u8:#1\string #2\string #3\endcsname}</font>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\gdef\UTFviiiFourOctets</font></b>#1#2#3#4<font color="#009900">{\expandafter</font>
<font color="#009900">   \UTFviiiDefined\csname u8:#1\string #2\string #3\string #4\endcsname}</font>

<b><font color="#0000FF">\gdef\UTFviiiDefined</font></b>#1<font color="#009900">{%</font>
<font color="#009900">  \ifx #1\relax</font>
<font color="#009900">    \message{\linenumber Unicode char \string #1 not defined for Texinfo}%</font>
<font color="#009900">  \else</font>
<font color="#009900">    \expandafter #1%</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<b><font color="#0000FF">\begingroup</font></b>
  <b><font color="#0000FF">\catcode</font></b><font color="#FF0000">`\~13</font>
<font color="#FF0000">  \catcode`\"12</font>

<font color="#FF0000">  \def\UTFviiiLoop{%</font>
<font color="#FF0000">    \global\catcode\countUTFx\active</font>
<font color="#FF0000">    \uccode`\~\countUTFx</font>
<font color="#FF0000">    \uppercase\expandafter{\UTFviiiTmp}%</font>
<font color="#FF0000">    \advance\countUTFx by 1</font>
<font color="#FF0000">    \ifnum\countUTFx &lt; \countUTFy</font>
<font color="#FF0000">      \expandafter\UTFviiiLoop</font>
<font color="#FF0000">    \fi}</font>

<font color="#FF0000">  \countUTFx = "C2</font>
<font color="#FF0000">  \countUTFy = "E0</font>
<font color="#FF0000">  \def\UTFviiiTmp{%</font>
<font color="#FF0000">    \xdef~{\noexpand\UTFviiiTwoOctets\string~}}</font>
<font color="#FF0000">  \UTFviiiLoop</font>

<font color="#FF0000">  \countUTFx = "E0</font>
<font color="#FF0000">  \countUTFy = "F0</font>
<font color="#FF0000">  \def\UTFviiiTmp{%</font>
<font color="#FF0000">    \xdef~{\noexpand\UTFviiiThreeOctets\string~}}</font>
<font color="#FF0000">  \UTFviiiLoop</font>

<font color="#FF0000">  \countUTFx = "F0</font>
<font color="#FF0000">  \countUTFy = "F4</font>
<font color="#FF0000">  \def\UTFviiiTmp{%</font>
<font color="#FF0000">    \xdef~{\noexpand\UTFviiiFourOctets\string~}}</font>
<font color="#FF0000">  \UTFviiiLoop</font>
<font color="#FF0000">\endgroup</font>

<font color="#FF0000">\begingroup</font>
<font color="#FF0000">  \catcode`\"=12</font>
<font color="#FF0000">  \catcode`\&lt;=12</font>
<font color="#FF0000">  \catcode`\.=12</font>
<font color="#FF0000">  \catcode`\,=12</font>
<font color="#FF0000">  \catcode`\;=12</font>
<font color="#FF0000">  \catcode`\!=12</font>
<font color="#FF0000">  \catcode`\~=13</font>

<font color="#FF0000">  \gdef\DeclareUnicodeCharacter#1#2{%</font>
<font color="#FF0000">    \countUTFz = "#1\relax</font>
<font color="#FF0000">    %\wlog{\space\space defining Unicode char U+#1 (decimal \the\countUTFz)}%</font>
<font color="#FF0000">    \begingroup</font>
<font color="#FF0000">      \parseXMLCharref</font>
<font color="#FF0000">      \def\UTFviiiTwoOctets##1##2{%</font>
<font color="#FF0000">        \csname u8:##1\string ##2\endcsname}%</font>
<font color="#FF0000">      \def\UTFviiiThreeOctets##1##2##3{%</font>
<font color="#FF0000">        \csname u8:##1\string ##2\string ##3\endcsname}%</font>
<font color="#FF0000">      \def\UTFviiiFourOctets##1##2##3##4{%</font>
<font color="#FF0000">        \csname u8:##1\string ##2\string ##3\string ##4\endcsname}%</font>
<font color="#FF0000">      \expandafter\expandafter\expandafter\expandafter</font>
<font color="#FF0000">       \expandafter\expandafter\expandafter</font>
<font color="#FF0000">       \gdef\UTFviiiTmp{#2}%</font>
<font color="#FF0000">    \endgroup}</font>

<font color="#FF0000">  \gdef\parseXMLCharref{%</font>
<font color="#FF0000">    \ifnum\countUTFz &lt; "A0\relax</font>
<font color="#FF0000">      \errhelp = \EMsimple</font>
<font color="#FF0000">      \errmessage{Cannot define Unicode char value &lt; 00A0}%</font>
<font color="#FF0000">    \else\ifnum\countUTFz &lt; "800\relax</font>
<font color="#FF0000">      \parseUTFviiiA,%</font>
<font color="#FF0000">      \parseUTFviiiB C\UTFviiiTwoOctets.,%</font>
<font color="#FF0000">    \else\ifnum\countUTFz &lt; "10000\relax</font>
<font color="#FF0000">      \parseUTFviiiA;%</font>
<font color="#FF0000">      \parseUTFviiiA,%</font>
<font color="#FF0000">      \parseUTFviiiB E\UTFviiiThreeOctets.{,;}%</font>
<font color="#FF0000">    \else</font>
<font color="#FF0000">      \parseUTFviiiA;%</font>
<font color="#FF0000">      \parseUTFviiiA,%</font>
<font color="#FF0000">      \parseUTFviiiA!%</font>
<font color="#FF0000">      \parseUTFviiiB F\UTFviiiFourOctets.{!,;}%</font>
<font color="#FF0000">    \fi\fi\fi</font>
<font color="#FF0000">  }</font>

<font color="#FF0000">  \gdef\parseUTFviiiA#1{%</font>
<font color="#FF0000">    \countUTFx = \countUTFz</font>
<font color="#FF0000">    \divide\countUTFz by 64</font>
<font color="#FF0000">    \countUTFy = \countUTFz</font>
<font color="#FF0000">    \multiply\countUTFz by 64</font>
<font color="#FF0000">    \advance\countUTFx by -\countUTFz</font>
<font color="#FF0000">    \advance\countUTFx by 128</font>
<font color="#FF0000">    \uccode `#1\countUTFx</font>
<font color="#FF0000">    \countUTFz = \countUTFy}</font>

<font color="#FF0000">  \gdef\parseUTFviiiB#1#2#3#4{%</font>
<font color="#FF0000">    \advance\countUTFz by "#10\relax</font>
<font color="#FF0000">    \uccode `#3\countUTFz</font>
<font color="#FF0000">    \uppercase{\gdef\UTFviiiTmp{#2#3#4}}}</font>
<font color="#FF0000">\endgroup</font>

<font color="#FF0000">\def\utfeightchardefs{%</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00A0}{\tie}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00A1}{\exclamdown}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00A3}{\pounds}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00A8}{\"{ }}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00A9}{\copyright}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00AA}{\ordf}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00AB}{\guillemetleft}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00AD}{\-}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00AE}{\registeredsymbol}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00AF}{\={ }}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{00B0}{\ringaccent{ }}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00B4}{\'{ }}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00B8}{\cedilla{ }}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00BA}{\ordm}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00BB}{\guillemetright}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00BF}{\questiondown}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{00C0}{\`A}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00C1}{\'A}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00C2}{\^A}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00C3}{\~A}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00C4}{\"A}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00C5}{\AA}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00C6}{\AE}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00C7}{\cedilla{C}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00C8}{\`E}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00C9}{\'E}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00CA}{\^E}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00CB}{\"E}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00CC}{\`I}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00CD}{\'I}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00CE}{\^I}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00CF}{\"I}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{00D0}{\DH}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00D1}{\~N}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00D2}{\`O}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00D3}{\'O}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00D4}{\^O}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00D5}{\~O}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00D6}{\"O}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00D8}{\O}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00D9}{\`U}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00DA}{\'U}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00DB}{\^U}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00DC}{\"U}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00DD}{\'Y}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00DE}{\TH}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00DF}{\ss}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{00E0}{\`a}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00E1}{\'a}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00E2}{\^a}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00E3}{\~a}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00E4}{\"a}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00E5}{\aa}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00E6}{\ae}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00E7}{\cedilla{c}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00E8}{\`e}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00E9}{\'e}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00EA}{\^e}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00EB}{\"e}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00EC}{\`{\dotless{i}}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00ED}{\'{\dotless{i}}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00EE}{\^{\dotless{i}}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00EF}{\"{\dotless{i}}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{00F0}{\dh}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00F1}{\~n}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00F2}{\`o}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00F3}{\'o}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00F4}{\^o}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00F5}{\~o}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00F6}{\"o}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00F8}{\o}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00F9}{\`u}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00FA}{\'u}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00FB}{\^u}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00FC}{\"u}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00FD}{\'y}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00FE}{\th}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{00FF}{\"y}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{0100}{\=A}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0101}{\=a}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0102}{\u{A}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0103}{\u{a}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0104}{\ogonek{A}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0105}{\ogonek{a}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0106}{\'C}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0107}{\'c}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0108}{\^C}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0109}{\^c}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0118}{\ogonek{E}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0119}{\ogonek{e}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{010A}{\dotaccent{C}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{010B}{\dotaccent{c}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{010C}{\v{C}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{010D}{\v{c}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{010E}{\v{D}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{0112}{\=E}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0113}{\=e}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0114}{\u{E}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0115}{\u{e}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0116}{\dotaccent{E}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0117}{\dotaccent{e}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{011A}{\v{E}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{011B}{\v{e}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{011C}{\^G}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{011D}{\^g}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{011E}{\u{G}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{011F}{\u{g}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{0120}{\dotaccent{G}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0121}{\dotaccent{g}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0124}{\^H}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0125}{\^h}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0128}{\~I}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0129}{\~{\dotless{i}}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{012A}{\=I}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{012B}{\={\dotless{i}}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{012C}{\u{I}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{012D}{\u{\dotless{i}}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{0130}{\dotaccent{I}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0131}{\dotless{i}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0132}{IJ}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0133}{ij}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0134}{\^J}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0135}{\^{\dotless{j}}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0139}{\'L}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{013A}{\'l}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{0141}{\L}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0142}{\l}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0143}{\'N}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0144}{\'n}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0147}{\v{N}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0148}{\v{n}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{014C}{\=O}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{014D}{\=o}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{014E}{\u{O}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{014F}{\u{o}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{0150}{\H{O}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0151}{\H{o}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0152}{\OE}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0153}{\oe}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0154}{\'R}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0155}{\'r}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0158}{\v{R}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0159}{\v{r}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{015A}{\'S}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{015B}{\'s}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{015C}{\^S}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{015D}{\^s}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{015E}{\cedilla{S}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{015F}{\cedilla{s}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{0160}{\v{S}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0161}{\v{s}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0162}{\cedilla{t}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0163}{\cedilla{T}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0164}{\v{T}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{0168}{\~U}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0169}{\~u}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{016A}{\=U}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{016B}{\=u}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{016C}{\u{U}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{016D}{\u{u}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{016E}{\ringaccent{U}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{016F}{\ringaccent{u}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{0170}{\H{U}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0171}{\H{u}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0174}{\^W}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0175}{\^w}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0176}{\^Y}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0177}{\^y}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0178}{\"Y}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0179}{\'Z}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{017A}{\'z}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{017B}{\dotaccent{Z}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{017C}{\dotaccent{z}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{017D}{\v{Z}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{017E}{\v{z}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{01C4}{D\v{Z}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01C5}{D\v{z}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01C6}{d\v{z}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01C7}{LJ}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01C8}{Lj}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01C9}{lj}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01CA}{NJ}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01CB}{Nj}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01CC}{nj}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01CD}{\v{A}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01CE}{\v{a}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01CF}{\v{I}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{01D0}{\v{\dotless{i}}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01D1}{\v{O}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01D2}{\v{o}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01D3}{\v{U}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01D4}{\v{u}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{01E2}{\={\AE}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01E3}{\={\ae}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01E6}{\v{G}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01E7}{\v{g}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01E8}{\v{K}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01E9}{\v{k}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{01F0}{\v{\dotless{j}}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01F1}{DZ}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01F2}{Dz}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01F3}{dz}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01F4}{\'G}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01F5}{\'g}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01F8}{\`N}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01F9}{\`n}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01FC}{\'{\AE}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01FD}{\'{\ae}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01FE}{\'{\O}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{01FF}{\'{\o}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{021E}{\v{H}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{021F}{\v{h}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{0226}{\dotaccent{A}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0227}{\dotaccent{a}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0228}{\cedilla{E}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0229}{\cedilla{e}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{022E}{\dotaccent{O}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{022F}{\dotaccent{o}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{0232}{\=Y}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0233}{\=y}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{0237}{\dotless{j}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{02DB}{\ogonek{ }}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1E02}{\dotaccent{B}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E03}{\dotaccent{b}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E04}{\udotaccent{B}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E05}{\udotaccent{b}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E06}{\ubaraccent{B}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E07}{\ubaraccent{b}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E0A}{\dotaccent{D}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E0B}{\dotaccent{d}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E0C}{\udotaccent{D}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E0D}{\udotaccent{d}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E0E}{\ubaraccent{D}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E0F}{\ubaraccent{d}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1E1E}{\dotaccent{F}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E1F}{\dotaccent{f}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1E20}{\=G}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E21}{\=g}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E22}{\dotaccent{H}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E23}{\dotaccent{h}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E24}{\udotaccent{H}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E25}{\udotaccent{h}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E26}{\"H}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E27}{\"h}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1E30}{\'K}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E31}{\'k}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E32}{\udotaccent{K}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E33}{\udotaccent{k}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E34}{\ubaraccent{K}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E35}{\ubaraccent{k}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E36}{\udotaccent{L}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E37}{\udotaccent{l}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E3A}{\ubaraccent{L}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E3B}{\ubaraccent{l}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E3E}{\'M}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E3F}{\'m}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1E40}{\dotaccent{M}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E41}{\dotaccent{m}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E42}{\udotaccent{M}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E43}{\udotaccent{m}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E44}{\dotaccent{N}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E45}{\dotaccent{n}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E46}{\udotaccent{N}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E47}{\udotaccent{n}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E48}{\ubaraccent{N}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E49}{\ubaraccent{n}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1E54}{\'P}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E55}{\'p}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E56}{\dotaccent{P}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E57}{\dotaccent{p}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E58}{\dotaccent{R}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E59}{\dotaccent{r}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E5A}{\udotaccent{R}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E5B}{\udotaccent{r}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E5E}{\ubaraccent{R}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E5F}{\ubaraccent{r}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1E60}{\dotaccent{S}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E61}{\dotaccent{s}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E62}{\udotaccent{S}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E63}{\udotaccent{s}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E6A}{\dotaccent{T}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E6B}{\dotaccent{t}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E6C}{\udotaccent{T}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E6D}{\udotaccent{t}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E6E}{\ubaraccent{T}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E6F}{\ubaraccent{t}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1E7C}{\~V}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E7D}{\~v}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E7E}{\udotaccent{V}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E7F}{\udotaccent{v}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1E80}{\`W}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E81}{\`w}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E82}{\'W}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E83}{\'w}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E84}{\"W}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E85}{\"w}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E86}{\dotaccent{W}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E87}{\dotaccent{w}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E88}{\udotaccent{W}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E89}{\udotaccent{w}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E8A}{\dotaccent{X}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E8B}{\dotaccent{x}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E8C}{\"X}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E8D}{\"x}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E8E}{\dotaccent{Y}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E8F}{\dotaccent{y}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1E90}{\^Z}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E91}{\^z}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E92}{\udotaccent{Z}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E93}{\udotaccent{z}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E94}{\ubaraccent{Z}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E95}{\ubaraccent{z}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E96}{\ubaraccent{h}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E97}{\"t}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E98}{\ringaccent{w}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1E99}{\ringaccent{y}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1EA0}{\udotaccent{A}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1EA1}{\udotaccent{a}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1EB8}{\udotaccent{E}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1EB9}{\udotaccent{e}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1EBC}{\~E}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1EBD}{\~e}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1ECA}{\udotaccent{I}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1ECB}{\udotaccent{i}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1ECC}{\udotaccent{O}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1ECD}{\udotaccent{o}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1EE4}{\udotaccent{U}}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1EE5}{\udotaccent{u}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1EF2}{\`Y}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1EF3}{\`y}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1EF4}{\udotaccent{Y}}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{1EF8}{\~Y}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{1EF9}{\~y}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{2013}{--}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{2014}{---}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{2018}{\quoteleft}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{2019}{\quoteright}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{201A}{\quotesinglbase}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{201C}{\quotedblleft}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{201D}{\quotedblright}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{201E}{\quotedblbase}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{2022}{\bullet}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{2026}{\dots}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{2039}{\guilsinglleft}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{203A}{\guilsinglright}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{20AC}{\euro}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{2192}{\expansion}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{21D2}{\result}</font>

<font color="#FF0000">  \DeclareUnicodeCharacter{2212}{\minus}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{2217}{\point}</font>
<font color="#FF0000">  \DeclareUnicodeCharacter{2261}{\equiv}</font>
<font color="#FF0000">}% end of \utfeightchardefs</font>


<font color="#FF0000">% US-ASCII character definitions.</font>
<font color="#FF0000">\def\asciichardefs{% nothing need be done</font>
<font color="#FF0000">   \relax</font>
<font color="#FF0000">}</font>

<font color="#FF0000">% Make non-ASCII characters printable again for compatibility with</font>
<font color="#FF0000">% existing Texinfo documents that may use them, even without declaring a</font>
<font color="#FF0000">% document encoding.</font>
<font color="#FF0000">%</font>
<font color="#FF0000">\setnonasciicharscatcode \other</font>


<font color="#FF0000">\message{formatting,}</font>

<font color="#FF0000">\newdimen\defaultparindent \defaultparindent = 15pt</font>

<font color="#FF0000">\chapheadingskip = 15pt plus 4pt minus 2pt</font>
<font color="#FF0000">\secheadingskip = 12pt plus 3pt minus 2pt</font>
<font color="#FF0000">\subsecheadingskip = 9pt plus 2pt minus 2pt</font>

<font color="#FF0000">% Prevent underfull vbox error messages.</font>
<font color="#FF0000">\vbadness = 10000</font>

<font color="#FF0000">% Don'</font>t be very finicky about underfull hboxes, either.
<b><font color="#0000FF">\hbadness</font></b> = 6666

<i><font color="#9A1900">% Following George Bush, get rid of widows and orphans.</font></i>
<b><font color="#0000FF">\widowpenalty</font></b>=10000
<b><font color="#0000FF">\clubpenalty</font></b>=10000

<i><font color="#9A1900">% Use TeX 3.0's \emergencystretch to help line breaking, but if we're</font></i>
<i><font color="#9A1900">% using an old version of TeX, don't do anything.  We want the amount of</font></i>
<i><font color="#9A1900">% stretch added to depend on the line length, hence the dependence on</font></i>
<i><font color="#9A1900">% \hsize.  We call this whenever the paper size is set.</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def\setemergencystretch</font></b><font color="#009900">{%</font>
<font color="#009900">  \ifx\emergencystretch\thisisundefined</font>
<font color="#009900">    % Allow us to assign to \emergencystretch anyway.</font>
<font color="#009900">    \def\emergencystretch{\dimen0}%</font>
<font color="#009900">  \else</font>
<font color="#009900">    \emergencystretch = .15\hsize</font>
<font color="#009900">  \fi</font>
<font color="#009900">}</font>

<i><font color="#9A1900">% Parameters in order: 1) textheight; 2) textwidth;</font></i>
<i><font color="#9A1900">% 3) voffset; 4) hoffset; 5) binding offset; 6) topskip;</font></i>
<i><font color="#9A1900">% 7) physical page height; 8) physical page width.</font></i>
<i><font color="#9A1900">%</font></i>
<i><font color="#9A1900">% We also call \setleading{\textleading}, so the caller should define</font></i>
<i><font color="#9A1900">% \textleading.  The caller should also set \parskip.</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\def\internalpagesizes</font></b>#1#2#3#4#5#6#7#8<font color="#009900">{%</font>
<font color="#009900">  \voffset = #3\relax</font>
<font color="#009900">  \topskip = #6\relax</font>
<font color="#009900">  \splittopskip = \topskip</font>
<font color="#009900">  %</font>
<font color="#009900">  \vsize = #1\relax</font>
<font color="#009900">  \advance\vsize by \topskip</font>
<font color="#009900">  \outervsize = \vsize</font>
<font color="#009900">  \advance\outervsize by 2\topandbottommargin</font>
<font color="#009900">  \pageheight = \vsize</font>
<font color="#009900">  %</font>
<font color="#009900">  \hsize = #2\relax</font>
<font color="#009900">  \outerhsize = \hsize</font>
<font color="#009900">  \advance\outerhsize by 0.5in</font>
<font color="#009900">  \pagewidth = \hsize</font>
<font color="#009900">  %</font>
<font color="#009900">  \normaloffset = #4\relax</font>
<font color="#009900">  \bindingoffset = #5\relax</font>
<font color="#009900">  %</font>
<font color="#009900">  \ifpdf</font>
<font color="#009900">    \pdfpageheight #7\relax</font>
<font color="#009900">    \pdfpagewidth #8\relax</font>
<font color="#009900">    % if we don't reset these, they will remain at "1 true in" of</font>
<font color="#009900">    % whatever layout pdftex was dumped with.</font>
<font color="#009900">    \pdfhorigin = 1 true in</font>
<font color="#009900">    \pdfvorigin = 1 true in</font>
<font color="#009900">  \fi</font>
<font color="#009900">  %</font>
<font color="#009900">  \setleading{\textleading}</font>
<font color="#009900">  %</font>
<font color="#009900">  \parindent = \defaultparindent</font>
<font color="#009900">  \setemergencystretch</font>
<font color="#009900">}</font>

<i><font color="#9A1900">% @letterpaper (the default).</font></i>
<b><font color="#0000FF">\def\letterpaper</font></b><font color="#009900">{{\globaldefs = 1</font>
<font color="#009900">  \parskip = 3pt plus 2pt minus 1pt</font>
<font color="#009900">  \textleading = 13.2pt</font>
<font color="#009900">  %</font>
<font color="#009900">  % If page is nothing but text, make it come out even.</font>
<font color="#009900">  \internalpagesizes{607.2pt}{6in}% that's 46 lines</font>
<font color="#009900">                    {\voffset}{.25in}%</font>
<font color="#009900">                    {\bindingoffset}{36pt}%</font>
<font color="#009900">                    {11in}{8.5in}%</font>
<font color="#009900">}}</font>

<i><font color="#9A1900">% Use @smallbook to reset parameters for 7x9.25 trim size.</font></i>
<b><font color="#0000FF">\def\smallbook</font></b><font color="#009900">{{\globaldefs = 1</font>
<font color="#009900">  \parskip = 2pt plus 1pt</font>
<font color="#009900">  \textleading = 12pt</font>
<font color="#009900">  %</font>
<font color="#009900">  \internalpagesizes{7.5in}{5in}%</font>
<font color="#009900">                    {-.2in}{0in}%</font>
<font color="#009900">                    {\bindingoffset}{16pt}%</font>
<font color="#009900">                    {9.25in}{7in}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \lispnarrowing = 0.3in</font>
<font color="#009900">  \tolerance = 700</font>
<font color="#009900">  \hfuzz = 1pt</font>
<font color="#009900">  \contentsrightmargin = 0pt</font>
<font color="#009900">  \defbodyindent = .5cm</font>
<font color="#009900">}}</font>

<i><font color="#9A1900">% Use @smallerbook to reset parameters for 6x9 trim size.</font></i>
<i><font color="#9A1900">% (Just testing, parameters still in flux.)</font></i>
<b><font color="#0000FF">\def\smallerbook</font></b><font color="#009900">{{\globaldefs = 1</font>
<font color="#009900">  \parskip = 1.5pt plus 1pt</font>
<font color="#009900">  \textleading = 12pt</font>
<font color="#009900">  %</font>
<font color="#009900">  \internalpagesizes{7.4in}{4.8in}%</font>
<font color="#009900">                    {-.2in}{-.4in}%</font>
<font color="#009900">                    {0pt}{14pt}%</font>
<font color="#009900">                    {9in}{6in}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \lispnarrowing = 0.25in</font>
<font color="#009900">  \tolerance = 700</font>
<font color="#009900">  \hfuzz = 1pt</font>
<font color="#009900">  \contentsrightmargin = 0pt</font>
<font color="#009900">  \defbodyindent = .4cm</font>
<font color="#009900">}}</font>

<i><font color="#9A1900">% Use @afourpaper to print on European A4 paper.</font></i>
<b><font color="#0000FF">\def\afourpaper</font></b><font color="#009900">{{\globaldefs = 1</font>
<font color="#009900">  \parskip = 3pt plus 2pt minus 1pt</font>
<font color="#009900">  \textleading = 13.2pt</font>
<font color="#009900">  %</font>
<font color="#009900">  % Double-side printing via postscript on Laserjet 4050</font>
<font color="#009900">  % prints double-sided nicely when \bindingoffset=10mm and \hoffset=-6mm.</font>
<font color="#009900">  % To change the settings for a different printer or situation, adjust</font>
<font color="#009900">  % \normaloffset until the front-side and back-side texts align.  Then</font>
<font color="#009900">  % do the same for \bindingoffset.  You can set these for testing in</font>
<font color="#009900">  % your texinfo source file like this:</font>
<font color="#009900">  % @tex</font>
<font color="#009900">  % \global\normaloffset = -6mm</font>
<font color="#009900">  % \global\bindingoffset = 10mm</font>
<font color="#009900">  % @end tex</font>
<font color="#009900">  \internalpagesizes{673.2pt}{160mm}% that's 51 lines</font>
<font color="#009900">                    {\voffset}{\hoffset}%</font>
<font color="#009900">                    {\bindingoffset}{44pt}%</font>
<font color="#009900">                    {297mm}{210mm}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \tolerance = 700</font>
<font color="#009900">  \hfuzz = 1pt</font>
<font color="#009900">  \contentsrightmargin = 0pt</font>
<font color="#009900">  \defbodyindent = 5mm</font>
<font color="#009900">}}</font>

<i><font color="#9A1900">% Use @afivepaper to print on European A5 paper.</font></i>
<i><font color="#9A1900">% From romildo@urano.iceb.ufop.br, 2 July 2000.</font></i>
<i><font color="#9A1900">% He also recommends making @example and @lisp be small.</font></i>
<b><font color="#0000FF">\def\afivepaper</font></b><font color="#009900">{{\globaldefs = 1</font>
<font color="#009900">  \parskip = 2pt plus 1pt minus 0.1pt</font>
<font color="#009900">  \textleading = 12.5pt</font>
<font color="#009900">  %</font>
<font color="#009900">  \internalpagesizes{160mm}{120mm}%</font>
<font color="#009900">                    {\voffset}{\hoffset}%</font>
<font color="#009900">                    {\bindingoffset}{8pt}%</font>
<font color="#009900">                    {210mm}{148mm}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \lispnarrowing = 0.2in</font>
<font color="#009900">  \tolerance = 800</font>
<font color="#009900">  \hfuzz = 1.2pt</font>
<font color="#009900">  \contentsrightmargin = 0pt</font>
<font color="#009900">  \defbodyindent = 2mm</font>
<font color="#009900">  \tableindent = 12mm</font>
<font color="#009900">}}</font>

<i><font color="#9A1900">% A specific text layout, 24x15cm overall, intended for A4 paper.</font></i>
<b><font color="#0000FF">\def\afourlatex</font></b><font color="#009900">{{\globaldefs = 1</font>
<font color="#009900">  \afourpaper</font>
<font color="#009900">  \internalpagesizes{237mm}{150mm}%</font>
<font color="#009900">                    {\voffset}{4.6mm}%</font>
<font color="#009900">                    {\bindingoffset}{7mm}%</font>
<font color="#009900">                    {297mm}{210mm}%</font>
<font color="#009900">  %</font>
<font color="#009900">  % Must explicitly reset to 0 because we call \afourpaper.</font>
<font color="#009900">  \globaldefs = 0</font>
<font color="#009900">}}</font>

<i><font color="#9A1900">% Use @afourwide to print on A4 paper in landscape format.</font></i>
<b><font color="#0000FF">\def\afourwide</font></b><font color="#009900">{{\globaldefs = 1</font>
<font color="#009900">  \afourpaper</font>
<font color="#009900">  \internalpagesizes{241mm}{165mm}%</font>
<font color="#009900">                    {\voffset}{-2.95mm}%</font>
<font color="#009900">                    {\bindingoffset}{7mm}%</font>
<font color="#009900">                    {297mm}{210mm}%</font>
<font color="#009900">  \globaldefs = 0</font>
<font color="#009900">}}</font>

<i><font color="#9A1900">% @pagesizes TEXTHEIGHT[,TEXTWIDTH]</font></i>
<i><font color="#9A1900">% Perhaps we should allow setting the margins, \topskip, \parskip,</font></i>
<i><font color="#9A1900">% and/or leading, also. Or perhaps we should compute them somehow.</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\parseargdef\pagesizes</font></b><font color="#009900">{\pagesizesyyy #1,,\finish}</font>
<b><font color="#0000FF">\def\pagesizesyyy</font></b>#1,#2,#3<b><font color="#0000FF">\finish</font></b><font color="#009900">{{%</font>
<font color="#009900">  \setbox0 = \hbox{\ignorespaces #2}\ifdim\wd0 &gt; 0pt \hsize=#2\relax \fi</font>
<font color="#009900">  \globaldefs = 1</font>
<font color="#009900">  %</font>
<font color="#009900">  \parskip = 3pt plus 2pt minus 1pt</font>
<font color="#009900">  \setleading{\textleading}%</font>
<font color="#009900">  %</font>
<font color="#009900">  \dimen0 = #1\relax</font>
<font color="#009900">  \advance\dimen0 by \voffset</font>
<font color="#009900">  %</font>
<font color="#009900">  \dimen2 = \hsize</font>
<font color="#009900">  \advance\dimen2 by \normaloffset</font>
<font color="#009900">  %</font>
<font color="#009900">  \internalpagesizes{#1}{\hsize}%</font>
<font color="#009900">                    {\voffset}{\normaloffset}%</font>
<font color="#009900">                    {\bindingoffset}{44pt}%</font>
<font color="#009900">                    {\dimen0}{\dimen2}%</font>
<font color="#009900">}}</font>

<i><font color="#9A1900">% Set default to letter.</font></i>
<i><font color="#9A1900">%</font></i>
<b><font color="#0000FF">\letterpaper</font></b>


<b><font color="#0000FF">\message</font></b><font color="#009900">{and turning on texinfo input format.}</font>

<b><font color="#0000FF">\def</font></b>^^L<font color="#009900">{\par}</font> <i><font color="#9A1900">% remove \outer, so ^L can appear in an @comment</font></i>

<i><font color="#9A1900">% DEL is a comment character, in case @c does not suffice.</font></i>
<b><font color="#0000FF">\catcode</font></b><font color="#FF0000">`\^^? = 14</font>

<font color="#FF0000">% Define macros to output various characters with catcode for normal text.</font>
<font color="#FF0000">\catcode`\"=\other \def\normaldoublequote{"}</font>
<font color="#FF0000">\catcode`\$=\other \def\normaldollar{$}%$ font-lock fix</font>
<font color="#FF0000">\catcode`\+=\other \def\normalplus{+}</font>
<font color="#FF0000">\catcode`\&lt;=\other \def\normalless{&lt;}</font>
<font color="#FF0000">\catcode`\&gt;=\other \def\normalgreater{&gt;}</font>
<font color="#FF0000">\catcode`\^=\other \def\normalcaret{^}</font>
<font color="#FF0000">\catcode`\_=\other \def\normalunderscore{_}</font>
<font color="#FF0000">\catcode`\|=\other \def\normalverticalbar{|}</font>
<font color="#FF0000">\catcode`\~=\other \def\normaltilde{~}</font>

<font color="#FF0000">% This macro is used to make a character print one way in \tt</font>
<font color="#FF0000">% (where it can probably be output as-is), and another way in other fonts,</font>
<font color="#FF0000">% where something hairier probably needs to be done.</font>
<font color="#FF0000">%</font>
<font color="#FF0000">% #1 is what to print if we are indeed using \tt; #2 is what to print</font>
<font color="#FF0000">% otherwise.  Since all the Computer Modern typewriter fonts have zero</font>
<font color="#FF0000">% interword stretch (and shrink), and it is reasonable to expect all</font>
<font color="#FF0000">% typewriter fonts to have this, we can check that font parameter.</font>
<font color="#FF0000">%</font>
<font color="#FF0000">\def\ifusingtt#1#2{\ifdim \fontdimen3\font=0pt #1\else #2\fi}</font>

<font color="#FF0000">% Same as above, but check for italic font.  Actually this also catches</font>
<font color="#FF0000">% non-italic slanted fonts since it is impossible to distinguish them from</font>
<font color="#FF0000">% italic fonts.  But since this is only used by $ and it uses \sl anyway</font>
<font color="#FF0000">% this is not a problem.</font>
<font color="#FF0000">\def\ifusingit#1#2{\ifdim \fontdimen1\font&gt;0pt #1\else #2\fi}</font>

<font color="#FF0000">% Turn off all special characters except @</font>
<font color="#FF0000">% (and those which the user can use as if they were ordinary).</font>
<font color="#FF0000">% Most of these we simply print from the \tt font, but for some, we can</font>
<font color="#FF0000">% use math or other variants that look better in normal text.</font>

<font color="#FF0000">\catcode`\"=\active</font>
<font color="#FF0000">\def\activedoublequote{{\tt\char34}}</font>
<font color="#FF0000">\let"=\activedoublequote</font>
<font color="#FF0000">\catcode`\~=\active</font>
<font color="#FF0000">\def~{{\tt\char126}}</font>
<font color="#FF0000">\chardef\hat=`\^</font>
<font color="#FF0000">\catcode`\^=\active</font>
<font color="#FF0000">\def^{{\tt \hat}}</font>

<font color="#FF0000">\catcode`\_=\active</font>
<font color="#FF0000">\def_{\ifusingtt\normalunderscore\_}</font>
<font color="#FF0000">\let\realunder=_</font>
<font color="#FF0000">% Subroutine for the previous macro.</font>
<font color="#FF0000">\def\_{\leavevmode \kern.07em \vbox{\hrule width.3em height.1ex}\kern .07em }</font>

<font color="#FF0000">\catcode`\|=\active</font>
<font color="#FF0000">\def|{{\tt\char124}}</font>
<font color="#FF0000">\chardef \less=`\&lt;</font>
<font color="#FF0000">\catcode`\&lt;=\active</font>
<font color="#FF0000">\def&lt;{{\tt \less}}</font>
<font color="#FF0000">\chardef \gtr=`\&gt;</font>
<font color="#FF0000">\catcode`\&gt;=\active</font>
<font color="#FF0000">\def&gt;{{\tt \gtr}}</font>
<font color="#FF0000">\catcode`\+=\active</font>
<font color="#FF0000">\def+{{\tt \char 43}}</font>
<font color="#FF0000">\catcode`\$=\active</font>
<font color="#FF0000">\def${\ifusingit{{\sl\$}}\normaldollar}%$ font-lock fix</font>

<font color="#FF0000">% If a .fmt file is being used, characters that might appear in a file</font>
<font color="#FF0000">% name cannot be active until we have parsed the command line.</font>
<font color="#FF0000">% So turn them off again, and have \everyjob (or @setfilename) turn them on.</font>
<font color="#FF0000">% \otherifyactive is called near the end of this file.</font>
<font color="#FF0000">\def\otherifyactive{\catcode`+=\other \catcode`\_=\other}</font>

<font color="#FF0000">% Used sometimes to turn off (effectively) the active characters even after</font>
<font color="#FF0000">% parsing them.</font>
<font color="#FF0000">\def\turnoffactive{%</font>
<font color="#FF0000">  \normalturnoffactive</font>
<font color="#FF0000">  \otherbackslash</font>
<font color="#FF0000">}</font>

<font color="#FF0000">\catcode`\@=0</font>

<font color="#FF0000">% \backslashcurfont outputs one backslash character in current font,</font>
<font color="#FF0000">% as in \char`\\.</font>
<font color="#FF0000">\global\chardef\backslashcurfont=`\\</font>
<font color="#FF0000">\global\let\rawbackslashxx=\backslashcurfont  % let existing .??s files work</font>

<font color="#FF0000">% \realbackslash is an actual character `\' with catcode other, and</font>
<font color="#FF0000">% \doublebackslash is two of them (for the pdf outlines).</font>
<font color="#FF0000">{\catcode`\\=\other @gdef@realbackslash{\} @gdef@doublebackslash{\\}}</font>

<font color="#FF0000">% In texinfo, backslash is an active character; it prints the backslash</font>
<font color="#FF0000">% in fixed width font.</font>
<font color="#FF0000">\catcode`\\=\active  % @ for escape char from now on.</font>

<font color="#FF0000">% The story here is that in math mode, the \char of \backslashcurfont</font>
<font color="#FF0000">% ends up printing the roman \ from the math symbol font (because \char</font>
<font color="#FF0000">% in math mode uses the \mathcode, and plain.tex sets</font>
<font color="#FF0000">% \mathcode`\\="026E).  It seems better for @backslashchar{} to always</font>
<font color="#FF0000">% print a typewriter backslash, hence we use an explicit \mathchar,</font>
<font color="#FF0000">% which is the decimal equivalent of "715c (class 7, e.g., use \fam;</font>
<font color="#FF0000">% ignored family value; char position "5C).  We can'</font>t use <font color="#FF0000">" for the</font>
<font color="#FF0000">% usual hex value because it has already been made active.</font>
<font color="#FF0000">@def@normalbackslash{{@tt @ifmmode @mathchar29020 @else @backslashcurfont @fi}}</font>
<font color="#FF0000">@let@backslashchar = @normalbackslash % @backslashchar{} is for user documents.</font>

<font color="#FF0000">% On startup, @fixbackslash assigns:</font>
<font color="#FF0000">%  @let \ = @normalbackslash</font>
<font color="#FF0000">% \rawbackslash defines an active \ to do \backslashcurfont.</font>
<font color="#FF0000">% \otherbackslash defines an active \ to be a literal `\' character with</font>
<font color="#FF0000">% catcode other.  We switch back and forth between these.</font>
<font color="#FF0000">@gdef@rawbackslash{@let\=@backslashcurfont}</font>
<font color="#FF0000">@gdef@otherbackslash{@let\=@realbackslash}</font>

<font color="#FF0000">% Same as @turnoffactive except outputs \ as {\tt\char`\\} instead of</font>
<font color="#FF0000">% the literal character `\'.</font>
<font color="#FF0000">%</font>
<font color="#FF0000">@def@normalturnoffactive{%</font>
<font color="#FF0000">  @let"</font>=@normaldoublequote
  @let<font color="#FF6600">$=@normaldollar %$</font> font-lock fix
  @let+=@normalplus
  @let&lt;=@normalless
  @let&gt;=@normalgreater
  @let\=@normalbackslash
  @let^=@normalcaret
  @let_=@normalunderscore
  @let|=@normalverticalbar
  @let<font color="#990000">~</font>=@normaltilde
  @markupsetuplqdefault
  @markupsetuprqdefault
  @unsepspaces
}

<i><font color="#9A1900">% Make _ and + \other characters, temporarily.</font></i>
<i><font color="#9A1900">% This is canceled by @fixbackslash.</font></i>
@otherifyactive

<i><font color="#9A1900">% If a .fmt file is being used, we don't want the `\input texinfo' to show up.</font></i>
<i><font color="#9A1900">% That is what \eatinput is for; after that, the `\' should revert to printing</font></i>
<i><font color="#9A1900">% a backslash.</font></i>
<i><font color="#9A1900">%</font></i>
@gdef@eatinput input texinfo<font color="#009900">{@fixbackslash}</font>
@global@let<font color="#990000">\ </font>= @eatinput

<i><font color="#9A1900">% On the other hand, perhaps the file did not have a `\input texinfo'. Then</font></i>
<i><font color="#9A1900">% the first `\' in the file would cause an error. This macro tries to fix</font></i>
<i><font color="#9A1900">% that, assuming it is called before the first `\' could plausibly occur.</font></i>
<i><font color="#9A1900">% Also turn back on active characters that might appear in the input</font></i>
<i><font color="#9A1900">% file name, in case not using a pre-dumped format.</font></i>
<i><font color="#9A1900">%</font></i>
@gdef@fixbackslash<font color="#009900">{%</font>
<font color="#009900">  @ifx\@eatinput @let\ = @normalbackslash @fi</font>
<font color="#009900">  @catcode`+=@active</font>
<font color="#009900">  @catcode`@_=@active</font>
<font color="#009900">}</font>

<i><font color="#9A1900">% Say @foo, not \foo, in error messages.</font></i>
@escapechar = <font color="#FF0000">`@@</font>

<font color="#FF0000">% These (along with &amp; and #) are made active for url-breaking, so need</font>
<font color="#FF0000">% active definitions as the normal characters.</font>
<font color="#FF0000">@def@normaldot{.}</font>
<font color="#FF0000">@def@normalquest{?}</font>
<font color="#FF0000">@def@normalslash{/}</font>

<font color="#FF0000">% These look ok in all fonts, so just make them not special.</font>
<font color="#FF0000">% @hashchar{} gets its own user-level command, because of #line.</font>
<font color="#FF0000">@catcode`@&amp; = @other @def@normalamp{&amp;}</font>
<font color="#FF0000">@catcode`@# = @other @def@normalhash{#}</font>
<font color="#FF0000">@catcode`@% = @other @def@normalpercent{%}</font>

<font color="#FF0000">@let @hashchar = @normalhash</font>

<font color="#FF0000">@c Finally, make ` and '</font> active, so that txicodequoteundirected and
@c txicodequotebacktick work right in, e.g., @w<font color="#009900">{@code{`foo'}}</font>.  If we
@c don't make <font color="#FF0000">` and '</font> active, @code will not get them as active chars.
@c Do this last of all since we use <font color="#FF0000">` in the previous @catcode assignments.</font>
<font color="#FF0000">@catcode`@'</font>=@active
@catcode<font color="#FF0000">`@`=@active</font>
<font color="#FF0000">@markupsetuplqdefault</font>
<font color="#FF0000">@markupsetuprqdefault</font>

<font color="#FF0000">@c Local variables:</font>
<font color="#FF0000">@c eval: (add-hook '</font>write-file-hooks 'time-stamp)
@c page-delimiter: <font color="#FF0000">"^\\\\message"</font>
@c time-stamp-start: <font color="#FF0000">"def\\\\texinfoversion{"</font>
@c time-stamp-format: <font color="#FF0000">"%:y-%02m-%02d.%02H"</font>
@c time-stamp-end: <font color="#FF0000">"}"</font>
@c End:

@c vim:sw=2:

@ignore
   arch-tag: e1b36e32-c96e-4135-a41a-0b2efa2ea115
@end ignore
</tt></pre>
