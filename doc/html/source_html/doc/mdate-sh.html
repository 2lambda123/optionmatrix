<!-- Generator: GNU source-highlight 3.1.7
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">#!/bin/sh</font></i>
<i><font color="#9A1900"># Get modification time of a file or directory and pretty-print it.</font></i>

<font color="#009900">scriptversion</font><font color="#990000">=</font><font color="#993399">2009</font>-<font color="#993399">04</font>-<font color="#993399">28.21</font><font color="#990000">;</font> <i><font color="#9A1900"># UTC</font></i>

<i><font color="#9A1900"># Copyright (C) 1995, 1996, 1997, 2003, 2004, 2005, 2007, 2009 Free</font></i>
<i><font color="#9A1900"># Software Foundation, Inc.</font></i>
<i><font color="#9A1900"># written by Ulrich Drepper &lt;drepper@gnu.ai.mit.edu&gt;, June 1995</font></i>
<i><font color="#9A1900">#</font></i>
<i><font color="#9A1900"># This program is free software; you can redistribute it and/or modify</font></i>
<i><font color="#9A1900"># it under the terms of the GNU General Public License as published by</font></i>
<i><font color="#9A1900"># the Free Software Foundation; either version 2, or (at your option)</font></i>
<i><font color="#9A1900"># any later version.</font></i>
<i><font color="#9A1900">#</font></i>
<i><font color="#9A1900"># This program is distributed in the hope that it will be useful,</font></i>
<i><font color="#9A1900"># but WITHOUT ANY WARRANTY; without even the implied warranty of</font></i>
<i><font color="#9A1900"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</font></i>
<i><font color="#9A1900"># GNU General Public License for more details.</font></i>
<i><font color="#9A1900">#</font></i>
<i><font color="#9A1900"># You should have received a copy of the GNU General Public License</font></i>
<i><font color="#9A1900"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</font></i>

<i><font color="#9A1900"># As a special exception to the GNU General Public License, if you</font></i>
<i><font color="#9A1900"># distribute this file as part of a program that contains a</font></i>
<i><font color="#9A1900"># configuration script generated by Autoconf, you may include it under</font></i>
<i><font color="#9A1900"># the same distribution terms that you use for the rest of that program.</font></i>

<i><font color="#9A1900"># This file is maintained in Automake, please report</font></i>
<i><font color="#9A1900"># bugs to &lt;bug-automake@gnu.org&gt; or send patches to</font></i>
<i><font color="#9A1900"># &lt;automake-patches@gnu.org&gt;.</font></i>

<b><font color="#0000FF">case</font></b> <font color="#009900">$1</font> <b><font color="#0000FF">in</font></b>
  <font color="#FF0000">''</font><font color="#990000">)</font>
     echo <font color="#FF0000">"$0: No file.  Try </font><font color="#CC33CC">\`</font><font color="#FF0000">$0 --help' for more information."</font> <font color="#993399">1</font><font color="#990000">&gt;&amp;</font><font color="#993399">2</font>
     <b><font color="#0000FF">exit</font></b> <font color="#993399">1</font><font color="#990000">;</font>
     <font color="#990000">;;</font>
  -h <font color="#990000">|</font> --h<font color="#990000">*)</font>
    cat <font color="#990000">&lt;&lt;\</font>EOF
Usage<font color="#990000">:</font> mdate-sh <font color="#990000">[</font>--help<font color="#990000">]</font> <font color="#990000">[</font>--version<font color="#990000">]</font> FILE

Pretty-print the modification time of FILE<font color="#990000">.</font>

Report bugs to <font color="#990000">&lt;</font>bug-automake@gnu<font color="#990000">.</font>org<font color="#990000">&gt;.</font>
EOF
    <b><font color="#0000FF">exit</font></b> <font color="#009900">$?</font>
    <font color="#990000">;;</font>
  -v <font color="#990000">|</font> --v<font color="#990000">*)</font>
    echo <font color="#FF0000">"mdate-sh $scriptversion"</font>
    <b><font color="#0000FF">exit</font></b> <font color="#009900">$?</font>
    <font color="#990000">;;</font>
<b><font color="#0000FF">esac</font></b>

<i><font color="#9A1900"># Prevent date giving response in another language.</font></i>
<font color="#009900">LANG</font><font color="#990000">=</font>C
<b><font color="#0000FF">export</font></b> LANG
<font color="#009900">LC_ALL</font><font color="#990000">=</font>C
<b><font color="#0000FF">export</font></b> LC_ALL
<font color="#009900">LC_TIME</font><font color="#990000">=</font>C
<b><font color="#0000FF">export</font></b> LC_TIME

<i><font color="#9A1900"># GNU ls changes its time format in response to the TIME_STYLE</font></i>
<i><font color="#9A1900"># variable.  Since we cannot assume `unset' works, revert this</font></i>
<i><font color="#9A1900"># variable to its documented default.</font></i>
<b><font color="#0000FF">if</font></b> <b><font color="#0000FF">test</font></b> <font color="#FF0000">"${TIME_STYLE+set}"</font> <font color="#990000">=</font> <b><font color="#0000FF">set</font></b><font color="#990000">;</font> <b><font color="#0000FF">then</font></b>
  <font color="#009900">TIME_STYLE</font><font color="#990000">=</font>posix-long-iso
  <b><font color="#0000FF">export</font></b> TIME_STYLE
<b><font color="#0000FF">fi</font></b>

<font color="#009900">save_arg1</font><font color="#990000">=</font><font color="#009900">$1</font>

<i><font color="#9A1900"># Find out how to get the extended ls output of a file or directory.</font></i>
<b><font color="#0000FF">if</font></b> ls -L /dev/null <font color="#993399">1</font><font color="#990000">&gt;</font>/dev/null <font color="#993399">2</font><font color="#990000">&gt;&amp;</font><font color="#993399">1</font><font color="#990000">;</font> <b><font color="#0000FF">then</font></b>
  <font color="#009900">ls_command</font><font color="#990000">=</font><font color="#FF0000">'ls -L -l -d'</font>
<b><font color="#0000FF">else</font></b>
  <font color="#009900">ls_command</font><font color="#990000">=</font><font color="#FF0000">'ls -l -d'</font>
<b><font color="#0000FF">fi</font></b>
<i><font color="#9A1900"># Avoid user/group names that might have spaces, when possible.</font></i>
<b><font color="#0000FF">if</font></b> ls -n /dev/null <font color="#993399">1</font><font color="#990000">&gt;</font>/dev/null <font color="#993399">2</font><font color="#990000">&gt;&amp;</font><font color="#993399">1</font><font color="#990000">;</font> <b><font color="#0000FF">then</font></b>
  <font color="#009900">ls_command</font><font color="#990000">=</font><font color="#FF0000">"$ls_command -n"</font>
<b><font color="#0000FF">fi</font></b>

<i><font color="#9A1900"># A `ls -l' line looks as follows on OS/2.</font></i>
<i><font color="#9A1900">#  drwxrwx---        0 Aug 11  2001 foo</font></i>
<i><font color="#9A1900"># This differs from Unix, which adds ownership information.</font></i>
<i><font color="#9A1900">#  drwxrwx---   2 root  root      4096 Aug 11  2001 foo</font></i>
<i><font color="#9A1900">#</font></i>
<i><font color="#9A1900"># To find the date, we split the line on spaces and iterate on words</font></i>
<i><font color="#9A1900"># until we find a month.  This cannot work with files whose owner is a</font></i>
<i><font color="#9A1900"># user named `Jan', or `Feb', etc.  However, it's unlikely that `/'</font></i>
<i><font color="#9A1900"># will be owned by a user whose name is a month.  So we first look at</font></i>
<i><font color="#9A1900"># the extended ls output of the root directory to decide how many</font></i>
<i><font color="#9A1900"># words should be skipped to get the date.</font></i>

<i><font color="#9A1900"># On HPUX /bin/sh, "set" interprets "-rw-r--r--" as options, so the "x" below.</font></i>
<b><font color="#0000FF">set</font></b> x`<font color="#009900">$ls_command</font> <font color="#990000">/</font>`

<i><font color="#9A1900"># Find which argument is the month.</font></i>
<font color="#009900">month</font><font color="#990000">=</font>
<b><font color="#0000FF">command</font></b><font color="#990000">=</font>
<b><font color="#0000FF">until</font></b> <b><font color="#0000FF">test</font></b> <font color="#009900">$month</font>
<b><font color="#0000FF">do</font></b>
  <b><font color="#0000FF">shift</font></b>
  <i><font color="#9A1900"># Add another shift to the command.</font></i>
  <b><font color="#0000FF">command</font></b><font color="#990000">=</font><font color="#FF0000">"$command shift;"</font>
  <b><font color="#0000FF">case</font></b> <font color="#009900">$1</font> <b><font color="#0000FF">in</font></b>
    Jan<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>January<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">1</font><font color="#990000">;;</font>
    Feb<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>February<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">2</font><font color="#990000">;;</font>
    Mar<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>March<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">3</font><font color="#990000">;;</font>
    Apr<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>April<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">4</font><font color="#990000">;;</font>
    May<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>May<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">5</font><font color="#990000">;;</font>
    Jun<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>June<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">6</font><font color="#990000">;;</font>
    Jul<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>July<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">7</font><font color="#990000">;;</font>
    Aug<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>August<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">8</font><font color="#990000">;;</font>
    Sep<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>September<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">9</font><font color="#990000">;;</font>
    Oct<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>October<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">10</font><font color="#990000">;;</font>
    Nov<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>November<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">11</font><font color="#990000">;;</font>
    Dec<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>December<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">12</font><font color="#990000">;;</font>
  <b><font color="#0000FF">esac</font></b>
<b><font color="#0000FF">done</font></b>

<i><font color="#9A1900"># Get the extended ls output of the file or directory.</font></i>
<b><font color="#0000FF">set</font></b> dummy x`<b><font color="#0000FF">eval</font></b> <font color="#FF0000">"$ls_command </font><font color="#CC33CC">\"\$</font><font color="#FF0000">save_arg1</font><font color="#CC33CC">\"</font><font color="#FF0000">"</font>`

<i><font color="#9A1900"># Remove all preceding arguments</font></i>
<b><font color="#0000FF">eval</font></b> <font color="#009900">$command</font>

<i><font color="#9A1900"># Because of the dummy argument above, month is in $2.</font></i>
<i><font color="#9A1900">#</font></i>
<i><font color="#9A1900"># On a POSIX system, we should have</font></i>
<i><font color="#9A1900">#</font></i>
<i><font color="#9A1900"># $# = 5</font></i>
<i><font color="#9A1900"># $1 = file size</font></i>
<i><font color="#9A1900"># $2 = month</font></i>
<i><font color="#9A1900"># $3 = day</font></i>
<i><font color="#9A1900"># $4 = year or time</font></i>
<i><font color="#9A1900"># $5 = filename</font></i>
<i><font color="#9A1900">#</font></i>
<i><font color="#9A1900"># On Darwin 7.7.0 and 7.6.0, we have</font></i>
<i><font color="#9A1900">#</font></i>
<i><font color="#9A1900"># $# = 4</font></i>
<i><font color="#9A1900"># $1 = day</font></i>
<i><font color="#9A1900"># $2 = month</font></i>
<i><font color="#9A1900"># $3 = year or time</font></i>
<i><font color="#9A1900"># $4 = filename</font></i>

<i><font color="#9A1900"># Get the month.</font></i>
<b><font color="#0000FF">case</font></b> <font color="#009900">$2</font> <b><font color="#0000FF">in</font></b>
  Jan<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>January<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">1</font><font color="#990000">;;</font>
  Feb<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>February<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">2</font><font color="#990000">;;</font>
  Mar<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>March<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">3</font><font color="#990000">;;</font>
  Apr<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>April<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">4</font><font color="#990000">;;</font>
  May<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>May<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">5</font><font color="#990000">;;</font>
  Jun<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>June<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">6</font><font color="#990000">;;</font>
  Jul<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>July<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">7</font><font color="#990000">;;</font>
  Aug<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>August<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">8</font><font color="#990000">;;</font>
  Sep<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>September<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">9</font><font color="#990000">;;</font>
  Oct<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>October<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">10</font><font color="#990000">;;</font>
  Nov<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>November<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">11</font><font color="#990000">;;</font>
  Dec<font color="#990000">)</font> <font color="#009900">month</font><font color="#990000">=</font>December<font color="#990000">;</font> <font color="#009900">nummonth</font><font color="#990000">=</font><font color="#993399">12</font><font color="#990000">;;</font>
<b><font color="#0000FF">esac</font></b>

<b><font color="#0000FF">case</font></b> <font color="#009900">$3</font> <b><font color="#0000FF">in</font></b>
  <font color="#990000">???*)</font> <font color="#009900">day</font><font color="#990000">=</font><font color="#009900">$1</font><font color="#990000">;;</font>
  <font color="#990000">*)</font> <font color="#009900">day</font><font color="#990000">=</font><font color="#009900">$3</font><font color="#990000">;</font> <b><font color="#0000FF">shift</font></b><font color="#990000">;;</font>
<b><font color="#0000FF">esac</font></b>

<i><font color="#9A1900"># Here we have to deal with the problem that the ls output gives either</font></i>
<i><font color="#9A1900"># the time of day or the year.</font></i>
<b><font color="#0000FF">case</font></b> <font color="#009900">$3</font> <b><font color="#0000FF">in</font></b>
  <font color="#990000">*:*)</font> <b><font color="#0000FF">set</font></b> `date`<font color="#990000">;</font> <b><font color="#0000FF">eval</font></b> <font color="#009900">year</font><font color="#990000">=\</font><font color="#009900">$$</font><i><font color="#9A1900">#</font></i>
       <b><font color="#0000FF">case</font></b> <font color="#009900">$2</font> <b><font color="#0000FF">in</font></b>
	 Jan<font color="#990000">)</font> <font color="#009900">nummonthtod</font><font color="#990000">=</font><font color="#993399">1</font><font color="#990000">;;</font>
	 Feb<font color="#990000">)</font> <font color="#009900">nummonthtod</font><font color="#990000">=</font><font color="#993399">2</font><font color="#990000">;;</font>
	 Mar<font color="#990000">)</font> <font color="#009900">nummonthtod</font><font color="#990000">=</font><font color="#993399">3</font><font color="#990000">;;</font>
	 Apr<font color="#990000">)</font> <font color="#009900">nummonthtod</font><font color="#990000">=</font><font color="#993399">4</font><font color="#990000">;;</font>
	 May<font color="#990000">)</font> <font color="#009900">nummonthtod</font><font color="#990000">=</font><font color="#993399">5</font><font color="#990000">;;</font>
	 Jun<font color="#990000">)</font> <font color="#009900">nummonthtod</font><font color="#990000">=</font><font color="#993399">6</font><font color="#990000">;;</font>
	 Jul<font color="#990000">)</font> <font color="#009900">nummonthtod</font><font color="#990000">=</font><font color="#993399">7</font><font color="#990000">;;</font>
	 Aug<font color="#990000">)</font> <font color="#009900">nummonthtod</font><font color="#990000">=</font><font color="#993399">8</font><font color="#990000">;;</font>
	 Sep<font color="#990000">)</font> <font color="#009900">nummonthtod</font><font color="#990000">=</font><font color="#993399">9</font><font color="#990000">;;</font>
	 Oct<font color="#990000">)</font> <font color="#009900">nummonthtod</font><font color="#990000">=</font><font color="#993399">10</font><font color="#990000">;;</font>
	 Nov<font color="#990000">)</font> <font color="#009900">nummonthtod</font><font color="#990000">=</font><font color="#993399">11</font><font color="#990000">;;</font>
	 Dec<font color="#990000">)</font> <font color="#009900">nummonthtod</font><font color="#990000">=</font><font color="#993399">12</font><font color="#990000">;;</font>
       <b><font color="#0000FF">esac</font></b>
       <i><font color="#9A1900"># For the first six month of the year the time notation can also</font></i>
       <i><font color="#9A1900"># be used for files modified in the last year.</font></i>
       <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>expr <font color="#009900">$nummonth</font> <font color="#990000">\&gt;</font> <font color="#009900">$nummonthtod</font><font color="#990000">)</font> <font color="#990000">&gt;</font> /dev/null<font color="#990000">;</font>
       <b><font color="#0000FF">then</font></b>
	 <font color="#009900">year</font><font color="#990000">=</font>`expr <font color="#009900">$year</font> - <font color="#993399">1</font>`
       <b><font color="#0000FF">fi</font></b><font color="#990000">;;</font>
  <font color="#990000">*)</font> <font color="#009900">year</font><font color="#990000">=</font><font color="#009900">$3</font><font color="#990000">;;</font>
<b><font color="#0000FF">esac</font></b>

<i><font color="#9A1900"># The result.</font></i>
echo <font color="#009900">$day</font> <font color="#009900">$month</font> <font color="#009900">$year</font>

<i><font color="#9A1900"># Local Variables:</font></i>
<i><font color="#9A1900"># mode: shell-script</font></i>
<i><font color="#9A1900"># sh-indentation: 2</font></i>
<i><font color="#9A1900"># eval: (add-hook 'write-file-hooks 'time-stamp)</font></i>
<i><font color="#9A1900"># time-stamp-start: "scriptversion="</font></i>
<i><font color="#9A1900"># time-stamp-format: "%:y-%02m-%02d.%02H"</font></i>
<i><font color="#9A1900"># time-stamp-time-zone: "UTC"</font></i>
<i><font color="#9A1900"># time-stamp-end: "; # UTC"</font></i>
<i><font color="#9A1900"># End:</font></i>
</tt></pre>
