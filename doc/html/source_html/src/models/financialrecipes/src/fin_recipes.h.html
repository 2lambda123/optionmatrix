<!-- Generator: GNU source-highlight 3.1.7
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">// file: fin_recipes.h</font></i>
<i><font color="#9A1900">// author: Bernt Arne Oedegaard</font></i>
<i><font color="#9A1900">//   defines all routines in the financial numerical recipes "book"</font></i>

<b><font color="#000080">#ifndef</font></b> _FIN_RECIPES_H_
<b><font color="#000080">#define</font></b> _FIN_RECIPES_H_

<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;vector&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;cmath&gt;</font>
<b><font color="#0000FF">using</font></b> <b><font color="#0000FF">namespace</font></b> std<font color="#990000">;</font>

<i><font color="#9A1900">///////// present value ////////////////////////////////////</font></i>
<i><font color="#9A1900">// discrete coumpounding</font></i>
<i><font color="#9A1900">/////////////////////////////////</font></i>
<i><font color="#9A1900">// discrete, annual compounding</font></i>

<font color="#009900">double</font> <b><font color="#000000">cash_flow_pv_discrete</font></b> <font color="#990000">(</font> <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cflow_times<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cflow_amounts<font color="#990000">,</font>
			       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">cash_flow_irr_discrete</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cflow_times<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cflow_amounts<font color="#990000">);</font>
<font color="#009900">bool</font> <b><font color="#000000">cash_flow_unique_irr</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cflow_times<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cflow_amounts<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">bonds_price_discrete</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflow_times<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflows<font color="#990000">,</font>
			    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">);</font>  
<font color="#009900">double</font> <b><font color="#000000">bonds_yield_to_maturity_discrete</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> times<font color="#990000">,</font>
					<b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> amounts<font color="#990000">,</font>
					<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> bondprice<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">bonds_duration_discrete</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> times<font color="#990000">,</font> 
			       <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflows<font color="#990000">,</font>
			       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">bonds_duration_macaulay_discrete</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflow_times<font color="#990000">,</font> 
					<b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflows<font color="#990000">,</font>
					<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> bond_price<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">bonds_duration_modified_discrete</font></b> <font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> times<font color="#990000">,</font>
					 <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> amounts<font color="#990000">,</font>
					 <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> bond_price<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">bonds_convexity_discrete</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cflow_times<font color="#990000">,</font> 
				<b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cflow_amounts<font color="#990000">,</font>
				<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">);</font>
<i><font color="#9A1900">/////////////////////////////////</font></i>
<i><font color="#9A1900">// continous compounding. </font></i>
<font color="#009900">double</font> <b><font color="#000000">cash_flow_pv</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cflow_times<font color="#990000">,</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cflow_amounts<font color="#990000">,</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">cash_flow_irr</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cflow_times<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cflow_amounts<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">bonds_price</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflow_times<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflows<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">bonds_price</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> coupon_times<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> coupon_amounts<font color="#990000">,</font>
		   <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> principal_times<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> principal_amounts<font color="#990000">,</font> 
		   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">bonds_duration</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflow_times<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflows<font color="#990000">,</font>
		      <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">bonds_yield_to_maturity</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflow_times<font color="#990000">,</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflow_amounts<font color="#990000">,</font>
			       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> bondprice<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">bonds_duration_macaulay</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflow_times<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflows<font color="#990000">,</font>
			       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> bond_price<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">bonds_convexity</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflow_times<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflow_amounts<font color="#990000">,</font>
		       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> y <font color="#990000">);</font>

<i><font color="#9A1900">/// term structure basics </font></i>

<font color="#009900">double</font> <b><font color="#000000">term_structure_yield_from_discount_factor</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> dfact<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">);</font> 
<font color="#009900">double</font> <b><font color="#000000">term_structure_discount_factor_from_yield</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">term_structure_forward_rate_from_discount_factors</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> d_t1<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> d_t2<font color="#990000">,</font>
							 <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">term_structure_forward_rate_from_yields</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r_t1<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r_t2<font color="#990000">,</font> 
					       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t1<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t2<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">term_structure_yield_linearly_interpolated</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
						  <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> obs_times<font color="#990000">,</font> 
						  <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> obs_yields<font color="#990000">);</font>
<i><font color="#9A1900">// a term structure class</font></i>

<b><font color="#0000FF">class</font></b> <font color="#008080">term_structure_class</font> <font color="#FF0000">{</font>
<b><font color="#0000FF">public</font></b><font color="#990000">:</font>
    <b><font color="#0000FF">virtual</font></b> <font color="#990000">~</font><b><font color="#000000">term_structure_class</font></b><font color="#990000">();</font>
    <b><font color="#0000FF">virtual</font></b> <font color="#009900">double</font> <b><font color="#000000">r</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">)</font> <b><font color="#0000FF">const</font></b><font color="#990000">;</font> <i><font color="#9A1900">// short rate, yield on zero coupon bond</font></i>
    <b><font color="#0000FF">virtual</font></b> <font color="#009900">double</font> <b><font color="#000000">d</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">)</font> <b><font color="#0000FF">const</font></b><font color="#990000">;</font> <i><font color="#9A1900">// discount_factor</font></i>
    <b><font color="#0000FF">virtual</font></b> <font color="#009900">double</font> <b><font color="#000000">f</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t1<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t2<font color="#990000">)</font> <b><font color="#0000FF">const</font></b><font color="#990000">;</font> <i><font color="#9A1900">// forward_rate</font></i>
<font color="#FF0000">}</font><font color="#990000">;</font>

<b><font color="#0000FF">class</font></b> <font color="#008080">term_structure_class_flat</font> <font color="#990000">:</font> <b><font color="#0000FF">public</font></b> term_structure_class <font color="#FF0000">{</font>
<b><font color="#0000FF">private</font></b><font color="#990000">:</font> 
    <font color="#009900">double</font> R_<font color="#990000">;</font>                              <i><font color="#9A1900">// interest rate</font></i>
<b><font color="#0000FF">public</font></b><font color="#990000">:</font>
    <b><font color="#000000">term_structure_class_flat</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">);</font>
    <b><font color="#0000FF">virtual</font></b> <font color="#990000">~</font><b><font color="#000000">term_structure_class_flat</font></b><font color="#990000">();</font>
    <b><font color="#0000FF">virtual</font></b> <font color="#009900">double</font> <b><font color="#000000">r</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">)</font> <b><font color="#0000FF">const</font></b><font color="#990000">;</font>
    <font color="#009900">void</font> <b><font color="#000000">set_int_rate</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">);</font>
<font color="#FF0000">}</font><font color="#990000">;</font>

<b><font color="#0000FF">class</font></b> <font color="#008080">term_structure_class_interpolated</font> <font color="#990000">:</font> <b><font color="#0000FF">public</font></b> term_structure_class <font color="#FF0000">{</font>
<b><font color="#0000FF">private</font></b><font color="#990000">:</font> 
    <font color="#008080">vector&lt;double&gt;</font> times_<font color="#990000">;</font>     <i><font color="#9A1900">// use to keep a list of yields</font></i>
    <font color="#008080">vector&lt;double&gt;</font> yields_<font color="#990000">;</font>
    <font color="#009900">void</font> <b><font color="#000000">clear</font></b><font color="#990000">();</font>
<b><font color="#0000FF">public</font></b><font color="#990000">:</font>
    <b><font color="#000000">term_structure_class_interpolated</font></b><font color="#990000">();</font>
    <b><font color="#000000">term_structure_class_interpolated</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> times<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> yields<font color="#990000">);</font>
    <b><font color="#0000FF">virtual</font></b> <font color="#990000">~</font><b><font color="#000000">term_structure_class_interpolated</font></b><font color="#990000">();</font>
    <b><font color="#000000">term_structure_class_interpolated</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> term_structure_class_interpolated<font color="#990000">&amp;);</font>
    <font color="#008080">term_structure_class_interpolated</font> <b><font color="#0000FF">operator</font></b><font color="#990000">=</font> <font color="#990000">(</font><b><font color="#0000FF">const</font></b> term_structure_class_interpolated<font color="#990000">&amp;);</font>

    <font color="#009900">int</font> <b><font color="#000000">no_observations</font></b><font color="#990000">()</font> <b><font color="#0000FF">const</font></b> <font color="#FF0000">{</font> <b><font color="#0000FF">return</font></b> times_<font color="#990000">.</font><b><font color="#000000">size</font></b><font color="#990000">();</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <b><font color="#0000FF">virtual</font></b> <font color="#009900">double</font> <b><font color="#000000">r</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> T<font color="#990000">)</font> <b><font color="#0000FF">const</font></b><font color="#990000">;</font>
    <font color="#009900">void</font> <b><font color="#000000">set_interpolated_observations</font></b><font color="#990000">(</font>vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> times<font color="#990000">,</font> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> yields<font color="#990000">);</font>
<font color="#FF0000">}</font><font color="#990000">;</font>

<i><font color="#9A1900">// using the term structure classes</font></i>

<font color="#009900">double</font> <b><font color="#000000">bonds_price</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflow_times<font color="#990000">,</font>  
		   <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflows<font color="#990000">,</font>
		   <b><font color="#0000FF">const</font></b> term_structure_class<font color="#990000">&amp;</font> d<font color="#990000">);</font> 

<font color="#009900">double</font> <b><font color="#000000">bonds_duration</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflow_times<font color="#990000">,</font>
		      <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflow_amounts<font color="#990000">,</font>
		      <b><font color="#0000FF">const</font></b> term_structure_class<font color="#990000">&amp;</font> d<font color="#990000">);</font> 

<font color="#009900">double</font> <b><font color="#000000">bonds_convexity</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflow_times<font color="#990000">,</font>
		       <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cashflow_amounts<font color="#990000">,</font>
		       <b><font color="#0000FF">const</font></b> term_structure_class<font color="#990000">&amp;</font> d<font color="#990000">);</font> 

<i><font color="#9A1900">//// Futures pricing</font></i>
<font color="#009900">double</font> <b><font color="#000000">futures_price</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time_to_maturity<font color="#990000">);</font>

<i><font color="#9A1900">/// Binomial option pricing </font></i>

    <i><font color="#9A1900">// one periode binomial </font></i>
<font color="#009900">double</font> <b><font color="#000000">option_price_call_european_binomial_single_period</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
							  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> u<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> d<font color="#990000">);</font>
<i><font color="#9A1900">// multiple periode binomial </font></i>

<font color="#009900">double</font> <b><font color="#000000">option_price_call_european_binomial_multi_period_given_ud</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
								  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> u<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> d<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_periods<font color="#990000">);</font>

<i><font color="#9A1900">// multiple periode binomial </font></i>
<font color="#008080">vector&lt; vector&lt;double&gt; &gt;</font> <b><font color="#000000">binomial_tree</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S0<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> u<font color="#990000">,</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> d<font color="#990000">,</font> 
				       <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_steps<font color="#990000">);</font>

<i><font color="#9A1900">/// Black Scholes formula //////////////////////////////////////////</font></i>

<font color="#009900">double</font> <b><font color="#000000">option_price_call_black_scholes</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
				       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">)</font> <font color="#990000">;</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_put_black_scholes</font></b> <font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
				       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">)</font> <font color="#990000">;</font>

<font color="#009900">double</font> 
<b><font color="#000000">option_price_implied_volatility_call_black_scholes_newton</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>
							   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b>  <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
							   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> option_price<font color="#990000">);</font>
<font color="#009900">double</font> 
<b><font color="#000000">option_price_implied_volatility_put_black_scholes_newton</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>
							  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b>  <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
							  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> option_price<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_implied_volatility_call_black_scholes_bisections</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>
								      <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
								      <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> option_price<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_implied_volatility_put_black_scholes_bisections</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>
								     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
								     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> option_price<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_delta_call_black_scholes</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
					     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_delta_put_black_scholes</font></b> <font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
					     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>
<font color="#009900">void</font> <b><font color="#000000">option_price_partials_call_black_scholes</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
					      <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
					      <font color="#009900">double</font><font color="#990000">&amp;</font> Delta<font color="#990000">,</font> <font color="#009900">double</font><font color="#990000">&amp;</font> Gamma<font color="#990000">,</font> <font color="#009900">double</font><font color="#990000">&amp;</font> Theta<font color="#990000">,</font>
					      <font color="#009900">double</font><font color="#990000">&amp;</font> Vega<font color="#990000">,</font> <font color="#009900">double</font><font color="#990000">&amp;</font> Rho<font color="#990000">);</font>
<font color="#009900">void</font> <b><font color="#000000">option_price_partials_put_black_scholes</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
					     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font>
					     <font color="#009900">double</font><font color="#990000">&amp;</font> Delta<font color="#990000">,</font> <font color="#009900">double</font><font color="#990000">&amp;</font> Gamma<font color="#990000">,</font> <font color="#009900">double</font><font color="#990000">&amp;</font> Theta<font color="#990000">,</font> 
					     <font color="#009900">double</font><font color="#990000">&amp;</font> Vega<font color="#990000">,</font> <font color="#009900">double</font><font color="#990000">&amp;</font> Rho<font color="#990000">);</font>

<i><font color="#9A1900">/// warrant price</font></i>
<font color="#009900">double</font> <b><font color="#000000">warrant_price_adjusted_black_scholes</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>  
					    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> 
					    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
					    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> no_warrants_outstanding<font color="#990000">,</font>
					    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> no_shares_outstanding<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">warrant_price_adjusted_black_scholes</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>  
					    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> q<font color="#990000">,</font> 
					    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
					    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> no_warrants_outstanding<font color="#990000">,</font>
					    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> no_shares_outstanding<font color="#990000">);</font>

<i><font color="#9A1900">/// Extensions of the Black Scholes model //////////////</font></i>

<font color="#009900">double</font> <b><font color="#000000">option_price_european_call_payout</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
					 <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> b<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_european_put_payout</font></b> <font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
					 <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> b<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_european_call_dividends</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
					    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font>
					    <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> dividend_times<font color="#990000">,</font> 
					    <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> dividend_amounts <font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_european_put_dividends</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
					    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font>
					    <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> dividend_times<font color="#990000">,</font> 
					    <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> dividend_amounts<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_american_call_one_dividend</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
					       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>
					       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> tau<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> D1<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> tau1<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">futures_option_price_call_european_black</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> F<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
						<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">futures_option_price_put_european_black</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> F<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
					       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">currency_option_price_call_european</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r_f<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">currency_option_price_put_european</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
					  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r_f<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_american_perpetual_call</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
					    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> q<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_american_perpetual_put</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> q<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">);</font>

<i><font color="#9A1900">// binomial option approximation ////////////////</font></i>

<font color="#009900">double</font> <b><font color="#000000">option_price_call_european_binomial</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> steps<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_put_european_binomial</font></b> <font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> steps<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_call_american_binomial</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> steps<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_put_american_binomial</font></b> <font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> steps<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_call_american_binomial</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> 
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> y<font color="#990000">,</font>
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> steps<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_put_american_binomial</font></b> <font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> y<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> 
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> steps<font color="#990000">);</font>
 
<font color="#009900">double</font> <b><font color="#000000">option_price_call_american_discrete_dividends_binomial</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> 
							       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
							       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font> 
							       <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> steps<font color="#990000">,</font> 
							       <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> dividend_times<font color="#990000">,</font>
							       <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> dividend_amounts<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_put_american_discrete_dividends_binomial</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> 
							     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
							     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font>
							     <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> steps<font color="#990000">,</font> 
							     <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> dividend_times<font color="#990000">,</font> 
							     <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> dividend_amounts<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_call_american_proportional_dividends_binomial</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>
								  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>
								  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_steps<font color="#990000">,</font>
								  <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> dividend_times<font color="#990000">,</font>
								  <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> dividend_yields<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_put_american_proportional_dividends_binomial</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
								  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_steps<font color="#990000">,</font>
								  <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> dividend_times<font color="#990000">,</font>
								  <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> dividend_yields<font color="#990000">);</font> 

<font color="#009900">double</font> <b><font color="#000000">option_price_delta_american_call_binomial</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>  
						 <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_steps<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_delta_american_put_binomial</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>  
						<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_steps<font color="#990000">);</font>
<font color="#009900">void</font> <b><font color="#000000">option_price_partials_american_call_binomial</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>    
						  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_steps<font color="#990000">,</font>
						  <font color="#009900">double</font><font color="#990000">&amp;</font> delta<font color="#990000">,</font> <font color="#009900">double</font><font color="#990000">&amp;</font> gamma<font color="#990000">,</font> <font color="#009900">double</font><font color="#990000">&amp;</font> theta<font color="#990000">,</font>
						  <font color="#009900">double</font><font color="#990000">&amp;</font> vega<font color="#990000">,</font> <font color="#009900">double</font><font color="#990000">&amp;</font> rho<font color="#990000">);</font>  
 
<font color="#009900">void</font> <b><font color="#000000">option_price_partials_american_put_binomial</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>    
						 <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_steps<font color="#990000">,</font>
						 <font color="#009900">double</font><font color="#990000">&amp;</font> delta<font color="#990000">,</font> <font color="#009900">double</font><font color="#990000">&amp;</font> gamma<font color="#990000">,</font> <font color="#009900">double</font><font color="#990000">&amp;</font> theta<font color="#990000">,</font>
						 <font color="#009900">double</font><font color="#990000">&amp;</font> vega<font color="#990000">,</font> <font color="#009900">double</font><font color="#990000">&amp;</font> rho<font color="#990000">);</font>  

<font color="#009900">double</font> <b><font color="#000000">futures_option_price_call_american_binomial</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> F<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>
						   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_steps<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">futures_option_price_put_american_binomial</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> F<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>
						   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_steps<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">currency_option_price_call_american_binomial</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r_f<font color="#990000">,</font> 
						     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> n<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">currency_option_price_put_american_binomial</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r_f<font color="#990000">,</font>
						    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> n<font color="#990000">);</font>

<i><font color="#9A1900">//////////////////// finite differences //////////////////</font></i>

<font color="#009900">double</font> <b><font color="#000000">option_price_call_american_finite_diff_explicit</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font>  r<font color="#990000">,</font>
							<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
							<b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_S_steps<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_t_steps<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_put_american_finite_diff_explicit</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font>  r<font color="#990000">,</font> 
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
						       <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_S_steps<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_t_steps<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_call_european_finite_diff_explicit</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font>  r<font color="#990000">,</font>
							<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
							<b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_S_steps<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_t_steps<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_put_european_finite_diff_explicit</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font>  r<font color="#990000">,</font> 
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
						       <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_S_steps<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_t_steps<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_call_american_finite_diff_implicit</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
							<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
							<b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_S_steps<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_t_steps<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_put_american_finite_diff_implicit</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
						       <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_S_steps<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_t_steps<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_call_european_finite_diff_implicit</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
							<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
							<b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_S_steps<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_t_steps<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_put_european_finite_diff_implicit</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
						       <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_S_steps<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_t_steps<font color="#990000">);</font>

<i><font color="#9A1900">///////////////////////// simulated option prices //////////////////////////////////////</font></i>
<i><font color="#9A1900">// Payoff only function of terminal price</font></i>
<font color="#009900">double</font> <b><font color="#000000">option_price_call_european_simulated</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>
					    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>
					    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time_to_maturity<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_sims<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_put_european_simulated</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time_to_maturity<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_sims<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_delta_call_european_simulated</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>
						  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>
						  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time_to_maturity<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_sims<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_delta_put_european_simulated</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>
						 <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>
						 <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time_to_maturity<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_sims<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">simulate_lognormal_random_variable</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>
					  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>

<font color="#009900">double</font> 
<b><font color="#000000">derivative_price_simulate_european_option_generic</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>
						   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>
						   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font>
						   <font color="#009900">double</font> <b><font color="#000000">payoff</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">),</font>
						   <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_sims<font color="#990000">);</font> 
<font color="#009900">double</font> 
<b><font color="#000000">derivative_price_simulate_european_option_generic_with_control_variate</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>
								       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>
								       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font>
								       <font color="#009900">double</font> <b><font color="#000000">payoff</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font>
										     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">),</font>
								       <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_sims<font color="#990000">);</font> 

<font color="#009900">double</font> 
<b><font color="#000000">derivative_price_simulate_european_option_generic_with_antithetic_variate</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>
									  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
									  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>
									  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font>
									  <font color="#009900">double</font> <b><font color="#000000">payoff</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font>
											<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">),</font>
									  <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_sims<font color="#990000">);</font> 
<i><font color="#9A1900">/////////////////////////////</font></i>
<i><font color="#9A1900">// payoffs of various options, to be used as function arguments in above simulations</font></i>
<font color="#009900">double</font> <b><font color="#000000">payoff_call</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">payoff_put</font></b> <font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">payoff_cash_or_nothing_call</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">payoff_asset_or_nothing_call</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">);</font>
 
<i><font color="#9A1900">/////////// approximated option prices ////////////////////////</font></i>
<font color="#009900">double</font> <b><font color="#000000">option_price_american_put_approximated_johnson</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> X<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time <font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_american_call_approximated_baw</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> 
						   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> b<font color="#990000">,</font> 
						   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">option_price_american_put_approximated_baw</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> 
						  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> b<font color="#990000">,</font> 
						  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_american_put_approximated_geske_johnson</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> X<font color="#990000">,</font>
							     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> 
							     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time <font color="#990000">);</font> 

<font color="#009900">double</font> <b><font color="#000000">option_price_american_call_approximated_bjerksund_stensland</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> 
								    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> X<font color="#990000">,</font> 
								    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
								    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> q<font color="#990000">,</font>
								    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> 
								    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time <font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_american_put_approximated_bjerksund_stensland</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> 
								   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> X<font color="#990000">,</font> 
								   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
								   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> q<font color="#990000">,</font>
								   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> 
								   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> T <font color="#990000">);</font>

<i><font color="#9A1900">////////////// path dependent and other exotic options ////////////////////////////////</font></i>

<font color="#009900">double</font> <b><font color="#000000">option_price_call_bermudan_binomial</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
					    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> q<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
					    <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> potential_exercise_times<font color="#990000">,</font>
					    <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> steps<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_put_bermudan_binomial</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> q<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
					   <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> potential_exercise_times<font color="#990000">,</font>
					   <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> steps<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_european_lookback_call</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> Smin<font color="#990000">,</font>  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> q<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">option_price_european_lookback_put</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> Smin<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
					  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> q<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>


<font color="#009900">double</font> 
<b><font color="#000000">option_price_asian_geometric_average_price_call</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
						<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> q<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>

<font color="#008080">vector&lt;double&gt;</font> <b><font color="#000000">simulate_lognormally_distributed_sequence</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>  
							 <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font>  <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_steps<font color="#990000">);</font>
<font color="#009900">double</font> 
<b><font color="#000000">derivative_price_simulate_european_option_generic</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
						   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font>
						   <font color="#009900">double</font> <b><font color="#000000">payoff</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> S<font color="#990000">,</font>
								 <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">),</font>
						   <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_steps<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_sims<font color="#990000">);</font> 


<font color="#009900">double</font> 
<b><font color="#000000">derivative_price_simulate_european_option_generic_with_control_variate</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>
								       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font>
								       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font>
								       <font color="#009900">double</font> <b><font color="#000000">payoff</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> S<font color="#990000">,</font>
										     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">),</font>
								       <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> nosteps<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> nosims<font color="#990000">);</font> 


<i><font color="#9A1900">/////////////////////////////</font></i>
<i><font color="#9A1900">// payoffs of various options, to be used as function arguments in above simulations</font></i>

<font color="#009900">double</font> <b><font color="#000000">payoff_arithmetric_average_call</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> prices<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">payoff_geometric_average_call</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> prices<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">payoff_lookback_call</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> prices<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> unused_variable<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">payoff_lookback_put</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> prices<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> unused_variable<font color="#990000">);</font>

<i><font color="#9A1900">/////////////////////////////////////</font></i>
<i><font color="#9A1900">// generic binomial trees</font></i>

<font color="#009900">double</font> <b><font color="#000000">option_price_generic_binomial</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> 
				      <font color="#009900">double</font> <b><font color="#000000">generic_payoff</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">),</font>
				      <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> steps<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">payoff_binary_call</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">payoff_binary_put</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">);</font>

<i><font color="#9A1900">////////////////////////////////////////</font></i>
<i><font color="#9A1900">// trinomial trees</font></i>

<font color="#009900">double</font> <b><font color="#000000">option_price_call_american_trinomial</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> q<font color="#990000">,</font>
					     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font>  <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> steps<font color="#990000">)</font> <font color="#990000">;</font> 

<font color="#009900">double</font> <b><font color="#000000">option_price_put_american_trinomial</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> q<font color="#990000">,</font>
					    <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font>  <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> steps<font color="#990000">)</font> <font color="#990000">;</font> 


<i><font color="#9A1900">/////////////////// alternative stochastic processes ////////////////</font></i>

<font color="#009900">double</font> <b><font color="#000000">option_price_call_merton_jump_diffusion</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
						<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time_to_maturity<font color="#990000">,</font>
						<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> lambda<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> kappa<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> delta<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">heston_call_option_price</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> v<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> tau<font color="#990000">,</font>
				<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> rho<font color="#990000">,</font>  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> kappa<font color="#990000">,</font>  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> lambda<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> theta<font color="#990000">,</font>
				<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">);</font>

<i><font color="#9A1900">// fixed income derivatives,  GBM assumption on bond price</font></i>

<font color="#009900">double</font> <b><font color="#000000">bond_option_price_call_zero_black_scholes</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> B<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
						 <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">bond_option_price_put_zero_black_scholes</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> B<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
						<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">bond_option_price_call_coupon_bond_black_scholes</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> B<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
							<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
							<b><font color="#0000FF">const</font></b> <font color="#008080">vector&lt;double&gt;</font> coupon_times<font color="#990000">,</font> 
							<b><font color="#0000FF">const</font></b> <font color="#008080">vector&lt;double&gt;</font> coupon_amounts<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">bond_option_price_put_coupon_bond_black_scholes</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> B<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font> 
						       <b><font color="#0000FF">const</font></b> <font color="#008080">vector&lt;double&gt;</font> coupon_times<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#008080">vector&lt;double&gt;</font> coupon_amounts<font color="#990000">);</font>
<font color="#009900">double</font> <b><font color="#000000">bond_option_price_call_american_binomial</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> B<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
						<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> steps<font color="#990000">);</font> 
<font color="#009900">double</font> <b><font color="#000000">bond_option_price_put_american_binomial</font></b><font color="#990000">(</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> B<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> 
						<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> steps<font color="#990000">);</font> 

<i><font color="#9A1900">////////////////////////////////////////////////////////////////////////////////</font></i>
<i><font color="#9A1900">// term structure models</font></i>
<i><font color="#9A1900">/// formulas for calculation</font></i>

<font color="#009900">double</font> <b><font color="#000000">term_structure_yield_nelson_siegel</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font>
					  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> beta0<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> beta1<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> beta2<font color="#990000">,</font>
					  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> lambda <font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">term_structure_yield_svensson</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font>
				     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> beta0<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> beta1<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> beta2<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> beta3<font color="#990000">,</font>
				     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> tau1<font color="#990000">,</font>  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> tau2 <font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">term_structure_discount_factor_cubic_spline</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font>
						   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> b1<font color="#990000">,</font>
						   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> c1<font color="#990000">,</font>
						   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> d1<font color="#990000">,</font>
						   <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> f<font color="#990000">,</font>
						   <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> knots<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">term_structure_discount_factor_cir</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
					  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> kappa<font color="#990000">,</font>
					  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> lambda<font color="#990000">,</font>
					  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> theta<font color="#990000">,</font>
					  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">term_structure_discount_factor_vasicek</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> time<font color="#990000">,</font>
					      <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
					      <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> a<font color="#990000">,</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> b<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">);</font>

<i><font color="#9A1900">/// defining classes wrapping the above term structure approximations</font></i>
 
<b><font color="#0000FF">class</font></b> <font color="#008080">term_structure_class_nelson_siegel</font> <font color="#990000">:</font> <b><font color="#0000FF">public</font></b> term_structure_class <font color="#FF0000">{</font>
<b><font color="#0000FF">private</font></b><font color="#990000">:</font> 
    <font color="#009900">double</font> beta0_<font color="#990000">,</font> beta1_<font color="#990000">,</font> beta2_<font color="#990000">,</font> lambda_<font color="#990000">;</font>
<b><font color="#0000FF">public</font></b><font color="#990000">:</font>
    <b><font color="#000000">term_structure_class_nelson_siegel</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> beta0<font color="#990000">,</font>  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> beta1<font color="#990000">,</font>
				       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> beta2<font color="#990000">,</font>  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> lambda<font color="#990000">);</font>
    <b><font color="#0000FF">virtual</font></b> <font color="#009900">double</font> <b><font color="#000000">r</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">)</font> <b><font color="#0000FF">const</font></b><font color="#990000">;</font>
<font color="#FF0000">}</font><font color="#990000">;</font>

<b><font color="#0000FF">class</font></b> <font color="#008080">term_structure_class_svensson</font><font color="#990000">:</font><b><font color="#0000FF">public</font></b> term_structure_class <font color="#FF0000">{</font>
<b><font color="#0000FF">private</font></b><font color="#990000">:</font> 
    <font color="#009900">double</font> beta0_<font color="#990000">,</font> beta1_<font color="#990000">,</font> beta2_<font color="#990000">,</font> beta3_<font color="#990000">,</font> tau1_<font color="#990000">,</font> tau2_<font color="#990000">;</font>
<b><font color="#0000FF">public</font></b><font color="#990000">:</font>
    <b><font color="#000000">term_structure_class_svensson</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> beta0<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> beta1<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> beta2<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> beta3<font color="#990000">,</font> 
				  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> tau1<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> tau2<font color="#990000">);</font>
    <b><font color="#0000FF">virtual</font></b> <font color="#009900">double</font> <b><font color="#000000">r</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> T<font color="#990000">)</font> <b><font color="#0000FF">const</font></b><font color="#990000">;</font>
<font color="#FF0000">}</font><font color="#990000">;</font>

<b><font color="#0000FF">class</font></b> <font color="#008080">term_structure_class_cubic_spline</font> <font color="#990000">:</font> <b><font color="#0000FF">public</font></b> term_structure_class <font color="#FF0000">{</font>
<b><font color="#0000FF">private</font></b><font color="#990000">:</font> 
    <font color="#009900">double</font> b_<font color="#990000">;</font> <font color="#009900">double</font> c_<font color="#990000">;</font> <font color="#009900">double</font> d_<font color="#990000">;</font> <font color="#008080">vector&lt;double&gt; f_; vector&lt;double&gt;</font> knots_<font color="#990000">;</font>
<b><font color="#0000FF">public</font></b><font color="#990000">:</font>
    <b><font color="#000000">term_structure_class_cubic_spline</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> b<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> c<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> d<font color="#990000">,</font> 
				      <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> f<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;</font> <font color="#990000">&amp;</font> knots<font color="#990000">);</font>
    <b><font color="#0000FF">virtual</font></b> <font color="#009900">double</font> <b><font color="#000000">d</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">)</font> <b><font color="#0000FF">const</font></b><font color="#990000">;</font> <i><font color="#9A1900">// discount factor</font></i>
<font color="#FF0000">}</font><font color="#990000">;</font>

<b><font color="#0000FF">class</font></b> <font color="#008080">term_structure_class_cir</font> <font color="#990000">:</font> <b><font color="#0000FF">public</font></b> term_structure_class <font color="#FF0000">{</font>
<b><font color="#0000FF">private</font></b><font color="#990000">:</font> 
    <font color="#009900">double</font> r_<font color="#990000">;</font>  <font color="#009900">double</font> kappa_<font color="#990000">;</font>  <font color="#009900">double</font> lambda_<font color="#990000">;</font> <font color="#009900">double</font> theta_<font color="#990000">;</font> <font color="#009900">double</font> sigma_<font color="#990000">;</font>
<b><font color="#0000FF">public</font></b><font color="#990000">:</font>
    <b><font color="#000000">term_structure_class_cir</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> k<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> l<font color="#990000">,</font>
			     <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> th<font color="#990000">,</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">);</font>
    <b><font color="#0000FF">virtual</font></b> <font color="#009900">double</font> <b><font color="#000000">d</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> t<font color="#990000">)</font> <b><font color="#0000FF">const</font></b><font color="#990000">;</font> <i><font color="#9A1900">// discount factor</font></i>
<font color="#FF0000">}</font><font color="#990000">;</font>

<b><font color="#0000FF">class</font></b> <font color="#008080">term_structure_class_vasicek</font> <font color="#990000">:</font> <b><font color="#0000FF">public</font></b> term_structure_class <font color="#FF0000">{</font>
<b><font color="#0000FF">private</font></b><font color="#990000">:</font> 
    <font color="#009900">double</font> r_<font color="#990000">;</font> <font color="#009900">double</font> a_<font color="#990000">;</font> <font color="#009900">double</font> b_<font color="#990000">;</font> <font color="#009900">double</font> sigma_<font color="#990000">;</font>
<b><font color="#0000FF">public</font></b><font color="#990000">:</font>
    <b><font color="#000000">term_structure_class_vasicek</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> a<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> b<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">);</font>
    <b><font color="#0000FF">virtual</font></b> <font color="#009900">double</font> <b><font color="#000000">d</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> T<font color="#990000">)</font> <b><font color="#0000FF">const</font></b><font color="#990000">;</font>
<font color="#FF0000">}</font><font color="#990000">;</font>

<i><font color="#9A1900">/////////////////</font></i>
<i><font color="#9A1900">/// binomial term structure models</font></i>
<i><font color="#9A1900">/// bond option, rendlemann bartter  (binomial)</font></i>

<font color="#009900">double</font> 
<b><font color="#000000">bond_option_price_call_zero_american_rendleman_bartter</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> option_maturity<font color="#990000">,</font>  
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> S<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> M<font color="#990000">,</font> 
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> interest<font color="#990000">,</font> 
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> bond_maturity<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> maturity_payment<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_steps<font color="#990000">);</font>

<font color="#008080">vector&lt; vector&lt;double&gt; &gt;</font> <b><font color="#000000">interest_rate_trees_gbm_build</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r0<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> u<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> d<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> n<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">interest_rate_trees_gbm_value_of_cashflows</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cflow<font color="#990000">,</font>
						  <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;</font> <font color="#990000">&gt;&amp;</font> r_tree<font color="#990000">,</font>
						  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> q<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">interest_rate_trees_gbm_value_of_callable_bond</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> cflows<font color="#990000">,</font>
						      <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;</font> <font color="#990000">&gt;&amp;</font> r_tree<font color="#990000">,</font>
						      <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> q<font color="#990000">,</font>
						      <b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> first_call_time<font color="#990000">,</font>
						      <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> call_price<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">price_european_call_option_on_bond_using_ho_lee</font></b><font color="#990000">(</font>term_structure_class<font color="#990000">*</font> initial<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> delta<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> pi<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> underlying_bond_cflow_times<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> underlying_bond_cflows<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> option_time_to_maturity<font color="#990000">);</font>
<i><font color="#9A1900">///////////////////////////////////////////////</font></i>
<i><font color="#9A1900">// ho and lee modelling</font></i>

<b><font color="#0000FF">class</font></b> <font color="#008080">term_structure_class_ho_lee</font> <font color="#990000">:</font> <b><font color="#0000FF">public</font></b> term_structure_class <font color="#FF0000">{</font>
<b><font color="#0000FF">private</font></b><font color="#990000">:</font> 
    term_structure_class<font color="#990000">*</font> initial_term_<font color="#990000">;</font>
    <font color="#009900">int</font> n_<font color="#990000">;</font>
    <font color="#009900">int</font> i_<font color="#990000">;</font>
    <font color="#009900">double</font> delta_<font color="#990000">;</font>
    <font color="#009900">double</font> pi_<font color="#990000">;</font>
<b><font color="#0000FF">public</font></b><font color="#990000">:</font>
    <b><font color="#000000">term_structure_class_ho_lee</font></b><font color="#990000">(</font>term_structure_class<font color="#990000">*</font> fitted_term<font color="#990000">,</font>
				<b><font color="#0000FF">const</font></b> <font color="#009900">int</font> <font color="#990000">&amp;</font> n<font color="#990000">,</font> 
				<b><font color="#0000FF">const</font></b> <font color="#009900">int</font> <font color="#990000">&amp;</font> i<font color="#990000">,</font> 
				<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> lambda<font color="#990000">,</font> 
				<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> pi<font color="#990000">);</font>
    <font color="#009900">double</font> <b><font color="#000000">d</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> T<font color="#990000">)</font> <b><font color="#0000FF">const</font></b><font color="#990000">;</font>
<font color="#FF0000">}</font><font color="#990000">;</font>

vector<font color="#990000">&lt;</font> vector<font color="#990000">&lt;</font>term_structure_class_ho_lee<font color="#990000">&gt;</font> <font color="#990000">&gt;</font> 
<b><font color="#000000">term_structure_ho_lee_build_term_structure_tree</font></b><font color="#990000">(</font>term_structure_class<font color="#990000">*</font> initial<font color="#990000">,</font>
						<b><font color="#0000FF">const</font></b> <font color="#009900">int</font><font color="#990000">&amp;</font> no_steps<font color="#990000">,</font>
						<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> delta<font color="#990000">,</font>
						<b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> pi<font color="#990000">);</font>

<font color="#009900">double</font> <b><font color="#000000">price_european_call_option_on_bond_using_ho_lee</font></b><font color="#990000">(</font>term_structure_class<font color="#990000">*</font> initial<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> delta<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> pi<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> underlying_bond_cflow_times<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font> underlying_bond_cflows<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> K<font color="#990000">,</font>
						       <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> option_time_to_maturity<font color="#990000">);</font>


<i><font color="#9A1900">/////////////////////////////////</font></i>
<i><font color="#9A1900">// term structure derivatives, analytical solutions</font></i>

<font color="#009900">double</font> <b><font color="#000000">bond_option_price_call_zero_vasicek</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> X<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> option_time_to_maturity<font color="#990000">,</font>
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> bond_time_to_maturity<font color="#990000">,</font>
					   <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> a<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> b<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">);</font>  

<font color="#009900">double</font> <b><font color="#000000">bond_option_price_put_zero_vasicek</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> X<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> r<font color="#990000">,</font>
					  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> option_time_to_maturity<font color="#990000">,</font>
					  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> bond_time_to_maturity<font color="#990000">,</font>
					  <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> a<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> b<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> <font color="#009900">double</font><font color="#990000">&amp;</font> sigma<font color="#990000">);</font>  
<b><font color="#000080">#endif</font></b>
</tt></pre>
