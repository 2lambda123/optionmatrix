<!-- Generator: GNU source-highlight 3.1.7
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">/* optionmatrix:                                                            */</font></i>
<i><font color="#9A1900">/*                                                                          */</font></i>
<i><font color="#9A1900">/* Options &amp; Futures Matrix Modeler                                         */</font></i>
<i><font color="#9A1900">/* View and Control Theoretical Option Chains                               */</font></i>
<i><font color="#9A1900">/*                                                                          */</font></i>
<i><font color="#9A1900">/* File: gtk_cashflow.cpp of optionmatrix                                   */</font></i>
<i><font color="#9A1900">/*                                                                          */</font></i>
<i><font color="#9A1900">/* Copyright (c) Anthony Bradford. 2012.                                    */</font></i>
<i><font color="#9A1900">/* </font></i><u><font color="#0000FF">http://anthonybradford.com</font></u><i><font color="#9A1900">                                               */</font></i>
<i><font color="#9A1900">/* </font></i><u><font color="#0000FF">info@anthonybradford.com</font></u><i><font color="#9A1900">                                                 */</font></i>
<i><font color="#9A1900">/*                                                                          */</font></i>
<i><font color="#9A1900">/* optionmatrix may be freely redistributed.                                */</font></i>
<i><font color="#9A1900">/* See file COPYING included with this distribution for license information */</font></i>

<i><font color="#9A1900">/* </font></i>
<i><font color="#9A1900">   optionmatrix is free software; you can redistribute it and/or modify</font></i>
<i><font color="#9A1900">   it under the terms of the GNU General Public License as published by</font></i>
<i><font color="#9A1900">   the Free Software Foundation; either version 3 of the License, or</font></i>
<i><font color="#9A1900">   (at your option) any later version.</font></i>

<i><font color="#9A1900">   optionmatrix program is distributed in the hope that it will be useful,</font></i>
<i><font color="#9A1900">   but WITHOUT ANY WARRANTY; without even the implied warranty of</font></i>
<i><font color="#9A1900">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</font></i>
<i><font color="#9A1900">   GNU General Public License for more details.</font></i>

<i><font color="#9A1900">   You should have received a copy of the GNU General Public License</font></i>
<i><font color="#9A1900">   along with this program.  If not, see </font></i><u><font color="#0000FF">&lt;http://www.gnu.org/licenses/&gt;</font></u><i><font color="#9A1900">.</font></i>
<i><font color="#9A1900">*/</font></i>

<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;gtk/gtk.h&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;vector&gt;</font>

<b><font color="#000080">#include</font></b> <font color="#FF0000">"gtk_main.h"</font>

<font color="#009900">void</font> <b><font color="#000000">InitPaint</font></b><font color="#990000">(</font><b><font color="#0000FF">struct</font></b> <font color="#008080">_properties</font> <font color="#990000">*</font>properties<font color="#990000">)</font>
<font color="#FF0000">{</font>
  <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"InitPaint():</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

  <font color="#008080">GtkTreeIter</font> iter<font color="#990000">;</font>
  <font color="#009900">char</font> amountText<font color="#990000">[</font><font color="#993399">400</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#009900">char</font> decimalTimeText<font color="#990000">[</font><font color="#993399">400</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#009900">char</font> actualTimeText<font color="#990000">[</font><font color="#993399">400</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>

  <b><font color="#000000">pthread_mutex_lock</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>mutexCashflow<font color="#990000">);</font>

  std<font color="#990000">::</font>vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;::</font><font color="#008080">iterator</font> it<font color="#990000">;</font>
  std<font color="#990000">::</font>vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;::</font><font color="#008080">iterator</font> it2<font color="#990000">;</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_amounts<font color="#990000">-&gt;</font><b><font color="#000000">size</font></b><font color="#990000">()</font> <font color="#990000">!=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times_adjusted<font color="#990000">-&gt;</font><b><font color="#000000">size</font></b><font color="#990000">()</font> <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"InitPaint(): Error: Size mismatch between amounts and times</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">for</font></b><font color="#990000">(</font> it  <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_amounts<font color="#990000">-&gt;</font><b><font color="#000000">begin</font></b><font color="#990000">(),</font>
       it2 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times_adjusted<font color="#990000">-&gt;</font><b><font color="#000000">begin</font></b><font color="#990000">();</font>
       it <font color="#990000">!=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_amounts<font color="#990000">-&gt;</font><b><font color="#000000">end</font></b><font color="#990000">();</font>  
       <font color="#990000">++</font>it<font color="#990000">,</font> it2<font color="#990000">++)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>amountText<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,*</font>it<font color="#990000">);</font>
    <i><font color="#9A1900">//sprintf(decimalTimeText,"%.*f", properties-&gt;precision,*it2);</font></i>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>decimalTimeText<font color="#990000">,</font><font color="#FF0000">"%.15f"</font><font color="#990000">,</font> <font color="#990000">*</font>it2<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>actualTimeText<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font> <b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(*</font>it2<font color="#990000">)</font> <font color="#990000">);</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">3</font> <font color="#990000">||</font>
        option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">5</font> <font color="#990000">||</font>
        option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">6</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">gtk_tree_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>store<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> NULL<font color="#990000">);</font>
      <b><font color="#000000">gtk_tree_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>store<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> amountText<font color="#990000">,</font> X2<font color="#990000">,</font> decimalTimeText<font color="#990000">,</font> X3<font color="#990000">,</font> actualTimeText<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

    <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">4</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">gtk_tree_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>store<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> NULL<font color="#990000">);</font>
      <b><font color="#000000">gtk_tree_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>store<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> decimalTimeText<font color="#990000">,</font> X2<font color="#990000">,</font> actualTimeText<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

    <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
    <font color="#FF0000">{</font>
      <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"on_buttonDividends_clicked(): dividend format not understood</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>
    <font color="#FF0000">}</font>

  <font color="#FF0000">}</font>

  <b><font color="#000000">pthread_mutex_unlock</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>mutexCashflow<font color="#990000">);</font>

  <b><font color="#000000">gtk_tree_view_set_model</font></b><font color="#990000">(</font><b><font color="#000000">GTK_TREE_VIEW</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>treeview2<font color="#990000">),</font> <b><font color="#000000">GTK_TREE_MODEL</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>store<font color="#990000">));</font>
  <b><font color="#000000">gtk_tree_view_expand_all</font></b><font color="#990000">(</font><b><font color="#000000">GTK_TREE_VIEW</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>treeview2<font color="#990000">));</font>

  <b><font color="#0000FF">return</font></b><font color="#990000">;</font>
<font color="#FF0000">}</font>

<font color="#008080">gboolean</font> <b><font color="#000000">ListTimer</font></b><font color="#990000">(</font><b><font color="#0000FF">struct</font></b> <font color="#008080">_properties</font> <font color="#990000">*</font>properties<font color="#990000">)</font>
<font color="#FF0000">{</font>
  <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"ListTimer():</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

  <font color="#008080">GtkTreeIter</font> iter<font color="#990000">;</font>
  <font color="#009900">char</font> amountText<font color="#990000">[</font><font color="#993399">400</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#009900">char</font> decimalTimeText<font color="#990000">[</font><font color="#993399">400</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#009900">char</font> actualTimeText<font color="#990000">[</font><font color="#993399">400</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>

  <font color="#008080">GtkTreeModel</font> <font color="#990000">*</font>model<font color="#990000">;</font>
  model <font color="#990000">=</font> <b><font color="#000000">gtk_tree_view_get_model</font></b><font color="#990000">(</font><b><font color="#000000">GTK_TREE_VIEW</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>treeview2<font color="#990000">));</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">gtk_tree_model_get_iter_from_string</font></b><font color="#990000">(</font>model<font color="#990000">,&amp;</font>iter<font color="#990000">,</font><font color="#FF0000">"0"</font><font color="#990000">)</font> <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <i><font color="#9A1900">//g_print("***********************************************************************************\n");</font></i>

    <b><font color="#000000">pthread_mutex_lock</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>mutexCashflow<font color="#990000">);</font>

    std<font color="#990000">::</font>vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;::</font><font color="#008080">iterator</font> it<font color="#990000">;</font>
    std<font color="#990000">::</font>vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;::</font><font color="#008080">iterator</font> it2<font color="#990000">;</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_amounts<font color="#990000">-&gt;</font><b><font color="#000000">size</font></b><font color="#990000">()</font> <font color="#990000">!=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times_adjusted<font color="#990000">-&gt;</font><b><font color="#000000">size</font></b><font color="#990000">()</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"ListTimer(): Error: Size mismatch between amounts and times</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">for</font></b><font color="#990000">(</font> it  <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_amounts<font color="#990000">-&gt;</font><b><font color="#000000">begin</font></b><font color="#990000">(),</font>
         it2 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times_adjusted<font color="#990000">-&gt;</font><b><font color="#000000">begin</font></b><font color="#990000">();</font>
         it <font color="#990000">!=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_amounts<font color="#990000">-&gt;</font><b><font color="#000000">end</font></b><font color="#990000">();</font>  
         <font color="#990000">++</font>it<font color="#990000">,</font> it2<font color="#990000">++)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>amountText<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,*</font>it<font color="#990000">);</font>
      <i><font color="#9A1900">//sprintf(decimalTimeText,"%.*f", properties-&gt;precision,*it2);</font></i>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>decimalTimeText<font color="#990000">,</font><font color="#FF0000">"%.15f"</font><font color="#990000">,</font> <font color="#990000">*</font>it2<font color="#990000">);</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>actualTimeText<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font> <b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(*</font>it2<font color="#990000">)</font> <font color="#990000">);</font>

      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">3</font> <font color="#990000">||</font>
          option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">5</font> <font color="#990000">||</font>
          option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">6</font>  <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <b><font color="#000000">gtk_tree_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>store<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> amountText<font color="#990000">,</font> X2<font color="#990000">,</font> decimalTimeText<font color="#990000">,</font> X3<font color="#990000">,</font> actualTimeText<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">4</font> <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <b><font color="#000000">gtk_tree_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>store<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> decimalTimeText<font color="#990000">,</font> X2<font color="#990000">,</font> actualTimeText<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
      <font color="#FF0000">{</font>
        <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"on_buttonDividends_clicked(): dividend format not understood</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>
      <font color="#FF0000">}</font>

      <b><font color="#000000">gtk_tree_model_iter_next</font></b><font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>

    <font color="#FF0000">}</font>

    <b><font color="#000000">pthread_mutex_unlock</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>mutexCashflow<font color="#990000">);</font>

    <b><font color="#000000">gtk_tree_view_set_model</font></b><font color="#990000">(</font><b><font color="#000000">GTK_TREE_VIEW</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>treeview2<font color="#990000">),</font> <b><font color="#000000">GTK_TREE_MODEL</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>store<font color="#990000">));</font>
    <b><font color="#000000">gtk_tree_view_expand_all</font></b><font color="#990000">(</font><b><font color="#000000">GTK_TREE_VIEW</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>treeview2<font color="#990000">));</font>
    <i><font color="#9A1900">//g_object_unref(properties-&gt;GtkInfo.store);</font></i>

  <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
  <font color="#FF0000">{</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"No tree model iter</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">return</font></b> <b><font color="#000000">GTK_IS_DIALOG</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>dialog<font color="#990000">);</font>
<font color="#FF0000">}</font>

<font color="#009900">void</font> <b><font color="#000000">AddToVector</font></b><font color="#990000">(</font><b><font color="#0000FF">struct</font></b> <font color="#008080">_properties</font> <font color="#990000">*</font>properties<font color="#990000">)</font>
<font color="#FF0000">{</font>
  <font color="#008080">GtkTreeModel</font> <font color="#990000">*</font>model<font color="#990000">;</font>
  model <font color="#990000">=</font> <b><font color="#000000">gtk_tree_view_get_model</font></b><font color="#990000">(</font><b><font color="#000000">GTK_TREE_VIEW</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>treeview2<font color="#990000">));</font>

  <b><font color="#000000">pthread_mutex_lock</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>mutexCashflow<font color="#990000">);</font>

  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_amounts<font color="#990000">-&gt;</font><b><font color="#000000">erase</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_amounts<font color="#990000">-&gt;</font><b><font color="#000000">begin</font></b><font color="#990000">(),</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_amounts<font color="#990000">-&gt;</font><b><font color="#000000">end</font></b><font color="#990000">()</font> <font color="#990000">);</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times<font color="#990000">-&gt;</font><b><font color="#000000">erase</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times<font color="#990000">-&gt;</font><b><font color="#000000">begin</font></b><font color="#990000">(),</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times<font color="#990000">-&gt;</font><b><font color="#000000">end</font></b><font color="#990000">()</font> <font color="#990000">);</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times_adjusted<font color="#990000">-&gt;</font><b><font color="#000000">erase</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times_adjusted<font color="#990000">-&gt;</font><b><font color="#000000">begin</font></b><font color="#990000">(),</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times_adjusted<font color="#990000">-&gt;</font><b><font color="#000000">end</font></b><font color="#990000">()</font> <font color="#990000">);</font>

  <font color="#008080">GtkTreeIter</font> iter<font color="#990000">;</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">gtk_tree_model_get_iter_from_string</font></b><font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> <font color="#FF0000">"0"</font><font color="#990000">)</font> <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <font color="#008080">gchar</font> <font color="#990000">*</font>timeText<font color="#990000">;</font>
    <font color="#008080">gchar</font> <font color="#990000">*</font>amountsText<font color="#990000">;</font>
    
    <font color="#009900">double</font> amount<font color="#990000">;</font>
    <font color="#009900">double</font> decimalTime<font color="#990000">;</font>

    <b><font color="#0000FF">do</font></b>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">3</font> <font color="#990000">||</font>
          option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">5</font> <font color="#990000">||</font>
          option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">6</font> <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <b><font color="#000000">gtk_tree_model_get</font></b><font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> <font color="#990000">&amp;</font>amountsText<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>
        <b><font color="#000000">gtk_tree_model_get</font></b><font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X2<font color="#990000">,</font> <font color="#990000">&amp;</font>timeText<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">sscanf</font></b><font color="#990000">(</font>amountsText<font color="#990000">,</font><font color="#FF0000">"%lf"</font><font color="#990000">,</font> <font color="#990000">&amp;</font>amount<font color="#990000">)</font> <font color="#990000">!=</font> <font color="#993399">1</font> <font color="#990000">)</font>
          <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"AddToVector(): Error: sscanf does not equal 1 for amountText</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">sscanf</font></b><font color="#990000">(</font>timeText<font color="#990000">,</font><font color="#FF0000">"%lf"</font><font color="#990000">,</font> <font color="#990000">&amp;</font>decimalTime<font color="#990000">)</font> <font color="#990000">!=</font> <font color="#993399">1</font> <font color="#990000">)</font>
          <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"AddToVector(): Error: sscanf does not equal 1 for timeText</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

        <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"amount = %lf, decimalTime = %lf</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> amount<font color="#990000">,</font> decimalTime<font color="#990000">);</font>

        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_amounts<font color="#990000">-&gt;</font><b><font color="#000000">push_back</font></b><font color="#990000">(</font>amount<font color="#990000">);</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times<font color="#990000">-&gt;</font><b><font color="#000000">push_back</font></b><font color="#990000">(</font>decimalTime<font color="#990000">);</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times_adjusted<font color="#990000">-&gt;</font><b><font color="#000000">push_back</font></b><font color="#990000">(</font>decimalTime<font color="#990000">);</font>

        <b><font color="#000000">time</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>starttime4<font color="#990000">);</font>

        <b><font color="#000000">g_free</font></b><font color="#990000">(</font>amountsText<font color="#990000">);</font>
        <b><font color="#000000">g_free</font></b><font color="#990000">(</font>timeText<font color="#990000">);</font>

      <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">4</font> <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <b><font color="#000000">gtk_tree_model_get</font></b><font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> <font color="#990000">&amp;</font>timeText<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">sscanf</font></b><font color="#990000">(</font>timeText<font color="#990000">,</font><font color="#FF0000">"%lf"</font><font color="#990000">,</font> <font color="#990000">&amp;</font>decimalTime<font color="#990000">)</font> <font color="#990000">!=</font> <font color="#993399">1</font> <font color="#990000">)</font>
          <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"on_buttonDividends_clicked(): Error: sscanf does not equal 1 for timeText</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

        <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"decimalTime = %lf</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> decimalTime<font color="#990000">);</font>

        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_amounts<font color="#990000">-&gt;</font><b><font color="#000000">push_back</font></b><font color="#990000">(</font>amount<font color="#990000">);</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times<font color="#990000">-&gt;</font><b><font color="#000000">push_back</font></b><font color="#990000">(</font>decimalTime<font color="#990000">);</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times_adjusted<font color="#990000">-&gt;</font><b><font color="#000000">push_back</font></b><font color="#990000">(</font>decimalTime<font color="#990000">);</font>

        <b><font color="#000000">time</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>starttime4<font color="#990000">);</font>

        <b><font color="#000000">g_free</font></b><font color="#990000">(</font>timeText<font color="#990000">);</font>

      <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
      <font color="#FF0000">{</font>
        <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"on_buttonDividends_clicked(): dividend format not understood</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>
      <font color="#FF0000">}</font>

    <font color="#FF0000">}</font>  <b><font color="#0000FF">while</font></b><font color="#990000">(</font><b><font color="#000000">gtk_tree_model_iter_next</font></b> <font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">));</font>

  <font color="#FF0000">}</font>

  <b><font color="#000000">pthread_mutex_unlock</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>mutexCashflow<font color="#990000">);</font>
<font color="#FF0000">}</font>

<font color="#009900">void</font> <b><font color="#000000">on_buttonDividends_clicked</font></b><font color="#990000">(</font> <font color="#008080">GtkWidget</font> <font color="#990000">*</font>widget<font color="#990000">,</font> <b><font color="#0000FF">struct</font></b> <font color="#008080">_properties</font> <font color="#990000">*</font>properties <font color="#990000">)</font>
<font color="#FF0000">{</font>
  <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"on_buttonDividends_clicked()</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_amounts <font color="#990000">=</font> <font color="#990000">&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>amounts<font color="#990000">;</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times <font color="#990000">=</font> <font color="#990000">&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>times<font color="#990000">;</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times_adjusted <font color="#990000">=</font> <font color="#990000">&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>times_adjusted<font color="#990000">;</font>

  <b><font color="#000000">generic_process_button</font></b><font color="#990000">(</font>properties<font color="#990000">);</font>
<font color="#FF0000">}</font>

<font color="#009900">void</font> <b><font color="#000000">on_buttonCoupons_clicked</font></b><font color="#990000">(</font> <font color="#008080">GtkWidget</font> <font color="#990000">*</font>widget<font color="#990000">,</font> <b><font color="#0000FF">struct</font></b> <font color="#008080">_properties</font> <font color="#990000">*</font>properties <font color="#990000">)</font>
<font color="#FF0000">{</font>
  <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"on_buttonCoupons_clicked()</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_amounts <font color="#990000">=</font> <font color="#990000">&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>coupon<font color="#990000">;</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times <font color="#990000">=</font> <font color="#990000">&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>coupon_times<font color="#990000">;</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times_adjusted <font color="#990000">=</font> <font color="#990000">&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>coupon_times_adjusted<font color="#990000">;</font>

  <b><font color="#000000">generic_process_button</font></b><font color="#990000">(</font>properties<font color="#990000">);</font>
<font color="#FF0000">}</font>

<font color="#009900">void</font> <b><font color="#000000">on_buttonPrincipal_clicked</font></b><font color="#990000">(</font> <font color="#008080">GtkWidget</font> <font color="#990000">*</font>widget<font color="#990000">,</font> <b><font color="#0000FF">struct</font></b> <font color="#008080">_properties</font> <font color="#990000">*</font>properties <font color="#990000">)</font>
<font color="#FF0000">{</font>
  <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"on_buttonPrincipal_clicked()</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_amounts <font color="#990000">=</font> <font color="#990000">&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>principal<font color="#990000">;</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times <font color="#990000">=</font> <font color="#990000">&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>principal_times<font color="#990000">;</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>generic_times_adjusted <font color="#990000">=</font> <font color="#990000">&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>principal_times_adjusted<font color="#990000">;</font>

  <b><font color="#000000">generic_process_button</font></b><font color="#990000">(</font>properties<font color="#990000">);</font>
<font color="#FF0000">}</font>

<font color="#009900">void</font> <b><font color="#000000">generic_process_button</font></b><font color="#990000">(</font><b><font color="#0000FF">struct</font></b> <font color="#008080">_properties</font> <font color="#990000">*</font>properties <font color="#990000">)</font>
<font color="#FF0000">{</font>
  <font color="#008080">GtkWidget</font> <font color="#990000">*</font>scrolled_win<font color="#990000">,</font> <font color="#990000">*</font>vbox<font color="#990000">,</font> <font color="#990000">*</font>hbox<font color="#990000">,</font> <font color="#990000">*</font>add<font color="#990000">,</font> <font color="#990000">*</font>remove<font color="#990000">;</font>
  <font color="#008080">GtkTreeSelection</font> <font color="#990000">*</font>selection<font color="#990000">;</font>
  
  properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>dialog <font color="#990000">=</font> <b><font color="#000000">gtk_dialog_new</font></b><font color="#990000">();</font>

  <b><font color="#000000">gtk_window_set_icon</font></b><font color="#990000">(</font><b><font color="#000000">GTK_WINDOW</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>dialog<font color="#990000">),</font> <b><font color="#000000">create_pixbuf</font></b><font color="#990000">(</font><font color="#FF0000">"images/2.png"</font><font color="#990000">));</font>
  <b><font color="#000000">gtk_window_set_title</font></b><font color="#990000">(</font><b><font color="#000000">GTK_WINDOW</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>dialog<font color="#990000">),</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>dividend<font color="#990000">);</font>
  <b><font color="#000000">gtk_container_set_border_width</font></b><font color="#990000">(</font><b><font color="#000000">GTK_CONTAINER</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>dialog<font color="#990000">),</font> <font color="#993399">10</font><font color="#990000">);</font>

  <i><font color="#9A1900">// width, height</font></i>
  <b><font color="#000000">gtk_widget_set_size_request</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>dialog<font color="#990000">,</font> <font color="#993399">420</font><font color="#990000">,</font> <font color="#993399">300</font><font color="#990000">);</font>
  
  properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>treeview2 <font color="#990000">=</font> <b><font color="#000000">gtk_tree_view_new</font></b><font color="#990000">();</font>  

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">3</font> <font color="#990000">||</font>
      option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">5</font> <font color="#990000">||</font>
      option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">6</font> <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">setup_tree_view3</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>treeview2<font color="#990000">);</font>
    properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>store <font color="#990000">=</font> <b><font color="#000000">gtk_tree_store_new</font></b><font color="#990000">(</font>X4<font color="#990000">,</font> G_TYPE_STRING<font color="#990000">,</font> G_TYPE_STRING<font color="#990000">,</font> G_TYPE_STRING<font color="#990000">);</font>
  <font color="#FF0000">}</font>
  <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">4</font> <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">setup_tree_view4</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>treeview2<font color="#990000">);</font>
    properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>store <font color="#990000">=</font> <b><font color="#000000">gtk_tree_store_new</font></b><font color="#990000">(</font>X3<font color="#990000">,</font> G_TYPE_STRING<font color="#990000">,</font> G_TYPE_STRING<font color="#990000">);</font>
  <font color="#FF0000">}</font>
  
  selection <font color="#990000">=</font> <b><font color="#000000">gtk_tree_view_get_selection</font></b><font color="#990000">(</font><b><font color="#000000">GTK_TREE_VIEW</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>treeview2<font color="#990000">));</font>
  <b><font color="#000000">gtk_tree_selection_set_mode</font></b><font color="#990000">(</font>selection<font color="#990000">,</font> GTK_SELECTION_MULTIPLE<font color="#990000">);</font>
  
  scrolled_win <font color="#990000">=</font> <b><font color="#000000">gtk_scrolled_window_new</font></b> <font color="#990000">(</font>NULL<font color="#990000">,</font> NULL<font color="#990000">);</font>
  <b><font color="#000000">gtk_scrolled_window_set_policy</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SCROLLED_WINDOW</font></b> <font color="#990000">(</font>scrolled_win<font color="#990000">),</font>
                                 GTK_POLICY_AUTOMATIC<font color="#990000">,</font> GTK_POLICY_AUTOMATIC<font color="#990000">);</font>

<b><font color="#000080">#ifdef</font></b> HAVE_LIBGTK_X11_2_0
  <i><font color="#9A1900">// DEPRECATED</font></i>
  add <font color="#990000">=</font> <b><font color="#000000">gtk_button_new_from_stock</font></b><font color="#990000">(</font>GTK_STOCK_ADD<font color="#990000">);</font>
  remove <font color="#990000">=</font> <b><font color="#000000">gtk_button_new_from_stock</font></b><font color="#990000">(</font>GTK_STOCK_REMOVE<font color="#990000">);</font>
<b><font color="#000080">#endif</font></b>
<b><font color="#000080">#ifdef</font></b> HAVE_LIBGTK_3
  add <font color="#990000">=</font> <b><font color="#000000">gtk_button_new_with_label</font></b><font color="#990000">(</font><font color="#FF0000">"Add"</font><font color="#990000">);</font>
  remove <font color="#990000">=</font> <b><font color="#000000">gtk_button_new_with_label</font></b><font color="#990000">(</font><font color="#FF0000">"Remove"</font><font color="#990000">);</font>
<b><font color="#000080">#endif</font></b>
  
  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">3</font> <font color="#990000">||</font>
      option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">5</font> <font color="#990000">||</font>
      option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">6</font> <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">g_signal_connect</font></b><font color="#990000">(</font><b><font color="#000000">G_OBJECT</font></b> <font color="#990000">(</font>add<font color="#990000">),</font> <font color="#FF0000">"clicked"</font><font color="#990000">,</font> <b><font color="#000000">G_CALLBACK</font></b> <font color="#990000">(</font>add_cashflow3<font color="#990000">),</font> properties<font color="#990000">);</font>
  <font color="#FF0000">}</font>
  <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">4</font> <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">g_signal_connect</font></b><font color="#990000">(</font><b><font color="#000000">G_OBJECT</font></b> <font color="#990000">(</font>add<font color="#990000">),</font> <font color="#FF0000">"clicked"</font><font color="#990000">,</font> <b><font color="#000000">G_CALLBACK</font></b> <font color="#990000">(</font>add_cashflow4<font color="#990000">),</font> properties<font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <b><font color="#000000">g_signal_connect</font></b><font color="#990000">(</font><b><font color="#000000">G_OBJECT</font></b> <font color="#990000">(</font>remove<font color="#990000">),</font> <font color="#FF0000">"clicked"</font><font color="#990000">,</font> <b><font color="#000000">G_CALLBACK</font></b> <font color="#990000">(</font>remove_cashflows<font color="#990000">),</font> properties<font color="#990000">);</font>

<b><font color="#000080">#ifdef</font></b> HAVE_LIBGTK_X11_2_0
  <i><font color="#9A1900">// DEPRECATED</font></i>
  hbox <font color="#990000">=</font> <b><font color="#000000">gtk_hbox_new</font></b><font color="#990000">(</font>FALSE<font color="#990000">,</font> <font color="#993399">5</font><font color="#990000">);</font>
<b><font color="#000080">#endif</font></b>
<b><font color="#000080">#ifdef</font></b> HAVE_LIBGTK_3
  hbox <font color="#990000">=</font> <b><font color="#000000">gtk_box_new</font></b><font color="#990000">(</font>GTK_ORIENTATION_HORIZONTAL<font color="#990000">,</font> <font color="#993399">5</font><font color="#990000">);</font>
<b><font color="#000080">#endif</font></b>

  <b><font color="#000000">gtk_box_pack_start</font></b><font color="#990000">(</font><b><font color="#000000">GTK_BOX</font></b> <font color="#990000">(</font>hbox<font color="#990000">),</font> add<font color="#990000">,</font> FALSE<font color="#990000">,</font> TRUE<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">);</font>
  <b><font color="#000000">gtk_box_pack_start</font></b><font color="#990000">(</font><b><font color="#000000">GTK_BOX</font></b> <font color="#990000">(</font>hbox<font color="#990000">),</font> remove<font color="#990000">,</font> FALSE<font color="#990000">,</font> TRUE<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">);</font>

<b><font color="#000080">#ifdef</font></b> HAVE_LIBGTK_X11_2_0
  <i><font color="#9A1900">// DEPRECATED</font></i>
  vbox <font color="#990000">=</font> <b><font color="#000000">gtk_vbox_new</font></b><font color="#990000">(</font>FALSE<font color="#990000">,</font> <font color="#993399">5</font><font color="#990000">);</font>
<b><font color="#000080">#endif</font></b>
<b><font color="#000080">#ifdef</font></b> HAVE_LIBGTK_3
  vbox <font color="#990000">=</font> <b><font color="#000000">gtk_box_new</font></b><font color="#990000">(</font>GTK_ORIENTATION_VERTICAL<font color="#990000">,</font> <font color="#993399">5</font><font color="#990000">);</font>
<b><font color="#000080">#endif</font></b>

  <b><font color="#000000">gtk_box_pack_start</font></b><font color="#990000">(</font><b><font color="#000000">GTK_BOX</font></b> <font color="#990000">(</font>vbox<font color="#990000">),</font> scrolled_win<font color="#990000">,</font> TRUE<font color="#990000">,</font> TRUE<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">);</font>
  <b><font color="#000000">gtk_box_pack_start</font></b><font color="#990000">(</font><b><font color="#000000">GTK_BOX</font></b> <font color="#990000">(</font>vbox<font color="#990000">),</font> hbox<font color="#990000">,</font> FALSE<font color="#990000">,</font> TRUE<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">);</font>

  <b><font color="#000000">gtk_container_add</font></b><font color="#990000">(</font><b><font color="#000000">GTK_CONTAINER</font></b> <font color="#990000">(</font>scrolled_win<font color="#990000">),</font> properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>treeview2<font color="#990000">);</font>
  <b><font color="#000000">gtk_box_pack_start</font></b><font color="#990000">(</font><b><font color="#000000">GTK_BOX</font></b><font color="#990000">(</font> <b><font color="#000000">gtk_dialog_get_content_area</font></b><font color="#990000">(</font><b><font color="#000000">GTK_DIALOG</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>dialog<font color="#990000">))),</font> vbox<font color="#990000">,</font> TRUE<font color="#990000">,</font> TRUE<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">);</font>
  <b><font color="#000000">gtk_widget_show_all</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>dialog<font color="#990000">);</font>

  <b><font color="#000000">InitPaint</font></b><font color="#990000">(</font>properties<font color="#990000">);</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>realTimeBleeding <font color="#990000">)</font>
    properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>gListTimer <font color="#990000">=</font> <b><font color="#000000">g_timeout_add</font></b><font color="#990000">(</font><font color="#993399">1000</font><font color="#990000">,</font> <font color="#990000">(</font>GSourceFunc<font color="#990000">)</font> ListTimer<font color="#990000">,</font> <font color="#990000">(</font>gpointer<font color="#990000">)</font> properties<font color="#990000">);</font>

  <b><font color="#000000">gtk_dialog_run</font></b><font color="#990000">(</font><b><font color="#000000">GTK_DIALOG</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>dialog<font color="#990000">));</font>

  <b><font color="#000000">AddToVector</font></b><font color="#990000">(</font>properties<font color="#990000">);</font>

  <b><font color="#000000">gtk_widget_destroy</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>dialog<font color="#990000">);</font>  

  <b><font color="#000000">gtk_tree_store_clear</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>store<font color="#990000">);</font>
  <b><font color="#000000">g_object_unref</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>store<font color="#990000">);</font>

  <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"on_buttonDividends_clicked(): Fell through</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>realTimeBleeding <font color="#990000">)</font>
    <b><font color="#000000">g_source_remove</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>gListTimer<font color="#990000">);</font>

<font color="#FF0000">}</font>

<font color="#009900">void</font> <b><font color="#000000">add_cashflow3</font></b><font color="#990000">(</font><font color="#008080">GtkButton</font> <font color="#990000">*</font>add<font color="#990000">,</font> <b><font color="#0000FF">struct</font></b> <font color="#008080">_properties</font> <font color="#990000">*</font>properties<font color="#990000">)</font>
<font color="#FF0000">{</font>
  <font color="#008080">GtkWidget</font> <font color="#990000">*</font>dialog<font color="#990000">;</font>
  <font color="#008080">GtkWidget</font> <font color="#990000">*</font>table<font color="#990000">,</font> <font color="#990000">*</font>spin<font color="#990000">,</font> <font color="#990000">*</font>spin2<font color="#990000">;</font>
  <font color="#008080">GtkWidget</font> <font color="#990000">*</font>content_area<font color="#990000">;</font>

  <font color="#008080">GtkTreeIter</font> iter<font color="#990000">;</font>
  <font color="#008080">GtkTreeModel</font> <font color="#990000">*</font>model<font color="#990000">;</font>
  <font color="#009900">double</font> t<font color="#990000">;</font>
  <font color="#009900">int</font> ret<font color="#990000">;</font>

  <font color="#008080">gchar</font> <font color="#990000">*</font>timeText<font color="#990000">;</font>

  <font color="#009900">double</font> amount<font color="#990000">;</font>
  <font color="#009900">double</font> decimalTime<font color="#990000">;</font>

  <font color="#009900">char</font> amountText<font color="#990000">[</font><font color="#993399">400</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#009900">char</font> decimalTimeText<font color="#990000">[</font><font color="#993399">400</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#009900">char</font> actualTimeText<font color="#990000">[</font><font color="#993399">400</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  
<b><font color="#000080">#ifdef</font></b> HAVE_LIBGTK_X11_2_0
  <i><font color="#9A1900">// DEPRECATED</font></i>
  dialog <font color="#990000">=</font> <b><font color="#000000">gtk_dialog_new_with_buttons</font></b><font color="#990000">(</font><font color="#FF0000">"Add"</font><font color="#990000">,</font> NULL<font color="#990000">,</font>
                                       GTK_DIALOG_MODAL<font color="#990000">,</font>
                                       GTK_STOCK_ADD<font color="#990000">,</font> GTK_RESPONSE_OK<font color="#990000">,</font>
                                       GTK_STOCK_CANCEL<font color="#990000">,</font> GTK_RESPONSE_CANCEL<font color="#990000">,</font>
                                       NULL<font color="#990000">);</font>
<b><font color="#000080">#endif</font></b>

<b><font color="#000080">#ifdef</font></b> HAVE_LIBGTK_3
  dialog <font color="#990000">=</font> <b><font color="#000000">gtk_dialog_new_with_buttons</font></b><font color="#990000">(</font><font color="#FF0000">"Add"</font><font color="#990000">,</font> NULL<font color="#990000">,</font>
                                       GTK_DIALOG_MODAL<font color="#990000">,</font>
                                       <font color="#FF0000">"Add"</font><font color="#990000">,</font>
                                       GTK_RESPONSE_OK<font color="#990000">,</font>
                                       <font color="#FF0000">"Cancel"</font><font color="#990000">,</font>
                                       GTK_RESPONSE_CANCEL<font color="#990000">,</font>
                                       NULL<font color="#990000">);</font>
<b><font color="#000080">#endif</font></b>

  content_area <font color="#990000">=</font> <b><font color="#000000">gtk_dialog_get_content_area</font></b> <font color="#990000">(</font><b><font color="#000000">GTK_DIALOG</font></b> <font color="#990000">(</font>dialog<font color="#990000">));</font>

  <b><font color="#000000">gtk_window_set_icon</font></b><font color="#990000">(</font><b><font color="#000000">GTK_WINDOW</font></b><font color="#990000">(</font>dialog<font color="#990000">),</font> <b><font color="#000000">create_pixbuf</font></b><font color="#990000">(</font><font color="#FF0000">"images/2.png"</font><font color="#990000">));</font>

  spin <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_new_with_range</font></b><font color="#990000">(-</font><font color="#993399">1000</font><font color="#990000">,</font> <font color="#993399">1000</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">);</font>
  spin2 <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_new_with_range</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">200</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">);</font>

  <b><font color="#000000">gtk_spin_button_set_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>spin<font color="#990000">),</font> <font color="#993399">0</font><font color="#990000">);</font>

  <b><font color="#000000">gtk_spin_button_set_digits</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>spin<font color="#990000">),</font> <font color="#993399">4</font> <font color="#990000">);</font>
  <b><font color="#000000">gtk_spin_button_set_digits</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>spin2<font color="#990000">),</font> <font color="#993399">4</font> <font color="#990000">);</font>
  
<b><font color="#000080">#ifdef</font></b> HAVE_LIBGTK_X11_2_0
  <i><font color="#9A1900">// DEPRECATED</font></i>
  table <font color="#990000">=</font> <b><font color="#000000">gtk_table_new</font></b><font color="#990000">(</font><font color="#993399">4</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> FALSE<font color="#990000">);</font>
  <b><font color="#000000">gtk_table_set_row_spacings</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_TABLE</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <font color="#993399">5</font> <font color="#990000">);</font>
  <b><font color="#000000">gtk_table_set_col_spacings</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_TABLE</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <font color="#993399">5</font> <font color="#990000">);</font>
  <b><font color="#000000">gtk_container_set_border_width</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_CONTAINER</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <font color="#993399">5</font> <font color="#990000">);</font>

  <b><font color="#000000">gtk_table_attach</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_TABLE</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <b><font color="#000000">gtk_label_new</font></b> <font color="#990000">(</font><font color="#FF0000">"Amount:"</font><font color="#990000">),</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font> 
                   <font color="#990000">(</font>GtkAttachOptions<font color="#990000">)</font> <font color="#990000">(</font>GTK_SHRINK <font color="#990000">|</font> GTK_FILL<font color="#990000">),</font> 
                   <font color="#990000">(</font>GtkAttachOptions<font color="#990000">)</font> <font color="#990000">(</font>GTK_SHRINK <font color="#990000">|</font> GTK_FILL<font color="#990000">),</font> 
                   <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">0</font> <font color="#990000">);</font>

  <b><font color="#000000">gtk_table_attach</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_TABLE</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> spin<font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font>
                   <font color="#990000">(</font>GtkAttachOptions<font color="#990000">)</font> <font color="#990000">(</font>GTK_EXPAND <font color="#990000">|</font> GTK_FILL<font color="#990000">),</font> 
                   <font color="#990000">(</font>GtkAttachOptions<font color="#990000">)</font> <font color="#990000">(</font>GTK_SHRINK <font color="#990000">|</font> GTK_FILL<font color="#990000">),</font> 
                   <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">0</font> <font color="#990000">);</font>

  <b><font color="#000000">gtk_table_attach</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_TABLE</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <b><font color="#000000">gtk_label_new</font></b> <font color="#990000">(</font><font color="#FF0000">"Time:"</font><font color="#990000">),</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">3</font><font color="#990000">,</font> 
                   <font color="#990000">(</font>GtkAttachOptions<font color="#990000">)</font> <font color="#990000">(</font>GTK_SHRINK <font color="#990000">|</font> GTK_FILL<font color="#990000">),</font> 
                   <font color="#990000">(</font>GtkAttachOptions<font color="#990000">)</font> <font color="#990000">(</font>GTK_SHRINK <font color="#990000">|</font> GTK_FILL<font color="#990000">),</font> 
                   <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">0</font> <font color="#990000">);</font>

  <b><font color="#000000">gtk_table_attach</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_TABLE</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> spin2<font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">3</font><font color="#990000">,</font> 
                   <font color="#990000">(</font>GtkAttachOptions<font color="#990000">)</font> <font color="#990000">(</font>GTK_EXPAND <font color="#990000">|</font> GTK_FILL<font color="#990000">),</font> 
                   <font color="#990000">(</font>GtkAttachOptions<font color="#990000">)</font> <font color="#990000">(</font>GTK_SHRINK <font color="#990000">|</font> GTK_FILL<font color="#990000">),</font> 
                   <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">0</font> <font color="#990000">);</font>
<b><font color="#000080">#endif</font></b>
<b><font color="#000080">#ifdef</font></b> HAVE_LIBGTK_3
 
  table <font color="#990000">=</font> <b><font color="#000000">gtk_grid_new</font></b><font color="#990000">();</font>
  <b><font color="#000000">gtk_grid_set_row_spacing</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_GRID</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <font color="#993399">5</font> <font color="#990000">);</font>
  <b><font color="#000000">gtk_grid_set_column_spacing</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_GRID</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <font color="#993399">5</font> <font color="#990000">);</font>

  <b><font color="#000000">gtk_grid_attach</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_GRID</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <b><font color="#000000">gtk_label_new</font></b> <font color="#990000">(</font><font color="#FF0000">"Amount:"</font><font color="#990000">),</font> <font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">1</font> <font color="#990000">);</font>
  <i><font color="#9A1900">// spin for amount</font></i>
  <b><font color="#000000">gtk_grid_attach</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_GRID</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> spin<font color="#990000">,</font> <font color="#993399">5</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">1</font> <font color="#990000">);</font>

  <b><font color="#000000">gtk_grid_attach</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_GRID</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <b><font color="#000000">gtk_label_new</font></b> <font color="#990000">(</font><font color="#FF0000">"Time:"</font><font color="#990000">),</font> <font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">1</font> <font color="#990000">);</font>
  <i><font color="#9A1900">// spin2 for time</font></i>
  <b><font color="#000000">gtk_grid_attach</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_GRID</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> spin2<font color="#990000">,</font> <font color="#993399">5</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">1</font> <font color="#990000">);</font>

<b><font color="#000080">#endif</font></b>

  <b><font color="#000000">gtk_container_add</font></b><font color="#990000">(</font><b><font color="#000000">GTK_CONTAINER</font></b> <font color="#990000">(</font>content_area<font color="#990000">),</font> table<font color="#990000">);</font>  
  <b><font color="#000000">gtk_widget_show_all</font></b><font color="#990000">(</font>dialog<font color="#990000">);</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">gtk_dialog_run</font></b><font color="#990000">(</font><b><font color="#000000">GTK_DIALOG</font></b> <font color="#990000">(</font>dialog<font color="#990000">))</font> <font color="#990000">==</font> GTK_RESPONSE_OK <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    amount <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_SPIN_BUTTON</font></b> <font color="#990000">(</font>spin<font color="#990000">)</font> <font color="#990000">);</font>
    <i><font color="#9A1900">//g_print("amount = %f\n", amount);</font></i>

    t <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b> <font color="#990000">(</font>spin2<font color="#990000">));</font>
    <i><font color="#9A1900">//g_print("t = %f\n", t);</font></i>
    
    model <font color="#990000">=</font> <b><font color="#000000">gtk_tree_view_get_model</font></b><font color="#990000">((</font>GtkTreeView <font color="#990000">*)</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>treeview2<font color="#990000">);</font>
    ret <font color="#990000">=</font> <b><font color="#000000">gtk_tree_model_get_iter_from_string</font></b><font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> <font color="#FF0000">"0"</font><font color="#990000">);</font>
    <i><font color="#9A1900">//g_print("ret = %d\n", ret);</font></i>

    <font color="#008080">gboolean</font> found <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
    <font color="#009900">int</font> counter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> ret <font color="#990000">)</font>
    <b><font color="#0000FF">do</font></b>
    <font color="#FF0000">{</font>
      <b><font color="#000000">gtk_tree_model_get</font></b><font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X2<font color="#990000">,</font> <font color="#990000">&amp;</font>timeText<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>
      
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">sscanf</font></b><font color="#990000">(</font>timeText<font color="#990000">,</font><font color="#FF0000">"%lf"</font><font color="#990000">,</font> <font color="#990000">&amp;</font>decimalTime<font color="#990000">)</font> <font color="#990000">!=</font> <font color="#993399">1</font> <font color="#990000">)</font>
        <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"add_cashflow3(): Error: sscanf does not equal 1</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

      <i><font color="#9A1900">//g_print("double t = %f\n", decimalTime);</font></i>

      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> t <font color="#990000">&gt;</font> decimalTime <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        counter<font color="#990000">++;</font>
      <font color="#FF0000">}</font>
      
      <b><font color="#000000">g_free</font></b><font color="#990000">(</font>timeText<font color="#990000">);</font>

    <font color="#FF0000">}</font> <b><font color="#0000FF">while</font></b><font color="#990000">(</font> <b><font color="#000000">gtk_tree_model_iter_next</font></b> <font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">)</font> <font color="#990000">);</font>

    <i><font color="#9A1900">//g_print("counter = %d\n", counter);</font></i>
    
    <font color="#009900">int</font> counter2 <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

    ret <font color="#990000">=</font> <b><font color="#000000">gtk_tree_model_get_iter_from_string</font></b><font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> <font color="#FF0000">"0"</font><font color="#990000">);</font>
    <i><font color="#9A1900">//g_print("ret = %d\n", ret);</font></i>
    
    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> ret <font color="#990000">)</font>
    <b><font color="#0000FF">do</font></b>
    <font color="#FF0000">{</font>
      <b><font color="#000000">gtk_tree_model_get</font></b><font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X2<font color="#990000">,</font> <font color="#990000">&amp;</font>timeText<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>
      
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">sscanf</font></b><font color="#990000">(</font>timeText<font color="#990000">,</font><font color="#FF0000">"%lf"</font><font color="#990000">,</font> <font color="#990000">&amp;</font>decimalTime<font color="#990000">)</font> <font color="#990000">!=</font> <font color="#993399">1</font> <font color="#990000">)</font>
        <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"add_cashflow3(): Error: sscanf does not equal 1</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

      <i><font color="#9A1900">//g_print("double t = %f\n", decimalTime);</font></i>

      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> t <font color="#990000">&gt;</font> decimalTime <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <i><font color="#9A1900">//g_print("%d - %d\t\t%f &gt; %f\n", counter2, counter, t, decimalTime);</font></i>
        counter2<font color="#990000">++;</font>
        
        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> counter2 <font color="#990000">&gt;=</font> counter <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          found <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
          <b><font color="#000000">g_free</font></b><font color="#990000">(</font>timeText<font color="#990000">);</font>
          <i><font color="#9A1900">//g_print("Insert here\n");</font></i>
          <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
        <font color="#FF0000">}</font>
      <font color="#FF0000">}</font>
      
      <b><font color="#000000">g_free</font></b><font color="#990000">(</font>timeText<font color="#990000">);</font>

    <font color="#FF0000">}</font> <b><font color="#0000FF">while</font></b><font color="#990000">(</font><b><font color="#000000">gtk_tree_model_iter_next</font></b> <font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">));</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>amountText<font color="#990000">,</font><font color="#FF0000">"%f"</font><font color="#990000">,</font> amount<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>decimalTimeText<font color="#990000">,</font><font color="#FF0000">"%.15f"</font><font color="#990000">,</font> t<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>actualTimeText<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font> <b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>t<font color="#990000">)</font> <font color="#990000">);</font>
  
    <i><font color="#9A1900">//g_print("found     = %d\t", found);</font></i>
    <i><font color="#9A1900">//g_print("counter   = %d\t", counter);</font></i>
    <i><font color="#9A1900">//g_print("counter2  = %d\n", counter2);</font></i>
  
    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">!</font>found <font color="#990000">&amp;&amp;</font> <font color="#990000">!</font>counter <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <i><font color="#9A1900">//g_print("set first one\n");</font></i>
      <b><font color="#000000">gtk_tree_store_prepend</font></b><font color="#990000">(</font><b><font color="#000000">GTK_TREE_STORE</font></b><font color="#990000">(</font>model<font color="#990000">),</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> NULL<font color="#990000">);</font>
    <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
    <font color="#FF0000">{</font>
      <b><font color="#000000">gtk_tree_store_insert_after</font></b><font color="#990000">(</font><b><font color="#000000">GTK_TREE_STORE</font></b><font color="#990000">(</font>model<font color="#990000">),</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> NULL<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
    <font color="#FF0000">}</font>
  
    <b><font color="#000000">gtk_tree_store_set</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_TREE_STORE</font></b><font color="#990000">(</font>model<font color="#990000">),</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> amountText<font color="#990000">,</font> X2<font color="#990000">,</font> decimalTimeText<font color="#990000">,</font> X3<font color="#990000">,</font> actualTimeText<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font> <font color="#990000">);</font>

  <font color="#FF0000">}</font>

  <b><font color="#000000">gtk_widget_destroy</font></b><font color="#990000">(</font>dialog<font color="#990000">);</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>realTimeBleeding <font color="#990000">)</font>
    <b><font color="#000000">AddToVector</font></b><font color="#990000">(</font>properties<font color="#990000">);</font>
<font color="#FF0000">}</font>

<font color="#009900">void</font> <b><font color="#000000">add_cashflow4</font></b><font color="#990000">(</font><font color="#008080">GtkButton</font> <font color="#990000">*</font>add<font color="#990000">,</font> <b><font color="#0000FF">struct</font></b> <font color="#008080">_properties</font> <font color="#990000">*</font>properties<font color="#990000">)</font>
<font color="#FF0000">{</font>
  <font color="#008080">GtkWidget</font> <font color="#990000">*</font>dialog<font color="#990000">,</font> <font color="#990000">*</font>table<font color="#990000">,</font> <font color="#990000">*</font>spin2<font color="#990000">;</font>
  <font color="#008080">GtkWidget</font> <font color="#990000">*</font>content_area<font color="#990000">;</font>

  <font color="#008080">GtkTreeIter</font> iter<font color="#990000">;</font>
  <font color="#008080">GtkTreeModel</font> <font color="#990000">*</font>model<font color="#990000">;</font>
  <font color="#009900">double</font> t<font color="#990000">;</font>
  <font color="#009900">int</font> ret<font color="#990000">;</font>

  <font color="#008080">gchar</font> <font color="#990000">*</font>timeText<font color="#990000">;</font>

  <font color="#009900">double</font> decimalTime<font color="#990000">;</font>

  <font color="#009900">char</font> decimalTimeText<font color="#990000">[</font><font color="#993399">400</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#009900">char</font> actualTimeText<font color="#990000">[</font><font color="#993399">400</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>

<b><font color="#000080">#ifdef</font></b> HAVE_LIBGTK_X11_2_0
  <i><font color="#9A1900">// DEPRECATED</font></i>
  dialog <font color="#990000">=</font> <b><font color="#000000">gtk_dialog_new_with_buttons</font></b><font color="#990000">(</font><font color="#FF0000">"Add"</font><font color="#990000">,</font> NULL<font color="#990000">,</font>
                                       GTK_DIALOG_MODAL<font color="#990000">,</font>
                                       GTK_STOCK_ADD<font color="#990000">,</font> GTK_RESPONSE_OK<font color="#990000">,</font>
                                       GTK_STOCK_CANCEL<font color="#990000">,</font> GTK_RESPONSE_CANCEL<font color="#990000">,</font>
                                       NULL<font color="#990000">);</font>
<b><font color="#000080">#endif</font></b>

<b><font color="#000080">#ifdef</font></b> HAVE_LIBGTK_3
  dialog <font color="#990000">=</font> <b><font color="#000000">gtk_dialog_new_with_buttons</font></b><font color="#990000">(</font><font color="#FF0000">"Add"</font><font color="#990000">,</font> NULL<font color="#990000">,</font>
                                       GTK_DIALOG_MODAL<font color="#990000">,</font>
                                       <font color="#FF0000">"Add"</font><font color="#990000">,</font>
                                       GTK_RESPONSE_OK<font color="#990000">,</font>
                                       <font color="#FF0000">"Cancel"</font><font color="#990000">,</font>
                                       GTK_RESPONSE_CANCEL<font color="#990000">,</font>
                                       NULL<font color="#990000">);</font>
<b><font color="#000080">#endif</font></b>

  content_area <font color="#990000">=</font> <b><font color="#000000">gtk_dialog_get_content_area</font></b> <font color="#990000">(</font><b><font color="#000000">GTK_DIALOG</font></b> <font color="#990000">(</font>dialog<font color="#990000">));</font>

  spin2 <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_new_with_range</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">200</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">);</font>
  <b><font color="#000000">gtk_spin_button_set_digits</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_SPIN_BUTTON</font></b> <font color="#990000">(</font>spin2<font color="#990000">),</font> <font color="#993399">4</font> <font color="#990000">);</font>

<b><font color="#000080">#ifdef</font></b> HAVE_LIBGTK_X11_2_0
  <i><font color="#9A1900">// DEPRECATED</font></i>
  table <font color="#990000">=</font> <b><font color="#000000">gtk_table_new</font></b><font color="#990000">(</font><font color="#993399">4</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> FALSE<font color="#990000">);</font>
  <b><font color="#000000">gtk_table_set_row_spacings</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_TABLE</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <font color="#993399">5</font> <font color="#990000">);</font>
  <b><font color="#000000">gtk_table_set_col_spacings</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_TABLE</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <font color="#993399">5</font> <font color="#990000">);</font>
  <b><font color="#000000">gtk_container_set_border_width</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_CONTAINER</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <font color="#993399">5</font> <font color="#990000">);</font>

  <b><font color="#000000">gtk_table_attach</font></b><font color="#990000">(</font><b><font color="#000000">GTK_TABLE</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <b><font color="#000000">gtk_label_new</font></b> <font color="#990000">(</font><font color="#FF0000">"Time:"</font><font color="#990000">),</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">3</font><font color="#990000">,</font> 
                   <font color="#990000">(</font>GtkAttachOptions<font color="#990000">)</font> <font color="#990000">(</font>GTK_SHRINK <font color="#990000">|</font> GTK_FILL<font color="#990000">),</font> 
                   <font color="#990000">(</font>GtkAttachOptions<font color="#990000">)</font> <font color="#990000">(</font>GTK_SHRINK <font color="#990000">|</font> GTK_FILL<font color="#990000">),</font> 
                   <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">);</font>

  <b><font color="#000000">gtk_table_attach</font></b><font color="#990000">(</font><b><font color="#000000">GTK_TABLE</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> spin2<font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">3</font><font color="#990000">,</font> 
                   <font color="#990000">(</font>GtkAttachOptions<font color="#990000">)</font> <font color="#990000">(</font>GTK_EXPAND <font color="#990000">|</font> GTK_FILL<font color="#990000">),</font> 
                   <font color="#990000">(</font>GtkAttachOptions<font color="#990000">)</font> <font color="#990000">(</font>GTK_SHRINK <font color="#990000">|</font> GTK_FILL<font color="#990000">),</font> 
                   <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">);</font>
<b><font color="#000080">#endif</font></b>

<b><font color="#000080">#ifdef</font></b> HAVE_LIBGTK_3

  table <font color="#990000">=</font> <b><font color="#000000">gtk_grid_new</font></b><font color="#990000">();</font>
  <b><font color="#000000">gtk_grid_set_row_spacing</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_GRID</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <font color="#993399">5</font> <font color="#990000">);</font>
  <b><font color="#000000">gtk_grid_set_column_spacing</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_GRID</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <font color="#993399">5</font> <font color="#990000">);</font>
  <b><font color="#000000">gtk_grid_attach</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_GRID</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> <b><font color="#000000">gtk_label_new</font></b> <font color="#990000">(</font><font color="#FF0000">"Time:"</font><font color="#990000">),</font> <font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">1</font> <font color="#990000">);</font>
  <i><font color="#9A1900">// spin2 for time</font></i>
  <b><font color="#000000">gtk_grid_attach</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_GRID</font></b> <font color="#990000">(</font>table<font color="#990000">),</font> spin2<font color="#990000">,</font> <font color="#993399">5</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">1</font> <font color="#990000">);</font>

<b><font color="#000080">#endif</font></b>

  <b><font color="#000000">gtk_container_add</font></b> <font color="#990000">(</font><b><font color="#000000">GTK_CONTAINER</font></b> <font color="#990000">(</font>content_area<font color="#990000">),</font> table<font color="#990000">);</font>  
  <b><font color="#000000">gtk_widget_show_all</font></b><font color="#990000">(</font>dialog<font color="#990000">);</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">gtk_dialog_run</font></b><font color="#990000">(</font><b><font color="#000000">GTK_DIALOG</font></b> <font color="#990000">(</font>dialog<font color="#990000">))</font> <font color="#990000">==</font> GTK_RESPONSE_OK <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    t <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_SPIN_BUTTON</font></b> <font color="#990000">(</font>spin2<font color="#990000">)</font> <font color="#990000">);</font>
    <i><font color="#9A1900">//g_print("t = %f\n", t);</font></i>
    
    model <font color="#990000">=</font> <b><font color="#000000">gtk_tree_view_get_model</font></b><font color="#990000">((</font>GtkTreeView <font color="#990000">*)</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>treeview2<font color="#990000">);</font>
    ret <font color="#990000">=</font> <b><font color="#000000">gtk_tree_model_get_iter_from_string</font></b><font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> <font color="#FF0000">"0"</font><font color="#990000">);</font>
    <i><font color="#9A1900">//g_print("ret = %d\n", ret);</font></i>

    <font color="#008080">gboolean</font> found <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
    <font color="#009900">int</font> counter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> ret <font color="#990000">)</font>
    <b><font color="#0000FF">do</font></b>
    <font color="#FF0000">{</font>
      <b><font color="#000000">gtk_tree_model_get</font></b><font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> <font color="#990000">&amp;</font>timeText<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>
      
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">sscanf</font></b><font color="#990000">(</font>timeText<font color="#990000">,</font><font color="#FF0000">"%lf"</font><font color="#990000">,</font> <font color="#990000">&amp;</font>decimalTime<font color="#990000">)</font> <font color="#990000">!=</font> <font color="#993399">1</font> <font color="#990000">)</font>
        <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"add_cashflow4(): error: sscanf does not equal 1</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

      <i><font color="#9A1900">//g_print("double t = %f\n", decimalTime);</font></i>

      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> t <font color="#990000">&gt;</font> decimalTime <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        counter<font color="#990000">++;</font>
      <font color="#FF0000">}</font>
      
      <b><font color="#000000">g_free</font></b><font color="#990000">(</font>timeText<font color="#990000">);</font>

    <font color="#FF0000">}</font> <b><font color="#0000FF">while</font></b><font color="#990000">(</font><b><font color="#000000">gtk_tree_model_iter_next</font></b> <font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">));</font>

    <i><font color="#9A1900">//g_print("counter = %d\n", counter);</font></i>
    
    <font color="#009900">int</font> counter2 <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

    ret <font color="#990000">=</font> <b><font color="#000000">gtk_tree_model_get_iter_from_string</font></b><font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> <font color="#FF0000">"0"</font><font color="#990000">);</font>
    <i><font color="#9A1900">//g_print("ret = %d\n", ret);</font></i>
    
    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> ret <font color="#990000">)</font>
    <b><font color="#0000FF">do</font></b>
    <font color="#FF0000">{</font>
      <b><font color="#000000">gtk_tree_model_get</font></b><font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> <font color="#990000">&amp;</font>timeText<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>
      
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">sscanf</font></b><font color="#990000">(</font>timeText<font color="#990000">,</font><font color="#FF0000">"%lf"</font><font color="#990000">,</font> <font color="#990000">&amp;</font>decimalTime<font color="#990000">)</font> <font color="#990000">!=</font> <font color="#993399">1</font> <font color="#990000">)</font>
        <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"add_cashflow4(): Error: sscanf does not equal 1</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

      <i><font color="#9A1900">//g_print("double t = %f\n", decimalTime);</font></i>

      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> t <font color="#990000">&gt;</font> decimalTime <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <i><font color="#9A1900">//g_print("%d - %d\t\t%f &gt; %f\n", counter2, counter, t, decimalTime);</font></i>
        counter2<font color="#990000">++;</font>
        
        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> counter2 <font color="#990000">&gt;=</font> counter <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          found <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
          <b><font color="#000000">g_free</font></b><font color="#990000">(</font>timeText<font color="#990000">);</font>
          <i><font color="#9A1900">//g_print("Insert here\n");</font></i>
          <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
        <font color="#FF0000">}</font>
      <font color="#FF0000">}</font>
      
      <b><font color="#000000">g_free</font></b><font color="#990000">(</font>timeText<font color="#990000">);</font>

    <font color="#FF0000">}</font> <b><font color="#0000FF">while</font></b><font color="#990000">(</font><b><font color="#000000">gtk_tree_model_iter_next</font></b> <font color="#990000">(</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">));</font>

    <i><font color="#9A1900">//sprintf(amountText,"%f", amount);</font></i>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>decimalTimeText<font color="#990000">,</font><font color="#FF0000">"%.15f"</font><font color="#990000">,</font> t<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>actualTimeText<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font> <b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>t<font color="#990000">)</font> <font color="#990000">);</font>
  
    <i><font color="#9A1900">//g_print("found     = %d\t", found);</font></i>
    <i><font color="#9A1900">//g_print("counter   = %d\t", counter);</font></i>
    <i><font color="#9A1900">//g_print("counter2  = %d\n", counter2);</font></i>
  
    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">!</font>found <font color="#990000">&amp;&amp;</font> <font color="#990000">!</font>counter <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <i><font color="#9A1900">//g_print("set first one\n");</font></i>
      <b><font color="#000000">gtk_tree_store_prepend</font></b><font color="#990000">(</font><b><font color="#000000">GTK_TREE_STORE</font></b><font color="#990000">(</font>model<font color="#990000">),</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> NULL<font color="#990000">);</font>
    <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
    <font color="#FF0000">{</font>
      <b><font color="#000000">gtk_tree_store_insert_after</font></b><font color="#990000">(</font><b><font color="#000000">GTK_TREE_STORE</font></b><font color="#990000">(</font>model<font color="#990000">),</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> NULL<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
    <font color="#FF0000">}</font>
  
    <b><font color="#000000">gtk_tree_store_set</font></b><font color="#990000">(</font><b><font color="#000000">GTK_TREE_STORE</font></b><font color="#990000">(</font>model<font color="#990000">),</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> decimalTimeText<font color="#990000">,</font> X2<font color="#990000">,</font> actualTimeText<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <b><font color="#000000">gtk_widget_destroy</font></b><font color="#990000">(</font>dialog<font color="#990000">);</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>realTimeBleeding <font color="#990000">)</font>
    <b><font color="#000000">AddToVector</font></b><font color="#990000">(</font>properties<font color="#990000">);</font>
<font color="#FF0000">}</font>

<font color="#009900">void</font> <b><font color="#000000">remove_row</font></b><font color="#990000">(</font><font color="#008080">GtkTreeRowReference</font> <font color="#990000">*</font>ref<font color="#990000">,</font> <b><font color="#0000FF">struct</font></b> <font color="#008080">_properties</font> <font color="#990000">*</font>properties<font color="#990000">)</font>
<font color="#FF0000">{</font>
  <i><font color="#9A1900">//g_print("remove_row()\n");</font></i>

  <font color="#008080">GtkTreeIter</font> iter<font color="#990000">;</font>
  <font color="#008080">GtkTreePath</font> <font color="#990000">*</font>path<font color="#990000">;</font>
  
  path <font color="#990000">=</font> <b><font color="#000000">gtk_tree_row_reference_get_path</font></b><font color="#990000">(</font>ref<font color="#990000">);</font>
  <b><font color="#000000">gtk_tree_model_get_iter</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>model<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> path<font color="#990000">);</font>

  <b><font color="#000000">gtk_tree_store_remove</font></b><font color="#990000">(</font><b><font color="#000000">GTK_TREE_STORE</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>model<font color="#990000">),</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>    

<font color="#FF0000">}</font>

<font color="#009900">void</font> <b><font color="#000000">remove_cashflows</font></b><font color="#990000">(</font><font color="#008080">GtkButton</font> <font color="#990000">*</font>remove<font color="#990000">,</font> <b><font color="#0000FF">struct</font></b> <font color="#008080">_properties</font> <font color="#990000">*</font>properties<font color="#990000">)</font>
<font color="#FF0000">{</font>
  <i><font color="#9A1900">//g_print("remove_cashflows()\n");</font></i>

  <b><font color="#000000">g_source_remove</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>gListTimer<font color="#990000">);</font>

  <font color="#008080">GtkTreeSelection</font> <font color="#990000">*</font>selection<font color="#990000">;</font>
  <font color="#008080">GtkTreeRowReference</font> <font color="#990000">*</font>ref<font color="#990000">;</font>
  <font color="#008080">GList</font> <font color="#990000">*</font>rows<font color="#990000">,</font> <font color="#990000">*</font>ptr<font color="#990000">,</font> <font color="#990000">*</font>references <font color="#990000">=</font> NULL<font color="#990000">;</font>
  
  selection <font color="#990000">=</font> <b><font color="#000000">gtk_tree_view_get_selection</font></b><font color="#990000">((</font>GtkTreeView <font color="#990000">*)</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>treeview2<font color="#990000">);</font>
  properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>model <font color="#990000">=</font> <b><font color="#000000">gtk_tree_view_get_model</font></b><font color="#990000">((</font>GtkTreeView <font color="#990000">*)</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>treeview2<font color="#990000">);</font>
  rows <font color="#990000">=</font> <b><font color="#000000">gtk_tree_selection_get_selected_rows</font></b><font color="#990000">(</font>selection<font color="#990000">,</font> <font color="#990000">&amp;</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>model<font color="#990000">);</font>

  <i><font color="#9A1900">//g_print("remove_cashflows(): rows = %lf\n", rows);</font></i>

  ptr <font color="#990000">=</font> rows<font color="#990000">;</font>
  <b><font color="#0000FF">while</font></b> <font color="#990000">(</font> ptr <font color="#990000">!=</font> NULL <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    ref <font color="#990000">=</font> <b><font color="#000000">gtk_tree_row_reference_new</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>model<font color="#990000">,</font> <font color="#990000">(</font>GtkTreePath<font color="#990000">*)</font> ptr<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
    references <font color="#990000">=</font> <b><font color="#000000">g_list_prepend</font></b><font color="#990000">(</font>references<font color="#990000">,</font> <b><font color="#000000">gtk_tree_row_reference_copy</font></b> <font color="#990000">(</font>ref<font color="#990000">));</font>
    <b><font color="#000000">gtk_tree_row_reference_free</font></b><font color="#990000">(</font>ref<font color="#990000">);</font>
    ptr <font color="#990000">=</font> ptr<font color="#990000">-&gt;</font>next<font color="#990000">;</font>
  <font color="#FF0000">}</font>
  
  <b><font color="#000000">g_list_foreach</font></b><font color="#990000">(</font>references<font color="#990000">,</font> <font color="#990000">(</font>GFunc<font color="#990000">)</font> remove_row<font color="#990000">,</font> properties<font color="#990000">);</font>
  <b><font color="#000000">g_list_foreach</font></b><font color="#990000">(</font>references<font color="#990000">,</font> <font color="#990000">(</font>GFunc<font color="#990000">)</font> gtk_tree_row_reference_free<font color="#990000">,</font> NULL<font color="#990000">);</font>
  <b><font color="#000000">g_list_foreach</font></b><font color="#990000">(</font>rows<font color="#990000">,</font> <font color="#990000">(</font>GFunc<font color="#990000">)</font> gtk_tree_path_free<font color="#990000">,</font> NULL<font color="#990000">);</font>
  <b><font color="#000000">g_list_free</font></b><font color="#990000">(</font>references<font color="#990000">);</font>
  <b><font color="#000000">g_list_free</font></b><font color="#990000">(</font>rows<font color="#990000">);</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>realTimeBleeding <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">AddToVector</font></b><font color="#990000">(</font>properties<font color="#990000">);</font>
    properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>gListTimer <font color="#990000">=</font> <b><font color="#000000">g_timeout_add</font></b><font color="#990000">(</font><font color="#993399">1000</font><font color="#990000">,</font> <font color="#990000">(</font>GSourceFunc<font color="#990000">)</font> ListTimer<font color="#990000">,</font> <font color="#990000">(</font>gpointer<font color="#990000">)</font> properties<font color="#990000">);</font>
  <font color="#FF0000">}</font>

<font color="#FF0000">}</font>

<font color="#009900">void</font> <b><font color="#000000">setup_tree_view3</font></b><font color="#990000">(</font><font color="#008080">GtkWidget</font> <font color="#990000">*</font>treeview<font color="#990000">)</font>
<font color="#FF0000">{</font>
  <font color="#008080">GtkCellRenderer</font> <font color="#990000">*</font>renderer<font color="#990000">;</font>
  <font color="#008080">GtkTreeViewColumn</font> <font color="#990000">*</font>column<font color="#990000">;</font>

  renderer <font color="#990000">=</font> <b><font color="#000000">gtk_cell_renderer_text_new</font></b><font color="#990000">();</font>
  column <font color="#990000">=</font> gtk_tree_view_column_new_with_attributes
                         <font color="#990000">(</font><font color="#FF0000">"Amount"</font><font color="#990000">,</font> renderer<font color="#990000">,</font> <font color="#FF0000">"text"</font><font color="#990000">,</font> X1<font color="#990000">,</font> NULL<font color="#990000">);</font>
  <b><font color="#000000">gtk_tree_view_append_column</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_TREE_VIEW</font></b> <font color="#990000">(</font>treeview<font color="#990000">),</font> column <font color="#990000">);</font>
  
  renderer <font color="#990000">=</font> <b><font color="#000000">gtk_cell_renderer_text_new</font></b><font color="#990000">();</font>
  column <font color="#990000">=</font> gtk_tree_view_column_new_with_attributes
       <font color="#990000">(</font><font color="#FF0000">"Decimal Time"</font><font color="#990000">,</font> renderer<font color="#990000">,</font> <font color="#FF0000">"text"</font><font color="#990000">,</font> X2<font color="#990000">,</font> NULL<font color="#990000">);</font>
  <b><font color="#000000">gtk_tree_view_append_column</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_TREE_VIEW</font></b> <font color="#990000">(</font>treeview<font color="#990000">),</font> column <font color="#990000">);</font>
  
  renderer <font color="#990000">=</font> <b><font color="#000000">gtk_cell_renderer_text_new</font></b><font color="#990000">();</font>
  column <font color="#990000">=</font> gtk_tree_view_column_new_with_attributes
                         <font color="#990000">(</font><font color="#FF0000">"Actual Date"</font><font color="#990000">,</font> renderer<font color="#990000">,</font> <font color="#FF0000">"text"</font><font color="#990000">,</font> X3<font color="#990000">,</font> NULL<font color="#990000">);</font>
  <b><font color="#000000">gtk_tree_view_append_column</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_TREE_VIEW</font></b> <font color="#990000">(</font>treeview<font color="#990000">),</font> column <font color="#990000">);</font>

<font color="#FF0000">}</font>

<font color="#009900">void</font> <b><font color="#000000">setup_tree_view4</font></b><font color="#990000">(</font><font color="#008080">GtkWidget</font> <font color="#990000">*</font>treeview<font color="#990000">)</font>
<font color="#FF0000">{</font>
  <font color="#008080">GtkCellRenderer</font> <font color="#990000">*</font>renderer<font color="#990000">;</font>
  <font color="#008080">GtkTreeViewColumn</font> <font color="#990000">*</font>column<font color="#990000">;</font>

  renderer <font color="#990000">=</font> <b><font color="#000000">gtk_cell_renderer_text_new</font></b><font color="#990000">();</font>
  column <font color="#990000">=</font> gtk_tree_view_column_new_with_attributes
       <font color="#990000">(</font><font color="#FF0000">"Decimal Time"</font><font color="#990000">,</font> renderer<font color="#990000">,</font> <font color="#FF0000">"text"</font><font color="#990000">,</font> X1<font color="#990000">,</font> NULL<font color="#990000">);</font>
  <b><font color="#000000">gtk_tree_view_append_column</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_TREE_VIEW</font></b> <font color="#990000">(</font>treeview<font color="#990000">),</font> column <font color="#990000">);</font>
  
  renderer <font color="#990000">=</font> <b><font color="#000000">gtk_cell_renderer_text_new</font></b><font color="#990000">();</font>
  column <font color="#990000">=</font> gtk_tree_view_column_new_with_attributes
                         <font color="#990000">(</font><font color="#FF0000">"Actual Date"</font><font color="#990000">,</font> renderer<font color="#990000">,</font> <font color="#FF0000">"text"</font><font color="#990000">,</font> X2<font color="#990000">,</font> NULL<font color="#990000">);</font>
  <b><font color="#000000">gtk_tree_view_append_column</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_TREE_VIEW</font></b> <font color="#990000">(</font>treeview<font color="#990000">),</font> column <font color="#990000">);</font>

<font color="#FF0000">}</font>
</tt></pre>
