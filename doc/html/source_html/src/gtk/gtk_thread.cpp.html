<!-- Generator: GNU source-highlight 3.1.7
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">/* optionmatrix:                                                            */</font></i>
<i><font color="#9A1900">/*                                                                          */</font></i>
<i><font color="#9A1900">/* Options &amp; Futures Matrix Modeler                                         */</font></i>
<i><font color="#9A1900">/* View and Control Theoretical Option Chains                               */</font></i>
<i><font color="#9A1900">/*                                                                          */</font></i>
<i><font color="#9A1900">/* File: gtk_thread.cpp of optionmatrix                                     */</font></i>
<i><font color="#9A1900">/*                                                                          */</font></i>
<i><font color="#9A1900">/* Copyright (c) Anthony Bradford. 2012.                                    */</font></i>
<i><font color="#9A1900">/* </font></i><u><font color="#0000FF">http://anthonybradford.com</font></u><i><font color="#9A1900">                                               */</font></i>
<i><font color="#9A1900">/* </font></i><u><font color="#0000FF">info@anthonybradford.com</font></u><i><font color="#9A1900">                                                 */</font></i>
<i><font color="#9A1900">/*                                                                          */</font></i>
<i><font color="#9A1900">/* optionmatrix may be freely redistributed.                                */</font></i>
<i><font color="#9A1900">/* See file COPYING included with this distribution for license information */</font></i>

<i><font color="#9A1900">/* </font></i>
<i><font color="#9A1900">   optionmatrix is free software; you can redistribute it and/or modify</font></i>
<i><font color="#9A1900">   it under the terms of the GNU General Public License as published by</font></i>
<i><font color="#9A1900">   the Free Software Foundation; either version 3 of the License, or</font></i>
<i><font color="#9A1900">   (at your option) any later version.</font></i>

<i><font color="#9A1900">   optionmatrix program is distributed in the hope that it will be useful,</font></i>
<i><font color="#9A1900">   but WITHOUT ANY WARRANTY; without even the implied warranty of</font></i>
<i><font color="#9A1900">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</font></i>
<i><font color="#9A1900">   GNU General Public License for more details.</font></i>

<i><font color="#9A1900">   You should have received a copy of the GNU General Public License</font></i>
<i><font color="#9A1900">   along with this program.  If not, see </font></i><u><font color="#0000FF">&lt;http://www.gnu.org/licenses/&gt;</font></u><i><font color="#9A1900">.</font></i>
<i><font color="#9A1900">*/</font></i>

<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;gtk/gtk.h&gt;</font>

<b><font color="#000080">#include</font></b> <font color="#FF0000">"gtk_main.h"</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">"../common/prototypes.h"</font>

<font color="#008080">gboolean</font> <b><font color="#000000">calculate_options</font></b><font color="#990000">(</font><b><font color="#0000FF">struct</font></b> <font color="#008080">_properties</font> <font color="#990000">*</font>properties<font color="#990000">)</font>
<font color="#FF0000">{</font>
  <i><font color="#9A1900">//g_print("calculate_options()\n");</font></i>
  <i><font color="#9A1900">//g_print("properties-&gt;format = %d\n", properties-&gt;format );</font></i>
  <i><font color="#9A1900">//g_print("properties-&gt;decimalorcalendar = %d\n",properties-&gt;decimalorcalendar);</font></i>

  <b><font color="#0000FF">static</font></b> <font color="#009900">int</font> messageClear<font color="#990000">;</font>

  <b><font color="#000000">gtk_list_store_clear</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">);</font>

  <font color="#008080">guint</font> index <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
  <font color="#008080">GtkTreeIter</font> iter<font color="#990000">;</font>

  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>price <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonPrice<font color="#990000">));</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>rate  <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonRate<font color="#990000">));</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>volatility <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonStandardDeviation<font color="#990000">));</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>dividend <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonDividend<font color="#990000">));</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>steps <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonSteps<font color="#990000">));</font>
  properties<font color="#990000">-&gt;</font>distribution_mean <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonDistMean<font color="#990000">));</font>
  properties<font color="#990000">-&gt;</font>distribution_variance <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonDistVariance<font color="#990000">));</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>modeltype <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">;</font>

  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseZ <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonUseZ<font color="#990000">)</font> <font color="#990000">);</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseB <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonUseB<font color="#990000">)</font> <font color="#990000">);</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseJ <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonUseJ<font color="#990000">)</font> <font color="#990000">);</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseP <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonUseP<font color="#990000">)</font> <font color="#990000">);</font>

  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseQ <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonUseQ<font color="#990000">)</font> <font color="#990000">);</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseR <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonUseR<font color="#990000">)</font> <font color="#990000">);</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseS <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonUseS<font color="#990000">)</font> <font color="#990000">);</font>
  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseT <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font> <b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonUseT<font color="#990000">)</font> <font color="#990000">);</font>

  <font color="#009900">double</font> price <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>price<font color="#990000">;</font>
 
  <font color="#008080">gchar</font> textPrice<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#008080">gchar</font> textPrice2<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#008080">gchar</font> textStrike<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#008080">gchar</font> textCall<font color="#990000">[</font><font color="#993399">8</font><font color="#990000">][</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#008080">gchar</font> textPut<font color="#990000">[</font><font color="#993399">8</font><font color="#990000">][</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#008080">gchar</font> textCallDelta<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font>  <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#008080">gchar</font> textPutDelta<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#008080">gchar</font> textGamma<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#008080">gchar</font> textVega<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#008080">gchar</font> textCallTheta<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#008080">gchar</font> textPutTheta<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#008080">gchar</font> textCallRho<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#008080">gchar</font> textPutRho<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#008080">gchar</font> textMonth<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>

  <font color="#009900">double</font> callLeg2<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#009900">double</font> putLeg2<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#009900">char</font> textMonthLeg2<font color="#990000">[</font><font color="#993399">100</font><font color="#990000">][</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#009900">char</font> textStrikeLeg2<font color="#990000">[</font><font color="#993399">100</font><font color="#990000">][</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#009900">char</font> textLegacyCall<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#009900">char</font> textLegacyPut<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>

  <font color="#009900">int</font> totalCounter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

  <font color="#009900">char</font> dataExport<font color="#990000">[</font><font color="#993399">20000</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#009900">char</font> lineData<font color="#990000">[</font><font color="#993399">5000</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>

  <font color="#009900">double</font> cumStrikeLeg1 <font color="#990000">=</font> <font color="#993399">0.0</font><font color="#990000">;</font>
  <font color="#009900">double</font> cumStrikeLeg2 <font color="#990000">=</font> <font color="#993399">0.0</font><font color="#990000">;</font>

  <font color="#009900">char</font> statusMessage<font color="#990000">[</font><font color="#993399">80</font> <font color="#990000">*</font> <font color="#993399">3</font><font color="#990000">]</font>  <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">sanity_check</font></b><font color="#990000">(</font>properties<font color="#990000">,</font> <font color="#990000">&amp;</font>statusMessage<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">])</font> <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"%s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>statusMessage<font color="#990000">);</font>
    <b><font color="#000000">gtk_label_set_text</font></b><font color="#990000">(</font><b><font color="#000000">GTK_LABEL</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>labelInfo<font color="#990000">),</font>statusMessage<font color="#990000">);</font>
    <b><font color="#000000">gtk_widget_show</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>labelInfo<font color="#990000">);</font>
    messageClear <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
  <font color="#FF0000">}</font>
  
  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">(</font>messageClear<font color="#990000">++</font> <font color="#990000">%</font> <font color="#993399">20</font><font color="#990000">)</font> <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">gtk_widget_hide</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>labelInfo<font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <font color="#008080">time_t</font> mytime<font color="#990000">;</font>
  <b><font color="#0000FF">struct</font></b> <font color="#008080">tm</font> <font color="#990000">*</font>my_tm<font color="#990000">;</font>
    
  <b><font color="#000000">time</font></b><font color="#990000">(&amp;</font>mytime<font color="#990000">);</font>
  my_tm<font color="#990000">=</font><b><font color="#000000">localtime</font></b><font color="#990000">(&amp;</font>mytime<font color="#990000">);</font>

  <font color="#009900">char</font> tstring<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font>  <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <b><font color="#000000">strftime</font></b><font color="#990000">(</font>tstring<font color="#990000">,</font><b><font color="#0000FF">sizeof</font></b><font color="#990000">(</font>tstring<font color="#990000">),</font><font color="#FF0000">"%a %b %d %Y %H:%M:%S"</font><font color="#990000">,</font>my_tm<font color="#990000">);</font>
  <b><font color="#000000">gtk_label_set_text</font></b><font color="#990000">(</font><b><font color="#000000">GTK_LABEL</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>labelDisplayTime<font color="#990000">),</font>tstring<font color="#990000">);</font>

  <font color="#008080">gchar</font> dateTime<font color="#990000">[</font><font color="#993399">400</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#008080">gchar</font> dateTime2<font color="#990000">[</font><font color="#993399">400</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#008080">gchar</font> dateTime3<font color="#990000">[</font><font color="#993399">400</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>

  <font color="#008080">gdouble</font> decimalTime  <font color="#990000">=</font> <font color="#990000">(</font>gdouble<font color="#990000">)</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">-</font> <font color="#990000">(</font>gdouble<font color="#990000">)</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te<font color="#990000">;</font>
  <font color="#008080">gdouble</font> decimalTime2 <font color="#990000">=</font> <font color="#990000">(</font>gdouble<font color="#990000">)</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">]</font> <font color="#990000">-</font> <font color="#990000">(</font>gdouble<font color="#990000">)</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te2<font color="#990000">;</font>
  <font color="#008080">gdouble</font> decimalTime3 <font color="#990000">=</font> <font color="#990000">(</font>gdouble<font color="#990000">)</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">2</font><font color="#990000">]</font> <font color="#990000">-</font> <font color="#990000">(</font>gdouble<font color="#990000">)</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te3<font color="#990000">;</font>

  <b><font color="#000000">pthread_mutex_lock</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>mutexCashflow<font color="#990000">);</font>

  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>times_adjusted<font color="#990000">.</font><b><font color="#000000">erase</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>times_adjusted<font color="#990000">.</font><b><font color="#000000">begin</font></b><font color="#990000">(),</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>times_adjusted<font color="#990000">.</font><b><font color="#000000">end</font></b><font color="#990000">()</font> <font color="#990000">);</font>

  <b><font color="#0000FF">for</font></b><font color="#990000">(</font> std<font color="#990000">::</font>vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;::</font><font color="#008080">iterator</font> it <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>times<font color="#990000">.</font><b><font color="#000000">begin</font></b><font color="#990000">();</font> it <font color="#990000">!=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>times<font color="#990000">.</font><b><font color="#000000">end</font></b><font color="#990000">();</font> <font color="#990000">++</font>it<font color="#990000">)</font>
  <font color="#FF0000">{</font>
    properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>times_adjusted<font color="#990000">.</font><b><font color="#000000">push_back</font></b><font color="#990000">(</font> <font color="#990000">*</font>it <font color="#990000">-</font> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>realTimeBleeding <font color="#990000">?</font> <font color="#990000">(</font>gdouble<font color="#990000">)</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te4 <font color="#990000">:</font> <font color="#990000">(</font>gdouble<font color="#990000">)</font> <font color="#993399">0</font> <font color="#990000">)</font> <font color="#990000">);</font>

    <i><font color="#9A1900">//g_print("%s ", decimal_date_to_real_date(*it - (properties-&gt;realTimeBleeding ? (gdouble) properties-&gt;data.te : (gdouble) 0) ));</font></i>
  <font color="#FF0000">}</font>
    
  <b><font color="#000000">pthread_mutex_unlock</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>mutexCashflow<font color="#990000">);</font>

  <i><font color="#9A1900">//</font></i>

  <b><font color="#000000">pthread_mutex_lock</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>mutexCashflow<font color="#990000">);</font>

  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>coupon_times_adjusted<font color="#990000">.</font><b><font color="#000000">erase</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>coupon_times_adjusted<font color="#990000">.</font><b><font color="#000000">begin</font></b><font color="#990000">(),</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>coupon_times_adjusted<font color="#990000">.</font><b><font color="#000000">end</font></b><font color="#990000">()</font> <font color="#990000">);</font>

  <b><font color="#0000FF">for</font></b><font color="#990000">(</font> std<font color="#990000">::</font>vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;::</font><font color="#008080">iterator</font> it <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>coupon_times<font color="#990000">.</font><b><font color="#000000">begin</font></b><font color="#990000">();</font> it <font color="#990000">!=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>coupon_times<font color="#990000">.</font><b><font color="#000000">end</font></b><font color="#990000">();</font> <font color="#990000">++</font>it<font color="#990000">)</font>
  <font color="#FF0000">{</font>
    properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>coupon_times_adjusted<font color="#990000">.</font><b><font color="#000000">push_back</font></b><font color="#990000">(</font> <font color="#990000">*</font>it <font color="#990000">-</font> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>realTimeBleeding <font color="#990000">?</font> <font color="#990000">(</font>gdouble<font color="#990000">)</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te4 <font color="#990000">:</font> <font color="#990000">(</font>gdouble<font color="#990000">)</font> <font color="#993399">0</font> <font color="#990000">)</font> <font color="#990000">);</font>

    <i><font color="#9A1900">//g_print("%s ", decimal_date_to_real_date(*it - (properties-&gt;realTimeBleeding ? (gdouble) properties-&gt;data.te : (gdouble) 0) ));</font></i>
  <font color="#FF0000">}</font>

  properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>principal_times_adjusted<font color="#990000">.</font><b><font color="#000000">erase</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>principal_times_adjusted<font color="#990000">.</font><b><font color="#000000">begin</font></b><font color="#990000">(),</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>principal_times_adjusted<font color="#990000">.</font><b><font color="#000000">end</font></b><font color="#990000">()</font> <font color="#990000">);</font>

  <b><font color="#0000FF">for</font></b><font color="#990000">(</font> std<font color="#990000">::</font>vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;::</font><font color="#008080">iterator</font> it <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>principal_times<font color="#990000">.</font><b><font color="#000000">begin</font></b><font color="#990000">();</font> it <font color="#990000">!=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>principal_times<font color="#990000">.</font><b><font color="#000000">end</font></b><font color="#990000">();</font> <font color="#990000">++</font>it<font color="#990000">)</font>
  <font color="#FF0000">{</font>
    properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>principal_times_adjusted<font color="#990000">.</font><b><font color="#000000">push_back</font></b><font color="#990000">(</font> <font color="#990000">*</font>it <font color="#990000">-</font> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>realTimeBleeding <font color="#990000">?</font> <font color="#990000">(</font>gdouble<font color="#990000">)</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te4 <font color="#990000">:</font> <font color="#990000">(</font>gdouble<font color="#990000">)</font> <font color="#993399">0</font> <font color="#990000">)</font> <font color="#990000">);</font>

    <i><font color="#9A1900">//g_print("%s ", decimal_date_to_real_date(*it - (properties-&gt;realTimeBleeding ? (gdouble) properties-&gt;data.te : (gdouble) 0) ));</font></i>
  <font color="#FF0000">}</font>
    
  <b><font color="#000000">pthread_mutex_unlock</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>mutexCashflow<font color="#990000">);</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportTime2 <font color="#990000">&amp;&amp;</font>
     option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>perpetual <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
     properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTime2InFocusflag <font color="#990000">==</font> FALSE<font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>dateTime2<font color="#990000">,</font><font color="#FF0000">"%s Date: %s  "</font><font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportTime2des<font color="#990000">,</font><b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime2<font color="#990000">));</font>
    <i><font color="#9A1900">//g_print("%.*f = %s\n",15,decimalTime2,dateTime2);</font></i>
    <b><font color="#000000">gtk_label_set_text</font></b><font color="#990000">(</font><b><font color="#000000">GTK_LABEL</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>labelTime2<font color="#990000">),</font>dateTime2<font color="#990000">);</font>

    properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTime2Flag <font color="#990000">=</font> FALSE<font color="#990000">;</font>
    <b><font color="#000000">gtk_spin_button_set_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTime2<font color="#990000">),</font>decimalTime2<font color="#990000">);</font>
    <b><font color="#000000">gtk_spin_button_set_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonDaysToDividend<font color="#990000">),(</font><font color="#993399">365</font> <font color="#990000">*</font> decimalTime2<font color="#990000">));</font>
    properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTime2Flag <font color="#990000">=</font> TRUE<font color="#990000">;</font>
    <b><font color="#000000">gtk_widget_show</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTime2<font color="#990000">);</font>
    <b><font color="#000000">gtk_widget_show</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonDaysToDividend<font color="#990000">);</font>
    <b><font color="#000000">gtk_widget_show</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>labelTime2<font color="#990000">);</font>
    <b><font color="#000000">gtk_widget_show</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>buttonCalendar2<font color="#990000">);</font>
    <b><font color="#000000">gtk_widget_show</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>labelDaysToDividend<font color="#990000">);</font>
    <i><font color="#9A1900">//g_print("show spinbuttonTime2, labelTime2\n");</font></i>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">gtk_widget_is_focus</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTime2<font color="#990000">)</font> <font color="#990000">)</font>
      <b><font color="#000000">g_signal_emit_by_name</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>comboboxModel<font color="#990000">,</font> <font color="#FF0000">"grab-focus"</font><font color="#990000">);</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">gtk_widget_is_focus</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonDaysToDividend<font color="#990000">)</font> <font color="#990000">)</font>
      <b><font color="#000000">g_signal_emit_by_name</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>comboboxModel<font color="#990000">,</font> <font color="#FF0000">"grab-focus"</font><font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <i><font color="#9A1900">//</font></i>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportTime3 <font color="#990000">&amp;&amp;</font>
     properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTime3InFocusflag <font color="#990000">==</font> FALSE<font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>dateTime3<font color="#990000">,</font><font color="#FF0000">"%s Date: %s  "</font><font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportTime3des<font color="#990000">,</font><b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime3<font color="#990000">));</font>
    <i><font color="#9A1900">//g_print("%.*f = %s\n",15,decimalTime2,dateTime2);</font></i>
    <b><font color="#000000">gtk_label_set_text</font></b><font color="#990000">(</font><b><font color="#000000">GTK_LABEL</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>labelTime3<font color="#990000">),</font>dateTime3<font color="#990000">);</font>

    properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTime3Flag <font color="#990000">=</font> FALSE<font color="#990000">;</font>
    <b><font color="#000000">gtk_spin_button_set_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTime3<font color="#990000">),</font>decimalTime3<font color="#990000">);</font>
    <b><font color="#000000">gtk_spin_button_set_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonDaysToDividend2<font color="#990000">),(</font><font color="#993399">365</font> <font color="#990000">*</font> decimalTime3<font color="#990000">));</font>
    properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTime3Flag <font color="#990000">=</font> TRUE<font color="#990000">;</font>
    <b><font color="#000000">gtk_widget_show</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTime3<font color="#990000">);</font>
    <b><font color="#000000">gtk_widget_show</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonDaysToDividend2<font color="#990000">);</font>
    <b><font color="#000000">gtk_widget_show</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>labelTime3<font color="#990000">);</font>
    <b><font color="#000000">gtk_widget_show</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>buttonCalendar3<font color="#990000">);</font>
    <b><font color="#000000">gtk_widget_show</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>labelDaysToDividend2<font color="#990000">);</font>
    <i><font color="#9A1900">//g_print("show spinbuttonTime2, labelTime2\n");</font></i>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">gtk_widget_is_focus</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTime3<font color="#990000">)</font> <font color="#990000">)</font>
      <b><font color="#000000">g_signal_emit_by_name</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>comboboxModel<font color="#990000">,</font> <font color="#FF0000">"grab-focus"</font><font color="#990000">);</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">gtk_widget_is_focus</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonDaysToDividend2<font color="#990000">)</font> <font color="#990000">)</font>
      <b><font color="#000000">g_signal_emit_by_name</font></b> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>comboboxModel<font color="#990000">,</font> <font color="#FF0000">"grab-focus"</font><font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <i><font color="#9A1900">//</font></i>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>decimalorcalendar <font color="#990000">==</font> DECIMALS <font color="#990000">&amp;&amp;</font> <font color="#990000">!</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>perpetual <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <i><font color="#9A1900">//sprintf(dateTime,"Expiration Date: %s",decimal_date_to_real_date(decimalTime));</font></i>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>dateTime<font color="#990000">,</font><font color="#FF0000">"%s Date: %s"</font><font color="#990000">,</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportTime1des<font color="#990000">,</font> <b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime<font color="#990000">));</font>
    <b><font color="#000000">gtk_label_set_text</font></b><font color="#990000">(</font><b><font color="#000000">GTK_LABEL</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>labelTime1<font color="#990000">),</font>dateTime<font color="#990000">);</font>
    <b><font color="#000000">gtk_widget_show</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>labelTime1<font color="#990000">);</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTimeInFocusflag<font color="#990000">)</font> <font color="#990000">==</font> FALSE<font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <i><font color="#9A1900">//g_print("properties-&gt;GtkInfo.spinbuttonTimeInFocusflag == FALSE\t%d\n",properties-&gt;GtkInfo.spinbuttonTimeInFocusflag);</font></i>
      properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTimeFlag <font color="#990000">=</font> FALSE<font color="#990000">;</font>
      <b><font color="#000000">gtk_spin_button_set_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTime<font color="#990000">),</font>decimalTime<font color="#990000">);</font>
      <b><font color="#000000">gtk_spin_button_set_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonDaysToExpr<font color="#990000">),(</font><font color="#993399">365</font> <font color="#990000">*</font> decimalTime<font color="#990000">));</font>
      properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTimeFlag <font color="#990000">=</font> TRUE<font color="#990000">;</font>

      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">gtk_widget_is_focus</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonTime<font color="#990000">)</font> <font color="#990000">)</font>
        <b><font color="#000000">g_signal_emit_by_name</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>comboboxModel<font color="#990000">,</font> <font color="#FF0000">"grab-focus"</font><font color="#990000">);</font>

      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">gtk_widget_is_focus</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonDaysToExpr<font color="#990000">)</font> <font color="#990000">)</font>
        <b><font color="#000000">g_signal_emit_by_name</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>comboboxModel<font color="#990000">,</font> <font color="#FF0000">"grab-focus"</font><font color="#990000">);</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>assetClass <font color="#990000">==</font> BOND_CLASS <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"Bond Calculate</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

    <font color="#009900">char</font> description<font color="#990000">[</font><font color="#993399">250</font><font color="#990000">]</font>  <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#009900">char</font> timeDecimal<font color="#990000">[</font><font color="#993399">250</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#009900">char</font> dateTime<font color="#990000">[</font><font color="#993399">250</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#009900">char</font> value<font color="#990000">[</font><font color="#993399">250</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>

    <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> bonddata<font color="#990000">;</font>
    bonddata <font color="#990000">=</font> <b><font color="#000000">bonddispatch</font></b><font color="#990000">(</font>properties<font color="#990000">);</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">!</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>perpetual <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Discount Factor T1"</font><font color="#990000">);</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>timeDecimal<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime2<font color="#990000">);</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>dateTime<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font> <b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime2<font color="#990000">));</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>discount_t2<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> timeDecimal<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Discount Factor T1   %.*f   %s   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>discount_t2<font color="#990000">,</font><b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime2<font color="#990000">),</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime2<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Discount Factor T2"</font><font color="#990000">);</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>timeDecimal<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime<font color="#990000">);</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>dateTime<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font> <b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime<font color="#990000">));</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>discount_t1<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> timeDecimal<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Discount Factor T2   %.*f   %s   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>discount_t1<font color="#990000">,</font><b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime<font color="#990000">),</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Spot Rate T1"</font><font color="#990000">);</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>timeDecimal<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime2<font color="#990000">);</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>dateTime<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font> <b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime2<font color="#990000">));</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>spot_t2<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> timeDecimal<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Spot Rate T1   %.*f   %s   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>spot_t2<font color="#990000">,</font><b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime2<font color="#990000">),</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime2<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Spot Rate T2"</font><font color="#990000">);</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>timeDecimal<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime<font color="#990000">);</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>dateTime<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font> <b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime<font color="#990000">));</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>spot_t1<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> timeDecimal<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Spot Rate T2   %.*f   %s   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>spot_t1<font color="#990000">,</font><b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime<font color="#990000">),</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
      
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Forward T1 : T2"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>forward<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> timeDecimal<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Forward T1 : T2   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>forward<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>

      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> <font color="#FF0000">""</font><font color="#990000">,</font> X2<font color="#990000">,</font> <font color="#FF0000">""</font><font color="#990000">,</font> X3<font color="#990000">,</font> <font color="#FF0000">""</font><font color="#990000">,</font> X4<font color="#990000">,</font> <font color="#FF0000">""</font><font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>bond_price <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Bond Price"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>bond_price<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> dateTime<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Bond Price   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>bond_price<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>pv_continous <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Present Value"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>pv_continous<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> dateTime<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Present Value %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>pv_continous<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>pv_discrete <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Present Value Discrete"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>pv_discrete<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> dateTime<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Present Value Discrete   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>pv_discrete<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>YTMContinous <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"YTM"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>YTMContinous<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> dateTime<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"YTM   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>YTMContinous<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>YTMDiscrete <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"YTM Discrete"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>YTMDiscrete<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> dateTime<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"YTM Discrete   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>YTMDiscrete<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>durationContinous <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Duration"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>durationContinous<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> dateTime<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Duration   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>durationContinous<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>durationDiscrete <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Duration Discrete"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>durationDiscrete<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> dateTime<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Duration Discrete   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>durationDiscrete<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>durationModifiedDiscrete <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Duration Modified Discrete"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>durationModifiedDiscrete<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> dateTime<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Duration Modified Discrete   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>durationModifiedDiscrete<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>durationMacaulayDiscrete <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Duration Macaulay Discrete"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>durationMacaulayDiscrete<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> dateTime<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Duration Macaulay Discrete   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>durationMacaulayDiscrete<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>convexityContinous <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Convexity"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>convexityContinous<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> dateTime<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Convexity %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>convexityContinous<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>convexityDiscrete <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Convexity Discrete"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>convexityDiscrete<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> dateTime<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Convexity Discrete %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>convexityDiscrete<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>call <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Call"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>call<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> dateTime<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Call   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>call<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>irr <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"IRR"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>irr<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> dateTime<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"IRR   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>irr<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>irr_discrete <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"IRR Discrete"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>irr_discrete<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> dateTime<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"IRR Discrete   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>irr_discrete<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>uirr <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"UIRR"</font><font color="#990000">);</font>
      timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
      <b><font color="#000000">strcpy</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"True"</font><font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> dateTime<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"UIRR   True</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>textExport <font color="#990000">==</font> <b><font color="#0000FF">true</font></b> <font color="#990000">)</font>
      <b><font color="#000000">text_export</font></b><font color="#990000">(</font>properties<font color="#990000">,</font> dataExport<font color="#990000">);</font>

    <b><font color="#0000FF">return</font></b> TRUE<font color="#990000">;</font>
  <font color="#FF0000">}</font>

<b><font color="#000080">#ifdef</font></b> FINRECIPES

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>assetClass <font color="#990000">==</font> TERMSTRUCTURE_CLASS <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"Termstructure Calculate</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

    properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>term <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

    <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> termstructuredata<font color="#990000">;</font>
    properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>term_model <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>modeltype<font color="#990000">;</font>
    termstructuredata <font color="#990000">=</font> <b><font color="#000000">termstructure</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>

    <font color="#009900">char</font> description<font color="#990000">[</font><font color="#993399">250</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#009900">char</font> timeDecimal<font color="#990000">[</font><font color="#993399">250</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#009900">char</font> dateTime<font color="#990000">[</font><font color="#993399">250</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#009900">char</font> value<font color="#990000">[</font><font color="#993399">250</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>

    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"*discount factor t1 = %.*f:%.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>discount_t1<font color="#990000">);</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"*discount factor t2 = %.*f:%.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime2<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>discount_t2<font color="#990000">);</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"*spot rate t1 = %.*f:%.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>spot_t1<font color="#990000">);</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"*spot rate t2 = %.*f:%.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime2<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>spot_t2<font color="#990000">);</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"*forward rate from t1= %.*f to t2 %.*f:%.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime2<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>forward<font color="#990000">);</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Discount Factor T1"</font><font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>timeDecimal<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime2<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>dateTime<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font> <b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime2<font color="#990000">));</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>discount_t2<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> timeDecimal<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Discount Factor T1   %.*f   %s   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>discount_t2<font color="#990000">,</font><b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime2<font color="#990000">),</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime2<font color="#990000">);</font>
    <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Discount Factor T2"</font><font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>timeDecimal<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>dateTime<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font> <b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime<font color="#990000">));</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>discount_t1<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> timeDecimal<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Discount Factor T2   %.*f   %s   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>discount_t1<font color="#990000">,</font><b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime<font color="#990000">),</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime<font color="#990000">);</font>
    <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Spot Rate T1"</font><font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>timeDecimal<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime2<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>dateTime<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font> <b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime2<font color="#990000">));</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>spot_t2<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> timeDecimal<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Spot Rate T1   %.*f   %s   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>spot_t2<font color="#990000">,</font><b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime2<font color="#990000">),</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime2<font color="#990000">);</font>
    <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Spot Rate T2"</font><font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>timeDecimal<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>dateTime<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font> <b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime<font color="#990000">));</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>spot_t1<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> timeDecimal<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Spot Rate T2   %.*f   %s   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>spot_t1<font color="#990000">,</font><b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>decimalTime<font color="#990000">),</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>decimalTime<font color="#990000">);</font>
    <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>description<font color="#990000">,</font><font color="#FF0000">"Forward T1 : T2"</font><font color="#990000">);</font>
    timeDecimal<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> dateTime<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font> 
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>value<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>forward<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> description<font color="#990000">,</font> X2<font color="#990000">,</font> value<font color="#990000">,</font> X3<font color="#990000">,</font> dateTime<font color="#990000">,</font> X4<font color="#990000">,</font> timeDecimal<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"Forward T1 : T2   %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>forward<font color="#990000">);</font>
    <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>term <font color="#990000">)</font>
      <b><font color="#0000FF">delete</font></b> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>term<font color="#990000">;</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>textExport <font color="#990000">==</font> <b><font color="#0000FF">true</font></b> <font color="#990000">)</font>
      <b><font color="#000000">text_export</font></b><font color="#990000">(</font>properties<font color="#990000">,</font> dataExport<font color="#990000">);</font>

    <b><font color="#0000FF">return</font></b> TRUE<font color="#990000">;</font>
  <font color="#FF0000">}</font>

<b><font color="#000080">#endif</font></b>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>format <font color="#990000">==</font> DECIMAL_FUTURE <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"DECIMAL_FUTURE</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"properties-&gt;decimalorcalendar = %d</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>decimalorcalendar<font color="#990000">);</font>

    <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> futuredata<font color="#990000">;</font>
    futuredata <font color="#990000">=</font> <b><font color="#000000">future</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>

    <font color="#009900">char</font> textSpot<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textSpot<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>price<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> <font color="#FF0000">"Spot Price"</font><font color="#990000">,</font> X2<font color="#990000">,</font> textSpot<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">" %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> <font color="#FF0000">"Spot Price"</font><font color="#990000">,</font>textSpot<font color="#990000">);</font>
    <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>

    <font color="#009900">char</font> textFuturesPrice<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textFuturesPrice<font color="#990000">,</font><font color="#FF0000">"%.*f (%s)"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>future<font color="#990000">,(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>future <font color="#990000">&gt;</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>price <font color="#990000">?</font> <font color="#FF0000">"Cotango"</font> <font color="#990000">:</font> <font color="#FF0000">"Backwardation"</font><font color="#990000">)</font> <font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> <font color="#FF0000">"Futures Price"</font><font color="#990000">,</font> X2<font color="#990000">,</font> textFuturesPrice<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">" %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> <font color="#FF0000">"Futures Price"</font><font color="#990000">,</font>textFuturesPrice<font color="#990000">);</font>
    <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>

    <font color="#009900">char</font> textRate<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textRate<font color="#990000">,</font><font color="#FF0000">"%.*f%%"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>rate<font color="#990000">*</font><font color="#993399">100</font><font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> <font color="#FF0000">"Interest Rate"</font><font color="#990000">,</font> X2<font color="#990000">,</font> textRate<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">" %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> <font color="#FF0000">"Interest Rate"</font><font color="#990000">,</font> textRate<font color="#990000">);</font>
    <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>

    <font color="#009900">char</font> textBasis<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textBasis<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>price<font color="#990000">-</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>future<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> <font color="#FF0000">"Basis"</font><font color="#990000">,</font> X2<font color="#990000">,</font> textBasis<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">" %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> <font color="#FF0000">"Basis"</font><font color="#990000">,</font> textBasis<font color="#990000">);</font>
    <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <font color="#009900">char</font> textDiv<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textDiv<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>dividend<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
      <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> <font color="#FF0000">"Div yield underlying"</font><font color="#990000">,</font> X2<font color="#990000">,</font> textDiv<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">" %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> <font color="#FF0000">"Div yield underlying"</font><font color="#990000">,</font> textDiv<font color="#990000">);</font>
      <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <font color="#009900">char</font> textExpr<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textExpr<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font><b><font color="#000000">decimal_date_to_real_date</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]-</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te<font color="#990000">));</font>
    <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> <font color="#FF0000">"Expiration Date"</font><font color="#990000">,</font> X2<font color="#990000">,</font> textExpr<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">" %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> <font color="#FF0000">"Expiration Date"</font><font color="#990000">,</font>textExpr<font color="#990000">);</font>
    <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
    
    <font color="#009900">char</font> textTicker<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textTicker<font color="#990000">,</font><font color="#FF0000">"%s%02d"</font><font color="#990000">,</font>future_codes<font color="#990000">[</font><b><font color="#000000">decimal_date_to_int_month</font></b><font color="#990000">(</font><b><font color="#000000">adjust_to_current_time</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]-</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te<font color="#990000">,</font><font color="#993399">0</font><font color="#990000">))],</font><b><font color="#000000">decimal_date_to_int_year</font></b><font color="#990000">(</font><b><font color="#000000">adjust_to_current_time</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]-</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te<font color="#990000">,</font><font color="#993399">0</font><font color="#990000">)));</font>

    <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
    <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> <font color="#FF0000">"Ticker"</font><font color="#990000">,</font> X2<font color="#990000">,</font> textTicker<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">" %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> <font color="#FF0000">"Ticker"</font><font color="#990000">,</font> textTicker<font color="#990000">);</font>
    <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>format <font color="#990000">==</font> CALENDAR_FUTURE <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"CALENDAR_FUTURE</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>
    <i><font color="#9A1900">//g_print("properties-&gt;decimalorcalendar = %d\n",properties-&gt;decimalorcalendar);</font></i>

    <font color="#009900">int</font> index <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

    <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> futuredata<font color="#990000">;</font>
    <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> futuredata2<font color="#990000">;</font>

    <font color="#009900">char</font> textTicker<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#009900">char</font> textTicker2<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#009900">char</font> textMonthDayYear<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#009900">char</font> textMonthDayYear2<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#009900">char</font> textDecimalDate<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#009900">char</font> textDecimalDate2<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#009900">char</font> textDaysToExpr<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#009900">char</font> textDaysToExpr2<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#009900">char</font> textSpread<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#009900">char</font> textSpreadTicker<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>

    <font color="#009900">double</font> leg1<font color="#990000">;</font>
    <font color="#009900">double</font> leg2<font color="#990000">;</font>

    <b><font color="#0000FF">while</font></b><font color="#990000">(</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <b><font color="#000000">adjust_to_current_time_and_expr</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>expiration_time<font color="#990000">,</font><font color="#993399">0</font><font color="#990000">);</font>
      <i><font color="#9A1900">//g_print("t = %.*f\t%s\n",15,(double)properties-&gt;data.t[0],decimal_date_to_real_date(properties-&gt;data.t[0]));</font></i>

      futuredata <font color="#990000">=</font> <b><font color="#000000">future</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
      leg1 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>future<font color="#990000">;</font>
      
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPrice<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>future<font color="#990000">);</font>
      <i><font color="#9A1900">//sprintf(textTicker,"%s",future_codes[*properties-&gt;expiration_month]);</font></i>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textTicker<font color="#990000">,</font><font color="#FF0000">"%s%02d"</font><font color="#990000">,</font>future_codes<font color="#990000">[*</font>properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">],*</font>properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">);</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textMonthDayYear<font color="#990000">,</font><font color="#FF0000">"%s%2d %02.0f"</font><font color="#990000">,</font>mon<font color="#990000">[*</font>properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">],*</font>properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)*</font>properties<font color="#990000">-&gt;</font>expiration_year <font color="#990000">+</font> <font color="#993399">2000</font><font color="#990000">);</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textDecimalDate<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>
      <i><font color="#9A1900">//g_print("textDecimalDate %.*f\n",properties-&gt;precision,properties-&gt;data.t[0]);</font></i>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textDaysToExpr<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,(</font><font color="#993399">365</font><font color="#990000">*</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]));</font>
      <i><font color="#9A1900">//g_print("textDaysToExpr = %.*f\n",properties-&gt;precision,(365*properties-&gt;data.t[0]));</font></i>

      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>

      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> textMonthDayYear<font color="#990000">,</font> X2<font color="#990000">,</font> textPrice<font color="#990000">,</font> X3<font color="#990000">,</font> textDaysToExpr<font color="#990000">,</font> X4<font color="#990000">,</font> textDecimalDate<font color="#990000">,</font> X5<font color="#990000">,</font> textTicker<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>textExport <font color="#990000">==</font> <b><font color="#0000FF">true</font></b> <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"%s, %s, %s, %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> 
                textMonthDayYear<font color="#990000">,</font> textPrice<font color="#990000">,</font> textDaysToExpr<font color="#990000">,</font> textDecimalDate<font color="#990000">,</font> textTicker<font color="#990000">);</font>
          <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
        <font color="#FF0000">}</font>

      <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <b><font color="#000000">adjust_to_current_time_and_expr</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>time_to_expiration2<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>expiration_time<font color="#990000">,</font><font color="#993399">0</font><font color="#990000">);</font>
        <i><font color="#9A1900">//g_print("t = %.*f\t%s\n",15,(double)properties-&gt;data.t[0],decimal_date_to_real_date(properties-&gt;data.t[0]));</font></i>

        futuredata2 <font color="#990000">=</font> <b><font color="#000000">future</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
        leg2 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>future<font color="#990000">;</font>

        <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPrice2<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>future<font color="#990000">);</font>
        <i><font color="#9A1900">//sprintf(textTicker2,"%s",future_codes[*properties-&gt;expiration_month2]);</font></i>
        <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textTicker2<font color="#990000">,</font><font color="#FF0000">"%s%02d"</font><font color="#990000">,</font>future_codes<font color="#990000">[*</font>properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">],*</font>properties<font color="#990000">-&gt;</font>expiration_year2<font color="#990000">);</font>
        <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textMonthDayYear2<font color="#990000">,</font><font color="#FF0000">"%s%2d %02.0f"</font><font color="#990000">,</font>mon<font color="#990000">[*</font>properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">],*</font>properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)*</font>properties<font color="#990000">-&gt;</font>expiration_year2 <font color="#990000">+</font> <font color="#993399">2000</font><font color="#990000">);</font>
        <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textDecimalDate2<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>
        <i><font color="#9A1900">//g_print("textDecimalDate %.*f\n",properties-&gt;precision,properties-&gt;data.t[0]);</font></i>
        <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textDaysToExpr2<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,(</font><font color="#993399">365</font><font color="#990000">*</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]));</font>
        <i><font color="#9A1900">//g_print("textDaysToExpr = %.*f\n",properties-&gt;precision,(365*properties-&gt;data.t[0]));</font></i>
        <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textSpread<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font> <font color="#990000">(</font><font color="#009900">double</font><font color="#990000">)</font> leg1 <font color="#990000">-</font> <font color="#990000">(</font><font color="#009900">double</font><font color="#990000">)</font> leg2<font color="#990000">);</font>
        <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textSpreadTicker<font color="#990000">,</font><font color="#FF0000">"%s - %s"</font><font color="#990000">,</font>textTicker<font color="#990000">,</font> textTicker2<font color="#990000">);</font>

        <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> textMonthDayYear<font color="#990000">,</font> X2<font color="#990000">,</font> textPrice<font color="#990000">,</font> X3<font color="#990000">,</font> textDaysToExpr<font color="#990000">,</font> X4<font color="#990000">,</font> textDecimalDate<font color="#990000">,</font> X5<font color="#990000">,</font> textTicker<font color="#990000">,</font> X6<font color="#990000">,</font> textMonthDayYear2<font color="#990000">,</font> X7<font color="#990000">,</font> textPrice2<font color="#990000">,</font> X8<font color="#990000">,</font> textDaysToExpr2<font color="#990000">,</font> X9<font color="#990000">,</font> textDecimalDate2<font color="#990000">,</font> X10<font color="#990000">,</font> textTicker2<font color="#990000">,</font> X11<font color="#990000">,</font> textSpread<font color="#990000">,</font> X12<font color="#990000">,</font> textSpreadTicker<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>textExport <font color="#990000">==</font> <b><font color="#0000FF">true</font></b> <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> 
              textMonthDayYear<font color="#990000">,</font> textPrice<font color="#990000">,</font> textDaysToExpr<font color="#990000">,</font> textDecimalDate<font color="#990000">,</font> textTicker<font color="#990000">,</font> textMonthDayYear2<font color="#990000">,</font> textPrice2<font color="#990000">,</font> textDaysToExpr2<font color="#990000">,</font> textDecimalDate2<font color="#990000">,</font> textTicker2<font color="#990000">,</font> textSpread<font color="#990000">,</font> textSpreadTicker<font color="#990000">);</font>
          <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
        <font color="#FF0000">}</font>

      <font color="#FF0000">}</font>

      properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">++;</font>
      properties<font color="#990000">-&gt;</font>time_to_expiration2<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_year2<font color="#990000">++;</font>

      <b><font color="#0000FF">if</font></b><font color="#990000">(</font>index<font color="#990000">++</font> <font color="#990000">&gt;=</font> <font color="#993399">17</font><font color="#990000">)</font>
        <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <i><font color="#9A1900">/* reset pointers */</font></i>
    properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_month<font color="#990000">;</font>
    properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_days_to_expiration<font color="#990000">;</font>
    properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_year<font color="#990000">;</font>
    properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_time_to_expiration<font color="#990000">;</font>

    <i><font color="#9A1900">/* reset pointers */</font></i>
    properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_month2<font color="#990000">;</font>
    properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_days_to_expiration2<font color="#990000">;</font>
    properties<font color="#990000">-&gt;</font>expiration_year2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_year2<font color="#990000">;</font>
    properties<font color="#990000">-&gt;</font>time_to_expiration2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_time_to_expiration2<font color="#990000">;</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>format <font color="#990000">==</font> DECIMAL_GREEKS <font color="#990000">)</font>
  <font color="#FF0000">{</font>
      <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"DECIMAL_GREEKS</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>
      <font color="#009900">double</font> epsilon <font color="#990000">=</font> <font color="#990000">(</font><font color="#009900">double</font><font color="#990000">)</font> <font color="#993399">1</font> <font color="#990000">/</font> <b><font color="#000000">pow</font></b><font color="#990000">(</font><font color="#993399">10.0</font><font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">);</font>
      <font color="#009900">double</font> i<font color="#990000">;</font>
      index <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
      <b><font color="#0000FF">for</font></b><font color="#990000">(</font>i<font color="#990000">=(</font>properties<font color="#990000">-&gt;</font>strike_offset<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">-</font><font color="#993399">35</font><font color="#990000">/(</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">));</font>i<font color="#990000">&lt;(</font>properties<font color="#990000">-&gt;</font>strike_offset<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">+</font><font color="#993399">160</font><font color="#990000">);</font>i<font color="#990000">+=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor<font color="#990000">)</font>
      <font color="#FF0000">{</font>

         <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">(((</font><font color="#009900">int</font><font color="#990000">)</font>i<font color="#990000">%</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">0</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(</font><b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)!=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>retdiscard<font color="#990000">))</font> <font color="#990000">||</font>
            <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">2.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
            <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">7.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
            <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">12.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
            <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">17.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
            <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">22.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
            <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">27.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font>
           <font color="#990000">)</font>
         <font color="#FF0000">{</font>

         <b><font color="#0000FF">if</font></b><font color="#990000">(</font> i <font color="#990000">&lt;=</font> <font color="#993399">0</font> <font color="#990000">||</font> <b><font color="#000000">fabs</font></b><font color="#990000">(</font>i<font color="#990000">-</font><font color="#993399">0.0</font><font color="#990000">)</font> <font color="#990000">&lt;</font> epsilon <font color="#990000">)</font>
         <font color="#FF0000">{</font>
           i <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
        
           <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1 <font color="#990000">!=</font> <font color="#993399">5</font> <font color="#990000">)</font>
           <font color="#FF0000">{</font>
             properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">+</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>xcontrol<font color="#990000">;</font>
           <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
           <font color="#FF0000">{</font>
             properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">+</font> <font color="#993399">2.5</font><font color="#990000">;</font>
           <font color="#FF0000">}</font>
           <b><font color="#0000FF">continue</font></b><font color="#990000">;</font>
         <font color="#FF0000">}</font>

         <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPrice <font color="#990000">)</font>
           <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPrice<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>price<font color="#990000">);</font>

         <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
           properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike2<font color="#990000">));</font>
         <b><font color="#0000FF">else</font></b>
           properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> i<font color="#990000">;</font>

         <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
         <font color="#FF0000">{</font>
           <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)</font> <font color="#990000">==</font> <font color="#990000">.</font><font color="#993399">5</font> <font color="#990000">)</font>
           <font color="#FF0000">{</font>
             <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrike<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
           <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
           <font color="#FF0000">{</font>
             <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrike<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
           <font color="#FF0000">}</font>
         <font color="#FF0000">}</font>

         <i><font color="#9A1900">//g_print("price = %f, strike = %f, rate = %f, v = %f, div = %f, z = %f, b = %f, j = %f, p = %f", price, i, rate, volatility, dividend,properties-&gt;data.UseZ, properties-&gt;data.UseB, properties-&gt;data.UseJ, properties-&gt;data.UseP);</font></i>
        
         <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> optiondata<font color="#990000">;</font>

         <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">)</font>
         <font color="#FF0000">{</font>
           optiondata <font color="#990000">=</font> <b><font color="#000000">option_call</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
           <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>call<font color="#990000">);</font>
         <font color="#FF0000">}</font>

         <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
         <font color="#FF0000">{</font>
           optiondata <font color="#990000">=</font> <b><font color="#000000">option_put</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
           <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>put<font color="#990000">);</font>
         <font color="#FF0000">}</font>

         <b><font color="#000000">process_greeks</font></b><font color="#990000">(</font>properties<font color="#990000">,</font> <font color="#990000">&amp;</font>textCallDelta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textPutDelta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textGamma<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textVega<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textCallTheta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textPutTheta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textCallRho<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textPutRho<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>

         <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
         <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> textPrice<font color="#990000">,</font> X2<font color="#990000">,</font> textStrike<font color="#990000">,</font> X3<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X4<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X5<font color="#990000">,</font> textCallDelta<font color="#990000">,</font> X6<font color="#990000">,</font> textPutDelta<font color="#990000">,</font> X7<font color="#990000">,</font> textGamma<font color="#990000">,</font> X8<font color="#990000">,</font> textVega<font color="#990000">,</font> X9<font color="#990000">,</font> textCallTheta<font color="#990000">,</font> X10<font color="#990000">,</font> textPutTheta<font color="#990000">,</font> X11<font color="#990000">,</font> textCallRho<font color="#990000">,</font> X12<font color="#990000">,</font> textPutRho<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

         <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>textExport <font color="#990000">==</font> <b><font color="#0000FF">true</font></b> <font color="#990000">)</font>
         <font color="#FF0000">{</font>
           <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> textPrice<font color="#990000">,</font> textStrike<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textCallDelta<font color="#990000">,</font> textPutDelta<font color="#990000">,</font> textGamma<font color="#990000">,</font> textVega<font color="#990000">,</font> textCallTheta<font color="#990000">,</font> textPutTheta<font color="#990000">,</font> textCallRho<font color="#990000">,</font> textPutRho<font color="#990000">);</font>
           <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
         <font color="#FF0000">}</font>

         <b><font color="#0000FF">if</font></b><font color="#990000">(</font> index<font color="#990000">++</font> <font color="#990000">&gt;=</font> <font color="#993399">17</font> <font color="#990000">)</font>
          <b><font color="#0000FF">break</font></b><font color="#990000">;</font>

         <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">!</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
          <b><font color="#0000FF">break</font></b><font color="#990000">;</font>

         <font color="#FF0000">}</font>
      <font color="#FF0000">}</font>
  <font color="#FF0000">}</font>
  <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>format <font color="#990000">==</font> CALENDAR_CUSTOM <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"CALENDAR_CUSTOM</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>
    index <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      totalCounter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

      <b><font color="#0000FF">while</font></b><font color="#990000">(</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_year2<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">)</font>
      <font color="#FF0000">{</font>         
        <font color="#009900">double</font> i <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike2<font color="#990000">));</font>
        cumStrikeLeg2 <font color="#990000">+=</font> i<font color="#990000">;</font>

        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrikeLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>i<font color="#990000">);</font>
        <font color="#FF0000">}</font>
        <i><font color="#9A1900">//sprintf(textPrice,"%.*f",properties-&gt;precision,price);</font></i>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
           properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike2<font color="#990000">));</font>
        <b><font color="#0000FF">else</font></b>
           properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> i<font color="#990000">;</font>

        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <b><font color="#000000">adjust_to_current_time_and_expr</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>time_to_expiration2<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>expiration_time<font color="#990000">,</font><font color="#993399">0</font><font color="#990000">);</font>
        <i><font color="#9A1900">//g_print("t = %.*f\t%s\n",15,(double)properties-&gt;data.t[0],decimal_date_to_real_date(properties-&gt;data.t[0]));</font></i>
      
        <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> optiondata<font color="#990000">;</font>
          
        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          optiondata <font color="#990000">=</font> <b><font color="#000000">option_call</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
          callLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]</font> <font color="#990000">=</font> optiondata<font color="#990000">.</font>call<font color="#990000">;</font>
        <font color="#FF0000">}</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          optiondata <font color="#990000">=</font> <b><font color="#000000">option_put</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
          putLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]</font> <font color="#990000">=</font> optiondata<font color="#990000">.</font>put<font color="#990000">;</font>
        <font color="#FF0000">}</font>

        <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textMonthLeg2<font color="#990000">[</font>totalCounter<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font><font color="#FF0000">"%s%2d %04.0f"</font><font color="#990000">,</font>mon<font color="#990000">[*</font>properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">],*</font>properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)*</font>properties<font color="#990000">-&gt;</font>expiration_year2 <font color="#990000">+</font> <font color="#993399">2000</font><font color="#990000">);</font>

        <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textMonthLeg2<font color="#990000">[</font>totalCounter<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font><font color="#FF0000">"%s%2d %04.0f"</font><font color="#990000">,</font>mon<font color="#990000">[*</font>properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">],*</font>properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)*</font>properties<font color="#990000">-&gt;</font>expiration_year2 <font color="#990000">+</font> <font color="#993399">2000</font><font color="#990000">);</font>

        properties<font color="#990000">-&gt;</font>time_to_expiration2<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_year2<font color="#990000">++;</font>

        totalCounter<font color="#990000">++;</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> index<font color="#990000">++</font> <font color="#990000">&gt;=</font> <font color="#993399">18</font> <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
        <font color="#FF0000">}</font>
      <font color="#FF0000">}</font>
      <i><font color="#9A1900">//////////////////////////////////////////////////////////////////////////////////////////////////////////////////</font></i>

      <i><font color="#9A1900">/* reset pointers */</font></i>
      properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_month2<font color="#990000">;</font>
      properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_days_to_expiration2<font color="#990000">;</font>
      properties<font color="#990000">-&gt;</font>expiration_year2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_year2<font color="#990000">;</font>
      properties<font color="#990000">-&gt;</font>time_to_expiration2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_time_to_expiration2<font color="#990000">;</font>
    <font color="#FF0000">}</font>

    index <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
    totalCounter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
    <b><font color="#0000FF">while</font></b><font color="#990000">(</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <font color="#009900">double</font> i <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike<font color="#990000">));</font>
      cumStrikeLeg1 <font color="#990000">+=</font> i<font color="#990000">;</font>

      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
         properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike2<font color="#990000">));</font>
      <b><font color="#0000FF">else</font></b>
         properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> i<font color="#990000">;</font>

      <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
        <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrike<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>

      <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPrice <font color="#990000">)</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPrice<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>price<font color="#990000">);</font>

      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <b><font color="#000000">adjust_to_current_time_and_expr</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>expiration_time<font color="#990000">,</font><font color="#993399">0</font><font color="#990000">);</font>
      <i><font color="#9A1900">//g_print("t = %.*f\t%s\n",15,(double)properties-&gt;data.t[0],decimal_date_to_real_date(properties-&gt;data.t[0]));</font></i>
      
      <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> optiondata<font color="#990000">;</font>
          
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        optiondata <font color="#990000">=</font> <b><font color="#000000">option_call</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
        <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>call<font color="#990000">);</font>
      <font color="#FF0000">}</font>

      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        optiondata <font color="#990000">=</font> <b><font color="#000000">option_put</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
        <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>put<font color="#990000">);</font>
      <font color="#FF0000">}</font>

      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textMonth<font color="#990000">,</font><font color="#FF0000">"%s%2d %04.0f"</font><font color="#990000">,</font>mon<font color="#990000">[*</font>properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">],*</font>properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)*</font>properties<font color="#990000">-&gt;</font>expiration_year <font color="#990000">+</font> <font color="#993399">2000</font><font color="#990000">);</font>

      <font color="#009900">char</font> textDecimalDate<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font>  <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textDecimalDate<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>

      <font color="#009900">char</font> textDaysToExpr<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textDaysToExpr<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,(</font><font color="#993399">365</font><font color="#990000">*</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]));</font>

      <b><font color="#000000">process_greeks</font></b><font color="#990000">(</font>properties<font color="#990000">,</font> <font color="#990000">&amp;</font>textCallDelta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textPutDelta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textGamma<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textVega<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textCallTheta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textPutTheta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textCallRho<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textPutRho<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>

      <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
        <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textLegacyCall<font color="#990000">,</font><font color="#FF0000">"%s%c"</font><font color="#990000">,</font>option_calls<font color="#990000">[</font><b><font color="#000000">decimal_date_to_int_month</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">])],(</font><font color="#009900">char</font><font color="#990000">)</font> <b><font color="#000000">strike_price_codes</font></b><font color="#990000">(</font>i<font color="#990000">));</font>
      <b><font color="#0000FF">else</font></b>
        <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textLegacyCall<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font>option_calls<font color="#990000">[</font><b><font color="#000000">decimal_date_to_int_month</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">])]);</font>

      <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
        <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textLegacyPut<font color="#990000">,</font><font color="#FF0000">"%s%c"</font><font color="#990000">,</font>option_puts<font color="#990000">[</font><b><font color="#000000">decimal_date_to_int_month</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">])],(</font><font color="#009900">char</font><font color="#990000">)</font> <b><font color="#000000">strike_price_codes</font></b><font color="#990000">(</font>i<font color="#990000">));</font>
      <b><font color="#0000FF">else</font></b>
        <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textLegacyPut<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font>option_puts<font color="#990000">[</font><b><font color="#000000">decimal_date_to_int_month</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">])]);</font>
 
      <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>

      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> textPrice<font color="#990000">,</font> X2<font color="#990000">,</font> textMonth<font color="#990000">,</font> X3<font color="#990000">,</font> textStrike<font color="#990000">,</font> X4<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X5<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X6<font color="#990000">,</font> textDaysToExpr<font color="#990000">,</font> X7<font color="#990000">,</font> textDecimalDate<font color="#990000">,</font> X8<font color="#990000">,</font> textCallDelta<font color="#990000">,</font> X9<font color="#990000">,</font> textPutDelta<font color="#990000">,</font> X10<font color="#990000">,</font> textGamma<font color="#990000">,</font> X11<font color="#990000">,</font> textVega<font color="#990000">,</font> X12<font color="#990000">,</font> textCallTheta<font color="#990000">,</font> X13<font color="#990000">,</font> textPutTheta<font color="#990000">,</font> X14<font color="#990000">,</font> textCallRho<font color="#990000">,</font> X15<font color="#990000">,</font> textPutRho<font color="#990000">,</font> X16<font color="#990000">,</font> textLegacyCall<font color="#990000">,</font> X17<font color="#990000">,</font> textLegacyPut<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>textExport <font color="#990000">==</font> <b><font color="#0000FF">true</font></b> <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>
textPrice<font color="#990000">,</font> textMonth<font color="#990000">,</font> textStrike<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textDaysToExpr<font color="#990000">,</font> textDecimalDate<font color="#990000">,</font> textCallDelta<font color="#990000">,</font> textPutDelta<font color="#990000">,</font> textGamma<font color="#990000">,</font> textVega<font color="#990000">,</font> textCallTheta<font color="#990000">,</font> textPutTheta<font color="#990000">,</font> textCallRho<font color="#990000">,</font> textPutRho<font color="#990000">,</font> textLegacyCall<font color="#990000">,</font> textLegacyPut<font color="#990000">);</font>
          <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
        <font color="#FF0000">}</font>

      <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <font color="#009900">char</font> textCallLeg2<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
        <font color="#009900">char</font> textPutLeg2<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
        <font color="#009900">char</font> textCallCallSpread<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
        <font color="#009900">char</font> textPutPutSpread<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
        <font color="#009900">char</font> textCallPutSpread<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
        <font color="#009900">char</font> textPutCallSpread<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textCallLeg2<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>callLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textCallCallSpread<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>call <font color="#990000">-</font> callLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
        <font color="#FF0000">}</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPutLeg2<font color="#990000">,</font> <font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>putLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPutPutSpread<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>put <font color="#990000">-</font> putLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
        <font color="#FF0000">}</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">&amp;&amp;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textCallPutSpread<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font> optiondata<font color="#990000">.</font>call <font color="#990000">-</font> putLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPutCallSpread<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font> optiondata<font color="#990000">.</font>put  <font color="#990000">-</font> callLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
        <font color="#FF0000">}</font>

        <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> textPrice<font color="#990000">,</font> X2<font color="#990000">,</font> textMonth<font color="#990000">,</font> X3<font color="#990000">,</font> textStrike<font color="#990000">,</font> X4<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X5<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X6<font color="#990000">,</font> textMonthLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font> X7<font color="#990000">,</font> textStrikeLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font> X8<font color="#990000">,</font> textCallLeg2<font color="#990000">,</font> X9<font color="#990000">,</font> textPutLeg2<font color="#990000">,</font> X10<font color="#990000">,</font> textCallCallSpread<font color="#990000">,</font> X11<font color="#990000">,</font> textPutPutSpread<font color="#990000">,</font> X12<font color="#990000">,</font> textCallPutSpread<font color="#990000">,</font> X13<font color="#990000">,</font> textPutCallSpread<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>textExport <font color="#990000">==</font> <b><font color="#0000FF">true</font></b> <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>
                textPrice<font color="#990000">,</font> textMonth<font color="#990000">,</font> textStrike<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textMonthLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font> textStrikeLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font> textCallLeg2<font color="#990000">,</font> textPutLeg2<font color="#990000">,</font> textCallCallSpread<font color="#990000">,</font> textPutPutSpread<font color="#990000">,</font> textCallPutSpread<font color="#990000">,</font> textPutCallSpread<font color="#990000">);</font>
          <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
        <font color="#FF0000">}</font>

      <font color="#FF0000">}</font>

      properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">++;</font>

      totalCounter<font color="#990000">++;</font>

      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> index<font color="#990000">++</font> <font color="#990000">&gt;=</font> <font color="#993399">18</font> <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <i><font color="#9A1900">/* reset pointers */</font></i>
    properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_month<font color="#990000">;</font>
    properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_days_to_expiration<font color="#990000">;</font>
    properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_year<font color="#990000">;</font>
    properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_time_to_expiration<font color="#990000">;</font>

    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"cumStrikeLeg1 = %f, cumStrikeLeg2 = %f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>cumStrikeLeg1<font color="#990000">,</font>cumStrikeLeg2<font color="#990000">);</font>
    properties<font color="#990000">-&gt;</font>verticalSpread <font color="#990000">=</font> <font color="#990000">(</font> cumStrikeLeg1 <font color="#990000">!=</font> cumStrikeLeg2 <font color="#990000">);</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"properties-&gt;verticalSpread = %d</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>verticalSpread<font color="#990000">);</font>

  <font color="#FF0000">}</font>
  <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>format <font color="#990000">==</font> CALENDAR_OPTIONS6 <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"CALENDAR_OPTIONS6</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>

    <font color="#009900">int</font> counter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

    <font color="#009900">double</font> epsilon <font color="#990000">=</font> <font color="#990000">(</font><font color="#009900">double</font><font color="#990000">)</font> <font color="#993399">1</font> <font color="#990000">/</font> <b><font color="#000000">pow</font></b><font color="#990000">(</font><font color="#993399">10.0</font><font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">);</font>
    <font color="#009900">double</font> i<font color="#990000">;</font>
    index <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
    <b><font color="#0000FF">for</font></b><font color="#990000">(</font>i<font color="#990000">=(</font>properties<font color="#990000">-&gt;</font>strike_offset<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">-</font><font color="#993399">35</font><font color="#990000">/(</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">));</font>i<font color="#990000">&lt;(</font>properties<font color="#990000">-&gt;</font>strike_offset<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">+</font><font color="#993399">160</font><font color="#990000">);</font>i<font color="#990000">+=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor<font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">(((</font><font color="#009900">int</font><font color="#990000">)</font>i<font color="#990000">%</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">0</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(</font><b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)!=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>retdiscard<font color="#990000">))</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">2.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">7.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">12.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">17.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">22.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">27.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font>
        <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> i <font color="#990000">&lt;=</font> <font color="#993399">0</font> <font color="#990000">||</font> <b><font color="#000000">fabs</font></b><font color="#990000">(</font>i<font color="#990000">-</font><font color="#993399">0.0</font><font color="#990000">)</font> <font color="#990000">&lt;</font> epsilon <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          i <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
        
          <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1 <font color="#990000">!=</font> <font color="#993399">5</font> <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">+</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>xcontrol<font color="#990000">;</font>
            <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
            <font color="#FF0000">{</font>
              properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">+</font> <font color="#993399">2.5</font><font color="#990000">;</font>
            <font color="#FF0000">}</font>
          <font color="#FF0000">}</font>
          <b><font color="#0000FF">continue</font></b><font color="#990000">;</font>
        <font color="#FF0000">}</font>

        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPrice <font color="#990000">)</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPrice<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>price<font color="#990000">);</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
          properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike2<font color="#990000">));</font>
        <b><font color="#0000FF">else</font></b>
         properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> i<font color="#990000">;</font>

        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)</font> <font color="#990000">==</font> <font color="#990000">.</font><font color="#993399">5</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrike<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
          <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
          <font color="#FF0000">{</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrike<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
          <font color="#FF0000">}</font>
        <font color="#FF0000">}</font>

        counter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

        <b><font color="#0000FF">while</font></b><font color="#990000">(</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <b><font color="#000000">adjust_to_current_time_and_expr</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>expiration_time<font color="#990000">,</font><font color="#993399">0</font><font color="#990000">);</font>
          <i><font color="#9A1900">//g_print("t = %.*f\t%s\n",15,(double)properties-&gt;data.t[0],decimal_date_to_real_date(properties-&gt;data.t[0]));</font></i>

          <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> optiondata<font color="#990000">;</font>

          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            optiondata <font color="#990000">=</font> <b><font color="#000000">option_call</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textCall<font color="#990000">[</font>counter<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>call<font color="#990000">);</font>
          <font color="#FF0000">}</font>
          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            optiondata <font color="#990000">=</font> <b><font color="#000000">option_put</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textPut<font color="#990000">[</font>counter<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>put<font color="#990000">);</font>
          <font color="#FF0000">}</font>

          properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">++;</font>

          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">++</font>counter <font color="#990000">&gt;=</font> <font color="#993399">3</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
          <font color="#FF0000">}</font>
        <font color="#FF0000">}</font>

        <i><font color="#9A1900">/* reset pointers */</font></i>
        properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_month<font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_days_to_expiration<font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_year<font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_time_to_expiration<font color="#990000">;</font>
        
        <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
        <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> textPrice<font color="#990000">,</font> X2<font color="#990000">,</font> textStrike<font color="#990000">,</font> X3<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X4<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">],</font> X5<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">2</font><font color="#990000">],</font> X6<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X7<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">],</font> X8<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">2</font><font color="#990000">],</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>textExport <font color="#990000">==</font> <b><font color="#0000FF">true</font></b> <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">" %s, %s, %s, %s, %s, %s, %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>
                textPrice<font color="#990000">,</font> textStrike<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textCall<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">],</font> textCall<font color="#990000">[</font><font color="#993399">2</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">2</font><font color="#990000">]);</font>
          <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
        <font color="#FF0000">}</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> index<font color="#990000">++</font> <font color="#990000">&gt;=</font> <font color="#993399">17</font> <font color="#990000">)</font>
          <b><font color="#0000FF">break</font></b><font color="#990000">;</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">!</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
          <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>format <font color="#990000">==</font> CALENDAR_OPTIONS5 <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"CALENDAR_OPTIONS5</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>
    <font color="#009900">int</font> counter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

    <font color="#009900">double</font> epsilon <font color="#990000">=</font> <font color="#990000">(</font><font color="#009900">double</font><font color="#990000">)</font> <font color="#993399">1</font> <font color="#990000">/</font> <b><font color="#000000">pow</font></b><font color="#990000">(</font><font color="#993399">10.0</font><font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">);</font>
    <font color="#009900">double</font> i<font color="#990000">;</font>
    index <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">)</font>
    <b><font color="#0000FF">for</font></b><font color="#990000">(</font>i<font color="#990000">=(</font>properties<font color="#990000">-&gt;</font>strike_offset<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">-</font><font color="#993399">35</font><font color="#990000">/(</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">));</font>i<font color="#990000">&lt;(</font>properties<font color="#990000">-&gt;</font>strike_offset<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">+</font><font color="#993399">160</font><font color="#990000">);</font>i<font color="#990000">+=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor<font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">(((</font><font color="#009900">int</font><font color="#990000">)</font>i<font color="#990000">%</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">0</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(</font><b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)!=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>retdiscard<font color="#990000">))</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">2.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">7.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">12.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">17.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">22.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">27.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font>
        <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> i <font color="#990000">&lt;=</font> <font color="#993399">0</font> <font color="#990000">||</font> <b><font color="#000000">fabs</font></b><font color="#990000">(</font>i<font color="#990000">-</font><font color="#993399">0.0</font><font color="#990000">)</font> <font color="#990000">&lt;</font> epsilon <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          i <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1 <font color="#990000">!=</font> <font color="#993399">5</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">+</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>xcontrol<font color="#990000">;</font>
          <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
          <font color="#FF0000">{</font>
             properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">+</font> <font color="#993399">2.5</font><font color="#990000">;</font>
          <font color="#FF0000">}</font>
          <b><font color="#0000FF">continue</font></b><font color="#990000">;</font>
        <font color="#FF0000">}</font>

        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPrice <font color="#990000">)</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPrice<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>price<font color="#990000">);</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
          properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike2<font color="#990000">));</font>
        <b><font color="#0000FF">else</font></b>
         properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> i<font color="#990000">;</font>

        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>        
        <font color="#FF0000">{</font>
          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)</font> <font color="#990000">==</font> <font color="#990000">.</font><font color="#993399">5</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrike<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
          <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
          <font color="#FF0000">{</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrike<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
          <font color="#FF0000">}</font>
        <font color="#FF0000">}</font>

        counter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
        <b><font color="#0000FF">while</font></b><font color="#990000">(</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">)</font>
        <font color="#FF0000">{</font>         
          properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <b><font color="#000000">adjust_to_current_time_and_expr</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>expiration_time<font color="#990000">,</font><font color="#993399">0</font><font color="#990000">);</font>
          <i><font color="#9A1900">//g_print("t = %.*f\t%s\n",15,(double)properties-&gt;data.t[0],decimal_date_to_real_date(properties-&gt;data.t[0]));</font></i>
      
          <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> optiondata<font color="#990000">;</font>
          
          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            optiondata <font color="#990000">=</font> <b><font color="#000000">option_call</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textCall<font color="#990000">[</font>counter<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font><font color="#FF0000">"%c %.*f"</font><font color="#990000">,</font><b><font color="#000000">tolower</font></b><font color="#990000">(</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>call<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]),</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>call<font color="#990000">);</font>
          <font color="#FF0000">}</font>

          properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">++;</font>

          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">++</font>counter <font color="#990000">&gt;=</font> <font color="#993399">8</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
          <font color="#FF0000">}</font>
        <font color="#FF0000">}</font>
        <i><font color="#9A1900">/* reset pointers */</font></i>
        properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_month<font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_days_to_expiration<font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_year<font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_time_to_expiration<font color="#990000">;</font>

        <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
        <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> textPrice<font color="#990000">,</font> X2<font color="#990000">,</font> textStrike<font color="#990000">,</font> X3<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X4<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">],</font> X5<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">2</font><font color="#990000">],</font> X6<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">3</font><font color="#990000">],</font> X7<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">4</font><font color="#990000">],</font> X8<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">5</font><font color="#990000">],</font> X9<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">6</font><font color="#990000">],</font> X10<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">7</font><font color="#990000">],</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>textExport <font color="#990000">==</font> <b><font color="#0000FF">true</font></b> <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"%s, %s, %s, %s, %s, %s, %s, %s, %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font> 
                textPrice<font color="#990000">,</font> textStrike<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textCall<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">],</font> textCall<font color="#990000">[</font><font color="#993399">2</font><font color="#990000">],</font> textCall<font color="#990000">[</font><font color="#993399">3</font><font color="#990000">],</font> textCall<font color="#990000">[</font><font color="#993399">4</font><font color="#990000">],</font> textCall<font color="#990000">[</font><font color="#993399">5</font><font color="#990000">],</font> textCall<font color="#990000">[</font><font color="#993399">6</font><font color="#990000">],</font> textCall<font color="#990000">[</font><font color="#993399">7</font><font color="#990000">]);</font>
          <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
        <font color="#FF0000">}</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> index<font color="#990000">++</font> <font color="#990000">&gt;=</font> <font color="#993399">8</font> <font color="#990000">)</font>
          <b><font color="#0000FF">break</font></b><font color="#990000">;</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">!</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
          <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>
    <i><font color="#9A1900">///////////////////////////////////////////////////////////////////////////////////////////////////////////////</font></i>
    index <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
    <b><font color="#0000FF">for</font></b><font color="#990000">(</font>i<font color="#990000">=(</font>properties<font color="#990000">-&gt;</font>strike_offset<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">-</font><font color="#993399">35</font><font color="#990000">/(</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">));</font>i<font color="#990000">&lt;(</font>properties<font color="#990000">-&gt;</font>strike_offset<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">+</font><font color="#993399">160</font><font color="#990000">);</font>i<font color="#990000">+=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor<font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">(((</font><font color="#009900">int</font><font color="#990000">)</font>i<font color="#990000">%</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">0</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(</font><b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)!=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>retdiscard<font color="#990000">))</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">2.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">7.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">12.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">17.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">22.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">27.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font>
        <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> i <font color="#990000">&lt;=</font> <font color="#993399">0</font> <font color="#990000">||</font> <b><font color="#000000">fabs</font></b><font color="#990000">(</font>i<font color="#990000">-</font><font color="#993399">0.0</font><font color="#990000">)</font> <font color="#990000">&lt;</font> epsilon <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          i <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
        
          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1 <font color="#990000">!=</font> <font color="#993399">5</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">+</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>xcontrol<font color="#990000">;</font>
          <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
          <font color="#FF0000">{</font>
            properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">+</font> <font color="#993399">2.5</font><font color="#990000">;</font>
          <font color="#FF0000">}</font>
          <b><font color="#0000FF">continue</font></b><font color="#990000">;</font>
        <font color="#FF0000">}</font>

        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPrice <font color="#990000">)</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPrice<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>price<font color="#990000">);</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
          properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike2<font color="#990000">));</font>
        <b><font color="#0000FF">else</font></b>
         properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> i<font color="#990000">;</font>

        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)</font> <font color="#990000">==</font> <font color="#990000">.</font><font color="#993399">5</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrike<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
          <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
          <font color="#FF0000">{</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrike<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
          <font color="#FF0000">}</font>
        <font color="#FF0000">}</font>

        counter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

        <b><font color="#0000FF">while</font></b><font color="#990000">(</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">)</font>
        <font color="#FF0000">{</font>         
          properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <b><font color="#000000">adjust_to_current_time_and_expr</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>expiration_time<font color="#990000">,</font><font color="#993399">0</font><font color="#990000">);</font>
          <i><font color="#9A1900">//g_print("t = %.*f\t%s\n",15,(double)properties-&gt;data.t[0],decimal_date_to_real_date(properties-&gt;data.t[0]));</font></i>
      
          <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> optiondata<font color="#990000">;</font>
          
          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            optiondata <font color="#990000">=</font> <b><font color="#000000">option_put</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textPut<font color="#990000">[</font>counter<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font><font color="#FF0000">"%c %.*f"</font><font color="#990000">,</font><b><font color="#000000">tolower</font></b><font color="#990000">(</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>put<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]),</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>put<font color="#990000">);</font>
          <font color="#FF0000">}</font>

          properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">++;</font>

          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">++</font>counter <font color="#990000">&gt;=</font> <font color="#993399">8</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
          <font color="#FF0000">}</font>
        <font color="#FF0000">}</font>
        <i><font color="#9A1900">/* reset pointers */</font></i>
        properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_month<font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_days_to_expiration<font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_year<font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_time_to_expiration<font color="#990000">;</font>

        <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>
        <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> textPrice<font color="#990000">,</font> X2<font color="#990000">,</font> textStrike<font color="#990000">,</font> X3<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X4<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">],</font> X5<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">2</font><font color="#990000">],</font> X6<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">3</font><font color="#990000">],</font> X7<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">4</font><font color="#990000">],</font> X8<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">5</font><font color="#990000">],</font> X9<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">6</font><font color="#990000">],</font> X10<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">7</font><font color="#990000">],</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>textExport <font color="#990000">==</font> <b><font color="#0000FF">true</font></b> <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"%s, %s, %s, %s, %s, %s, %s, %s, %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>
                textPrice<font color="#990000">,</font> textStrike<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">2</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">3</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">4</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">5</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">6</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">7</font><font color="#990000">]);</font>
          <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
        <font color="#FF0000">}</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> index<font color="#990000">++</font> <font color="#990000">&gt;=</font> <font color="#993399">8</font> <font color="#990000">)</font>
          <b><font color="#0000FF">break</font></b><font color="#990000">;</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">!</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
          <b><font color="#0000FF">break</font></b><font color="#990000">;</font>

        <i><font color="#9A1900">//g_print("index = %d\n",index);</font></i>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>format <font color="#990000">==</font> CALENDAR_OPTIONS4 <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"CALENDAR_OPTIONS4</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>
    <font color="#009900">int</font> counter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      totalCounter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
      <font color="#009900">double</font> epsilon <font color="#990000">=</font> <font color="#990000">(</font><font color="#009900">double</font><font color="#990000">)</font> <font color="#993399">1</font> <font color="#990000">/</font> <b><font color="#000000">pow</font></b><font color="#990000">(</font><font color="#993399">10.0</font><font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">);</font>
      <font color="#009900">double</font> i<font color="#990000">;</font>
      index <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

      <b><font color="#0000FF">for</font></b><font color="#990000">(</font>i<font color="#990000">=(</font>properties<font color="#990000">-&gt;</font>strike_offset2<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">-</font><font color="#993399">35</font><font color="#990000">/(</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">));</font>i<font color="#990000">&lt;(</font>properties<font color="#990000">-&gt;</font>strike_offset2<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">+</font><font color="#993399">160</font><font color="#990000">);</font>i<font color="#990000">+=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor<font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">(((</font><font color="#009900">int</font><font color="#990000">)</font>i<font color="#990000">%</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">0</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(</font><b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)!=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>retdiscard<font color="#990000">))</font> <font color="#990000">||</font>
            <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">2.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
            <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">7.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
            <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">12.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
            <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">17.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
            <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">22.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
            <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">27.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font>
          <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> i <font color="#990000">&lt;=</font> <font color="#993399">0</font> <font color="#990000">||</font> <b><font color="#000000">fabs</font></b><font color="#990000">(</font>i<font color="#990000">-</font><font color="#993399">0.0</font><font color="#990000">)</font> <font color="#990000">&lt;</font> epsilon <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            i <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
        
            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1 <font color="#990000">!=</font> <font color="#993399">5</font> <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              properties<font color="#990000">-&gt;</font>strike_offset2 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset2 <font color="#990000">+</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>xcontrol<font color="#990000">;</font>
            <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
            <font color="#FF0000">{</font>
              properties<font color="#990000">-&gt;</font>strike_offset2 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset2 <font color="#990000">+</font> <font color="#993399">2.5</font><font color="#990000">;</font>
            <font color="#FF0000">}</font>
            <b><font color="#0000FF">continue</font></b><font color="#990000">;</font>
          <font color="#FF0000">}</font>

          cumStrikeLeg2 <font color="#990000">+=</font> i<font color="#990000">;</font>
          <i><font color="#9A1900">//g_print("t = %.*f\t%s\n",15,(double)properties-&gt;data.t[0],decimal_date_to_real_date(properties-&gt;data.t[0]));</font></i>

          counter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
          <b><font color="#0000FF">while</font></b><font color="#990000">(</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_year2<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">)</font>
            <font color="#FF0000">{</font>
               properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike2<font color="#990000">));</font>
               cumStrikeLeg2 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">;</font>
            <font color="#FF0000">}</font>
            <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
            <font color="#FF0000">{</font>
               properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike<font color="#990000">));</font>
               cumStrikeLeg2 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">;</font>
            <font color="#FF0000">}</font>
            <b><font color="#0000FF">else</font></b>
               properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> i<font color="#990000">;</font>

            <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)</font> <font color="#990000">==</font> <font color="#990000">.</font><font color="#993399">5</font> <font color="#990000">)</font>
              <font color="#FF0000">{</font>
                <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrikeLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
              <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
              <font color="#FF0000">{</font>
                <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrikeLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
              <font color="#FF0000">}</font>

              <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"textStrikeLeg2[totalCounter] = %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>textStrikeLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
            <font color="#FF0000">}</font>

            properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <b><font color="#000000">adjust_to_current_time_and_expr</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>time_to_expiration2<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>expiration_time<font color="#990000">,</font><font color="#993399">0</font><font color="#990000">);</font>

            <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> optiondata<font color="#990000">;</font>
          
            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              optiondata <font color="#990000">=</font> <b><font color="#000000">option_call</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
              callLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]</font> <font color="#990000">=</font> optiondata<font color="#990000">.</font>call<font color="#990000">;</font>
            <font color="#FF0000">}</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              optiondata <font color="#990000">=</font> <b><font color="#000000">option_put</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
              putLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]</font> <font color="#990000">=</font> optiondata<font color="#990000">.</font>put<font color="#990000">;</font>
            <font color="#FF0000">}</font>

            <i><font color="#9A1900">//sprintf(textMonth,"%s%2d %04.0f",mon[*properties-&gt;expiration_month],*properties-&gt;days_to_expiration,(double)*properties-&gt;expiration_year + 2000);</font></i>

            <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textMonthLeg2<font color="#990000">[</font>totalCounter<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font><font color="#FF0000">"%s%2d %04.0f"</font><font color="#990000">,</font>mon<font color="#990000">[*</font>properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">],*</font>properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)*</font>properties<font color="#990000">-&gt;</font>expiration_year2 <font color="#990000">+</font> <font color="#993399">2000</font><font color="#990000">);</font>

            properties<font color="#990000">-&gt;</font>time_to_expiration2<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_year2<font color="#990000">++;</font>

            totalCounter<font color="#990000">++;</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">++</font>counter <font color="#990000">&gt;=</font> <font color="#993399">4</font> <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
            <font color="#FF0000">}</font>            
          <font color="#FF0000">}</font>

          <i><font color="#9A1900">/* reset pointers */</font></i>
          properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_month2<font color="#990000">;</font>
          properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_days_to_expiration2<font color="#990000">;</font>
          properties<font color="#990000">-&gt;</font>expiration_year2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_year2<font color="#990000">;</font>
          properties<font color="#990000">-&gt;</font>time_to_expiration2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_time_to_expiration2<font color="#990000">;</font>

          <b><font color="#0000FF">if</font></b><font color="#990000">(</font>index<font color="#990000">++</font> <font color="#990000">&gt;=</font> <font color="#993399">4</font><font color="#990000">)</font>
            <b><font color="#0000FF">break</font></b><font color="#990000">;</font>

          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">!</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
            <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
        <font color="#FF0000">}</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <font color="#009900">double</font> epsilon <font color="#990000">=</font> <font color="#990000">(</font><font color="#009900">double</font><font color="#990000">)</font> <font color="#993399">1</font> <font color="#990000">/</font> <b><font color="#000000">pow</font></b><font color="#990000">(</font><font color="#993399">10.0</font><font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">);</font>
    <font color="#009900">double</font> i<font color="#990000">;</font>
    index <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
    totalCounter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
    <b><font color="#0000FF">for</font></b><font color="#990000">(</font>i<font color="#990000">=(</font>properties<font color="#990000">-&gt;</font>strike_offset<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">-</font><font color="#993399">35</font><font color="#990000">/(</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">));</font>i<font color="#990000">&lt;(</font>properties<font color="#990000">-&gt;</font>strike_offset<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">+</font><font color="#993399">160</font><font color="#990000">);</font>i<font color="#990000">+=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor<font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">(((</font><font color="#009900">int</font><font color="#990000">)</font>i<font color="#990000">%</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">0</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(</font><b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)!=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>retdiscard<font color="#990000">))</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">2.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">7.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">12.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">17.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">22.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">27.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font>
        <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> i <font color="#990000">&lt;=</font> <font color="#993399">0</font> <font color="#990000">||</font> <b><font color="#000000">fabs</font></b><font color="#990000">(</font>i<font color="#990000">-</font><font color="#993399">0.0</font><font color="#990000">)</font> <font color="#990000">&lt;</font> epsilon <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          i <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
        
          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1 <font color="#990000">!=</font> <font color="#993399">5</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">+</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>xcontrol<font color="#990000">;</font>
          <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
          <font color="#FF0000">{</font>
            properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">+</font> <font color="#993399">2.5</font><font color="#990000">;</font>
          <font color="#FF0000">}</font>
          <b><font color="#0000FF">continue</font></b><font color="#990000">;</font>
        <font color="#FF0000">}</font>

        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPrice <font color="#990000">)</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPrice<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>price<font color="#990000">);</font>

        cumStrikeLeg1 <font color="#990000">+=</font> i<font color="#990000">;</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike<font color="#990000">));</font>
          cumStrikeLeg1 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">;</font>
        <font color="#FF0000">}</font>
        <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike2<font color="#990000">));</font>
          cumStrikeLeg1 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">;</font>
        <font color="#FF0000">}</font>
        <b><font color="#0000FF">else</font></b>
          properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> i<font color="#990000">;</font>

        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)</font> <font color="#990000">==</font> <font color="#990000">.</font><font color="#993399">5</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrike<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
          <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
          <font color="#FF0000">{</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrike<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
          <font color="#FF0000">}</font>
        <font color="#FF0000">}</font>

        counter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
        <b><font color="#0000FF">while</font></b><font color="#990000">(</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">)</font>
        <font color="#FF0000">{</font>         
          properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <b><font color="#000000">adjust_to_current_time_and_expr</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>expiration_time<font color="#990000">,</font><font color="#993399">0</font><font color="#990000">);</font>
          <i><font color="#9A1900">//g_print("t = %.*f\t%s\n",15,(double)properties-&gt;data.t[0],decimal_date_to_real_date(properties-&gt;data.t[0]));</font></i>
      
          <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> optiondata<font color="#990000">;</font>
          
          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            optiondata <font color="#990000">=</font> <b><font color="#000000">option_call</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>call<font color="#990000">);</font>
          <font color="#FF0000">}</font>
          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            optiondata <font color="#990000">=</font> <b><font color="#000000">option_put</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>put<font color="#990000">);</font>
          <font color="#FF0000">}</font>

          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textMonth<font color="#990000">,</font><font color="#FF0000">"%s%2d %04.0f"</font><font color="#990000">,</font>mon<font color="#990000">[*</font>properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">],*</font>properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)*</font>properties<font color="#990000">-&gt;</font>expiration_year <font color="#990000">+</font> <font color="#993399">2000</font><font color="#990000">);</font>

          <font color="#009900">char</font> textDecimalDate<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textDecimalDate<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>

          <font color="#009900">char</font> textDaysToExpr<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textDaysToExpr<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,(</font><font color="#993399">365</font><font color="#990000">*</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]));</font>

          <b><font color="#000000">process_greeks</font></b><font color="#990000">(</font>properties<font color="#990000">,</font> <font color="#990000">&amp;</font>textCallDelta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textPutDelta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textGamma<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textVega<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textCallTheta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textPutTheta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textCallRho<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textPutRho<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>

          <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textLegacyCall<font color="#990000">,</font><font color="#FF0000">"%s%c"</font><font color="#990000">,</font>option_calls<font color="#990000">[</font><b><font color="#000000">decimal_date_to_int_month</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">])],(</font><font color="#009900">char</font><font color="#990000">)</font> <b><font color="#000000">strike_price_codes</font></b><font color="#990000">(</font>i<font color="#990000">));</font>
          <b><font color="#0000FF">else</font></b>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textLegacyCall<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font>option_calls<font color="#990000">[</font><b><font color="#000000">decimal_date_to_int_month</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">])]);</font> 

          <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textLegacyPut<font color="#990000">,</font><font color="#FF0000">"%s%c"</font><font color="#990000">,</font>option_puts<font color="#990000">[</font><b><font color="#000000">decimal_date_to_int_month</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">])],(</font><font color="#009900">char</font><font color="#990000">)</font> <b><font color="#000000">strike_price_codes</font></b><font color="#990000">(</font>i<font color="#990000">));</font>
          <b><font color="#0000FF">else</font></b>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textLegacyPut<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font>option_puts<font color="#990000">[</font><b><font color="#000000">decimal_date_to_int_month</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">])]);</font>
 
          <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>

          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> textPrice<font color="#990000">,</font> X2<font color="#990000">,</font> textMonth<font color="#990000">,</font> X3<font color="#990000">,</font> textStrike<font color="#990000">,</font> X4<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X5<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X6<font color="#990000">,</font> textDaysToExpr<font color="#990000">,</font> X7<font color="#990000">,</font> textDecimalDate<font color="#990000">,</font> X8<font color="#990000">,</font> textCallDelta<font color="#990000">,</font> X9<font color="#990000">,</font> textPutDelta<font color="#990000">,</font> X10<font color="#990000">,</font> textGamma<font color="#990000">,</font> X11<font color="#990000">,</font> textVega<font color="#990000">,</font> X12<font color="#990000">,</font> textCallTheta<font color="#990000">,</font> X13<font color="#990000">,</font> textPutTheta<font color="#990000">,</font> X14<font color="#990000">,</font> textCallRho<font color="#990000">,</font> X15<font color="#990000">,</font> textPutRho<font color="#990000">,</font> X16<font color="#990000">,</font> textLegacyCall<font color="#990000">,</font> X17<font color="#990000">,</font> textLegacyPut<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>textExport <font color="#990000">==</font> <b><font color="#0000FF">true</font></b> <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>
                    textPrice<font color="#990000">,</font> textMonth<font color="#990000">,</font> textStrike<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textDaysToExpr<font color="#990000">,</font> textDecimalDate<font color="#990000">,</font> textCallDelta<font color="#990000">,</font> textPutDelta<font color="#990000">,</font> textGamma<font color="#990000">,</font> textVega<font color="#990000">,</font> textCallTheta<font color="#990000">,</font> textPutTheta<font color="#990000">,</font> textCallRho<font color="#990000">,</font> textPutRho<font color="#990000">,</font> textLegacyCall<font color="#990000">,</font> textLegacyPut<font color="#990000">);</font>
              <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
            <font color="#FF0000">}</font>

          <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <i><font color="#9A1900">////////////////////////////////////////////////////////////////////////////////////////////////////////////</font></i>
            <font color="#009900">char</font> textCallLeg2<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
            <font color="#009900">char</font> textPutLeg2<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
            <font color="#009900">char</font> textCallCallSpread<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
            <font color="#009900">char</font> textPutPutSpread<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
            <font color="#009900">char</font> textCallPutSpread<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
            <font color="#009900">char</font> textPutCallSpread<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textCallLeg2<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>callLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textCallCallSpread<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>call <font color="#990000">-</font> callLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
            <font color="#FF0000">}</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPutLeg2<font color="#990000">,</font> <font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>putLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPutPutSpread<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>put <font color="#990000">-</font> putLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
            <font color="#FF0000">}</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">&amp;&amp;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textCallPutSpread<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font> optiondata<font color="#990000">.</font>call <font color="#990000">-</font> putLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPutCallSpread<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font> optiondata<font color="#990000">.</font>put  <font color="#990000">-</font> callLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
            <font color="#FF0000">}</font>

            <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> textPrice<font color="#990000">,</font> X2<font color="#990000">,</font> textMonth<font color="#990000">,</font> X3<font color="#990000">,</font> textStrike<font color="#990000">,</font> X4<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X5<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X6<font color="#990000">,</font> textMonthLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font> X7<font color="#990000">,</font> textStrikeLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font> X8<font color="#990000">,</font> textCallLeg2<font color="#990000">,</font> X9<font color="#990000">,</font> textPutLeg2<font color="#990000">,</font> X10<font color="#990000">,</font> textCallCallSpread<font color="#990000">,</font> X11<font color="#990000">,</font> textPutPutSpread<font color="#990000">,</font> X12<font color="#990000">,</font> textCallPutSpread<font color="#990000">,</font> X13<font color="#990000">,</font> textPutCallSpread<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>textExport <font color="#990000">==</font> <b><font color="#0000FF">true</font></b> <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>
                    textPrice<font color="#990000">,</font> textMonth<font color="#990000">,</font> textStrike<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textMonthLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font> textStrikeLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font> textCallLeg2<font color="#990000">,</font> textPutLeg2<font color="#990000">,</font> textCallCallSpread<font color="#990000">,</font> textPutPutSpread<font color="#990000">,</font> textCallPutSpread<font color="#990000">,</font> textPutCallSpread<font color="#990000">);</font>

              <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
            <font color="#FF0000">}</font>

            totalCounter<font color="#990000">++;</font>
          <font color="#FF0000">}</font>
          
          properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">++;</font>

          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">++</font>counter <font color="#990000">&gt;=</font> <font color="#993399">4</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
          <font color="#FF0000">}</font>
        <font color="#FF0000">}</font>
        <i><font color="#9A1900">/* reset pointers */</font></i>
        properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_month<font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_days_to_expiration<font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_year<font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_time_to_expiration<font color="#990000">;</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> index<font color="#990000">++</font> <font color="#990000">&gt;=</font> <font color="#993399">4</font> <font color="#990000">)</font>
          <b><font color="#0000FF">break</font></b><font color="#990000">;</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">!</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
          <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"cumStrikeLeg1 = %f, cumStrikeLeg2 = %f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>cumStrikeLeg1<font color="#990000">,</font>cumStrikeLeg2<font color="#990000">);</font>
    properties<font color="#990000">-&gt;</font>verticalSpread <font color="#990000">=</font> <font color="#990000">(</font> cumStrikeLeg1 <font color="#990000">!=</font> cumStrikeLeg2 <font color="#990000">);</font>
    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"properties-&gt;verticalSpread = %d</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>verticalSpread<font color="#990000">);</font>

  <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>format <font color="#990000">==</font> CALENDAR_OPTIONS3 <font color="#990000">)</font>
  <font color="#FF0000">{</font>

    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"CALENDAR_OPTIONS3</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">);</font>
    <font color="#009900">int</font> counter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
    <font color="#009900">double</font> i<font color="#990000">;</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      totalCounter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

      <b><font color="#0000FF">while</font></b><font color="#990000">(</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_year2<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">)</font>
      <font color="#FF0000">{</font>         
        <i><font color="#9A1900">///////////////////////////////////////////////////////////////////////////////////////////////////////////////////</font></i>
        <font color="#009900">double</font> epsilon <font color="#990000">=</font> <font color="#990000">(</font><font color="#009900">double</font><font color="#990000">)</font> <font color="#993399">1</font> <font color="#990000">/</font> <b><font color="#000000">pow</font></b><font color="#990000">(</font><font color="#993399">10.0</font><font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">);</font>
        index <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

        <b><font color="#0000FF">for</font></b><font color="#990000">(</font>i<font color="#990000">=(</font>properties<font color="#990000">-&gt;</font>strike_offset2<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">-</font><font color="#993399">35</font><font color="#990000">/(</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">));</font>i<font color="#990000">&lt;(</font>properties<font color="#990000">-&gt;</font>strike_offset2<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">+</font><font color="#993399">160</font><font color="#990000">);</font>i<font color="#990000">+=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor<font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">(((</font><font color="#009900">int</font><font color="#990000">)</font>i<font color="#990000">%</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">0</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(</font><b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)!=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>retdiscard<font color="#990000">))</font> <font color="#990000">||</font>
              <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">2.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
              <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">7.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
              <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">12.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
              <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">17.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
              <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">22.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
              <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">27.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font>
            <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> i <font color="#990000">&lt;=</font> <font color="#993399">0</font> <font color="#990000">||</font> <b><font color="#000000">fabs</font></b><font color="#990000">(</font>i<font color="#990000">-</font><font color="#993399">0.0</font><font color="#990000">)</font> <font color="#990000">&lt;</font> epsilon <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              i <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
        
              <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1 <font color="#990000">!=</font> <font color="#993399">5</font> <font color="#990000">)</font>
              <font color="#FF0000">{</font>
                properties<font color="#990000">-&gt;</font>strike_offset2 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset2 <font color="#990000">+</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>xcontrol<font color="#990000">;</font>
              <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
              <font color="#FF0000">{</font>
                properties<font color="#990000">-&gt;</font>strike_offset2 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset2 <font color="#990000">+</font> <font color="#993399">2.5</font><font color="#990000">;</font>
              <font color="#FF0000">}</font>
              <b><font color="#0000FF">continue</font></b><font color="#990000">;</font>
            <font color="#FF0000">}</font>

            cumStrikeLeg2 <font color="#990000">+=</font> i<font color="#990000">;</font>
            <i><font color="#9A1900">//sprintf(textPrice,"%.*f",properties-&gt;precision,price);</font></i>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">)</font>
            <font color="#FF0000">{</font>
               properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike2<font color="#990000">));</font>
               cumStrikeLeg2 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">;</font>
            <font color="#FF0000">}</font>
            <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
            <font color="#FF0000">{</font>
               properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike<font color="#990000">));</font>
               cumStrikeLeg2 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">;</font>
            <font color="#FF0000">}</font>
            <b><font color="#0000FF">else</font></b>
               properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> i<font color="#990000">;</font>

            <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)</font> <font color="#990000">==</font> <font color="#990000">.</font><font color="#993399">5</font> <font color="#990000">)</font>
              <font color="#FF0000">{</font>
                <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrikeLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
              <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
              <font color="#FF0000">{</font>
                <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrikeLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
              <font color="#FF0000">}</font>
            <font color="#FF0000">}</font>

            properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <b><font color="#000000">adjust_to_current_time_and_expr</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>time_to_expiration2<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>expiration_time<font color="#990000">,</font><font color="#993399">0</font><font color="#990000">);</font>
            <i><font color="#9A1900">//g_print("t = %.*f\t%s\n",15,(double)properties-&gt;data.t[0],decimal_date_to_real_date(properties-&gt;data.t[0]));</font></i>
      
            <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> optiondata<font color="#990000">;</font>
          
            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              optiondata <font color="#990000">=</font> <b><font color="#000000">option_call</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
              callLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]</font> <font color="#990000">=</font> optiondata<font color="#990000">.</font>call<font color="#990000">;</font>
            <font color="#FF0000">}</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              optiondata <font color="#990000">=</font> <b><font color="#000000">option_put</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
              putLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]</font> <font color="#990000">=</font> optiondata<font color="#990000">.</font>put<font color="#990000">;</font>
            <font color="#FF0000">}</font>

            <i><font color="#9A1900">//sprintf(textMonth,"%s%2d %04.0f",mon[*properties-&gt;expiration_month],*properties-&gt;days_to_expiration,(double)*properties-&gt;expiration_year + 2000);</font></i>

            <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textMonthLeg2<font color="#990000">[</font>totalCounter<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font><font color="#FF0000">"%s%2d %04.0f"</font><font color="#990000">,</font>mon<font color="#990000">[*</font>properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">],*</font>properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)*</font>properties<font color="#990000">-&gt;</font>expiration_year2 <font color="#990000">+</font> <font color="#993399">2000</font><font color="#990000">);</font>

            totalCounter<font color="#990000">++;</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> index<font color="#990000">++</font> <font color="#990000">&gt;=</font> <font color="#993399">4</font> <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
            <font color="#FF0000">}</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">!</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
              <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
          <font color="#FF0000">}</font>
        <font color="#FF0000">}</font>
        <i><font color="#9A1900">//////////////////////////////////////////////////////////////////////////////////////////////////////////////////</font></i>

        properties<font color="#990000">-&gt;</font>time_to_expiration2<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_year2<font color="#990000">++;</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">++</font>counter <font color="#990000">&gt;=</font> <font color="#990000">(</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">?</font> <font color="#993399">4</font> <font color="#990000">:</font> <font color="#993399">20</font><font color="#990000">)</font> <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
        <font color="#FF0000">}</font>
      <font color="#FF0000">}</font>

      <i><font color="#9A1900">/* reset pointers */</font></i>
      properties<font color="#990000">-&gt;</font>expiration_month2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_month2<font color="#990000">;</font>
      properties<font color="#990000">-&gt;</font>days_to_expiration2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_days_to_expiration2<font color="#990000">;</font>
      properties<font color="#990000">-&gt;</font>expiration_year2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_year2<font color="#990000">;</font>
      properties<font color="#990000">-&gt;</font>time_to_expiration2<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_time_to_expiration2<font color="#990000">;</font>
    <font color="#FF0000">}</font>

    counter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
    totalCounter <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

    <b><font color="#0000FF">while</font></b><font color="#990000">(</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(*</font>properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">!=-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>         
      <font color="#009900">double</font> epsilon <font color="#990000">=</font> <font color="#990000">(</font><font color="#009900">double</font><font color="#990000">)</font> <font color="#993399">1</font> <font color="#990000">/</font> <b><font color="#000000">pow</font></b><font color="#990000">(</font><font color="#993399">10.0</font><font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">);</font>
      <font color="#009900">double</font> i<font color="#990000">;</font>
      index <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

      <b><font color="#0000FF">for</font></b><font color="#990000">(</font>i<font color="#990000">=(</font>properties<font color="#990000">-&gt;</font>strike_offset<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">-</font><font color="#993399">35</font><font color="#990000">/(</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">));</font>i<font color="#990000">&lt;(</font>properties<font color="#990000">-&gt;</font>strike_offset<font color="#990000">+(</font><font color="#009900">int</font><font color="#990000">)</font>price<font color="#990000">+</font><font color="#993399">160</font><font color="#990000">);</font>i<font color="#990000">+=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor<font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">(((</font><font color="#009900">int</font><font color="#990000">)</font>i<font color="#990000">%</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">0</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> <font color="#990000">(</font><b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)!=</font>strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>retdiscard<font color="#990000">))</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">2.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font> <font color="#993399">7.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">12.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">17.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">22.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font> <font color="#990000">||</font>
          <font color="#990000">((</font>i<font color="#990000">==</font><font color="#993399">27.5</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1<font color="#990000">==</font><font color="#993399">5</font><font color="#990000">)</font>
        <font color="#990000">)</font>
        <font color="#FF0000">{</font>
          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> i <font color="#990000">&lt;=</font> <font color="#993399">0</font> <font color="#990000">||</font> <b><font color="#000000">fabs</font></b><font color="#990000">(</font>i<font color="#990000">-</font><font color="#993399">0.0</font><font color="#990000">)</font> <font color="#990000">&lt;</font> epsilon <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            i <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
        
            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>strikes5or1 <font color="#990000">!=</font> <font color="#993399">5</font> <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">+</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>xcontrol<font color="#990000">;</font>
            <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
            <font color="#FF0000">{</font>
              properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>strike_offset <font color="#990000">+</font> <font color="#993399">2.5</font><font color="#990000">;</font>
            <font color="#FF0000">}</font>
            <b><font color="#0000FF">continue</font></b><font color="#990000">;</font>
          <font color="#FF0000">}</font>

          <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPrice <font color="#990000">)</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPrice<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>price<font color="#990000">);</font>

          cumStrikeLeg1 <font color="#990000">+=</font> i<font color="#990000">;</font>

          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
             properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike<font color="#990000">));</font>
             cumStrikeLeg1 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">;</font>
          <font color="#FF0000">}</font>
          <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>incrementor <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
             properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> <b><font color="#000000">gtk_spin_button_get_value</font></b><font color="#990000">(</font><b><font color="#000000">GTK_SPIN_BUTTON</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>spinbuttonCustomStrike2<font color="#990000">));</font>
             cumStrikeLeg1 <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">;</font>
          <font color="#FF0000">}</font>
          <b><font color="#0000FF">else</font></b>
             properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike <font color="#990000">=</font> i<font color="#990000">;</font>

          <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">modf</font></b><font color="#990000">(</font>i<font color="#990000">,&amp;</font>properties<font color="#990000">-&gt;</font>discard<font color="#990000">)</font> <font color="#990000">==</font> <font color="#990000">.</font><font color="#993399">5</font> <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrike<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
            <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
            <font color="#FF0000">{</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textStrike<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> strike_control<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>strikestoogle<font color="#990000">].</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>strike<font color="#990000">);</font>
            <font color="#FF0000">}</font>
          <font color="#FF0000">}</font>

          properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <b><font color="#000000">adjust_to_current_time_and_expr</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>expiration_time<font color="#990000">,</font><font color="#993399">0</font><font color="#990000">);</font>
          <i><font color="#9A1900">//g_print("t = %.*f\t%s\n",15,(double)properties-&gt;data.t[0],decimal_date_to_real_date(properties-&gt;data.t[0]));</font></i>
      
          <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> optiondata<font color="#990000">;</font>
          
          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            optiondata <font color="#990000">=</font> <b><font color="#000000">option_call</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>call<font color="#990000">);</font>
          <font color="#FF0000">}</font>

          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            optiondata <font color="#990000">=</font> <b><font color="#000000">option_put</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(&amp;</font>textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>put<font color="#990000">);</font>
          <font color="#FF0000">}</font>

          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textMonth<font color="#990000">,</font><font color="#FF0000">"%s%2d %04.0f"</font><font color="#990000">,</font>mon<font color="#990000">[*</font>properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">],*</font>properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">,(</font><font color="#009900">double</font><font color="#990000">)*</font>properties<font color="#990000">-&gt;</font>expiration_year <font color="#990000">+</font> <font color="#993399">2000</font><font color="#990000">);</font>

          <font color="#009900">char</font> textDecimalDate<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textDecimalDate<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>

          <font color="#009900">char</font> textDaysToExpr<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
          <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textDaysToExpr<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,(</font><font color="#993399">365</font><font color="#990000">*</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]));</font>

          <b><font color="#000000">process_greeks</font></b><font color="#990000">(</font>properties<font color="#990000">,</font> <font color="#990000">&amp;</font>textCallDelta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textPutDelta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textGamma<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textVega<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textCallTheta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textPutTheta<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textCallRho<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">&amp;</font>textPutRho<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>

          <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textLegacyCall<font color="#990000">,</font><font color="#FF0000">"%s%c"</font><font color="#990000">,</font>option_calls<font color="#990000">[</font><b><font color="#000000">decimal_date_to_int_month</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">])],(</font><font color="#009900">char</font><font color="#990000">)</font> <b><font color="#000000">strike_price_codes</font></b><font color="#990000">(</font>i<font color="#990000">));</font>
          <b><font color="#0000FF">else</font></b>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textLegacyCall<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font>option_calls<font color="#990000">[</font><b><font color="#000000">decimal_date_to_int_month</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">])]);</font>

          <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textLegacyPut<font color="#990000">,</font><font color="#FF0000">"%s%c"</font><font color="#990000">,</font>option_puts<font color="#990000">[</font><b><font color="#000000">decimal_date_to_int_month</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">])],(</font><font color="#009900">char</font><font color="#990000">)</font> <b><font color="#000000">strike_price_codes</font></b><font color="#990000">(</font>i<font color="#990000">));</font>
          <b><font color="#0000FF">else</font></b>
            <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textLegacyPut<font color="#990000">,</font><font color="#FF0000">"%s"</font><font color="#990000">,</font>option_puts<font color="#990000">[</font><b><font color="#000000">decimal_date_to_int_month</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">])]);</font>
 
          <b><font color="#000000">gtk_list_store_append</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">);</font>

          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> textPrice<font color="#990000">,</font> X2<font color="#990000">,</font> textMonth<font color="#990000">,</font> X3<font color="#990000">,</font> textStrike<font color="#990000">,</font> X4<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X5<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X6<font color="#990000">,</font> textDaysToExpr<font color="#990000">,</font> X7<font color="#990000">,</font> textDecimalDate<font color="#990000">,</font> X8<font color="#990000">,</font> textCallDelta<font color="#990000">,</font> X9<font color="#990000">,</font> textPutDelta<font color="#990000">,</font> X10<font color="#990000">,</font> textGamma<font color="#990000">,</font> X11<font color="#990000">,</font> textVega<font color="#990000">,</font> X12<font color="#990000">,</font> textCallTheta<font color="#990000">,</font> X13<font color="#990000">,</font> textPutTheta<font color="#990000">,</font> X14<font color="#990000">,</font> textCallRho<font color="#990000">,</font> X15<font color="#990000">,</font> textPutRho<font color="#990000">,</font> X16<font color="#990000">,</font> textLegacyCall<font color="#990000">,</font> X17<font color="#990000">,</font> textLegacyPut<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>textExport <font color="#990000">==</font> <b><font color="#0000FF">true</font></b> <font color="#990000">)</font>
            <font color="#FF0000">{</font>            
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>
                      textPrice<font color="#990000">,</font> textMonth<font color="#990000">,</font> textStrike<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textDaysToExpr<font color="#990000">,</font> textDecimalDate<font color="#990000">,</font> textCallDelta<font color="#990000">,</font> textPutDelta<font color="#990000">,</font> textGamma<font color="#990000">,</font> textVega<font color="#990000">,</font> textCallTheta<font color="#990000">,</font> textPutTheta<font color="#990000">,</font> textCallRho<font color="#990000">,</font> textPutRho<font color="#990000">,</font> textLegacyCall<font color="#990000">,</font> textLegacyPut<font color="#990000">);</font>
              <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
            <font color="#FF0000">}</font>

          <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b> <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <font color="#009900">char</font> textCallLeg2<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
            <font color="#009900">char</font> textPutLeg2<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
            <font color="#009900">char</font> textCallCallSpread<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
            <font color="#009900">char</font> textPutPutSpread<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
            <font color="#009900">char</font> textCallPutSpread<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>
            <font color="#009900">char</font> textPutCallSpread<font color="#990000">[</font><font color="#993399">200</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#993399">0</font> <font color="#FF0000">}</font><font color="#990000">;</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textCallLeg2<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>callLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textCallCallSpread<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>call <font color="#990000">-</font> callLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
            <font color="#FF0000">}</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPutLeg2<font color="#990000">,</font> <font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>putLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPutPutSpread<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>put <font color="#990000">-</font> putLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
            <font color="#FF0000">}</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportCalls <font color="#990000">&amp;&amp;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportPuts <font color="#990000">)</font>
            <font color="#FF0000">{</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textCallPutSpread<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font> optiondata<font color="#990000">.</font>call <font color="#990000">-</font> putLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPutCallSpread<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font> optiondata<font color="#990000">.</font>put  <font color="#990000">-</font> callLeg2<font color="#990000">[</font>totalCounter<font color="#990000">]);</font>
            <font color="#FF0000">}</font>

            <b><font color="#000000">gtk_list_store_set</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>GtkInfo<font color="#990000">.</font>liststore1<font color="#990000">,</font> <font color="#990000">&amp;</font>iter<font color="#990000">,</font> X1<font color="#990000">,</font> textPrice<font color="#990000">,</font> X2<font color="#990000">,</font> textMonth<font color="#990000">,</font> X3<font color="#990000">,</font> textStrike<font color="#990000">,</font> X4<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X5<font color="#990000">,</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> X6<font color="#990000">,</font> textMonthLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font> X7<font color="#990000">,</font> textStrikeLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font> X8<font color="#990000">,</font> textCallLeg2<font color="#990000">,</font> X9<font color="#990000">,</font> textPutLeg2<font color="#990000">,</font> X10<font color="#990000">,</font> textCallCallSpread<font color="#990000">,</font> X11<font color="#990000">,</font> textPutPutSpread<font color="#990000">,</font> X12<font color="#990000">,</font> textCallPutSpread<font color="#990000">,</font> X13<font color="#990000">,</font> textPutCallSpread<font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">);</font>

            <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>textExport <font color="#990000">==</font> <b><font color="#0000FF">true</font></b> <font color="#990000">)</font>
            <font color="#FF0000">{</font>            
              <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>lineData<font color="#990000">,</font><font color="#FF0000">"%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>
                      textPrice<font color="#990000">,</font> textMonth<font color="#990000">,</font> textStrike<font color="#990000">,</font> textCall<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textPut<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> textMonthLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font> textStrikeLeg2<font color="#990000">[</font>totalCounter<font color="#990000">],</font> textCallLeg2<font color="#990000">,</font> textPutLeg2<font color="#990000">,</font> textCallCallSpread<font color="#990000">,</font> textPutPutSpread<font color="#990000">,</font> textCallPutSpread<font color="#990000">,</font> textPutCallSpread<font color="#990000">);</font>
              <b><font color="#000000">strcat</font></b><font color="#990000">(</font>dataExport<font color="#990000">,</font>lineData<font color="#990000">);</font>
            <font color="#FF0000">}</font>

            totalCounter<font color="#990000">++;</font>
          <font color="#FF0000">}</font>

          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> index<font color="#990000">++</font> <font color="#990000">&gt;=</font> <font color="#993399">4</font> <font color="#990000">)</font>
          <font color="#FF0000">{</font>
            <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
          <font color="#FF0000">}</font>

          <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">!</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">)</font>
            <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
        <font color="#FF0000">}</font>
      <font color="#FF0000">}</font>
      properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">++;</font>  properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">++;</font>

      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <font color="#990000">++</font>counter <font color="#990000">&gt;=</font> <font color="#990000">(</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportStrikes <font color="#990000">?</font> <font color="#993399">4</font> <font color="#990000">:</font> <font color="#993399">20</font><font color="#990000">)</font> <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <b><font color="#0000FF">break</font></b><font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>
    <i><font color="#9A1900">/* reset pointers */</font></i>
    properties<font color="#990000">-&gt;</font>expiration_month<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_month<font color="#990000">;</font>
    properties<font color="#990000">-&gt;</font>days_to_expiration<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_days_to_expiration<font color="#990000">;</font>
    properties<font color="#990000">-&gt;</font>expiration_year<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_expiration_year<font color="#990000">;</font>
    properties<font color="#990000">-&gt;</font>time_to_expiration<font color="#990000">=</font>properties<font color="#990000">-&gt;</font>start_time_to_expiration<font color="#990000">;</font>

    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"cumStrikeLeg1 = %f, cumStrikeLeg2 = %f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>cumStrikeLeg1<font color="#990000">,</font>cumStrikeLeg2<font color="#990000">);</font>

    properties<font color="#990000">-&gt;</font>verticalSpread <font color="#990000">=</font> <font color="#990000">(</font> cumStrikeLeg1 <font color="#990000">!=</font> cumStrikeLeg2 <font color="#990000">);</font>

    <b><font color="#000000">g_print</font></b><font color="#990000">(</font><font color="#FF0000">"properties-&gt;verticalSpread = %d</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>verticalSpread<font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>textExport <font color="#990000">==</font> <b><font color="#0000FF">true</font></b> <font color="#990000">)</font>
    <b><font color="#000000">text_export</font></b><font color="#990000">(</font>properties<font color="#990000">,</font> dataExport<font color="#990000">);</font>

  <b><font color="#0000FF">if</font></b> <font color="#990000">(</font> properties<font color="#990000">-&gt;</font>spreads <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">)</font>
    <b><font color="#000000">spreadName</font></b><font color="#990000">(</font>properties<font color="#990000">);</font>

  <b><font color="#0000FF">return</font></b> TRUE<font color="#990000">;</font>
<font color="#FF0000">}</font>

<font color="#009900">void</font> <b><font color="#000000">process_greeks</font></b><font color="#990000">(</font><b><font color="#0000FF">struct</font></b> <font color="#008080">_properties</font> <font color="#990000">*</font>properties<font color="#990000">,</font> <font color="#009900">char</font> <font color="#990000">*</font>textCallDelta<font color="#990000">,</font> <font color="#009900">char</font> <font color="#990000">*</font>textPutDelta<font color="#990000">,</font> <font color="#009900">char</font> <font color="#990000">*</font>textGamma<font color="#990000">,</font> <font color="#009900">char</font> <font color="#990000">*</font>textVega<font color="#990000">,</font> <font color="#009900">char</font> <font color="#990000">*</font>textCallTheta<font color="#990000">,</font> <font color="#009900">char</font> <font color="#990000">*</font>textPutTheta<font color="#990000">,</font> <font color="#009900">char</font> <font color="#990000">*</font>textCallRho<font color="#990000">,</font> <font color="#009900">char</font> <font color="#990000">*</font>textPutRho<font color="#990000">)</font>
<font color="#FF0000">{</font>
  <b><font color="#0000FF">struct</font></b> <font color="#008080">_data</font> optiondata<font color="#990000">;</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>produceCallDelta <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    optiondata <font color="#990000">=</font> <b><font color="#000000">option_call_delta</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textCallDelta<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>calldelta<font color="#990000">);</font>
  <font color="#FF0000">}</font>
        
  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>producePutDelta <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    optiondata <font color="#990000">=</font> <b><font color="#000000">option_put_delta</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPutDelta<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>putdelta<font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>produceGamma <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    optiondata <font color="#990000">=</font> <b><font color="#000000">option_gamma</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textGamma<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>gamma<font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>produceVega <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    optiondata <font color="#990000">=</font> <b><font color="#000000">option_vega</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textVega<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>vega<font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>produceCallTheta <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    optiondata <font color="#990000">=</font> <b><font color="#000000">option_call_theta</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textCallTheta<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>calltheta<font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>producePutTheta <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    optiondata <font color="#990000">=</font> <b><font color="#000000">option_put_theta</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPutTheta<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>puttheta<font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>produceCallRho <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    optiondata <font color="#990000">=</font> <b><font color="#000000">option_call_rho</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textCallRho<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>callrho<font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>producePutRho <font color="#990000">)</font>
  <font color="#FF0000">{</font>
    optiondata <font color="#990000">=</font> <b><font color="#000000">option_put_rho</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">);</font>
    <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>textPutRho<font color="#990000">,</font><font color="#FF0000">"%.*f"</font><font color="#990000">,</font> properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>optiondata<font color="#990000">.</font>putrho<font color="#990000">);</font>
  <font color="#FF0000">}</font>
<font color="#FF0000">}</font>
</tt></pre>
