<!-- Generator: GNU source-highlight 3.1.7
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">/* optionmatrix:                                                            */</font></i>
<i><font color="#9A1900">/*                                                                          */</font></i>
<i><font color="#9A1900">/* Options &amp; Futures Matrix Modeler                                         */</font></i>
<i><font color="#9A1900">/* View and Control Theoretical Option Chains                               */</font></i>
<i><font color="#9A1900">/*                                                                          */</font></i>
<i><font color="#9A1900">/* File: sanity.cpp of optionmatrix                                         */</font></i>
<i><font color="#9A1900">/*                                                                          */</font></i>
<i><font color="#9A1900">/* Copyright (c) Anthony Bradford. 2012.                                    */</font></i>
<i><font color="#9A1900">/* </font></i><u><font color="#0000FF">http://anthonybradford.com</font></u><i><font color="#9A1900">                                               */</font></i>
<i><font color="#9A1900">/* </font></i><u><font color="#0000FF">info@anthonybradford.com</font></u><i><font color="#9A1900">                                                 */</font></i>
<i><font color="#9A1900">/*                                                                          */</font></i>
<i><font color="#9A1900">/* optionmatrix may be freely redistributed.                                */</font></i>
<i><font color="#9A1900">/* See file COPYING included with this distribution for license information */</font></i>

<i><font color="#9A1900">/* </font></i>
<i><font color="#9A1900">   optionmatrix is free software; you can redistribute it and/or modify</font></i>
<i><font color="#9A1900">   it under the terms of the GNU General Public License as published by</font></i>
<i><font color="#9A1900">   the Free Software Foundation; either version 3 of the License, or</font></i>
<i><font color="#9A1900">   (at your option) any later version.</font></i>

<i><font color="#9A1900">   optionmatrix program is distributed in the hope that it will be useful,</font></i>
<i><font color="#9A1900">   but WITHOUT ANY WARRANTY; without even the implied warranty of</font></i>
<i><font color="#9A1900">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</font></i>
<i><font color="#9A1900">   GNU General Public License for more details.</font></i>

<i><font color="#9A1900">   You should have received a copy of the GNU General Public License</font></i>
<i><font color="#9A1900">   along with this program.  If not, see </font></i><u><font color="#0000FF">&lt;http://www.gnu.org/licenses/&gt;</font></u><i><font color="#9A1900">.</font></i>
<i><font color="#9A1900">*/</font></i>

<b><font color="#000080">#include</font></b> <font color="#FF0000">"defs.h"</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">"extern.h"</font>

<b><font color="#000080">#if</font></b> <b><font color="#000000">defined</font></b><font color="#990000">(</font>HAVE_LIBGTK_3<font color="#990000">)</font> <font color="#990000">||</font> <b><font color="#000000">defined</font></b><font color="#990000">(</font>HAVE_LIBGTK_X11_2_0<font color="#990000">)</font>
<b><font color="#000080"># include</font></b> <font color="#FF0000">"../gtk/gtk_extern.h"</font>
<b><font color="#000080">#endif</font></b>

<font color="#009900">int</font> <b><font color="#000000">sanity_check</font></b><font color="#990000">(</font><b><font color="#0000FF">struct</font></b> <font color="#008080">_properties</font> <font color="#990000">*</font>properties<font color="#990000">,</font> <font color="#009900">char</font> <font color="#990000">*</font>statusMessage<font color="#990000">)</font>
<font color="#FF0000">{</font>
    <font color="#009900">bool</font> messageSet <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> <b><font color="#000000">day_changed</font></b><font color="#990000">()</font> <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>decimalorcalendar <font color="#990000">==</font> CALENDAR <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#000000">expires</font></b><font color="#990000">(</font>LEG1<font color="#990000">,</font><font color="#993399">30</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>skipmonth<font color="#990000">,</font>properties<font color="#990000">);</font>
      <b><font color="#000000">expires</font></b><font color="#990000">(</font>LEG2<font color="#990000">,</font><font color="#993399">30</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>skipmonth2<font color="#990000">,</font>properties<font color="#990000">);</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseZ <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseZ <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
        option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>bZallow0Negative <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
        option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Zdefault <font color="#990000">!=</font> <font color="#993399">0</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseZ <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Zdefault<font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Defaulting %s to %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>UseZdes<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Zdefault<font color="#990000">);</font>
      messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseB <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseB <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
        option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>bBallow0Negative <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
        option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Bdefault <font color="#990000">!=</font> <font color="#993399">0</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseB <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Bdefault<font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Defaulting %s to %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>UseBdes<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Bdefault<font color="#990000">);</font>
      messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseJ <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseJ <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
        option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>bJallow0Negative <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
        option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Jdefault <font color="#990000">!=</font> <font color="#993399">0</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseJ <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Jdefault<font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Defaulting %s to %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>UseJdes<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Jdefault<font color="#990000">);</font>
      messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseP <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseP <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
       option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>bPallow0Negative <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
       option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Pdefault <font color="#990000">!=</font> <font color="#993399">0</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseP <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Pdefault<font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Defaulting %s to %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>UsePdes<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Pdefault<font color="#990000">);</font>
      messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseQ <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseQ <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
       option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>bQallow0Negative <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
       option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Qdefault <font color="#990000">!=</font> <font color="#993399">0</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseQ <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Qdefault<font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Defaulting %s to %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>UseQdes<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Qdefault<font color="#990000">);</font>
      messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseR <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseR <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
       option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>bRallow0Negative <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
       option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Rdefault <font color="#990000">!=</font> <font color="#993399">0</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseR <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Rdefault<font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Defaulting %s to %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>UseRdes<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Rdefault<font color="#990000">);</font>
      messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseS <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseS <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
       option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>bSallow0Negative <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
       option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Sdefault <font color="#990000">!=</font> <font color="#993399">0</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseS <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Sdefault<font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Defaulting %s to %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>UseSdes<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Sdefault<font color="#990000">);</font>
      messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseT <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseT <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
       option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>bTallow0Negative <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
       option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Tdefault <font color="#990000">!=</font> <font color="#993399">0</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseT <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Tdefault<font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Defaulting %s to %.*f</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>UseTdes<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Tdefault<font color="#990000">);</font>
      messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>bUsePound <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UsePound <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
        option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>bPoundallow0Negative <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">&amp;&amp;</font>
        option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Pounddefault <font color="#990000">!=</font> <font color="#993399">0</font><font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UsePound <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Pounddefault<font color="#990000">;</font>

      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>bUseStateNames <font color="#990000">==</font> <font color="#993399">0</font> <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Defaulting %s to %d</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>UsePounddes<font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Pounddefault<font color="#990000">);</font>
        messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>

      <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
      <font color="#FF0000">{</font>
        <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Defaulting %s to %s</font><font color="#CC33CC">\n</font><font color="#FF0000">"</font><font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>UsePounddes<font color="#990000">,(</font><font color="#009900">char</font> <font color="#990000">*)&amp;(</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>StateNames<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UsePound<font color="#990000">-</font><font color="#993399">1</font><font color="#990000">]));</font>
        messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <i><font color="#9A1900">/************************************************************************************/</font></i>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseZ <font color="#990000">&amp;&amp;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Zmax <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseZ <font color="#990000">&gt;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Zmax <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseZ <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Zdefault<font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>
    
    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseB <font color="#990000">&amp;&amp;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Bmax <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseB <font color="#990000">&gt;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Bmax <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseB <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Bdefault<font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseJ <font color="#990000">&amp;&amp;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Jmax <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseJ <font color="#990000">&gt;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Jmax <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseJ <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Jdefault<font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseP <font color="#990000">&amp;&amp;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Pmax <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseP <font color="#990000">&gt;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Pmax <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseP <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Pdefault<font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <i><font color="#9A1900">//</font></i>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseQ <font color="#990000">&amp;&amp;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Qmax <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseQ <font color="#990000">&gt;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Qmax <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseQ <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Qdefault<font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseR <font color="#990000">&amp;&amp;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Rmax <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseR <font color="#990000">&gt;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Rmax <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseR <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Rdefault<font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseS <font color="#990000">&amp;&amp;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Smax <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseS <font color="#990000">&gt;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Smax <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseS <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Sdefault<font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>iUseT <font color="#990000">&amp;&amp;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Tmax <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseT <font color="#990000">&gt;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Tmax <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UseT <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Tdefault<font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>bUsePound <font color="#990000">&amp;&amp;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Poundmax <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UsePound <font color="#990000">&gt;</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Poundmax <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UsePound <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>Pounddefault<font color="#990000">;</font>

        <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>bUseStateNames <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">)</font> 
        <font color="#FF0000">{</font>
          <i><font color="#9A1900">//sprintf(statusMessage,"%s = %s",option_algorithms[properties-&gt;modeltype].UsePounddes,&amp;(option_algorithms[properties-&gt;modeltype].StateNames[properties-&gt;data.UsePound-1]));</font></i>

        <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
        <font color="#FF0000">{</font>
          <i><font color="#9A1900">//sprintf(statusMessage,"%s = %d",option_algorithms[properties-&gt;modeltype].UsePounddes,properties-&gt;data.UsePound);</font></i>
        <font color="#FF0000">}</font>
        <i><font color="#9A1900">//messageSet = 1;</font></i>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <i><font color="#9A1900">/*******************************************************************/</font></i>
    <b><font color="#0000FF">if</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>format <font color="#990000">!=</font> DEMO_FUTURES <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>format <font color="#990000">!=</font> DEMO_OPTIONS<font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>assetClass <font color="#990000">==</font> FUTURES_CLASS <font color="#990000">&amp;&amp;</font> 
          properties<font color="#990000">-&gt;</font>format <font color="#990000">!=</font> CALENDAR_FUTURE <font color="#990000">&amp;&amp;</font>
          properties<font color="#990000">-&gt;</font>format <font color="#990000">!=</font> DECIMAL_FUTURE <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        properties<font color="#990000">-&gt;</font>format <font color="#990000">=</font> CALENDAR_FUTURE<font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>decimalorcalendar<font color="#990000">=</font>CALENDAR<font color="#990000">;</font>
      <font color="#FF0000">}</font>
    
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>assetClass <font color="#990000">!=</font> FUTURES_CLASS <font color="#990000">&amp;&amp;</font> 
         <font color="#990000">(</font> properties<font color="#990000">-&gt;</font>format <font color="#990000">==</font> CALENDAR_FUTURE <font color="#990000">||</font>
           properties<font color="#990000">-&gt;</font>format <font color="#990000">==</font> DECIMAL_FUTURE <font color="#990000">))</font>
      <font color="#FF0000">{</font>
        properties<font color="#990000">-&gt;</font>format <font color="#990000">=</font> DECIMAL_OPTIONS<font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>decimalorcalendar <font color="#990000">=</font> DECIMALS<font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">]</font> <font color="#990000">&lt;=</font> <font color="#993399">0</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Please set second time variable to positive amount for pricing"</font><font color="#990000">);</font>
      messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">2</font><font color="#990000">]</font> <font color="#990000">&lt;=</font> <font color="#993399">0</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">2</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Please set third time variable to positive amount for pricing"</font><font color="#990000">);</font>
      messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>format <font color="#990000">!=</font> DEMO_OPTIONS <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportTime2 <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">&amp;&amp;</font>
          properties<font color="#990000">-&gt;</font>format <font color="#990000">!=</font> DECIMAL_GREEKS <font color="#990000">&amp;&amp;</font>
          properties<font color="#990000">-&gt;</font>format <font color="#990000">!=</font> DECIMAL_OPTIONS <font color="#990000">)</font>
      <font color="#FF0000">{</font>
        properties<font color="#990000">-&gt;</font>format <font color="#990000">=</font> DECIMAL_OPTIONS<font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>decimalorcalendar <font color="#990000">=</font> DECIMALS<font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportTime2 <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">&amp;&amp;</font> 
        option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>perpetual <font color="#990000">==</font> <font color="#993399">0</font>  <font color="#990000">&amp;&amp;</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">]</font> <font color="#990000">&gt;=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">]*</font><font color="#993399">2</font><font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Setting %s %.*f greater than %s %.*f"</font><font color="#990000">,</font>
              option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportTime1des<font color="#990000">,</font>
              properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>
              properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font>
              option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportTime2des<font color="#990000">,</font>
              properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>
              properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">]);</font>
      messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportTime3 <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">&amp;&amp;</font> 
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">]</font> <font color="#990000">&gt;=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">2</font><font color="#990000">]</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">2</font><font color="#990000">]</font> <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">]*</font><font color="#993399">2</font><font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Setting %s %.*f greater than %s %.*f"</font><font color="#990000">,</font>
              option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportTime3des<font color="#990000">,</font>
              properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>
              properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">2</font><font color="#990000">],</font>
              option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportTime2des<font color="#990000">,</font>
              properties<font color="#990000">-&gt;</font>precision<font color="#990000">,</font>
              properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">]);</font>
      messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportVolatility <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">&amp;&amp;</font> 
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>volatility <font color="#990000">&lt;</font> <font color="#993399">0</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>volatility <font color="#990000">=</font> <font color="#990000">.</font><font color="#993399">25</font><font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Not set. Standard deviation forced to : %.3f"</font><font color="#990000">,</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>volatility<font color="#990000">);</font>
      messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>decimalorcalendar <font color="#990000">==</font> DECIMALS <font color="#990000">&amp;&amp;</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">&lt;=</font> <font color="#993399">0.0</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <i><font color="#9A1900">//properties-&gt;data.t[0] = .25;</font></i>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>t<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
      <i><font color="#9A1900">//sprintf(statusMessage,"Not set. Decimal time forced to: %.3f",properties-&gt;data.t[0]);</font></i>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"Please set time to positive amount for pricing"</font><font color="#990000">);</font>
      messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>realTimeBleeding <font color="#990000">==</font> <font color="#993399">1</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
        <b><font color="#000000">time</font></b><font color="#990000">(&amp;</font>properties<font color="#990000">-&gt;</font>updatetime<font color="#990000">);</font>

        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te  <font color="#990000">=</font> <b><font color="#000000">difftime</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>updatetime<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>starttime<font color="#990000">)</font> <font color="#990000">/</font> <font color="#990000">(</font><font color="#009900">double</font><font color="#990000">)</font> <font color="#993399">31536000</font><font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te2 <font color="#990000">=</font> <b><font color="#000000">difftime</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>updatetime<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>starttime2<font color="#990000">)</font> <font color="#990000">/</font> <font color="#990000">(</font><font color="#009900">double</font><font color="#990000">)</font> <font color="#993399">31536000</font><font color="#990000">;</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te3 <font color="#990000">=</font> <b><font color="#000000">difftime</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>updatetime<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>starttime3<font color="#990000">)</font> <font color="#990000">/</font> <font color="#990000">(</font><font color="#009900">double</font><font color="#990000">)</font> <font color="#993399">31536000</font><font color="#990000">;</font>

        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te4 <font color="#990000">=</font> <b><font color="#000000">difftime</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>updatetime<font color="#990000">,</font>properties<font color="#990000">-&gt;</font>starttime4<font color="#990000">)</font> <font color="#990000">/</font> <font color="#990000">(</font><font color="#009900">double</font><font color="#990000">)</font> <font color="#993399">31536000</font><font color="#990000">;</font>

    <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te  <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te2 <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te3 <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te4 <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>decimalorcalendar <font color="#990000">==</font> CALENDAR <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>te <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> properties<font color="#990000">-&gt;</font>customstrike <font color="#990000">&lt;=</font> <font color="#993399">0</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>customstrike <font color="#990000">=</font> properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>price<font color="#990000">;</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>bUsePound <font color="#990000">&amp;&amp;</font>
        option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>bPoundallow0Negative <font color="#990000">!=</font> <font color="#993399">1</font> <font color="#990000">&amp;&amp;</font> 
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UsePound <font color="#990000">&lt;=</font> <font color="#993399">0</font> <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>UsePound <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
      <b><font color="#000000">sprintf</font></b><font color="#990000">(</font>statusMessage<font color="#990000">,</font><font color="#FF0000">"%s set to 1"</font><font color="#990000">,</font>option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>UsePounddes<font color="#990000">);</font>
      messageSet <font color="#990000">=</font> <font color="#993399">1</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>
    
    <b><font color="#0000FF">if</font></b><font color="#990000">(</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>supportDividend <font color="#990000">==</font> <font color="#993399">2</font> <font color="#990000">&amp;&amp;</font>
        properties<font color="#990000">-&gt;</font>format <font color="#990000">==</font> DEMO_OPTIONS <font color="#990000">)</font>
    <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b><font color="#990000">(</font>properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>dividend <font color="#990000">==</font> <font color="#993399">0</font><font color="#990000">)</font>
      <font color="#FF0000">{</font>
        properties<font color="#990000">-&gt;</font>data<font color="#990000">.</font>dividend <font color="#990000">=</font> option_algorithms<font color="#990000">[</font>properties<font color="#990000">-&gt;</font>modeltype<font color="#990000">].</font>defaultDividend<font color="#990000">;</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">return</font></b> messageSet<font color="#990000">;</font>
<font color="#FF0000">}</font>
</tt></pre>
